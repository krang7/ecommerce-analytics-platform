[0m09:21:16.234469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E817F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E7E5D7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E83B5940>]}


============================== 09:21:16.239734 | 8c4087d8-acc5-4eb1-ae38-29ffdb924ffe ==============================
[0m09:21:16.239734 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:21:16.240700 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt init dbt_project', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m09:21:16.268979 [info ] [MainThread]: Creating dbt configuration folder at C:\Users\krang\.dbt
[0m09:21:16.272845 [debug] [MainThread]: Starter project path: C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\include\starter_project
[0m09:21:16.303647 [info ] [MainThread]: 
Your new dbt project "dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m09:21:16.303647 [info ] [MainThread]: Setting up your profile.
[0m09:24:57.470824 [error] [MainThread]: Encountered an error:
list index out of range
[0m09:24:57.515272 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 483, in init
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 346, in run
    self.setup_profile(profile_name)
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 261, in setup_profile
    adapter = self.ask_for_adapter_choice()
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\init.py", line 243, in ask_for_adapter_choice
    return available_adapters[numeric_choice - 1]
           ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
IndexError: list index out of range

[0m09:24:57.516287 [debug] [MainThread]: Command `dbt init` failed at 09:24:57.516287 after 221.38 seconds
[0m09:24:57.516287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E747D4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E847E360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275E83B5310>]}
[0m09:24:57.517773 [debug] [MainThread]: Flushing usage events
[0m09:24:58.717616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:27:23.680985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE03A75C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FADFE66BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE044E510>]}


============================== 09:27:23.686138 | 4d6659ec-87e1-4029-843c-f91d4096578c ==============================
[0m09:27:23.686138 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:27:23.686138 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt init dbt_project', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m09:27:23.707196 [info ] [MainThread]: A project called dbt_project already exists here.
[0m09:27:23.708617 [debug] [MainThread]: Command `dbt init` succeeded at 09:27:23.707196 after 0.12 seconds
[0m09:27:23.708617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FADF3B06B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FADFD2F320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FAE0063170>]}
[0m09:27:23.708617 [debug] [MainThread]: Flushing usage events
[0m09:27:24.831744 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:30:01.439671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE42AF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE7D60C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE79D8950>]}


============================== 09:30:01.443739 | 37144c11-7521-439c-b555-033ca2b4f5d2 ==============================
[0m09:30:01.443739 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:30:01.444741 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt init', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m09:30:12.281245 [info ] [MainThread]: A project called dbt_project already exists here.
[0m09:30:12.283275 [debug] [MainThread]: Command `dbt init` succeeded at 09:30:12.283275 after 10.95 seconds
[0m09:30:12.283275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE5401580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE994BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEE80132C0>]}
[0m09:30:12.284288 [debug] [MainThread]: Flushing usage events
[0m09:30:13.391659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:31:57.241336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669C0F260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669C0FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669C0FFB0>]}


============================== 09:31:57.245507 | 61245b3c-b250-4ff4-a0f9-faf748c662a0 ==============================
[0m09:31:57.245507 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:31:57.246510 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt init dbt_project', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m09:31:57.266048 [debug] [MainThread]: Starter project path: C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\include\starter_project
[0m09:31:57.280024 [info ] [MainThread]: 
Your new dbt project "dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m09:31:57.281033 [info ] [MainThread]: Setting up your profile.
[0m09:34:35.561558 [info ] [MainThread]: Profile dbt_project written to C:\Users\krang\.dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m09:34:35.562565 [debug] [MainThread]: Command `dbt init` succeeded at 09:34:35.562565 after 158.42 seconds
[0m09:34:35.563588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669745280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669F76720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021669F767E0>]}
[0m09:34:35.564593 [debug] [MainThread]: Flushing usage events
[0m09:34:36.695946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:49.833206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCD981550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCC77AB70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCD724170>]}


============================== 09:34:49.837271 | 5cae4baa-6696-4176-8eb8-58c511cc7fc8 ==============================
[0m09:34:49.837271 [info ] [MainThread]: Running with dbt=1.10.13
[0m09:34:49.838277 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m09:34:49.859506 [info ] [MainThread]: dbt version: 1.10.13
[0m09:34:49.859506 [info ] [MainThread]: python version: 3.12.5
[0m09:34:49.860786 [info ] [MainThread]: python path: C:\Users\krang\AppData\Local\Programs\Python\Python312\python.exe
[0m09:34:49.860786 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m09:34:49.914582 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m09:34:49.914582 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m09:34:49.915708 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m09:34:49.917066 [info ] [MainThread]: adapter type: postgres
[0m09:34:49.918086 [info ] [MainThread]: adapter version: 1.9.1
[0m09:34:49.918086 [info ] [MainThread]: Configuration:
[0m09:34:49.918086 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:34:49.919096 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m09:34:49.919096 [info ] [MainThread]: Required dependencies:
[0m09:34:49.919096 [debug] [MainThread]: Executing "git --help"
[0m09:34:49.971469 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:34:49.972475 [debug] [MainThread]: STDERR: "b''"
[0m09:34:49.972475 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:34:49.973486 [info ] [MainThread]: Connection:
[0m09:34:49.973486 [info ] [MainThread]:   host: localhost
[0m09:34:49.973486 [info ] [MainThread]:   port: 5432
[0m09:34:49.974489 [info ] [MainThread]:   user: postgres
[0m09:34:49.974489 [info ] [MainThread]:   database: ecommerce_raw
[0m09:34:49.974489 [info ] [MainThread]:   schema: public
[0m09:34:49.974489 [info ] [MainThread]:   connect_timeout: 10
[0m09:34:49.975560 [info ] [MainThread]:   role: None
[0m09:34:49.975560 [info ] [MainThread]:   search_path: None
[0m09:34:49.975560 [info ] [MainThread]:   keepalives_idle: 0
[0m09:34:49.976563 [info ] [MainThread]:   sslmode: None
[0m09:34:49.976563 [info ] [MainThread]:   sslcert: None
[0m09:34:49.976563 [info ] [MainThread]:   sslkey: None
[0m09:34:49.976563 [info ] [MainThread]:   sslrootcert: None
[0m09:34:49.977565 [info ] [MainThread]:   application_name: dbt
[0m09:34:49.977565 [info ] [MainThread]:   retries: 1
[0m09:34:49.977565 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m09:34:50.352956 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m09:34:52.396695 [debug] [MainThread]: Using postgres connection "debug"
[0m09:34:52.397710 [debug] [MainThread]: On debug: select 1 as id
[0m09:34:52.397710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:34:52.445194 [debug] [MainThread]: SQL status: SELECT 1 in 0.047 seconds
[0m09:34:52.446196 [debug] [MainThread]: On debug: Close
[0m09:34:52.446196 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:34:52.447202 [info ] [MainThread]: [31m1 check failed:[0m
[0m09:34:52.447202 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml> not found

[0m09:34:52.448261 [debug] [MainThread]: Command `dbt debug` failed at 09:34:52.448261 after 2.72 seconds
[0m09:34:52.448261 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:34:52.449261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCD586DE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCF1BE4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015BCD9BA4B0>]}
[0m09:34:52.449261 [debug] [MainThread]: Flushing usage events
[0m09:34:53.542974 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:17.133400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F648C5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F647C77D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F648C71A0>]}


============================== 13:52:17.141780 | 58d13ce9-d132-493e-8621-5c15b20a9df5 ==============================
[0m13:52:17.141780 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:52:17.143075 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt debug', 'printer_width': '80', 'target_path': 'None'}
[0m13:52:17.179112 [info ] [MainThread]: dbt version: 1.10.13
[0m13:52:17.180112 [info ] [MainThread]: python version: 3.12.5
[0m13:52:17.180112 [info ] [MainThread]: python path: C:\Users\krang\AppData\Local\Programs\Python\Python312\python.exe
[0m13:52:17.181186 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m13:52:17.410251 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m13:52:17.411253 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m13:52:17.411253 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m13:52:17.413263 [info ] [MainThread]: adapter type: postgres
[0m13:52:17.413263 [info ] [MainThread]: adapter version: 1.9.1
[0m13:52:17.503151 [info ] [MainThread]: Configuration:
[0m13:52:17.504151 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:52:17.504151 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:52:17.504151 [info ] [MainThread]: Required dependencies:
[0m13:52:17.505256 [debug] [MainThread]: Executing "git --help"
[0m13:52:17.545903 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:52:17.546955 [debug] [MainThread]: STDERR: "b''"
[0m13:52:17.546955 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:52:17.546955 [info ] [MainThread]: Connection:
[0m13:52:17.548253 [info ] [MainThread]:   host: localhost
[0m13:52:17.548253 [info ] [MainThread]:   port: 5432
[0m13:52:17.548253 [info ] [MainThread]:   user: postgres
[0m13:52:17.549256 [info ] [MainThread]:   database: ecommerce_raw
[0m13:52:17.549256 [info ] [MainThread]:   schema: public
[0m13:52:17.549256 [info ] [MainThread]:   connect_timeout: 10
[0m13:52:17.549256 [info ] [MainThread]:   role: None
[0m13:52:17.550258 [info ] [MainThread]:   search_path: None
[0m13:52:17.550258 [info ] [MainThread]:   keepalives_idle: 0
[0m13:52:17.550258 [info ] [MainThread]:   sslmode: prefer
[0m13:52:17.551287 [info ] [MainThread]:   sslcert: None
[0m13:52:17.551287 [info ] [MainThread]:   sslkey: None
[0m13:52:17.551287 [info ] [MainThread]:   sslrootcert: None
[0m13:52:17.552291 [info ] [MainThread]:   application_name: dbt
[0m13:52:17.552291 [info ] [MainThread]:   retries: 1
[0m13:52:17.553310 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:52:17.996430 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:52:20.252979 [debug] [MainThread]: Using postgres connection "debug"
[0m13:52:20.252979 [debug] [MainThread]: On debug: select 1 as id
[0m13:52:20.254484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:52:20.327858 [debug] [MainThread]: SQL status: SELECT 1 in 0.073 seconds
[0m13:52:20.329094 [debug] [MainThread]: On debug: Close
[0m13:52:20.329094 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:52:20.329094 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:52:20.330110 [debug] [MainThread]: Command `python -m dbt.cli.main debug` succeeded at 13:52:20.330110 after 3.34 seconds
[0m13:52:20.331320 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:52:20.331320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F64B432F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F64BC5DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F64F1DDC0>]}
[0m13:52:20.331320 [debug] [MainThread]: Flushing usage events
[0m13:52:21.476022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:52:36.981169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A379A8D400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3786A02C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3795BC140>]}


============================== 13:52:36.985401 | 23d04d2e-9f9c-489e-beca-796d8cce011f ==============================
[0m13:52:36.985401 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:52:36.985401 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'invocation_command': 'dbt seed --show', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:52:37.328325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37AEAF740>]}
[0m13:52:37.384438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37AE8C890>]}
[0m13:52:37.386471 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:52:37.725091 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:52:37.725850 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:52:37.727102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37B12FA70>]}
[0m13:52:39.767472 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:52:39.776531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37B6A08C0>]}
[0m13:52:39.847199 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:52:39.867678 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:52:39.897899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37B5918B0>]}
[0m13:52:39.898902 [info ] [MainThread]: Found 3 models, 4 data tests, 9 sources, 447 macros
[0m13:52:39.898902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23d04d2e-9f9c-489e-beca-796d8cce011f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A37B67E390>]}
[0m13:52:39.900977 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:52:39.900977 [debug] [MainThread]: Command end result
[0m13:52:39.919796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:52:39.921893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:52:39.926256 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:52:39.926905 [info ] [MainThread]: 
[0m13:52:39.926905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:39.926905 [info ] [MainThread]: 
[0m13:52:39.928360 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m13:52:39.929363 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 13:52:39.929363 after 3.05 seconds
[0m13:52:39.929363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3783EB050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3785765A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A378EDD8E0>]}
[0m13:52:39.930363 [debug] [MainThread]: Flushing usage events
[0m13:52:40.947995 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:00.615416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113941D0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113947BEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021139479A30>]}


============================== 13:53:00.619419 | 19a8583c-63ff-49e0-9fad-398eb289877a ==============================
[0m13:53:00.619419 [info ] [MainThread]: Running with dbt=1.10.13
[0m13:53:00.620420 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt build -s stg_customers --full-refresh', 'printer_width': '80', 'write_json': 'True'}
[0m13:53:00.834086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113952B800>]}
[0m13:53:00.889184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021139A2B7A0>]}
[0m13:53:00.889184 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:53:01.194570 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m13:53:01.354967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:53:01.354967 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:53:01.359996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:53:01.393320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113B70FA10>]}
[0m13:53:01.460357 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:53:01.463389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:53:01.506939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BA4F470>]}
[0m13:53:01.507939 [info ] [MainThread]: Found 3 models, 4 data tests, 9 sources, 447 macros
[0m13:53:01.509444 [info ] [MainThread]: 
[0m13:53:01.509444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:53:01.510459 [info ] [MainThread]: 
[0m13:53:01.510459 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:53:01.511508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:53:01.601588 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:53:01.601588 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:53:01.601588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:01.769388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.167 seconds
[0m13:53:01.770443 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:53:01.774446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:53:01.779073 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:53:01.780088 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:53:01.780088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:53:01.815409 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m13:53:01.816511 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:53:01.816511 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:53:01.832192 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.015 seconds
[0m13:53:01.833194 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:53:01.834193 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:53:01.839579 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:01.839579 [debug] [MainThread]: On master: BEGIN
[0m13:53:01.839579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:53:01.875319 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:53:01.875996 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:01.875996 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:53:01.893068 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m13:53:01.894072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BA4C5C0>]}
[0m13:53:01.895081 [debug] [MainThread]: On master: ROLLBACK
[0m13:53:01.895081 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:01.895786 [debug] [MainThread]: On master: BEGIN
[0m13:53:01.895786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:53:01.895786 [debug] [MainThread]: On master: COMMIT
[0m13:53:01.895786 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:01.895786 [debug] [MainThread]: On master: COMMIT
[0m13:53:01.897174 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:01.897174 [debug] [MainThread]: On master: Close
[0m13:53:01.902189 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m13:53:01.903454 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_customers ............................... [RUN]
[0m13:53:01.903454 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:53:01.903454 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m13:53:01.910004 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:53:01.912010 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m13:53:01.943474 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:53:01.946203 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:53:01.946203 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:53:01.947435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:53:01.988992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m13:53:01.988992 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:53:01.990013 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:53:02.010163 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:53:02.015219 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:53:02.015219 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:53:02.017322 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:53:02.029014 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:53:02.030017 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:53:02.030017 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:53:02.031979 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:53:02.037035 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:53:02.041092 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:53:02.041092 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:53:02.042709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:53:02.044492 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m13:53:02.045743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a8583c-63ff-49e0-9fad-398eb289877a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211370DD190>]}
[0m13:53:02.047037 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.14s]
[0m13:53:02.048048 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m13:53:02.049308 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:02.049308 [debug] [MainThread]: On master: BEGIN
[0m13:53:02.049308 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:53:02.085912 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:53:02.086939 [debug] [MainThread]: On master: COMMIT
[0m13:53:02.086939 [debug] [MainThread]: Using postgres connection "master"
[0m13:53:02.086939 [debug] [MainThread]: On master: COMMIT
[0m13:53:02.087943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:53:02.087943 [debug] [MainThread]: On master: Close
[0m13:53:02.087943 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:53:02.087943 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:53:02.088965 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:53:02.088965 [debug] [MainThread]: Connection 'model.dbt_project.stg_customers' was properly closed.
[0m13:53:02.088965 [info ] [MainThread]: 
[0m13:53:02.089965 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:53:02.089965 [debug] [MainThread]: Command end result
[0m13:53:02.109547 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:53:02.112051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:53:02.117157 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:53:02.118156 [info ] [MainThread]: 
[0m13:53:02.118156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:53:02.119244 [info ] [MainThread]: 
[0m13:53:02.119244 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:53:02.120248 [debug] [MainThread]: Command `python -m dbt.cli.main build` succeeded at 13:53:02.120248 after 1.61 seconds
[0m13:53:02.121254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113A05BBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113A05B740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113B4F35F0>]}
[0m13:53:02.121254 [debug] [MainThread]: Flushing usage events
[0m13:53:03.852989 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:50.589806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195968000B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019597433650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001959636AC60>]}


============================== 14:31:50.596615 | 90b5ebb3-b72c-4adf-8843-83b352e284d5 ==============================
[0m14:31:50.596615 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:31:50.596615 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed --show', 'printer_width': '80', 'write_json': 'True'}
[0m14:31:51.091794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '90b5ebb3-b72c-4adf-8843-83b352e284d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019598D2B860>]}
[0m14:31:51.147063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '90b5ebb3-b72c-4adf-8843-83b352e284d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195971F7260>]}
[0m14:31:51.148306 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:31:51.549075 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:31:52.001156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:31:52.002171 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\staging\stg_orders.sql
[0m14:31:52.215344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m14:31:52.226645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90b5ebb3-b72c-4adf-8843-83b352e284d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195992DB8C0>]}
[0m14:31:52.296676 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:31:52.301540 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:31:52.345904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90b5ebb3-b72c-4adf-8843-83b352e284d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019599325460>]}
[0m14:31:52.347047 [info ] [MainThread]: Found 4 models, 4 data tests, 9 sources, 447 macros
[0m14:31:52.347047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90b5ebb3-b72c-4adf-8843-83b352e284d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019596214E90>]}
[0m14:31:52.349292 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:31:52.350346 [debug] [MainThread]: Command end result
[0m14:31:52.425962 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:31:52.429029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:31:52.432029 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:31:52.433029 [info ] [MainThread]: 
[0m14:31:52.433029 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:52.433029 [info ] [MainThread]: 
[0m14:31:52.433029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=0
[0m14:31:52.435043 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 14:31:52.435043 after 1.98 seconds
[0m14:31:52.435792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195991D2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195992CF680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019599325940>]}
[0m14:31:52.435792 [debug] [MainThread]: Flushing usage events
[0m14:31:54.536796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:27.575112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D660E2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D687BB080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D68DC6E40>]}


============================== 14:40:27.580290 | 5f0a5b1d-43a5-42ae-99bc-f9aadceb76fc ==============================
[0m14:40:27.580290 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:40:27.582207 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:40:27.608932 [info ] [MainThread]: dbt version: 1.9.10
[0m14:40:27.608932 [info ] [MainThread]: python version: 3.12.5
[0m14:40:27.608932 [info ] [MainThread]: python path: C:\Users\krang\AppData\Local\Programs\Python\Python312\python.exe
[0m14:40:27.610433 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m14:40:27.664571 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m14:40:27.664571 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m14:40:27.665709 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m14:40:27.666785 [info ] [MainThread]: adapter type: postgres
[0m14:40:27.667804 [info ] [MainThread]: adapter version: 1.9.1
[0m14:40:27.755759 [info ] [MainThread]: Configuration:
[0m14:40:27.756759 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:40:27.758141 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:40:27.759140 [info ] [MainThread]: Required dependencies:
[0m14:40:27.759140 [debug] [MainThread]: Executing "git --help"
[0m14:40:27.795767 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:40:27.796782 [debug] [MainThread]: STDERR: "b''"
[0m14:40:27.797802 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:40:27.797802 [info ] [MainThread]: Connection:
[0m14:40:27.797802 [info ] [MainThread]:   host: localhost
[0m14:40:27.798806 [info ] [MainThread]:   port: 5432
[0m14:40:27.798806 [info ] [MainThread]:   user: postgres
[0m14:40:27.798806 [info ] [MainThread]:   database: ecommerce_raw
[0m14:40:27.799821 [info ] [MainThread]:   schema: public
[0m14:40:27.799821 [info ] [MainThread]:   connect_timeout: 10
[0m14:40:27.799821 [info ] [MainThread]:   role: None
[0m14:40:27.799821 [info ] [MainThread]:   search_path: None
[0m14:40:27.800837 [info ] [MainThread]:   keepalives_idle: 0
[0m14:40:27.800837 [info ] [MainThread]:   sslmode: prefer
[0m14:40:27.800837 [info ] [MainThread]:   sslcert: None
[0m14:40:27.800837 [info ] [MainThread]:   sslkey: None
[0m14:40:27.800837 [info ] [MainThread]:   sslrootcert: None
[0m14:40:27.800837 [info ] [MainThread]:   application_name: dbt
[0m14:40:27.802340 [info ] [MainThread]:   retries: 1
[0m14:40:27.802340 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:28.098704 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:40:29.900710 [debug] [MainThread]: Using postgres connection "debug"
[0m14:40:29.900710 [debug] [MainThread]: On debug: select 1 as id
[0m14:40:29.900710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:29.974076 [debug] [MainThread]: SQL status: SELECT 1 in 0.073 seconds
[0m14:40:29.975170 [debug] [MainThread]: On debug: Close
[0m14:40:29.975170 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:40:29.975170 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:40:29.977208 [debug] [MainThread]: Command `python -m dbt.cli.main debug` succeeded at 14:40:29.977208 after 2.51 seconds
[0m14:40:29.977208 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:40:29.977208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D683342F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D660E2D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D68FCF7D0>]}
[0m14:40:29.978208 [debug] [MainThread]: Flushing usage events
[0m14:40:31.340986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:52.432546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC1FB9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC1C73770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC248E1E0>]}


============================== 14:40:52.437300 | 05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3 ==============================
[0m14:40:52.437300 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:40:52.437300 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt seed --show', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m14:40:52.701145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC1C73770>]}
[0m14:40:52.757514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC22339E0>]}
[0m14:40:52.758517 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:53.070561 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:40:53.159373 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:40:53.160377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC40B3860>]}
[0m14:40:54.641078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m14:40:54.650164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4306A20>]}
[0m14:40:54.714416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:40:54.750608 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:40:54.778256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC44559A0>]}
[0m14:40:54.778256 [info ] [MainThread]: Found 4 models, 4 data tests, 9 sources, 447 macros
[0m14:40:54.779257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bbbc61-e2c4-4df9-b4d9-a8836ed56ba3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC39FF170>]}
[0m14:40:54.781342 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:40:54.781342 [debug] [MainThread]: Command end result
[0m14:40:54.799420 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:40:54.802421 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:40:54.805438 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:40:54.805438 [info ] [MainThread]: 
[0m14:40:54.805438 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:54.806631 [info ] [MainThread]: 
[0m14:40:54.806631 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=0 SKIP=0 TOTAL=0
[0m14:40:54.807635 [debug] [MainThread]: Command `python -m dbt.cli.main seed` succeeded at 14:40:54.807635 after 2.47 seconds
[0m14:40:54.808638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC2288200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC2030FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC432DBE0>]}
[0m14:40:54.808638 [debug] [MainThread]: Flushing usage events
[0m14:40:57.114424 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:56:57.311346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469A01130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469A01610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469A00B90>]}


============================== 14:56:57.319542 | d3fb6913-a950-4577-ab13-74fd77e2f382 ==============================
[0m14:56:57.319542 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:56:57.320100 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt ls -s stg_customers stg_orders --output json', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:56:57.581818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3fb6913-a950-4577-ab13-74fd77e2f382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469AF9190>]}
[0m14:56:57.634492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3fb6913-a950-4577-ab13-74fd77e2f382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001546901C6B0>]}
[0m14:56:57.635493 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:56:58.049802 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:56:58.709166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:56:58.709669 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:56:58.714681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m14:56:58.749859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3fb6913-a950-4577-ab13-74fd77e2f382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469BC9010>]}
[0m14:56:58.819567 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:56:58.851776 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:56:58.898731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3fb6913-a950-4577-ab13-74fd77e2f382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001546AFFB920>]}
[0m14:56:58.899739 [info ] [MainThread]: Found 4 models, 4 data tests, 9 sources, 447 macros
[0m14:56:58.900248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3fb6913-a950-4577-ab13-74fd77e2f382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001546B3606E0>]}
[0m14:56:58.901299 [info ] [MainThread]: {"name": "stg_customers", "resource_type": "model", "package_name": "dbt_project", "original_file_path": "models\\staging\\stg_customers.sql", "unique_id": "model.dbt_project.stg_customers", "alias": "stg_customers", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.dbt_project.raw.olist_customers_dataset"]}}
[0m14:56:58.901299 [info ] [MainThread]: {"name": "stg_orders", "resource_type": "model", "package_name": "dbt_project", "original_file_path": "models\\staging\\stg_orders.sql", "unique_id": "model.dbt_project.stg_orders", "alias": "stg_orders", "config": {"enabled": true, "alias": null, "schema": null, "database": null, "tags": [], "meta": {}, "group": null, "materialized": "view", "incremental_strategy": null, "batch_size": null, "lookback": 1, "begin": null, "persist_docs": {}, "post-hook": [], "pre-hook": [], "quoting": {}, "column_types": {}, "full_refresh": null, "unique_key": null, "on_schema_change": "ignore", "on_configuration_change": "apply", "grants": {}, "packages": [], "docs": {"show": true, "node_color": null}, "contract": {"enforced": false, "alias_types": true}, "event_time": null, "concurrent_batches": null, "access": "protected"}, "tags": [], "depends_on": {"macros": [], "nodes": ["source.dbt_project.raw.olist_orders_dataset"]}}
[0m14:56:58.902719 [debug] [MainThread]: Command `dbt ls` succeeded at 14:56:58.902719 after 1.72 seconds
[0m14:56:58.903722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000154690D2F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469643BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015469641C70>]}
[0m14:56:58.903722 [debug] [MainThread]: Flushing usage events
[0m14:57:02.577837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:25.121849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5008D1BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C5007C4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C57D6040E0>]}


============================== 15:01:25.128783 | ac749a09-c704-4770-9ffd-a110b8b055b5 ==============================
[0m15:01:25.128783 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:01:25.129785 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt debug', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:01:25.167238 [info ] [MainThread]: dbt version: 1.9.10
[0m15:01:25.168239 [info ] [MainThread]: python version: 3.12.5
[0m15:01:25.168743 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m15:01:25.168743 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m15:01:25.254012 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m15:01:25.254012 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m15:01:25.255363 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m15:01:25.256280 [info ] [MainThread]: adapter type: postgres
[0m15:01:25.257298 [info ] [MainThread]: adapter version: 1.9.1
[0m15:01:25.345613 [info ] [MainThread]: Configuration:
[0m15:01:25.345613 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:01:25.346863 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:01:25.346863 [info ] [MainThread]: Required dependencies:
[0m15:01:25.346863 [debug] [MainThread]: Executing "git --help"
[0m15:01:25.384078 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:01:25.384078 [debug] [MainThread]: STDERR: "b''"
[0m15:01:25.385150 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:01:25.385150 [info ] [MainThread]: Connection:
[0m15:01:25.386153 [info ] [MainThread]:   host: localhost
[0m15:01:25.386153 [info ] [MainThread]:   port: 5432
[0m15:01:25.386153 [info ] [MainThread]:   user: postgres
[0m15:01:25.387190 [info ] [MainThread]:   database: ecommerce_raw
[0m15:01:25.387190 [info ] [MainThread]:   schema: public
[0m15:01:25.387190 [info ] [MainThread]:   connect_timeout: 10
[0m15:01:25.387190 [info ] [MainThread]:   role: None
[0m15:01:25.387190 [info ] [MainThread]:   search_path: None
[0m15:01:25.387190 [info ] [MainThread]:   keepalives_idle: 0
[0m15:01:25.388694 [info ] [MainThread]:   sslmode: prefer
[0m15:01:25.388694 [info ] [MainThread]:   sslcert: None
[0m15:01:25.388694 [info ] [MainThread]:   sslkey: None
[0m15:01:25.389696 [info ] [MainThread]:   sslrootcert: None
[0m15:01:25.389696 [info ] [MainThread]:   application_name: dbt
[0m15:01:25.389696 [info ] [MainThread]:   retries: 1
[0m15:01:25.390725 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:01:25.786177 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:01:27.009904 [debug] [MainThread]: Using postgres connection "debug"
[0m15:01:27.010911 [debug] [MainThread]: On debug: select 1 as id
[0m15:01:27.010911 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:27.075319 [debug] [MainThread]: SQL status: SELECT 1 in 0.064 seconds
[0m15:01:27.076321 [debug] [MainThread]: On debug: Close
[0m15:01:27.076321 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:01:27.077322 [info ] [MainThread]: [32mAll checks passed![0m
[0m15:01:27.077322 [debug] [MainThread]: Command `dbt debug` succeeded at 15:01:27.077322 after 2.06 seconds
[0m15:01:27.078825 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:01:27.078825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C57FF0DF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C50102A330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C500C2FD70>]}
[0m15:01:27.078825 [debug] [MainThread]: Flushing usage events
[0m15:01:30.918599 [debug] [MainThread]: An error was encountered while trying to flush usage events
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
warning: dbt1050: No metadata adapter found for adapter type postgres
warning: dbt0255: Cannot register databases or schemas in the remote. Adapter '[33mpostgres[0m' does not support metadata operations.
error: dbt1053: Remote execution: failed to hydrate schema for source 'source.dbt_project.raw.olist_geolocation_dataset' (Missing schema for 'source.dbt_project.raw.olist_geolocation_dataset' (Expected at db/schemas/ecommerce_raw/public/olist_geolocation_dataset).
Hint: run `[33mdb seed[0m` if seeds map to sources, or `[33mdb sample --persist local ..[0m` to pull sample source data.).
Schemas should be fetched during pre-compile (Downloading Schemas).
Ensure remote connectivity/permissions or retry with '--static-analysis off' if appropriate.
   Skipped [-------] model public.stg_geolocation (view)

==================== Execution Summary =====================
Finished 'run' with 2 warnings and 1 error for target 'dev' [2.2s]
Processed: 1 model
Summary: 1 total | 1 skipped
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
warning: dbt1050: No metadata adapter found for adapter type postgres
warning: dbt0255: Cannot register databases or schemas in the remote. Adapter '[33mpostgres[0m' does not support metadata operations.
error: dbt1053: Remote execution: failed to hydrate schema for source 'source.dbt_project.raw.olist_geolocation_dataset' (Missing schema for 'source.dbt_project.raw.olist_geolocation_dataset' (Expected at db/schemas/ecommerce_raw/public/olist_geolocation_dataset).
Hint: run `[33mdb seed[0m` if seeds map to sources, or `[33mdb sample --persist local ..[0m` to pull sample source data.).
Schemas should be fetched during pre-compile (Downloading Schemas).
Ensure remote connectivity/permissions or retry with '--static-analysis off' if appropriate.
   Skipped [-------] model public.stg_geolocation (view)

==================== Execution Summary =====================
Finished 'run' with 2 warnings and 1 error for target 'dev' [1.7s]
Processed: 1 model
Summary: 1 total | 1 skipped
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
warning: dbt1050: No metadata adapter found for adapter type postgres
warning: dbt0255: Cannot register databases or schemas in the remote. Adapter '[33mpostgres[0m' does not support metadata operations.
error: dbt1053: Remote execution: failed to hydrate schema for source 'source.dbt_project.raw.olist_geolocation_dataset' (Missing schema for 'source.dbt_project.raw.olist_geolocation_dataset' (Expected at db/schemas/ecommerce_raw/public/olist_geolocation_dataset).
Hint: run `[33mdb seed[0m` if seeds map to sources, or `[33mdb sample --persist local ..[0m` to pull sample source data.).
Schemas should be fetched during pre-compile (Downloading Schemas).
Ensure remote connectivity/permissions or retry with '--static-analysis off' if appropriate.
   Skipped [-------] model public.stg_geolocation (view)

==================== Execution Summary =====================
Finished 'run' with 2 warnings and 1 error for target 'dev' [992ms]
Processed: 1 model
Summary: 1 total | 1 skipped
[0m19:29:01.829095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B8465CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B87425220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B874252E0>]}


============================== 19:29:01.838269 | 56a24cc4-1db5-49a4-b9ce-6f03c64af14a ==============================
[0m19:29:01.838269 [info ] [MainThread]: Running with dbt=1.9.10
[0m19:29:01.839272 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'invocation_command': 'dbt debug', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m19:29:01.887999 [info ] [MainThread]: dbt version: 1.9.10
[0m19:29:01.889007 [info ] [MainThread]: python version: 3.12.5
[0m19:29:01.889007 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m19:29:01.890173 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m19:29:02.179649 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m19:29:02.180666 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m19:29:02.180666 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m19:29:02.183287 [info ] [MainThread]: adapter type: postgres
[0m19:29:02.184295 [info ] [MainThread]: adapter version: 1.9.1
[0m19:29:02.285304 [info ] [MainThread]: Configuration:
[0m19:29:02.285304 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:29:02.286329 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:29:02.286329 [info ] [MainThread]: Required dependencies:
[0m19:29:02.286329 [debug] [MainThread]: Executing "git --help"
[0m19:29:02.340275 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:29:02.341291 [debug] [MainThread]: STDERR: "b''"
[0m19:29:02.341291 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:29:02.342296 [info ] [MainThread]: Connection:
[0m19:29:02.342296 [info ] [MainThread]:   host: localhost
[0m19:29:02.342296 [info ] [MainThread]:   port: 5432
[0m19:29:02.343301 [info ] [MainThread]:   user: postgres
[0m19:29:02.343301 [info ] [MainThread]:   database: ecommerce_raw
[0m19:29:02.343301 [info ] [MainThread]:   schema: public
[0m19:29:02.344305 [info ] [MainThread]:   connect_timeout: 10
[0m19:29:02.344305 [info ] [MainThread]:   role: None
[0m19:29:02.344305 [info ] [MainThread]:   search_path: None
[0m19:29:02.345310 [info ] [MainThread]:   keepalives_idle: 0
[0m19:29:02.345310 [info ] [MainThread]:   sslmode: prefer
[0m19:29:02.345310 [info ] [MainThread]:   sslcert: None
[0m19:29:02.346347 [info ] [MainThread]:   sslkey: None
[0m19:29:02.346347 [info ] [MainThread]:   sslrootcert: None
[0m19:29:02.346347 [info ] [MainThread]:   application_name: dbt
[0m19:29:02.346347 [info ] [MainThread]:   retries: 1
[0m19:29:02.347347 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:29:03.013023 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m19:29:05.761389 [debug] [MainThread]: Using postgres connection "debug"
[0m19:29:05.761389 [debug] [MainThread]: On debug: select 1 as id
[0m19:29:05.762397 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:05.857360 [debug] [MainThread]: SQL status: SELECT 1 in 0.095 seconds
[0m19:29:05.858391 [debug] [MainThread]: On debug: Close
[0m19:29:05.859398 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:29:05.859398 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:29:05.860412 [debug] [MainThread]: Command `dbt debug` succeeded at 19:29:05.860412 after 4.14 seconds
[0m19:29:05.861466 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:29:05.861466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B8465CE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B87DB89E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018B87B2EB70>]}
[0m19:29:05.861466 [debug] [MainThread]: Flushing usage events
[0m19:29:07.949200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:12.936987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D91B440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D5DA270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D981D90>]}


============================== 19:29:12.941988 | 3da6f62d-8d8f-47e8-8727-37dcae6dd719 ==============================
[0m19:29:12.941988 [info ] [MainThread]: Running with dbt=1.9.10
[0m19:29:12.942988 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'printer_width': '80', 'write_json': 'True'}
[0m19:29:13.083604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3da6f62d-8d8f-47e8-8727-37dcae6dd719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7D919A90>]}
[0m19:29:13.120726 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:29:13.122727 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:29:13.124897 [debug] [MainThread]: Command `cli deps` succeeded at 19:29:13.123727 after 0.32 seconds
[0m19:29:13.124897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7DA25760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7B4354C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B7DFAE8D0>]}
[0m19:29:13.125898 [debug] [MainThread]: Flushing usage events
[0m19:29:14.795040 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:29:19.663720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDB8274D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDC20E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDE538E30>]}


============================== 19:29:19.667881 | 87e07d1e-04de-4ad7-a464-b0f8354772a3 ==============================
[0m19:29:19.667881 [info ] [MainThread]: Running with dbt=1.9.10
[0m19:29:19.667881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_geolocation.sql', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m19:29:19.857831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDDAFCAD0>]}
[0m19:29:19.912269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDE64E360>]}
[0m19:29:19.913272 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m19:29:20.319083 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m19:29:20.509197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:20.509197 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:20.514217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m19:29:20.546573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDFAAB560>]}
[0m19:29:20.613149 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m19:29:20.664446 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m19:29:20.695613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDFEB94F0>]}
[0m19:29:20.695613 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m19:29:20.696743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDFE27350>]}
[0m19:29:20.699056 [info ] [MainThread]: 
[0m19:29:20.699056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:29:20.700059 [info ] [MainThread]: 
[0m19:29:20.700059 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:29:20.701243 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m19:29:20.850704 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m19:29:20.850704 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m19:29:20.851781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:20.904040 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m19:29:20.905042 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m19:29:20.909045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m19:29:20.915274 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m19:29:20.915274 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m19:29:20.915274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:20.952872 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m19:29:20.952872 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m19:29:20.952872 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m19:29:20.969799 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.016 seconds
[0m19:29:20.971123 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m19:29:20.971123 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m19:29:20.977565 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:20.977565 [debug] [MainThread]: On master: BEGIN
[0m19:29:20.977565 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:29:21.012545 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m19:29:21.012545 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:21.013548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m19:29:21.027155 [debug] [MainThread]: SQL status: SELECT 1 in 0.014 seconds
[0m19:29:21.029198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDBA375F0>]}
[0m19:29:21.029198 [debug] [MainThread]: On master: ROLLBACK
[0m19:29:21.029198 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:21.030201 [debug] [MainThread]: On master: BEGIN
[0m19:29:21.030201 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m19:29:21.030201 [debug] [MainThread]: On master: COMMIT
[0m19:29:21.031222 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:21.031222 [debug] [MainThread]: On master: COMMIT
[0m19:29:21.031222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:21.031222 [debug] [MainThread]: On master: Close
[0m19:29:21.037699 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_geolocation
[0m19:29:21.038706 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_geolocation ............................. [RUN]
[0m19:29:21.038706 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_geolocation'
[0m19:29:21.038706 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_geolocation
[0m19:29:21.046249 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_geolocation"
[0m19:29:21.047857 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_geolocation
[0m19:29:21.076863 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_geolocation"
[0m19:29:21.079181 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m19:29:21.079181 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: BEGIN
[0m19:29:21.079181 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:29:21.116747 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m19:29:21.117880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m19:29:21.117880 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */

  create view "ecommerce_raw"."public"."stg_geolocation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_geolocation_dataset"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );
[0m19:29:21.132189 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m19:29:21.138324 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m19:29:21.138324 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
alter table "ecommerce_raw"."public"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m19:29:21.140060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m19:29:21.151213 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m19:29:21.151213 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m19:29:21.152215 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m19:29:21.154230 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m19:29:21.158279 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_geolocation__dbt_backup"
[0m19:29:21.162370 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m19:29:21.163372 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
drop view if exists "ecommerce_raw"."public"."stg_geolocation__dbt_backup" cascade
[0m19:29:21.164375 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m19:29:21.166395 [debug] [Thread-1 (]: On model.dbt_project.stg_geolocation: Close
[0m19:29:21.169398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87e07d1e-04de-4ad7-a464-b0f8354772a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDB95B830>]}
[0m19:29:21.169398 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_geolocation ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m19:29:21.170665 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_geolocation
[0m19:29:21.171672 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:21.171672 [debug] [MainThread]: On master: BEGIN
[0m19:29:21.171672 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:29:21.207954 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m19:29:21.207954 [debug] [MainThread]: On master: COMMIT
[0m19:29:21.207954 [debug] [MainThread]: Using postgres connection "master"
[0m19:29:21.209011 [debug] [MainThread]: On master: COMMIT
[0m19:29:21.209011 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m19:29:21.209011 [debug] [MainThread]: On master: Close
[0m19:29:21.210018 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:21.210018 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m19:29:21.210018 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m19:29:21.211020 [debug] [MainThread]: Connection 'model.dbt_project.stg_geolocation' was properly closed.
[0m19:29:21.211020 [info ] [MainThread]: 
[0m19:29:21.211020 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m19:29:21.212020 [debug] [MainThread]: Command end result
[0m19:29:21.231659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m19:29:21.234734 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m19:29:21.240701 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m19:29:21.241702 [info ] [MainThread]: 
[0m19:29:21.241702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:29:21.241702 [info ] [MainThread]: 
[0m19:29:21.241702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:29:21.244051 [debug] [MainThread]: Command `dbt run` succeeded at 19:29:21.243041 after 1.68 seconds
[0m19:29:21.244051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDB8274D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDC20E150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FDFDEB890>]}
[0m19:29:21.244051 [debug] [MainThread]: Flushing usage events
[0m19:29:22.830592 [debug] [MainThread]: An error was encountered while trying to flush usage events
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.48
 Debugging platform: windows x86_64 (windows)
 Debugging adapter type: postgres (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "port": 5432,
  "database": "ecommerce_raw",
  "schema": "public",
  "sslmode": "prefer",
  "host": "localhost",
  "user": "postgres"
error: dbt1011: Error with dynamic library: LoadLibraryExW failed

==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [2.0s]
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.48
 Debugging platform: windows x86_64 (windows)
 Debugging adapter type: postgres (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "port": 5432,
  "database": "ecommerce_raw",
  "schema": "public",
  "sslmode": "prefer",
  "host": "localhost",
  "user": "postgres"
error: dbt1011: Error with dynamic library: LoadLibraryExW failed

==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [1.4s]
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.48
 Debugging platform: windows x86_64 (windows)
 Debugging adapter type: postgres (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "port": 5432,
  "database": "ecommerce_raw",
  "schema": "public",
  "sslmode": "prefer",
  "host": "localhost",
  "user": "postgres"
error: dbt1011: Error with dynamic library: LoadLibraryExW failed

==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [1.5s]
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.48
 Debugging platform: windows x86_64 (windows)
 Debugging adapter type: postgres (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "port": 5432,
  "database": "ecommerce_raw",
  "schema": "public",
  "sslmode": "prefer",
  "host": "localhost",
  "user": "postgres"
error: dbt1011: Error with dynamic library: LoadLibraryExW failed

==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [1.9s]
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
 Debugging profile: dev
 Debugging dbt version: 2.0.0-preview.48
 Debugging platform: windows x86_64 (windows)
 Debugging adapter type: postgres (remote)
 Debugging dependencies:
  git: OK
 Debugging connection:
  "port": 5432,
  "database": "ecommerce_raw",
  "schema": "public",
  "sslmode": "prefer",
  "host": "localhost",
  "user": "postgres"
error: dbt1011: Error with dynamic library: LoadLibraryExW failed

==================== Execution Summary =====================
Finished 'debug' with 1 error for target 'dev' [1.9s]
[0m20:28:01.165518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BDB0B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C11119A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C1433170>]}


============================== 20:28:01.172446 | e84a540f-366f-44d2-b38d-4a29ad3123cf ==============================
[0m20:28:01.172446 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:28:01.173449 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:28:01.201761 [info ] [MainThread]: dbt version: 1.9.10
[0m20:28:01.202768 [info ] [MainThread]: python version: 3.12.5
[0m20:28:01.202768 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m20:28:01.203870 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m20:28:01.413229 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m20:28:01.413229 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m20:28:01.414234 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m20:28:01.415240 [info ] [MainThread]: adapter type: postgres
[0m20:28:01.415240 [info ] [MainThread]: adapter version: 1.9.1
[0m20:28:01.505441 [info ] [MainThread]: Configuration:
[0m20:28:01.506450 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:28:01.506450 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:28:01.506450 [info ] [MainThread]: Required dependencies:
[0m20:28:01.507453 [debug] [MainThread]: Executing "git --help"
[0m20:28:01.556460 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:28:01.556460 [debug] [MainThread]: STDERR: "b''"
[0m20:28:01.557467 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:28:01.557467 [info ] [MainThread]: Connection:
[0m20:28:01.557467 [info ] [MainThread]:   host: localhost
[0m20:28:01.558471 [info ] [MainThread]:   port: 5432
[0m20:28:01.558471 [info ] [MainThread]:   user: postgres
[0m20:28:01.558471 [info ] [MainThread]:   database: ecommerce_raw
[0m20:28:01.558471 [info ] [MainThread]:   schema: public
[0m20:28:01.559566 [info ] [MainThread]:   connect_timeout: 10
[0m20:28:01.559566 [info ] [MainThread]:   role: None
[0m20:28:01.559566 [info ] [MainThread]:   search_path: None
[0m20:28:01.559566 [info ] [MainThread]:   keepalives_idle: 0
[0m20:28:01.559566 [info ] [MainThread]:   sslmode: prefer
[0m20:28:01.561070 [info ] [MainThread]:   sslcert: None
[0m20:28:01.561070 [info ] [MainThread]:   sslkey: None
[0m20:28:01.561070 [info ] [MainThread]:   sslrootcert: None
[0m20:28:01.561070 [info ] [MainThread]:   application_name: dbt
[0m20:28:01.562097 [info ] [MainThread]:   retries: 1
[0m20:28:01.562097 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:28:01.882608 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:28:03.692355 [debug] [MainThread]: Using postgres connection "debug"
[0m20:28:03.693356 [debug] [MainThread]: On debug: select 1 as id
[0m20:28:03.693356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:28:03.775862 [debug] [MainThread]: SQL status: SELECT 1 in 0.082 seconds
[0m20:28:03.776863 [debug] [MainThread]: On debug: Close
[0m20:28:03.777862 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:28:03.777862 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:28:03.779863 [debug] [MainThread]: Command `dbt debug` succeeded at 20:28:03.779863 after 2.72 seconds
[0m20:28:03.779863 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:28:03.779863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BDB0B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8C172DB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8BECE20F0>]}
[0m20:28:03.781367 [debug] [MainThread]: Flushing usage events
[0m20:28:05.230934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:29:10.993200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4256E10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4255A4CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4258E8560>]}


============================== 20:29:10.998201 | 2ba98119-2879-4587-9833-424c1f21e0cc ==============================
[0m20:29:10.998201 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:29:10.998201 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run --select stg_items_ordered.sql', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:29:11.247388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B425BC6450>]}
[0m20:29:11.300847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B425A727E0>]}
[0m20:29:11.302848 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:29:11.627419 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:29:12.534803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:29:12.535804 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:29:12.540318 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:29:12.575852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B426F978C0>]}
[0m20:29:12.648249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:29:12.668700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:29:12.703766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B427351C70>]}
[0m20:29:12.703766 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:29:12.704803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B425C69010>]}
[0m20:29:12.706831 [info ] [MainThread]: 
[0m20:29:12.706831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:12.706831 [info ] [MainThread]: 
[0m20:29:12.707834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:29:12.707834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:29:12.805680 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:29:12.805680 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:29:12.806949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:12.989227 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.182 seconds
[0m20:29:12.990741 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:29:12.994923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:29:13.000455 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:29:13.000455 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:29:13.001456 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:13.037866 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m20:29:13.039369 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:29:13.039369 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:29:13.053534 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.014 seconds
[0m20:29:13.055720 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:29:13.055720 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:29:13.061544 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.062544 [debug] [MainThread]: On master: BEGIN
[0m20:29:13.062544 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:13.099336 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:29:13.099336 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.100350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:29:13.112985 [debug] [MainThread]: SQL status: SELECT 2 in 0.013 seconds
[0m20:29:13.114997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B425C89610>]}
[0m20:29:13.114997 [debug] [MainThread]: On master: ROLLBACK
[0m20:29:13.116000 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.116000 [debug] [MainThread]: On master: BEGIN
[0m20:29:13.117030 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:29:13.117030 [debug] [MainThread]: On master: COMMIT
[0m20:29:13.117030 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.117030 [debug] [MainThread]: On master: COMMIT
[0m20:29:13.118182 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:13.118182 [debug] [MainThread]: On master: Close
[0m20:29:13.123967 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_items_ordered
[0m20:29:13.123967 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_items_ordered ........................... [RUN]
[0m20:29:13.124983 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m20:29:13.124983 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m20:29:13.133537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m20:29:13.136922 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_items_ordered
[0m20:29:13.166466 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m20:29:13.170124 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m20:29:13.170124 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m20:29:13.170124 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:29:13.207111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m20:29:13.207111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m20:29:13.208111 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m20:29:13.221501 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m20:29:13.227617 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m20:29:13.227617 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m20:29:13.229618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:29:13.241185 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m20:29:13.241185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m20:29:13.241185 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m20:29:13.243424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:29:13.248479 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m20:29:13.252985 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m20:29:13.252985 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m20:29:13.253985 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:29:13.256221 [debug] [Thread-1 (]: On model.dbt_project.stg_items_ordered: Close
[0m20:29:13.259224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ba98119-2879-4587-9833-424c1f21e0cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B422E6BB90>]}
[0m20:29:13.259224 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m20:29:13.260255 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_items_ordered
[0m20:29:13.261328 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.262328 [debug] [MainThread]: On master: BEGIN
[0m20:29:13.262328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:29:13.298626 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m20:29:13.298626 [debug] [MainThread]: On master: COMMIT
[0m20:29:13.299626 [debug] [MainThread]: Using postgres connection "master"
[0m20:29:13.299626 [debug] [MainThread]: On master: COMMIT
[0m20:29:13.300129 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:29:13.300129 [debug] [MainThread]: On master: Close
[0m20:29:13.301129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:13.301129 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:29:13.301129 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:29:13.301129 [debug] [MainThread]: Connection 'model.dbt_project.stg_items_ordered' was properly closed.
[0m20:29:13.301129 [info ] [MainThread]: 
[0m20:29:13.302130 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m20:29:13.303132 [debug] [MainThread]: Command end result
[0m20:29:13.322486 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:29:13.324619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:29:13.330354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:29:13.331464 [info ] [MainThread]: 
[0m20:29:13.331464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:29:13.332468 [info ] [MainThread]: 
[0m20:29:13.332468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:29:13.333473 [debug] [MainThread]: Command `dbt run` succeeded at 20:29:13.333473 after 2.45 seconds
[0m20:29:13.333473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4257E8CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B427190590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B4271EF6B0>]}
[0m20:29:13.334495 [debug] [MainThread]: Flushing usage events
[0m20:29:14.771423 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:20.239622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B552472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B558F10A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B558F28D0>]}


============================== 20:31:20.245252 | 059e9d9e-bea9-40f7-964c-54a5c70fe52c ==============================
[0m20:31:20.245252 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:31:20.245252 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_order_payment.sql', 'printer_width': '80', 'write_json': 'True'}
[0m20:31:20.461155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B55DD1D00>]}
[0m20:31:20.513248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B55E5A330>]}
[0m20:31:20.514248 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:31:20.867259 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:31:21.051204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:21.052204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:21.056708 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:31:21.090235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B55E9A810>]}
[0m20:31:21.159112 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:21.177799 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:21.210749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B572BAAB0>]}
[0m20:31:21.210749 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:31:21.212085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B5764F1A0>]}
[0m20:31:21.214157 [info ] [MainThread]: 
[0m20:31:21.214157 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:21.215162 [info ] [MainThread]: 
[0m20:31:21.215162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:21.216162 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:31:21.317136 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:31:21.318147 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:31:21.318147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:21.410663 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.092 seconds
[0m20:31:21.411739 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:31:21.416311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:31:21.420384 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:21.421434 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:31:21.421434 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:21.460041 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m20:31:21.460041 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:21.460041 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:21.473216 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.013 seconds
[0m20:31:21.475552 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:31:21.475552 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:31:21.481790 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.481790 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.481790 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:21.517738 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:31:21.519081 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.519081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:31:21.529440 [debug] [MainThread]: SQL status: SELECT 3 in 0.010 seconds
[0m20:31:21.530624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B571D3E90>]}
[0m20:31:21.531634 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:21.531634 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.531634 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.532677 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:31:21.532677 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.532677 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.533696 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.533696 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:21.533696 [debug] [MainThread]: On master: Close
[0m20:31:21.538238 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m20:31:21.539425 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_order_payment ........................... [RUN]
[0m20:31:21.539425 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m20:31:21.539425 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m20:31:21.548168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m20:31:21.549169 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m20:31:21.584309 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m20:31:21.585313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m20:31:21.586313 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m20:31:21.586313 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:21.628772 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m20:31:21.628772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m20:31:21.630020 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select order_id from renamed where payment_type = 'credit_card'
  );
[0m20:31:21.639591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m20:31:21.644639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m20:31:21.644639 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m20:31:21.647157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:31:21.659713 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m20:31:21.659713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m20:31:21.659713 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m20:31:21.661729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:21.667268 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m20:31:21.671284 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m20:31:21.671284 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m20:31:21.672844 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:31:21.674971 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m20:31:21.676474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '059e9d9e-bea9-40f7-964c-54a5c70fe52c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B5307BC50>]}
[0m20:31:21.677685 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.14s]
[0m20:31:21.677685 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m20:31:21.678775 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.679778 [debug] [MainThread]: On master: BEGIN
[0m20:31:21.679778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:21.717388 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m20:31:21.718394 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.718394 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:21.718394 [debug] [MainThread]: On master: COMMIT
[0m20:31:21.719399 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:21.719399 [debug] [MainThread]: On master: Close
[0m20:31:21.720402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:21.720402 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:31:21.720402 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:31:21.720402 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m20:31:21.721402 [info ] [MainThread]: 
[0m20:31:21.721402 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m20:31:21.722571 [debug] [MainThread]: Command end result
[0m20:31:21.742767 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:21.744767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:21.750289 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:31:21.750289 [info ] [MainThread]: 
[0m20:31:21.750289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:21.751712 [info ] [MainThread]: 
[0m20:31:21.751712 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:31:21.752715 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:21.752715 after 1.62 seconds
[0m20:31:21.752715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B552472F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B5521FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025B5521D430>]}
[0m20:31:21.753719 [debug] [MainThread]: Flushing usage events
[0m20:31:23.364587 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:38.655707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217394F3FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217394F3F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739142C00>]}


============================== 20:31:38.660965 | 181d756f-8192-4eaf-9774-ae72d0154d86 ==============================
[0m20:31:38.660965 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:31:38.661968 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run --select stg_orders.sql', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m20:31:38.905027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B3A4F20>]}
[0m20:31:38.960253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217394F3FE0>]}
[0m20:31:38.962259 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:31:39.285727 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:31:39.452525 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:39.452525 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:39.458045 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:31:39.493188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B4268A0>]}
[0m20:31:39.564957 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:39.585068 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:39.614207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B82C5C0>]}
[0m20:31:39.615711 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:31:39.615711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173950D370>]}
[0m20:31:39.618115 [info ] [MainThread]: 
[0m20:31:39.618115 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:39.618115 [info ] [MainThread]: 
[0m20:31:39.619540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:39.619540 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:31:39.717840 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:31:39.718846 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:31:39.718846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:39.877610 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.159 seconds
[0m20:31:39.879620 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:31:39.883768 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:31:39.888309 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:39.889312 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:31:39.889312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:39.930378 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m20:31:39.930378 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:39.931383 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:39.939088 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m20:31:39.940253 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:31:39.940253 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:31:39.946813 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:39.946813 [debug] [MainThread]: On master: BEGIN
[0m20:31:39.947816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:39.986803 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m20:31:39.986803 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:39.986803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:31:39.994921 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m20:31:39.996426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173A0D8590>]}
[0m20:31:39.997430 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:39.997430 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:39.997430 [debug] [MainThread]: On master: BEGIN
[0m20:31:39.998437 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:31:39.998437 [debug] [MainThread]: On master: COMMIT
[0m20:31:39.999443 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:39.999443 [debug] [MainThread]: On master: COMMIT
[0m20:31:39.999443 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:39.999443 [debug] [MainThread]: On master: Close
[0m20:31:40.003570 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m20:31:40.004575 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_orders .................................. [RUN]
[0m20:31:40.004575 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_orders'
[0m20:31:40.004575 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m20:31:40.012129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m20:31:40.014179 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m20:31:40.043997 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m20:31:40.045002 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m20:31:40.046002 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m20:31:40.046508 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:40.082947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m20:31:40.082947 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m20:31:40.083965 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m20:31:40.095150 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m20:31:40.100667 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m20:31:40.100667 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m20:31:40.101668 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:31:40.113349 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m20:31:40.114350 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m20:31:40.114350 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m20:31:40.115852 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:31:40.120984 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m20:31:40.125046 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m20:31:40.125046 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m20:31:40.126046 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:31:40.128292 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m20:31:40.130296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '181d756f-8192-4eaf-9774-ae72d0154d86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217372CB890>]}
[0m20:31:40.130296 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m20:31:40.131296 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m20:31:40.133352 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:40.133352 [debug] [MainThread]: On master: BEGIN
[0m20:31:40.133352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:40.172754 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m20:31:40.172754 [debug] [MainThread]: On master: COMMIT
[0m20:31:40.172754 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:40.173790 [debug] [MainThread]: On master: COMMIT
[0m20:31:40.173790 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:40.173790 [debug] [MainThread]: On master: Close
[0m20:31:40.174794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:40.174794 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:31:40.174794 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:31:40.175793 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m20:31:40.175793 [info ] [MainThread]: 
[0m20:31:40.176296 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m20:31:40.176798 [debug] [MainThread]: Command end result
[0m20:31:40.196077 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:40.198404 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:40.203405 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:31:40.204405 [info ] [MainThread]: 
[0m20:31:40.204405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:31:40.204405 [info ] [MainThread]: 
[0m20:31:40.205909 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:31:40.206995 [debug] [MainThread]: Command `dbt run` succeeded at 20:31:40.205909 after 1.68 seconds
[0m20:31:40.206995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739AFF350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021739C15190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002173B85FB60>]}
[0m20:31:40.206995 [debug] [MainThread]: Flushing usage events
[0m20:31:41.762108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:31:55.509758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F25AF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F25BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F25B140>]}


============================== 20:31:55.513793 | 4acc1408-6488-4595-bfcf-ce12d3a9828d ==============================
[0m20:31:55.513793 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:31:55.513793 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run --select stg_products.sql', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m20:31:55.691630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FE4ACF0>]}
[0m20:31:55.745816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F278800>]}
[0m20:31:55.746863 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:31:56.051678 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:31:56.214234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:31:56.215737 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:31:56.219796 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:31:56.253350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209511DC2C0>]}
[0m20:31:56.319305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:56.336365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:56.361130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020951669370>]}
[0m20:31:56.361130 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:31:56.361130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209511DD490>]}
[0m20:31:56.363488 [info ] [MainThread]: 
[0m20:31:56.363488 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:56.364585 [info ] [MainThread]: 
[0m20:31:56.364585 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:31:56.365584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:31:56.460766 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:31:56.461766 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:31:56.461766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:56.512384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m20:31:56.513629 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:31:56.517893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:31:56.523289 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:56.523289 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:31:56.524289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:56.564674 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m20:31:56.564674 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:31:56.564674 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:31:56.572298 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m20:31:56.573301 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:31:56.574305 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:31:56.579661 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.580664 [debug] [MainThread]: On master: BEGIN
[0m20:31:56.580664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:31:56.626322 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m20:31:56.627327 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.627327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:31:56.635940 [debug] [MainThread]: SQL status: SELECT 5 in 0.008 seconds
[0m20:31:56.637947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020951171AF0>]}
[0m20:31:56.637947 [debug] [MainThread]: On master: ROLLBACK
[0m20:31:56.638950 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.638950 [debug] [MainThread]: On master: BEGIN
[0m20:31:56.638950 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:31:56.639954 [debug] [MainThread]: On master: COMMIT
[0m20:31:56.639954 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.639954 [debug] [MainThread]: On master: COMMIT
[0m20:31:56.639954 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:56.640959 [debug] [MainThread]: On master: Close
[0m20:31:56.643973 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m20:31:56.645476 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m20:31:56.646503 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_products'
[0m20:31:56.646503 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m20:31:56.654038 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m20:31:56.655541 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m20:31:56.690424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m20:31:56.692503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m20:31:56.692503 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m20:31:56.692503 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:31:56.845296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m20:31:56.845296 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m20:31:56.845296 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        "product_id",
        "product_category_name",
    from source
)

select * from renamed
  );
[0m20:31:56.849532 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 15:     from source
             ^

[0m20:31:56.849532 [debug] [Thread-1 (]: On model.dbt_project.stg_products: ROLLBACK
[0m20:31:56.850533 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m20:31:56.906719 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m20:31:56.908884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4acc1408-6488-4595-bfcf-ce12d3a9828d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095169E450>]}
[0m20:31:56.908884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.26s]
[0m20:31:56.909887 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m20:31:56.911064 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql.
[0m20:31:56.912075 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.913079 [debug] [MainThread]: On master: BEGIN
[0m20:31:56.913079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:31:56.958598 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m20:31:56.958598 [debug] [MainThread]: On master: COMMIT
[0m20:31:56.959610 [debug] [MainThread]: Using postgres connection "master"
[0m20:31:56.959610 [debug] [MainThread]: On master: COMMIT
[0m20:31:56.959610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:31:56.960616 [debug] [MainThread]: On master: Close
[0m20:31:56.960616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:31:56.960616 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:31:56.961619 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:31:56.961619 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m20:31:56.961619 [info ] [MainThread]: 
[0m20:31:56.962619 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m20:31:56.962619 [debug] [MainThread]: Command end result
[0m20:31:56.982700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:31:56.986376 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:31:56.991645 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:31:56.992645 [info ] [MainThread]: 
[0m20:31:56.992645 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:31:56.992645 [info ] [MainThread]: 
[0m20:31:56.994097 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m20:31:56.994097 [info ] [MainThread]: 
[0m20:31:56.994097 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:31:56.995600 [debug] [MainThread]: Command `dbt run` failed at 20:31:56.995600 after 1.59 seconds
[0m20:31:56.995600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FC029F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094FB342C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094F7838C0>]}
[0m20:31:56.997005 [debug] [MainThread]: Flushing usage events
[0m20:31:58.622845 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:33:08.585872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F677B0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F90CCDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F90CECC0>]}


============================== 20:33:08.589945 | 9fd86c80-3c2d-43ad-9399-1595d8f87ad3 ==============================
[0m20:33:08.589945 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:33:08.590947 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sellers.sql', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m20:33:08.776377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F99250A0>]}
[0m20:33:08.829105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F8AAC890>]}
[0m20:33:08.831126 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:33:09.127183 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:33:09.292986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:33:09.292986 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:33:09.298276 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:33:09.330057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FAA166C0>]}
[0m20:33:09.400526 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:33:09.417110 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:33:09.444824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FAE2DD90>]}
[0m20:33:09.445826 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:33:09.445826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FAC583B0>]}
[0m20:33:09.448014 [info ] [MainThread]: 
[0m20:33:09.448014 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:09.449017 [info ] [MainThread]: 
[0m20:33:09.449017 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:33:09.450021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:33:09.591997 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:33:09.591997 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:33:09.591997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:09.638413 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m20:33:09.639464 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:33:09.644374 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:33:09.649409 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:33:09.649409 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:33:09.649409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:09.684921 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m20:33:09.684921 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:33:09.685924 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:33:09.692061 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.007 seconds
[0m20:33:09.693564 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:33:09.693564 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:33:09.699612 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.700612 [debug] [MainThread]: On master: BEGIN
[0m20:33:09.700612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:33:09.736557 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m20:33:09.737566 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.737566 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:33:09.744861 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m20:33:09.746867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183FB36AD20>]}
[0m20:33:09.746867 [debug] [MainThread]: On master: ROLLBACK
[0m20:33:09.747869 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.747869 [debug] [MainThread]: On master: BEGIN
[0m20:33:09.747869 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:33:09.748895 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.748895 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.748895 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.748895 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:09.749898 [debug] [MainThread]: On master: Close
[0m20:33:09.753511 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m20:33:09.753511 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_sellers ................................. [RUN]
[0m20:33:09.754524 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_sellers'
[0m20:33:09.754524 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m20:33:09.761669 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m20:33:09.762669 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m20:33:09.791865 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m20:33:09.793865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m20:33:09.794368 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m20:33:09.794368 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:33:09.828839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:33:09.829843 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m20:33:09.829843 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m20:33:09.836777 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m20:33:09.841877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m20:33:09.841877 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m20:33:09.842880 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:33:09.854014 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m20:33:09.855018 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m20:33:09.855018 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m20:33:09.856396 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:33:09.861593 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m20:33:09.866105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m20:33:09.866105 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m20:33:09.866105 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:33:09.868147 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m20:33:09.870380 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd86c80-3c2d-43ad-9399-1595d8f87ad3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F686B4D0>]}
[0m20:33:09.871385 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m20:33:09.871385 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m20:33:09.872512 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.873511 [debug] [MainThread]: On master: BEGIN
[0m20:33:09.874013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:33:09.909812 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:33:09.910878 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.910878 [debug] [MainThread]: Using postgres connection "master"
[0m20:33:09.910878 [debug] [MainThread]: On master: COMMIT
[0m20:33:09.911881 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:33:09.911881 [debug] [MainThread]: On master: Close
[0m20:33:09.912884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:09.912884 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:33:09.912884 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:33:09.912884 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m20:33:09.913883 [info ] [MainThread]: 
[0m20:33:09.913883 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m20:33:09.914386 [debug] [MainThread]: Command end result
[0m20:33:09.934120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:33:09.936128 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:33:09.941378 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:33:09.941378 [info ] [MainThread]: 
[0m20:33:09.942378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:09.942378 [info ] [MainThread]: 
[0m20:33:09.942378 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:33:09.943882 [debug] [MainThread]: Command `dbt run` succeeded at 20:33:09.943882 after 1.46 seconds
[0m20:33:09.943882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F8A263C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F8A26630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183F8A27D10>]}
[0m20:33:09.944956 [debug] [MainThread]: Flushing usage events
[0m20:33:11.505774 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:36:12.153736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F43C7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F3761F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F40A02F0>]}


============================== 20:36:12.160354 | bed67381-b49d-40a2-aee5-d241c6c5af3b ==============================
[0m20:36:12.160354 [info ] [MainThread]: Running with dbt=1.9.10
[0m20:36:12.160354 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run --select stg_products.sql', 'no_print': 'None', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m20:36:12.395155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F49A62A0>]}
[0m20:36:12.448624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F4A2B890>]}
[0m20:36:12.449625 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m20:36:12.804166 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m20:36:12.982471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:36:12.982471 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_products.sql
[0m20:36:13.194984 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m20:36:13.205781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F62B19A0>]}
[0m20:36:13.271881 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:36:13.289759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:36:13.322116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F617A090>]}
[0m20:36:13.322116 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m20:36:13.323118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F615AD20>]}
[0m20:36:13.325388 [info ] [MainThread]: 
[0m20:36:13.325388 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:13.325388 [info ] [MainThread]: 
[0m20:36:13.326565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:36:13.327570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m20:36:13.422947 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m20:36:13.422947 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m20:36:13.422947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:13.490479 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m20:36:13.491505 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m20:36:13.495761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m20:36:13.501637 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:36:13.501637 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m20:36:13.501637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:13.543041 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m20:36:13.544082 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m20:36:13.544082 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:36:13.552076 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.008 seconds
[0m20:36:13.553081 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m20:36:13.554087 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m20:36:13.560412 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.560412 [debug] [MainThread]: On master: BEGIN
[0m20:36:13.560412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:13.598030 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:36:13.598030 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.599034 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m20:36:13.606874 [debug] [MainThread]: SQL status: SELECT 6 in 0.008 seconds
[0m20:36:13.609072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F68BAB40>]}
[0m20:36:13.610575 [debug] [MainThread]: On master: ROLLBACK
[0m20:36:13.610575 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.610575 [debug] [MainThread]: On master: BEGIN
[0m20:36:13.611603 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:36:13.611603 [debug] [MainThread]: On master: COMMIT
[0m20:36:13.611603 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.612752 [debug] [MainThread]: On master: COMMIT
[0m20:36:13.612752 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:13.612752 [debug] [MainThread]: On master: Close
[0m20:36:13.617755 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m20:36:13.618920 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m20:36:13.618920 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_products'
[0m20:36:13.618920 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m20:36:13.626688 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m20:36:13.628977 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m20:36:13.657495 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m20:36:13.660710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m20:36:13.660710 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m20:36:13.661711 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:36:13.696677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m20:36:13.697708 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m20:36:13.697708 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name,
    from source
)

select * from renamed
  );
[0m20:36:13.701304 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 15:     from source
             ^

[0m20:36:13.701304 [debug] [Thread-1 (]: On model.dbt_project.stg_products: ROLLBACK
[0m20:36:13.702379 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m20:36:13.709791 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m20:36:13.711305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bed67381-b49d-40a2-aee5-d241c6c5af3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F6256CF0>]}
[0m20:36:13.712531 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.09s]
[0m20:36:13.712531 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m20:36:13.713536 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql.
[0m20:36:13.715644 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.715644 [debug] [MainThread]: On master: BEGIN
[0m20:36:13.715644 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:13.752152 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m20:36:13.753559 [debug] [MainThread]: On master: COMMIT
[0m20:36:13.753559 [debug] [MainThread]: Using postgres connection "master"
[0m20:36:13.753559 [debug] [MainThread]: On master: COMMIT
[0m20:36:13.754561 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:36:13.754561 [debug] [MainThread]: On master: Close
[0m20:36:13.754561 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:13.755563 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m20:36:13.755563 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m20:36:13.755563 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m20:36:13.755563 [info ] [MainThread]: 
[0m20:36:13.756563 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m20:36:13.757728 [debug] [MainThread]: Command end result
[0m20:36:13.776022 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m20:36:13.779220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m20:36:13.783757 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m20:36:13.784767 [info ] [MainThread]: 
[0m20:36:13.784767 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:36:13.785790 [info ] [MainThread]: 
[0m20:36:13.785790 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m20:36:13.785790 [info ] [MainThread]: 
[0m20:36:13.786796 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m20:36:13.787860 [debug] [MainThread]: Command `dbt run` failed at 20:36:13.787860 after 1.74 seconds
[0m20:36:13.787860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F4754B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F62B19A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0F3D9BA70>]}
[0m20:36:13.787860 [debug] [MainThread]: Flushing usage events
[0m20:36:15.386193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:03:52.166472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300E55B290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300E4F0E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300E4F0380>]}


============================== 21:03:52.172446 | d40c491e-466d-4445-8fe7-ac34616e3884 ==============================
[0m21:03:52.172446 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:03:52.173860 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select sql_products.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:03:52.453269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd40c491e-466d-4445-8fe7-ac34616e3884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230103E4E00>]}
[0m21:03:52.505381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd40c491e-466d-4445-8fe7-ac34616e3884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300E57A420>]}
[0m21:03:52.507388 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:03:52.893208 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:03:53.150074 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:03:53.150074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:03:53.155580 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:03:53.187763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd40c491e-466d-4445-8fe7-ac34616e3884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300F10B8C0>]}
[0m21:03:53.256315 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:03:53.281427 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:03:53.326398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd40c491e-466d-4445-8fe7-ac34616e3884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002301091A300>]}
[0m21:03:53.326398 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m21:03:53.326398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd40c491e-466d-4445-8fe7-ac34616e3884', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023010467A70>]}
[0m21:03:53.328914 [warn ] [MainThread]: The selection criterion 'sql_products.sql' does not match any enabled nodes
[0m21:03:53.328914 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:03:53.331432 [debug] [MainThread]: Command end result
[0m21:03:53.351342 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:03:53.353358 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:03:53.357359 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m21:03:53.358359 [debug] [MainThread]: Command `dbt run` succeeded at 21:03:53.357359 after 1.31 seconds
[0m21:03:53.358359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300EE9DDF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300ED3B6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002300DF03D70>]}
[0m21:03:53.358359 [debug] [MainThread]: Flushing usage events
[0m21:03:54.845168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:00.904995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC58587A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC591C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC3B5DEE0>]}


============================== 21:05:00.910923 | 34b3d512-9ecc-42fa-980b-8a38ab2f3c1e ==============================
[0m21:05:00.910923 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:05:00.910923 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_products.sql', 'printer_width': '80', 'write_json': 'True'}
[0m21:05:01.144099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC5FF5F70>]}
[0m21:05:01.198193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC5E72B70>]}
[0m21:05:01.199952 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:05:01.588796 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:05:01.814050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:05:01.815050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:05:01.819552 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:05:01.853244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC76206E0>]}
[0m21:05:01.922831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:05:01.947416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:05:01.989101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC780BA10>]}
[0m21:05:01.990109 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m21:05:01.990109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC74456D0>]}
[0m21:05:01.992546 [info ] [MainThread]: 
[0m21:05:01.993562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:05:01.993562 [info ] [MainThread]: 
[0m21:05:01.994565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:05:01.995568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m21:05:02.191097 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m21:05:02.191097 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m21:05:02.192103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:02.263087 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.071 seconds
[0m21:05:02.264591 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m21:05:02.268638 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m21:05:02.273820 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:05:02.273820 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m21:05:02.274821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:05:02.316237 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m21:05:02.317740 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:05:02.317740 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:05:02.329432 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.011 seconds
[0m21:05:02.331445 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m21:05:02.331445 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m21:05:02.337212 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.337212 [debug] [MainThread]: On master: BEGIN
[0m21:05:02.338718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:05:02.376921 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m21:05:02.376921 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.377924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:05:02.392099 [debug] [MainThread]: SQL status: SELECT 6 in 0.014 seconds
[0m21:05:02.394167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC7484110>]}
[0m21:05:02.394167 [debug] [MainThread]: On master: ROLLBACK
[0m21:05:02.395196 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.395196 [debug] [MainThread]: On master: BEGIN
[0m21:05:02.395196 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:05:02.396199 [debug] [MainThread]: On master: COMMIT
[0m21:05:02.396199 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.396199 [debug] [MainThread]: On master: COMMIT
[0m21:05:02.396199 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:05:02.397202 [debug] [MainThread]: On master: Close
[0m21:05:02.401298 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m21:05:02.401298 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m21:05:02.402801 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_products'
[0m21:05:02.402801 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m21:05:02.410866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m21:05:02.413382 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m21:05:02.442710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m21:05:02.443872 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:05:02.445378 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m21:05:02.445378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:05:02.486830 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m21:05:02.488333 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:05:02.488333 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name,
    from source
)

select * from renamed
  );
[0m21:05:02.491661 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 15:     from source
             ^

[0m21:05:02.491661 [debug] [Thread-1 (]: On model.dbt_project.stg_products: ROLLBACK
[0m21:05:02.492788 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m21:05:02.501032 [debug] [Thread-1 (]: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m21:05:02.504139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34b3d512-9ecc-42fa-980b-8a38ab2f3c1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC60B8230>]}
[0m21:05:02.504139 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model public.stg_products ....................... [[31mERROR[0m in 0.10s]
[0m21:05:02.505144 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m21:05:02.506148 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.stg_products' to be skipped because of status 'error'.  Reason: Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql.
[0m21:05:02.507152 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.507152 [debug] [MainThread]: On master: BEGIN
[0m21:05:02.507152 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:05:02.544019 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:05:02.545202 [debug] [MainThread]: On master: COMMIT
[0m21:05:02.545202 [debug] [MainThread]: Using postgres connection "master"
[0m21:05:02.546205 [debug] [MainThread]: On master: COMMIT
[0m21:05:02.546205 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:05:02.546205 [debug] [MainThread]: On master: Close
[0m21:05:02.547207 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:05:02.547207 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m21:05:02.547207 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m21:05:02.547207 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m21:05:02.548208 [info ] [MainThread]: 
[0m21:05:02.548208 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m21:05:02.549208 [debug] [MainThread]: Command end result
[0m21:05:02.569567 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:05:02.572568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:05:02.578075 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m21:05:02.578075 [info ] [MainThread]: 
[0m21:05:02.579171 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:05:02.579171 [info ] [MainThread]: 
[0m21:05:02.580220 [error] [MainThread]:   Database Error in model stg_products (models\staging\stg_products.sql)
  syntax error at or near "from"
  LINE 15:     from source
               ^
  compiled code at target\run\dbt_project\models\staging\stg_products.sql
[0m21:05:02.580220 [info ] [MainThread]: 
[0m21:05:02.581234 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:05:02.582236 [debug] [MainThread]: Command `dbt run` failed at 21:05:02.582236 after 1.78 seconds
[0m21:05:02.582236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC59F4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC5462B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DC5463E90>]}
[0m21:05:02.583238 [debug] [MainThread]: Flushing usage events
[0m21:05:04.037500 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:52.572405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E24CC0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E50F60C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4759D00>]}


============================== 21:05:52.577932 | 7cabccd9-adac-483d-8ab8-0d3003e3c834 ==============================
[0m21:05:52.577932 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:05:52.579028 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:05:52.719977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cabccd9-adac-483d-8ab8-0d3003e3c834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E52C4920>]}
[0m21:05:52.758262 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:05:52.765480 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:05:52.767573 [debug] [MainThread]: Command `cli deps` succeeded at 21:05:52.767573 after 0.31 seconds
[0m21:05:52.768836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E4FC8EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E51D6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000253E537F320>]}
[0m21:05:52.768836 [debug] [MainThread]: Flushing usage events
[0m21:05:54.247235 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:09:25.203582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029586E07AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295868F0E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029587569430>]}


============================== 21:09:25.209397 | d32d5875-bbfa-4375-b37b-dab31bcf4649 ==============================
[0m21:09:25.209397 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:09:25.209397 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_products.sql', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m21:09:25.459674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295878B21B0>]}
[0m21:09:25.516730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295876CEDE0>]}
[0m21:09:25.518742 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:09:25.968757 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:09:26.163545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:09:26.163545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:09:26.168612 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:09:26.202598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029586FFB9B0>]}
[0m21:09:26.271948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:09:26.298417 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:09:26.340623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029589086120>]}
[0m21:09:26.342028 [info ] [MainThread]: Found 9 models, 4 data tests, 9 sources, 447 macros
[0m21:09:26.342028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029588F3B290>]}
[0m21:09:26.344223 [info ] [MainThread]: 
[0m21:09:26.345301 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:09:26.345301 [info ] [MainThread]: 
[0m21:09:26.345301 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:09:26.346797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m21:09:26.619740 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m21:09:26.619740 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m21:09:26.619740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:26.718465 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.098 seconds
[0m21:09:26.719520 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m21:09:26.723523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m21:09:26.728314 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:09:26.729314 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m21:09:26.729314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:09:26.765803 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m21:09:26.766925 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:09:26.766925 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:09:26.782986 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.017 seconds
[0m21:09:26.785517 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m21:09:26.786590 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m21:09:26.792377 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:26.792377 [debug] [MainThread]: On master: BEGIN
[0m21:09:26.792377 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:09:26.829977 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m21:09:26.829977 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:26.830999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:09:26.842534 [debug] [MainThread]: SQL status: SELECT 6 in 0.012 seconds
[0m21:09:26.844652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029589191FA0>]}
[0m21:09:26.845654 [debug] [MainThread]: On master: ROLLBACK
[0m21:09:26.845654 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:26.845654 [debug] [MainThread]: On master: BEGIN
[0m21:09:26.846775 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:09:26.846775 [debug] [MainThread]: On master: COMMIT
[0m21:09:26.846775 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:26.847778 [debug] [MainThread]: On master: COMMIT
[0m21:09:26.847778 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:26.847778 [debug] [MainThread]: On master: Close
[0m21:09:26.853863 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m21:09:26.853863 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_products ................................ [RUN]
[0m21:09:26.854865 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_products'
[0m21:09:26.854865 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m21:09:26.862351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m21:09:26.864469 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m21:09:26.895023 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m21:09:26.897163 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:09:26.897163 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m21:09:26.897163 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:09:26.941454 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m21:09:26.941454 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:09:26.942543 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m21:09:26.960614 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m21:09:26.965964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:09:26.965964 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m21:09:26.968388 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:09:26.979620 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m21:09:26.979620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:09:26.980645 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m21:09:26.982811 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:09:26.988831 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m21:09:26.993932 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m21:09:26.993932 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m21:09:26.995729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:09:26.997924 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m21:09:27.000936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd32d5875-bbfa-4375-b37b-dab31bcf4649', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029584B6BA70>]}
[0m21:09:27.000936 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m21:09:27.001941 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m21:09:27.004023 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:27.004023 [debug] [MainThread]: On master: BEGIN
[0m21:09:27.004023 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:09:27.045830 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m21:09:27.045830 [debug] [MainThread]: On master: COMMIT
[0m21:09:27.045830 [debug] [MainThread]: Using postgres connection "master"
[0m21:09:27.046833 [debug] [MainThread]: On master: COMMIT
[0m21:09:27.046833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:09:27.046833 [debug] [MainThread]: On master: Close
[0m21:09:27.047836 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:09:27.047836 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m21:09:27.047836 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m21:09:27.047836 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m21:09:27.048839 [info ] [MainThread]: 
[0m21:09:27.048839 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m21:09:27.049914 [debug] [MainThread]: Command end result
[0m21:09:27.070365 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:09:27.072373 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:09:27.078399 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m21:09:27.078399 [info ] [MainThread]: 
[0m21:09:27.079403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:09:27.079403 [info ] [MainThread]: 
[0m21:09:27.079403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:09:27.080762 [debug] [MainThread]: Command `dbt run` succeeded at 21:09:27.080762 after 1.99 seconds
[0m21:09:27.081764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029587A30740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029588D4BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029584B6BA70>]}
[0m21:09:27.081764 [debug] [MainThread]: Flushing usage events
[0m21:09:28.620973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:49.497960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145EF7FB500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145EF19C980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145EFADB080>]}


============================== 21:12:49.504707 | b33baf56-2203-475f-97f4-a2cd10544fdc ==============================
[0m21:12:49.504707 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:12:49.505757 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_name_translatio.sql', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m21:12:49.719280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b33baf56-2203-475f-97f4-a2cd10544fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145F164AA50>]}
[0m21:12:49.772395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b33baf56-2203-475f-97f4-a2cd10544fdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145EFEA7560>]}
[0m21:12:49.774395 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:12:50.171504 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:12:50.365967 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:12:50.365967 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_name_translation.sql
[0m21:12:50.520803 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.stg_name_translation' (models\staging\stg_name_translation.sql) depends on a source named 'raw.product_category_name_translation_dataset' which was not found
[0m21:12:50.522001 [debug] [MainThread]: Command `dbt run` failed at 21:12:50.522001 after 1.13 seconds
[0m21:12:50.522001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145F01D41D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145F19E6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145F19E7CE0>]}
[0m21:12:50.523026 [debug] [MainThread]: Flushing usage events
[0m21:12:52.196035 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:01.270369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06CEB0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D85D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D4467B0>]}


============================== 21:13:01.274396 | 177f4fa7-1028-4d76-975a-48f689632f96 ==============================
[0m21:13:01.274396 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:13:01.275401 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_name_translation.sql', 'printer_width': '80', 'write_json': 'True'}
[0m21:13:01.468551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '177f4fa7-1028-4d76-975a-48f689632f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06D85ED20>]}
[0m21:13:01.527731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '177f4fa7-1028-4d76-975a-48f689632f96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06DAE8380>]}
[0m21:13:01.529753 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:13:01.965230 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:13:02.164125 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:13:02.165127 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models\staging\stg_name_translation.sql
[0m21:13:02.324000 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.stg_name_translation' (models\staging\stg_name_translation.sql) depends on a source named 'raw.product_category_name_translation_dataset' which was not found
[0m21:13:02.325003 [debug] [MainThread]: Command `dbt run` failed at 21:13:02.325003 after 1.19 seconds
[0m21:13:02.325003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06EDE72F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06F1A1F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F06EFE00E0>]}
[0m21:13:02.326009 [debug] [MainThread]: Flushing usage events
[0m21:13:03.897379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:42.602579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E466B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E2AAD5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E4E01100>]}


============================== 21:13:42.606982 | 1940bb7c-0408-40c4-8a2c-108e67662cf4 ==============================
[0m21:13:42.606982 [info ] [MainThread]: Running with dbt=1.9.10
[0m21:13:42.606982 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select stg_name_translation.sql', 'printer_width': '80', 'target_path': 'None'}
[0m21:13:42.801297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E5064C50>]}
[0m21:13:42.858847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E464F4A0>]}
[0m21:13:42.859851 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m21:13:43.256695 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m21:13:43.454347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:13:43.454347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:13:43.459362 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m21:13:43.492845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E5149700>]}
[0m21:13:43.560061 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:13:43.582824 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:13:43.620415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E681E660>]}
[0m21:13:43.621418 [info ] [MainThread]: Found 10 models, 4 data tests, 9 sources, 447 macros
[0m21:13:43.621418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E6404530>]}
[0m21:13:43.623449 [info ] [MainThread]: 
[0m21:13:43.624471 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:13:43.624471 [info ] [MainThread]: 
[0m21:13:43.624471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:43.625869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m21:13:43.815805 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m21:13:43.816808 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m21:13:43.816808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:43.901626 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m21:13:43.902627 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m21:13:43.907628 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m21:13:43.912629 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:13:43.912629 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m21:13:43.912629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:43.957018 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m21:13:43.957018 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m21:13:43.957018 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:13:43.969101 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.011 seconds
[0m21:13:43.971157 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m21:13:43.971157 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m21:13:43.977604 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:43.977604 [debug] [MainThread]: On master: BEGIN
[0m21:13:43.977604 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:44.013615 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:13:44.013615 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:44.013615 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m21:13:44.024433 [debug] [MainThread]: SQL status: SELECT 7 in 0.010 seconds
[0m21:13:44.027684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E50A36E0>]}
[0m21:13:44.027684 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:44.027684 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:44.028687 [debug] [MainThread]: On master: BEGIN
[0m21:13:44.028687 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:13:44.028687 [debug] [MainThread]: On master: COMMIT
[0m21:13:44.029691 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:44.029691 [debug] [MainThread]: On master: COMMIT
[0m21:13:44.029691 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:44.029691 [debug] [MainThread]: On master: Close
[0m21:13:44.035196 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_name_translation
[0m21:13:44.035196 [info ] [Thread-1 (]: 1 of 1 START sql view model public.stg_name_translation ........................ [RUN]
[0m21:13:44.036196 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m21:13:44.036196 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_name_translation
[0m21:13:44.045446 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m21:13:44.047884 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_name_translation
[0m21:13:44.081689 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m21:13:44.082689 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m21:13:44.084092 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m21:13:44.084092 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:13:44.229909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m21:13:44.229909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m21:13:44.229909 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m21:13:44.241059 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m21:13:44.246236 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m21:13:44.246236 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m21:13:44.248906 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m21:13:44.260043 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m21:13:44.260043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m21:13:44.261047 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m21:13:44.262077 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:13:44.266109 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m21:13:44.270482 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m21:13:44.271485 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m21:13:44.272600 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m21:13:44.274606 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: Close
[0m21:13:44.276642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1940bb7c-0408-40c4-8a2c-108e67662cf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E21DB9B0>]}
[0m21:13:44.276642 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.24s]
[0m21:13:44.278063 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_name_translation
[0m21:13:44.279427 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:44.279427 [debug] [MainThread]: On master: BEGIN
[0m21:13:44.279427 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:44.314524 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m21:13:44.314524 [debug] [MainThread]: On master: COMMIT
[0m21:13:44.314524 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:44.315629 [debug] [MainThread]: On master: COMMIT
[0m21:13:44.315629 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:44.315629 [debug] [MainThread]: On master: Close
[0m21:13:44.315629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:44.315629 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m21:13:44.317079 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m21:13:44.317079 [debug] [MainThread]: Connection 'model.dbt_project.stg_name_translation' was properly closed.
[0m21:13:44.317079 [info ] [MainThread]: 
[0m21:13:44.318080 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.69 seconds (0.69s).
[0m21:13:44.319197 [debug] [MainThread]: Command end result
[0m21:13:44.339267 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m21:13:44.342552 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m21:13:44.347538 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m21:13:44.347538 [info ] [MainThread]: 
[0m21:13:44.348701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:13:44.348701 [info ] [MainThread]: 
[0m21:13:44.348701 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:13:44.350028 [debug] [MainThread]: Command `dbt run` succeeded at 21:13:44.350028 after 1.85 seconds
[0m21:13:44.351051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E4373A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E4603080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242E4603D10>]}
[0m21:13:44.351051 [debug] [MainThread]: Flushing usage events
[0m21:13:45.899153 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:41:05.654562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC7977E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC76D4200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC77DFB30>]}


============================== 12:41:05.710486 | c9b6c13d-1c35-499b-83b0-5c9efb095302 ==============================
[0m12:41:05.710486 [info ] [MainThread]: Running with dbt=1.9.10
[0m12:41:05.711486 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt ', 'printer_width': '80', 'write_json': 'True'}
[0m12:41:05.890807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9b6c13d-1c35-499b-83b0-5c9efb095302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC7A33770>]}
[0m12:41:05.937487 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:41:05.941815 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:41:05.945407 [debug] [MainThread]: Command `cli deps` succeeded at 12:41:05.943893 after 0.68 seconds
[0m12:41:05.946416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC7B7E930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC7E2F470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EC79B0B60>]}
[0m12:41:05.946919 [debug] [MainThread]: Flushing usage events
[0m12:41:07.712220 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:43.789227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAC3F36E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAE8F82F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAECD3F20>]}


============================== 12:48:43.794145 | 279cd411-eb30-412c-b895-98efb677368f ==============================
[0m12:48:43.794145 [info ] [MainThread]: Running with dbt=1.9.10
[0m12:48:43.794145 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'printer_width': '80', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:48:43.827366 [info ] [MainThread]: dbt version: 1.9.10
[0m12:48:43.828366 [info ] [MainThread]: python version: 3.12.5
[0m12:48:43.829366 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m12:48:43.829366 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m12:48:43.899730 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m12:48:43.899730 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m12:48:43.900733 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m12:48:43.901969 [info ] [MainThread]: adapter type: postgres
[0m12:48:43.902971 [info ] [MainThread]: adapter version: 1.9.1
[0m12:48:43.994226 [info ] [MainThread]: Configuration:
[0m12:48:43.994226 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:48:43.995729 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:48:43.996240 [info ] [MainThread]: Required dependencies:
[0m12:48:43.996240 [debug] [MainThread]: Executing "git --help"
[0m12:48:44.032959 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:48:44.032959 [debug] [MainThread]: STDERR: "b''"
[0m12:48:44.034143 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:48:44.034143 [info ] [MainThread]: Connection:
[0m12:48:44.034143 [info ] [MainThread]:   host: localhost
[0m12:48:44.034143 [info ] [MainThread]:   port: 5432
[0m12:48:44.035647 [info ] [MainThread]:   user: postgres
[0m12:48:44.035647 [info ] [MainThread]:   database: ecommerce_raw
[0m12:48:44.035647 [info ] [MainThread]:   schema: public
[0m12:48:44.036662 [info ] [MainThread]:   connect_timeout: 10
[0m12:48:44.037170 [info ] [MainThread]:   role: None
[0m12:48:44.037170 [info ] [MainThread]:   search_path: None
[0m12:48:44.037170 [info ] [MainThread]:   keepalives_idle: 0
[0m12:48:44.038187 [info ] [MainThread]:   sslmode: prefer
[0m12:48:44.038187 [info ] [MainThread]:   sslcert: None
[0m12:48:44.038187 [info ] [MainThread]:   sslkey: None
[0m12:48:44.038187 [info ] [MainThread]:   sslrootcert: None
[0m12:48:44.039190 [info ] [MainThread]:   application_name: dbt
[0m12:48:44.039190 [info ] [MainThread]:   retries: 1
[0m12:48:44.040195 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:48:44.516398 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m12:48:47.041047 [debug] [MainThread]: Using postgres connection "debug"
[0m12:48:47.042047 [debug] [MainThread]: On debug: select 1 as id
[0m12:48:47.042047 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:47.139935 [debug] [MainThread]: SQL status: SELECT 1 in 0.098 seconds
[0m12:48:47.140937 [debug] [MainThread]: On debug: Close
[0m12:48:47.140937 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:48:47.140937 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:48:47.142953 [debug] [MainThread]: Command `dbt debug` succeeded at 12:48:47.142953 after 3.45 seconds
[0m12:48:47.142953 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:48:47.142953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAED0A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAF189370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDAB6CA0F0>]}
[0m12:48:47.143956 [debug] [MainThread]: Flushing usage events
[0m12:48:48.826628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:48:56.050199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D4D355B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D549B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D549BDA0>]}


============================== 12:48:56.054225 | be15bfb6-960d-48df-9b68-cac151e2eea3 ==============================
[0m12:48:56.054225 [info ] [MainThread]: Running with dbt=1.9.10
[0m12:48:56.055728 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m12:48:56.251646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D549B590>]}
[0m12:48:56.305606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D575D220>]}
[0m12:48:56.307673 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m12:48:56.703240 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m12:48:56.933275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:48:56.934275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:48:56.972339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D58F97C0>]}
[0m12:48:57.044261 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m12:48:57.091268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m12:48:57.136281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D748DA00>]}
[0m12:48:57.137469 [info ] [MainThread]: Found 10 models, 20 data tests, 9 sources, 447 macros
[0m12:48:57.137469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D713FBF0>]}
[0m12:48:57.140137 [info ] [MainThread]: 
[0m12:48:57.141138 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:48:57.141138 [info ] [MainThread]: 
[0m12:48:57.142138 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:48:57.147177 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m12:48:57.299256 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m12:48:57.299256 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m12:48:57.299256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:57.346415 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m12:48:57.346415 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m12:48:57.347571 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:48:57.399855 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.052 seconds
[0m12:48:57.401875 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m12:48:57.402943 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m12:48:57.409262 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:57.409262 [debug] [MainThread]: On master: BEGIN
[0m12:48:57.409262 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:48:57.446442 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:48:57.447458 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:57.447458 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m12:48:57.468801 [debug] [MainThread]: SQL status: SELECT 8 in 0.021 seconds
[0m12:48:57.471084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be15bfb6-960d-48df-9b68-cac151e2eea3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D7447D40>]}
[0m12:48:57.471084 [debug] [MainThread]: On master: ROLLBACK
[0m12:48:57.472106 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:57.472106 [debug] [MainThread]: On master: BEGIN
[0m12:48:57.473108 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:48:57.473108 [debug] [MainThread]: On master: COMMIT
[0m12:48:57.473108 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:57.473108 [debug] [MainThread]: On master: COMMIT
[0m12:48:57.474114 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:57.474114 [debug] [MainThread]: On master: Close
[0m12:48:57.479879 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:48:57.479879 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:48:57.481382 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:48:57.481382 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m12:48:57.481382 [info ] [Thread-1 (]: 1 of 20 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m12:48:57.481382 [info ] [Thread-2 (]: 2 of 20 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m12:48:57.482651 [info ] [Thread-3 (]: 3 of 20 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m12:48:57.482651 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m12:48:57.482651 [info ] [Thread-4 (]: 4 of 20 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m12:48:57.483861 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m12:48:57.483861 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m12:48:57.483861 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:48:57.483861 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m12:48:57.485364 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:48:57.485364 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:48:57.498640 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:48:57.499642 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m12:48:57.502650 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m12:48:57.506221 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:48:57.510199 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m12:48:57.511633 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m12:48:57.522679 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:48:57.527771 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m12:48:57.530230 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m12:48:57.530230 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:48:57.530230 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:48:57.532439 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:48:57.534444 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:48:57.536638 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m12:48:57.536638 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m12:48:57.537708 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:48:57.537708 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m12:48:57.537708 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:48:57.538878 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:48:57.538878 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m12:48:57.538878 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m12:48:57.540125 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m12:48:57.540125 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:48:57.541128 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:48:57.541128 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:48:57.593319 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m12:48:57.594414 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m12:48:57.594414 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m12:48:57.595413 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m12:48:57.595413 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.595413 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.600484 [debug] [Thread-2 (]: SQL status: BEGIN in 0.059 seconds
[0m12:48:57.600484 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m12:48:57.601498 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.601498 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m12:48:57.601498 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m12:48:57.602543 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.605631 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 17: from "ecommerce_raw"."public"."my_second_dbt_model"
              ^

[0m12:48:57.605631 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_first_dbt_model" does not exist
LINE 17: from "ecommerce_raw"."public"."my_first_dbt_model"
              ^

[0m12:48:57.606798 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m12:48:57.606798 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m12:48:57.606798 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m12:48:57.608138 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m12:48:57.657830 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.061 seconds
[0m12:48:57.657830 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.062 seconds
[0m12:48:57.662010 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m12:48:57.663468 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m12:48:57.663468 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m12:48:57.663468 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m12:48:57.664471 [info ] [Thread-3 (]: 3 of 20 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m12:48:57.665472 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m12:48:57.665472 [info ] [Thread-4 (]: 4 of 20 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.18s]
[0m12:48:57.666723 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f
[0m12:48:57.667814 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m12:48:57.667814 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1
[0m12:48:57.667814 [info ] [Thread-3 (]: 5 of 20 START test not_null_stg_geolocation_geolocation_id ..................... [RUN]
[0m12:48:57.669033 [info ] [Thread-4 (]: 6 of 20 START test not_null_stg_geolocation_location ........................... [RUN]
[0m12:48:57.669033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f)
[0m12:48:57.670042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1)
[0m12:48:57.670042 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f
[0m12:48:57.670042 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1
[0m12:48:57.674046 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f"
[0m12:48:57.677615 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1"
[0m12:48:57.679008 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f
[0m12:48:57.681613 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f"
[0m12:48:57.682640 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1
[0m12:48:57.686858 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1"
[0m12:48:57.687859 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f"
[0m12:48:57.687859 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f: BEGIN
[0m12:48:57.689132 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:48:57.689132 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1"
[0m12:48:57.689132 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1: BEGIN
[0m12:48:57.690299 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:48:57.735622 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m12:48:57.736127 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1"
[0m12:48:57.736631 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select location
from "ecommerce_raw"."public"."stg_geolocation"
where location is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.738102 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column "location" does not exist
LINE 16: select location
                ^

[0m12:48:57.738102 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1: ROLLBACK
[0m12:48:57.739107 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1: Close
[0m12:48:57.755623 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m12:48:57.756631 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m12:48:57.757810 [debug] [Thread-4 (]: Database Error in test not_null_stg_geolocation_location (models\staging\_staging_test.yml)
  column "location" does not exist
  LINE 16: select location
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_location.sql
[0m12:48:57.756631 [error] [Thread-2 (]: 2 of 20 ERROR not_null_my_second_dbt_model_id .................................. [[31mERROR[0m in 0.27s]
[0m12:48:57.758816 [error] [Thread-1 (]: 1 of 20 ERROR not_null_my_first_dbt_model_id ................................... [[31mERROR[0m in 0.28s]
[0m12:48:57.758816 [error] [Thread-4 (]: 6 of 20 ERROR not_null_stg_geolocation_location ................................ [[31mERROR[0m in 0.09s]
[0m12:48:57.759819 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m12:48:57.759819 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m12:48:57.760824 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1
[0m12:48:57.760824 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:48:57.761840 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_second_dbt_model_id.sql.
[0m12:48:57.761840 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:48:57.761840 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m12:48:57.762845 [info ] [Thread-2 (]: 7 of 20 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m12:48:57.763853 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql.
[0m12:48:57.763853 [info ] [Thread-1 (]: 8 of 20 START test not_null_stg_orders_order_id ................................ [RUN]
[0m12:48:57.763853 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m12:48:57.763853 [info ] [Thread-4 (]: 9 of 20 START test not_null_stg_products_product_id ............................ [RUN]
[0m12:48:57.765357 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_geolocation_location (models\staging\_staging_test.yml)
  column "location" does not exist
  LINE 16: select location
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_location.sql.
[0m12:48:57.765357 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m12:48:57.765357 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:48:57.766364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_geolocation_location.20ad1bc8e1, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m12:48:57.766364 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:48:57.769782 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:48:57.770786 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m12:48:57.773917 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:48:57.777627 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:48:57.779650 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:48:57.782159 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:48:57.782159 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:48:57.783165 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m12:48:57.784174 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:48:57.786187 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:48:57.787105 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:48:57.787105 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m12:48:57.788501 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:48:57.788501 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:48:57.789529 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m12:48:57.789529 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:48:57.790529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:57.790529 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m12:48:57.790529 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:48:57.836585 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m12:48:57.837794 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m12:48:57.837794 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f"
[0m12:48:57.837794 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m12:48:57.838799 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select geolocation_id
from "ecommerce_raw"."public"."stg_geolocation"
where geolocation_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.838799 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.838799 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:48:57.839802 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m12:48:57.839802 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.839802 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "geolocation_id" does not exist
LINE 16: select geolocation_id
                ^

[0m12:48:57.841041 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f: ROLLBACK
[0m12:48:57.841041 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f: Close
[0m12:48:57.845381 [debug] [Thread-3 (]: Database Error in test not_null_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 16: select geolocation_id
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_geolocation_id.sql
[0m12:48:57.845886 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m12:48:57.846389 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m12:48:57.846389 [error] [Thread-3 (]: 5 of 20 ERROR not_null_stg_geolocation_geolocation_id .......................... [[31mERROR[0m in 0.18s]
[0m12:48:57.847330 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.847330 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f
[0m12:48:57.848382 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_products_product_name.0b59e4b939
[0m12:48:57.848382 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 16: select geolocation_id
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_geolocation_id.sql.
[0m12:48:57.849390 [info ] [Thread-3 (]: 10 of 20 START test not_null_stg_products_product_name ......................... [RUN]
[0m12:48:57.850486 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_geolocation_geolocation_id.0b0962738f, now test.dbt_project.not_null_stg_products_product_name.0b59e4b939)
[0m12:48:57.850486 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_products_product_name.0b59e4b939
[0m12:48:57.855336 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_name.0b59e4b939"
[0m12:48:57.856345 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_products_product_name.0b59e4b939
[0m12:48:57.861609 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_name.0b59e4b939"
[0m12:48:57.862608 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_name.0b59e4b939"
[0m12:48:57.863609 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_name.0b59e4b939: BEGIN
[0m12:48:57.864609 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:48:57.877622 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m12:48:57.878719 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.037 seconds
[0m12:48:57.878719 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.039 seconds
[0m12:48:57.879724 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m12:48:57.881729 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m12:48:57.882744 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m12:48:57.883745 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m12:48:57.883745 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m12:48:57.883745 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m12:48:57.884745 [info ] [Thread-4 (]: 9 of 20 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.12s]
[0m12:48:57.884745 [info ] [Thread-1 (]: 8 of 20 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.12s]
[0m12:48:57.886249 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m12:48:57.887274 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m12:48:57.886249 [info ] [Thread-2 (]: 7 of 20 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.12s]
[0m12:48:57.887274 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m12:48:57.888448 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff
[0m12:48:57.888448 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m12:48:57.888448 [info ] [Thread-4 (]: 11 of 20 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m12:48:57.889452 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:48:57.889452 [info ] [Thread-1 (]: 12 of 20 START test not_null_stg_sellers_seller_name ........................... [RUN]
[0m12:48:57.890455 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m12:48:57.890455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff)
[0m12:48:57.890455 [info ] [Thread-2 (]: 13 of 20 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m12:48:57.891490 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m12:48:57.891490 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff
[0m12:48:57.892490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m12:48:57.896652 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m12:48:57.899965 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff"
[0m12:48:57.899965 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:48:57.908034 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:48:57.909040 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m12:48:57.912145 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m12:48:57.912145 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff
[0m12:48:57.913167 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:48:57.913167 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m12:48:57.916593 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff"
[0m12:48:57.918799 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:48:57.918799 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_name.0b59e4b939"
[0m12:48:57.919802 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m12:48:57.919802 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_name.0b59e4b939: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_name.0b59e4b939"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_name
from "ecommerce_raw"."public"."stg_products"
where product_name is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.920808 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m12:48:57.920808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:48:57.921812 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff"
[0m12:48:57.921812 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "product_name" does not exist
LINE 16: select product_name
                ^

[0m12:48:57.922816 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff: BEGIN
[0m12:48:57.922816 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:48:57.922816 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_name.0b59e4b939: ROLLBACK
[0m12:48:57.923842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:57.923842 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m12:48:57.923842 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_name.0b59e4b939: Close
[0m12:48:57.923842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:48:57.929620 [debug] [Thread-3 (]: Database Error in test not_null_stg_products_product_name (models\staging\_staging_test.yml)
  column "product_name" does not exist
  LINE 16: select product_name
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_name.sql
[0m12:48:57.930639 [error] [Thread-3 (]: 10 of 20 ERROR not_null_stg_products_product_name .............................. [[31mERROR[0m in 0.08s]
[0m12:48:57.931650 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_products_product_name.0b59e4b939
[0m12:48:57.931650 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m12:48:57.931650 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_stg_products_product_name.0b59e4b939' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_products_product_name (models\staging\_staging_test.yml)
  column "product_name" does not exist
  LINE 16: select product_name
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_name.sql.
[0m12:48:57.932651 [info ] [Thread-3 (]: 14 of 20 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m12:48:57.932651 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_name.0b59e4b939, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m12:48:57.934126 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m12:48:57.943488 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m12:48:57.945490 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m12:48:57.948756 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m12:48:57.949760 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m12:48:57.949760 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m12:48:57.950929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:48:57.971835 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m12:48:57.972835 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff"
[0m12:48:57.972835 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_name
from "ecommerce_raw"."public"."stg_sellers"
where seller_name is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.974272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "seller_name" does not exist
LINE 16: select seller_name
                ^
HINT:  Perhaps you meant to reference the column "stg_sellers.seller_state".

[0m12:48:57.974272 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff: ROLLBACK
[0m12:48:57.975777 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff: Close
[0m12:48:57.977735 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m12:48:57.977735 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m12:48:57.977735 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m12:48:57.979749 [debug] [Thread-1 (]: Database Error in test not_null_stg_sellers_seller_name (models\staging\_staging_test.yml)
  column "seller_name" does not exist
  LINE 16: select seller_name
                  ^
  HINT:  Perhaps you meant to reference the column "stg_sellers.seller_state".
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_sellers_seller_name.sql
[0m12:48:57.979749 [error] [Thread-1 (]: 12 of 20 ERROR not_null_stg_sellers_seller_name ................................ [[31mERROR[0m in 0.09s]
[0m12:48:57.980753 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff
[0m12:48:57.980753 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:48:57.981753 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_sellers_seller_name (models\staging\_staging_test.yml)
  column "seller_name" does not exist
  LINE 16: select seller_name
                  ^
  HINT:  Perhaps you meant to reference the column "stg_sellers.seller_state".
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_sellers_seller_name.sql.
[0m12:48:57.981753 [info ] [Thread-1 (]: 15 of 20 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m12:48:57.982976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_name.d49dcca3ff, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m12:48:57.982976 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:48:57.986495 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:48:57.987683 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:48:57.990886 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:48:57.991891 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:48:57.992897 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m12:48:57.992897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:57.994134 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m12:48:57.994134 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m12:48:57.994134 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:57.995637 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "public.my_first_dbt_model" does not exist
LINE 18: from "ecommerce_raw"."public"."my_first_dbt_model"
              ^

[0m12:48:57.996639 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m12:48:57.997735 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m12:48:58.002261 [debug] [Thread-3 (]: Database Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_first_dbt_model_id.sql
[0m12:48:58.003261 [error] [Thread-3 (]: 14 of 20 ERROR unique_my_first_dbt_model_id .................................... [[31mERROR[0m in 0.07s]
[0m12:48:58.004262 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m12:48:58.004262 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m12:48:58.004262 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_first_dbt_model_id.sql.
[0m12:48:58.005765 [info ] [Thread-3 (]: 16 of 20 START test unique_stg_customers_customer_id ........................... [RUN]
[0m12:48:58.006358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m12:48:58.006358 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m12:48:58.011752 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m12:48:58.013752 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m12:48:58.016275 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m12:48:58.017362 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m12:48:58.018026 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m12:48:58.018026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:48:58.044371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m12:48:58.045371 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m12:48:58.045371 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.046586 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.my_second_dbt_model" does not exist
LINE 18: from "ecommerce_raw"."public"."my_second_dbt_model"
              ^

[0m12:48:58.046586 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m12:48:58.047748 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m12:48:58.051812 [debug] [Thread-1 (]: Database Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m12:48:58.051812 [error] [Thread-1 (]: 15 of 20 ERROR unique_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.07s]
[0m12:48:58.052818 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m12:48:58.052818 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85
[0m12:48:58.053817 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_second_dbt_model_id.sql.
[0m12:48:58.053817 [info ] [Thread-1 (]: 17 of 20 START test unique_stg_geolocation_geolocation_id ...................... [RUN]
[0m12:48:58.055110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85)
[0m12:48:58.055615 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85
[0m12:48:58.058687 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85"
[0m12:48:58.059694 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85
[0m12:48:58.062721 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85"
[0m12:48:58.064732 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85"
[0m12:48:58.065722 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m12:48:58.066227 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85: BEGIN
[0m12:48:58.066227 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m12:48:58.067241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:58.067241 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.073865 [debug] [Thread-4 (]: SQL status: BEGIN in 0.153 seconds
[0m12:48:58.075368 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m12:48:58.075368 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m12:48:58.081136 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m12:48:58.083657 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m12:48:58.083657 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m12:48:58.085398 [info ] [Thread-4 (]: 11 of 20 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.19s]
[0m12:48:58.086400 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m12:48:58.086400 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:48:58.087536 [info ] [Thread-4 (]: 18 of 20 START test unique_stg_orders_order_id ................................. [RUN]
[0m12:48:58.087536 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m12:48:58.088560 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:48:58.092827 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:48:58.093847 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:48:58.096354 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:48:58.097405 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:48:58.098412 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m12:48:58.098412 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:48:58.104659 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.125 seconds
[0m12:48:58.106760 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m12:48:58.107755 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m12:48:58.107755 [info ] [Thread-2 (]: 13 of 20 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.22s]
[0m12:48:58.108837 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m12:48:58.108837 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m12:48:58.109841 [info ] [Thread-2 (]: 19 of 20 START test unique_stg_products_product_id ............................. [RUN]
[0m12:48:58.109841 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m12:48:58.110845 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m12:48:58.117857 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m12:48:58.119976 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m12:48:58.119976 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m12:48:58.181900 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m12:48:58.181900 [debug] [Thread-4 (]: SQL status: BEGIN in 0.084 seconds
[0m12:48:58.182935 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85"
[0m12:48:58.182935 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m12:48:58.183940 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    geolocation_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_geolocation"
where geolocation_id is not null
group by geolocation_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.183940 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.183940 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m12:48:58.185443 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "geolocation_id" does not exist
LINE 15:     geolocation_id as unique_field,
             ^

[0m12:48:58.185443 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m12:48:58.186447 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85: ROLLBACK
[0m12:48:58.186447 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:48:58.187443 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85: Close
[0m12:48:58.191710 [debug] [Thread-1 (]: Database Error in test unique_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 15:     geolocation_id as unique_field,
               ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\unique_stg_geolocation_geolocation_id.sql
[0m12:48:58.191710 [error] [Thread-1 (]: 17 of 20 ERROR unique_stg_geolocation_geolocation_id ........................... [[31mERROR[0m in 0.14s]
[0m12:48:58.192710 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85
[0m12:48:58.193711 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m12:48:58.193711 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85' to be skipped because of status 'error'.  Reason: Database Error in test unique_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 15:     geolocation_id as unique_field,
               ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\unique_stg_geolocation_geolocation_id.sql.
[0m12:48:58.194953 [info ] [Thread-1 (]: 20 of 20 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m12:48:58.195456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_geolocation_geolocation_id.bfffc43b85, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m12:48:58.195456 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m12:48:58.201049 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m12:48:58.203560 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m12:48:58.207595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m12:48:58.208875 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m12:48:58.210110 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m12:48:58.211111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:58.239233 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m12:48:58.239233 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m12:48:58.240404 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.247319 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.179 seconds
[0m12:48:58.248321 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m12:48:58.249321 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m12:48:58.249321 [error] [Thread-3 (]: 16 of 20 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.24s]
[0m12:48:58.250321 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m12:48:58.259218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m12:48:58.259218 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m12:48:58.260224 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m12:48:58.263686 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m12:48:58.265760 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m12:48:58.266272 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.025 seconds
[0m12:48:58.267289 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m12:48:58.267289 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m12:48:58.267289 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m12:48:58.268293 [info ] [Thread-1 (]: 20 of 20 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.07s]
[0m12:48:58.269296 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m12:48:58.269296 [info ] [Thread-2 (]: 19 of 20 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.16s]
[0m12:48:58.270296 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m12:48:58.280081 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.096 seconds
[0m12:48:58.282085 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m12:48:58.282085 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m12:48:58.283409 [info ] [Thread-4 (]: 18 of 20 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.20s]
[0m12:48:58.283409 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m12:48:58.284441 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:58.285441 [debug] [MainThread]: On master: BEGIN
[0m12:48:58.285441 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:48:58.323649 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:48:58.323649 [debug] [MainThread]: On master: COMMIT
[0m12:48:58.323649 [debug] [MainThread]: Using postgres connection "master"
[0m12:48:58.324653 [debug] [MainThread]: On master: COMMIT
[0m12:48:58.324653 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:48:58.324653 [debug] [MainThread]: On master: Close
[0m12:48:58.325655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:58.326161 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m12:48:58.326161 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m12:48:58.326161 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m12:48:58.326161 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m12:48:58.327195 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m12:48:58.327195 [info ] [MainThread]: 
[0m12:48:58.327195 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m12:48:58.331249 [debug] [MainThread]: Command end result
[0m12:48:58.355752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m12:48:58.358268 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m12:48:58.365494 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m12:48:58.365997 [info ] [MainThread]: 
[0m12:48:58.366501 [info ] [MainThread]: [31mCompleted with 10 errors, 0 partial successes, and 0 warnings:[0m
[0m12:48:58.366501 [info ] [MainThread]: 
[0m12:48:58.366501 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_second_dbt_model_id.sql
[0m12:48:58.367517 [info ] [MainThread]: 
[0m12:48:58.367517 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 17: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m12:48:58.368537 [info ] [MainThread]: 
[0m12:48:58.368537 [error] [MainThread]:   Database Error in test not_null_stg_geolocation_location (models\staging\_staging_test.yml)
  column "location" does not exist
  LINE 16: select location
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_location.sql
[0m12:48:58.368537 [info ] [MainThread]: 
[0m12:48:58.369583 [error] [MainThread]:   Database Error in test not_null_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 16: select geolocation_id
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_geolocation_geolocation_id.sql
[0m12:48:58.369583 [info ] [MainThread]: 
[0m12:48:58.370583 [error] [MainThread]:   Database Error in test not_null_stg_products_product_name (models\staging\_staging_test.yml)
  column "product_name" does not exist
  LINE 16: select product_name
                  ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_name.sql
[0m12:48:58.370583 [info ] [MainThread]: 
[0m12:48:58.370583 [error] [MainThread]:   Database Error in test not_null_stg_sellers_seller_name (models\staging\_staging_test.yml)
  column "seller_name" does not exist
  LINE 16: select seller_name
                  ^
  HINT:  Perhaps you meant to reference the column "stg_sellers.seller_state".
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\not_null_stg_sellers_seller_name.sql
[0m12:48:58.370583 [info ] [MainThread]: 
[0m12:48:58.371912 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models\example\schema.yml)
  relation "public.my_first_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_first_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_first_dbt_model_id.sql
[0m12:48:58.371912 [info ] [MainThread]: 
[0m12:48:58.372919 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models\example\schema.yml)
  relation "public.my_second_dbt_model" does not exist
  LINE 18: from "ecommerce_raw"."public"."my_second_dbt_model"
                ^
  compiled code at target\run\dbt_project\models\example\schema.yml\unique_my_second_dbt_model_id.sql
[0m12:48:58.372919 [info ] [MainThread]: 
[0m12:48:58.372919 [error] [MainThread]:   Database Error in test unique_stg_geolocation_geolocation_id (models\staging\_staging_test.yml)
  column "geolocation_id" does not exist
  LINE 15:     geolocation_id as unique_field,
               ^
  compiled code at target\run\dbt_project\models\staging\_staging_test.yml\unique_stg_geolocation_geolocation_id.sql
[0m12:48:58.373920 [info ] [MainThread]: 
[0m12:48:58.373920 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m12:48:58.373920 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m12:48:58.375422 [info ] [MainThread]: 
[0m12:48:58.375422 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m12:48:58.375422 [info ] [MainThread]: 
[0m12:48:58.376425 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=10 SKIP=0 TOTAL=20
[0m12:48:58.377320 [debug] [MainThread]: Command `dbt test` failed at 12:48:58.377320 after 2.43 seconds
[0m12:48:58.377320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D4F8DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D5324230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200D55FB170>]}
[0m12:48:58.378547 [debug] [MainThread]: Flushing usage events
[0m12:48:59.975411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:54:52.116157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D85A9FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D859CC6E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D87E35C10>]}


============================== 12:54:52.121544 | f75be0b4-790c-430b-acd5-c9e44ed6ac9b ==============================
[0m12:54:52.121544 [info ] [MainThread]: Running with dbt=1.9.10
[0m12:54:52.122048 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt ', 'no_print': 'None', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m12:54:52.287307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f75be0b4-790c-430b-acd5-c9e44ed6ac9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D88473F80>]}
[0m12:54:52.330944 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:54:52.334759 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:54:52.337229 [debug] [MainThread]: Command `cli deps` succeeded at 12:54:52.337229 after 0.35 seconds
[0m12:54:52.338246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D85A9FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D887D5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020D88473F80>]}
[0m12:54:52.339253 [debug] [MainThread]: Flushing usage events
[0m12:54:54.271064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:29.615516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204467B200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022046FE33B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022046FE3F20>]}


============================== 13:04:29.620466 | f74a28a6-d6bb-4884-ade4-c50df192a974 ==============================
[0m13:04:29.620466 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:04:29.621970 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m13:04:29.857911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220474C1FA0>]}
[0m13:04:29.912133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220469B8890>]}
[0m13:04:29.913649 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:04:30.328918 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:04:30.579940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:30.579940 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:30.618111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204886E8A0>]}
[0m13:04:30.689683 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:04:30.714796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:04:30.756313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022048F613A0>]}
[0m13:04:30.757316 [info ] [MainThread]: Found 10 models, 24 data tests, 9 sources, 447 macros
[0m13:04:30.757316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022048C95790>]}
[0m13:04:30.760573 [info ] [MainThread]: 
[0m13:04:30.760573 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:30.760573 [info ] [MainThread]: 
[0m13:04:30.762077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:30.766305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:04:31.010074 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:04:31.011074 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:04:31.011074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:31.105086 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.094 seconds
[0m13:04:31.106164 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:04:31.108496 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:04:31.113511 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:04:31.113511 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:04:31.113946 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:31.254619 [debug] [ThreadPool]: SQL status: BEGIN in 0.141 seconds
[0m13:04:31.254619 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:04:31.254619 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:04:31.270829 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.016 seconds
[0m13:04:31.272886 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:04:31.272886 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:04:31.279520 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.279520 [debug] [MainThread]: On master: BEGIN
[0m13:04:31.279520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:31.316257 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:04:31.316257 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.316257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:04:31.327784 [debug] [MainThread]: SQL status: SELECT 8 in 0.011 seconds
[0m13:04:31.330807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220492AA480>]}
[0m13:04:31.330807 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:31.330807 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.330807 [debug] [MainThread]: On master: BEGIN
[0m13:04:31.332312 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:04:31.332312 [debug] [MainThread]: On master: COMMIT
[0m13:04:31.332832 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.332832 [debug] [MainThread]: On master: COMMIT
[0m13:04:31.332832 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:31.332832 [debug] [MainThread]: On master: Close
[0m13:04:31.338283 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:04:31.339349 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:04:31.339349 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_geolocation
[0m13:04:31.339349 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:04:31.340358 [info ] [Thread-1 (]: 1 of 10 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m13:04:31.340358 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m13:04:31.341362 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_geolocation ............................ [RUN]
[0m13:04:31.341362 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:04:31.341362 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_items_ordered .......................... [RUN]
[0m13:04:31.342362 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:04:31.342865 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_geolocation'
[0m13:04:31.342865 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:04:31.342865 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:04:31.343890 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:04:31.343890 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_geolocation
[0m13:04:31.350121 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:04:31.350121 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:04:31.353184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:04:31.355295 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_geolocation"
[0m13:04:31.357564 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:04:31.358568 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:04:31.392525 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:04:31.393029 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:04:31.393029 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:04:31.408884 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:04:31.408884 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_geolocation
[0m13:04:31.412903 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:04:31.415279 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_geolocation"
[0m13:04:31.416293 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:04:31.416293 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:04:31.417297 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:31.417297 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.418304 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:04:31.418304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:31.418304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.419307 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:04:31.419307 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.419307 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:31.420620 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: BEGIN
[0m13:04:31.420620 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:31.459834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:04:31.459834 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:04:31.461282 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:04:31.462785 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m13:04:31.463717 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.464220 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:04:31.467450 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m13:04:31.467450 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.467450 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:04:31.468590 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:04:31.468590 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.469595 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */

  create view "ecommerce_raw"."public"."stg_geolocation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_geolocation_dataset"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );
[0m13:04:31.479391 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.018 seconds
[0m13:04:31.487055 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:04:31.488078 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.024 seconds
[0m13:04:31.488078 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:04:31.488078 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.019 seconds
[0m13:04:31.489081 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:04:31.491193 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.494259 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.496262 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.496262 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:04:31.497575 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:04:31.497575 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
alter table "ecommerce_raw"."public"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m13:04:31.498588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.498588 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.498588 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.510368 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:04:31.510368 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:04:31.512874 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.514957 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.515957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:04:31.519124 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.519124 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:04:31.519124 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
alter table "ecommerce_raw"."public"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m13:04:31.520140 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:04:31.520140 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:04:31.521205 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.521205 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.521205 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.524617 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:04:31.524617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:04:31.525620 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m13:04:31.526620 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:04:31.527777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.532812 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:04:31.532812 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.532812 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.533825 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:04:31.537836 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:04:31.537836 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m13:04:31.537836 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:04:31.539077 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:04:31.539077 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.540081 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:04:31.542101 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:04:31.542605 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:04:31.542605 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m13:04:31.544511 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:04:31.547514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:04:31.548813 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_geolocation__dbt_backup"
[0m13:04:31.550824 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:04:31.550824 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:04:31.552835 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:04:31.552835 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:04:31.554235 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
drop view if exists "ecommerce_raw"."public"."stg_geolocation__dbt_backup" cascade
[0m13:04:31.554235 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:04:31.555268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204477B650>]}
[0m13:04:31.556380 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.21s]
[0m13:04:31.557400 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:04:31.557400 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_name_translation
[0m13:04:31.557400 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_name_translation ....................... [RUN]
[0m13:04:31.558405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_name_translation)
[0m13:04:31.558405 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:04:31.560470 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:04:31.561973 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m13:04:31.561973 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m13:04:31.562975 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m13:04:31.564482 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:04:31.565486 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: Close
[0m13:04:31.566486 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:04:31.566486 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:04:31.567498 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220493341D0>]}
[0m13:04:31.567498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002204938A000>]}
[0m13:04:31.567498 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022049324050>]}
[0m13:04:31.571307 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:04:31.572809 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:04:31.572809 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_geolocation ....................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:04:31.573820 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:04:31.575005 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:04:31.575005 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_geolocation
[0m13:04:31.576013 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:04:31.576013 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_order_payment
[0m13:04:31.576013 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m13:04:31.577283 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.577283 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m13:04:31.577283 [info ] [Thread-2 (]: 6 of 10 START sql view model public.stg_order_payment .......................... [RUN]
[0m13:04:31.578770 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:04:31.578770 [info ] [Thread-3 (]: 7 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m13:04:31.579773 [info ] [Thread-4 (]: 8 of 10 START sql view model public.stg_products ............................... [RUN]
[0m13:04:31.579773 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_order_payment)
[0m13:04:31.579773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:31.580848 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_geolocation, now model.dbt_project.stg_orders)
[0m13:04:31.580848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m13:04:31.580848 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:04:31.580848 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m13:04:31.582351 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m13:04:31.584879 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:04:31.588000 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:04:31.590517 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:04:31.593025 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:04:31.599436 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:04:31.599436 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m13:04:31.604216 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:04:31.604216 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m13:04:31.608580 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:04:31.609589 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.609589 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:04:31.609589 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:31.610594 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.612097 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:04:31.612097 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:31.613099 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.613099 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m13:04:31.613099 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:31.629612 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m13:04:31.630790 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.630790 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:04:31.636410 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:04:31.639485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.640702 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:04:31.640702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:31.643710 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.643710 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:04:31.644711 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:31.645711 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:04:31.645711 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.646793 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:04:31.646793 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.649793 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:04:31.649793 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:04:31.649793 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:04:31.651959 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:04:31.652961 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: Close
[0m13:04:31.652961 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220497ABCB0>]}
[0m13:04:31.653899 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:04:31.653899 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.653899 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.09s]
[0m13:04:31.655296 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select order_id from renamed where payment_type = 'credit_card'
  );
[0m13:04:31.655296 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:04:31.656299 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m13:04:31.656299 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m13:04:31.656299 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.657315 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:04:31.657315 [info ] [Thread-1 (]: 9 of 10 START sql view model public.stg_sellers ................................ [RUN]
[0m13:04:31.658315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m13:04:31.658315 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:04:31.660808 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:04:31.660808 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m13:04:31.662313 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:04:31.662821 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.665047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.665047 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:04:31.666561 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:04:31.666561 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:04:31.666561 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m13:04:31.669598 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.673115 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:04:31.674157 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:04:31.674157 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:04:31.676209 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.677225 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:04:31.677225 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:04:31.680370 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.681875 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m13:04:31.681875 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:04:31.682884 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.682884 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.736071 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.736071 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:04:31.737506 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:04:31.737506 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:04:31.738508 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:04:31.738508 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:31.738508 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.740561 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.742064 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:04:31.742064 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.742064 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:04:31.743568 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:04:31.743568 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.743568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.745881 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:04:31.746881 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:04:31.746881 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:04:31.747951 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:04:31.749172 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:04:31.749172 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:04:31.749172 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.750176 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.750176 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:04:31.752045 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:04:31.753047 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:04:31.753047 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:04:31.754119 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.755234 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: Close
[0m13:04:31.755234 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:04:31.757568 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:04:31.757568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220493341D0>]}
[0m13:04:31.758567 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:04:31.759567 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:04:31.759567 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:04:31.759567 [info ] [Thread-2 (]: 6 of 10 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:04:31.760567 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m13:04:31.762072 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:04:31.762072 [debug] [Thread-2 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:04:31.763080 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022048840740>]}
[0m13:04:31.763080 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:04:31.763080 [info ] [Thread-2 (]: 10 of 10 START sql view model public.my_second_dbt_model ....................... [RUN]
[0m13:04:31.765895 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m13:04:31.764533 [info ] [Thread-3 (]: 7 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m13:04:31.766398 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.my_second_dbt_model)
[0m13:04:31.766398 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m13:04:31.766398 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022048840740>]}
[0m13:04:31.767840 [debug] [Thread-2 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:04:31.771089 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:04:31.767840 [info ] [Thread-4 (]: 8 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:04:31.771089 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m13:04:31.772594 [debug] [Thread-2 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:04:31.776181 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:04:31.777181 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:04:31.778364 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:04:31.778364 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:31.782026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:04:31.782026 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.783038 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:04:31.787276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:04:31.790938 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.791941 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:04:31.791941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:04:31.794447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.795447 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:04:31.795447 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:31.796447 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:04:31.797447 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.797447 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:04:31.798448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.800448 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:04:31.801952 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:04:31.801952 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:04:31.803887 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:04:31.805459 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m13:04:31.805459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022049289850>]}
[0m13:04:31.806459 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m13:04:31.806459 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m13:04:31.818962 [debug] [Thread-2 (]: SQL status: BEGIN in 0.040 seconds
[0m13:04:31.819965 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:04:31.819965 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:04:31.824984 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:04:31.827985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:04:31.827985 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:04:31.828985 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:04:31.829985 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:04:31.829985 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:04:31.829985 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:04:31.830995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:04:31.835035 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:04:31.835035 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:04:31.835035 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:04:31.836037 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:04:31.837159 [debug] [Thread-2 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:04:31.837159 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f74a28a6-d6bb-4884-ade4-c50df192a974', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022049361F40>]}
[0m13:04:31.838162 [info ] [Thread-2 (]: 10 of 10 OK created sql view model public.my_second_dbt_model .................. [[32mCREATE VIEW[0m in 0.07s]
[0m13:04:31.839162 [debug] [Thread-2 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:04:31.840163 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.840163 [debug] [MainThread]: On master: BEGIN
[0m13:04:31.840163 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:31.875940 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:04:31.875940 [debug] [MainThread]: On master: COMMIT
[0m13:04:31.876943 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:31.876943 [debug] [MainThread]: On master: COMMIT
[0m13:04:31.876943 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:31.876943 [debug] [MainThread]: On master: Close
[0m13:04:31.878069 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:31.878069 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:04:31.878069 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:04:31.878069 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:04:31.879071 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:04:31.879071 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:04:31.879071 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:04:31.879071 [info ] [MainThread]: 
[0m13:04:31.880522 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m13:04:31.882025 [debug] [MainThread]: Command end result
[0m13:04:31.907904 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:04:31.910225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:04:31.917059 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:04:31.917059 [info ] [MainThread]: 
[0m13:04:31.918059 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:04:31.918059 [info ] [MainThread]: 
[0m13:04:31.918059 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:04:31.919496 [debug] [MainThread]: Command `dbt run` succeeded at 13:04:31.919496 after 2.43 seconds
[0m13:04:31.920498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022044583950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022046D28560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022046D2A240>]}
[0m13:04:31.920498 [debug] [MainThread]: Flushing usage events
[0m13:04:33.613656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:04:39.204049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85F022A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A8670A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85F7A5A0>]}


============================== 13:04:39.208205 | c6fb5559-0180-4b5a-baef-4057f68935a5 ==============================
[0m13:04:39.208205 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:04:39.208205 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:04:39.397433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A86A085F0>]}
[0m13:04:39.450499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A8610FFB0>]}
[0m13:04:39.452002 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:04:39.844745 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:04:40.040914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:04:40.040914 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:04:40.080052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A86BBE8A0>]}
[0m13:04:40.155391 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:04:40.172911 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:04:40.218018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A87EDBD70>]}
[0m13:04:40.218018 [info ] [MainThread]: Found 10 models, 24 data tests, 9 sources, 447 macros
[0m13:04:40.219069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A885A78F0>]}
[0m13:04:40.222232 [info ] [MainThread]: 
[0m13:04:40.222232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:04:40.222737 [info ] [MainThread]: 
[0m13:04:40.223239 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:04:40.228250 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:04:40.373169 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:04:40.374121 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:04:40.374121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:04:40.416213 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m13:04:40.416213 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:04:40.416213 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:04:40.422015 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m13:04:40.424046 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:04:40.424520 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:04:40.430582 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:40.430582 [debug] [MainThread]: On master: BEGIN
[0m13:04:40.430582 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:04:40.466932 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:04:40.466932 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:40.466932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:04:40.473395 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:04:40.476836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6fb5559-0180-4b5a-baef-4057f68935a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A86C68CB0>]}
[0m13:04:40.476836 [debug] [MainThread]: On master: ROLLBACK
[0m13:04:40.477838 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:40.477838 [debug] [MainThread]: On master: BEGIN
[0m13:04:40.477838 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:04:40.478841 [debug] [MainThread]: On master: COMMIT
[0m13:04:40.478841 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:40.478841 [debug] [MainThread]: On master: COMMIT
[0m13:04:40.478841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:40.478841 [debug] [MainThread]: On master: Close
[0m13:04:40.484300 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:04:40.484300 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:04:40.484300 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:04:40.485718 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:04:40.485718 [info ] [Thread-1 (]: 1 of 24 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:04:40.485718 [info ] [Thread-2 (]: 2 of 24 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:04:40.485718 [info ] [Thread-3 (]: 3 of 24 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:04:40.487005 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:04:40.487005 [info ] [Thread-4 (]: 4 of 24 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:04:40.488077 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:04:40.488077 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:04:40.488077 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:04:40.488077 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m13:04:40.489448 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:04:40.489448 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:04:40.503489 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:04:40.503959 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:04:40.507531 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:04:40.512111 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:04:40.514617 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:04:40.516666 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:04:40.532822 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:04:40.534042 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:04:40.534042 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:04:40.537075 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:04:40.537075 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:04:40.539451 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:04:40.541927 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:04:40.541927 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:04:40.542986 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:04:40.542986 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:04:40.543939 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:04:40.543939 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:04:40.544996 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:04:40.544996 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:04:40.545998 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:04:40.545998 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:04:40.545998 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:04:40.547177 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:04:40.547177 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:04:40.589109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:04:40.590112 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:04:40.590112 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.591115 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m13:04:40.592115 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:04:40.592115 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.593118 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:04:40.596258 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:04:40.596258 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:04:40.598264 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:04:40.598264 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:04:40.598264 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:04:40.599268 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m13:04:40.600270 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:04:40.599268 [error] [Thread-1 (]: 1 of 24 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.11s]
[0m13:04:40.600270 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:04:40.600270 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:04:40.601396 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:04:40.601900 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.601900 [info ] [Thread-2 (]: 2 of 24 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.11s]
[0m13:04:40.602901 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.602901 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:04:40.603986 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:04:40.604990 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:04:40.603986 [info ] [Thread-1 (]: 5 of 24 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m13:04:40.604990 [info ] [Thread-2 (]: 6 of 24 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:04:40.606015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m13:04:40.606015 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:04:40.606015 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:04:40.606015 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:04:40.610459 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:04:40.613929 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:04:40.615653 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:04:40.615653 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:04:40.617961 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:04:40.619961 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:04:40.621961 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:04:40.621961 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:04:40.623036 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m13:04:40.623036 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:04:40.623036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:40.624118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:40.666332 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m13:04:40.666332 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:04:40.667348 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.669425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:04:40.669425 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:04:40.669425 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.764848 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.160 seconds
[0m13:04:40.764848 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.162 seconds
[0m13:04:40.766945 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:04:40.767951 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:04:40.767951 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:04:40.768955 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:04:40.768955 [info ] [Thread-4 (]: 4 of 24 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.28s]
[0m13:04:40.769959 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:04:40.769959 [info ] [Thread-3 (]: 3 of 24 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.28s]
[0m13:04:40.770962 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:04:40.770962 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:04:40.771962 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:04:40.771962 [info ] [Thread-4 (]: 7 of 24 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:04:40.771962 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:04:40.771962 [info ] [Thread-3 (]: 8 of 24 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:04:40.773403 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:04:40.773403 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:04:40.777097 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:04:40.778179 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:04:40.782837 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:04:40.785052 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:04:40.787115 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:04:40.788116 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:04:40.790323 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:04:40.791325 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:04:40.792326 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:04:40.792326 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:40.792830 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:04:40.792830 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:04:40.793845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:40.820278 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.153 seconds
[0m13:04:40.821281 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:04:40.822281 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:04:40.822784 [info ] [Thread-2 (]: 6 of 24 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.22s]
[0m13:04:40.823751 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:04:40.823751 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:04:40.824763 [info ] [Thread-2 (]: 9 of 24 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:04:40.824763 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:04:40.825767 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:04:40.828936 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:04:40.831208 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:04:40.833741 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:04:40.834746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.164 seconds
[0m13:04:40.835966 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m13:04:40.835966 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m13:04:40.837416 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:04:40.837416 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m13:04:40.838417 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:04:40.839416 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:04:40.838417 [info ] [Thread-1 (]: 5 of 24 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.23s]
[0m13:04:40.839416 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:40.839416 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.840714 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:04:40.840714 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:40.840714 [info ] [Thread-1 (]: 10 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:04:40.842217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:04:40.842217 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:40.847420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:40.849459 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:40.853880 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:40.855882 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:40.855882 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:04:40.855882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:40.888600 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m13:04:40.888600 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:04:40.890064 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.898328 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.057 seconds
[0m13:04:40.899510 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:04:40.900515 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:04:40.900515 [info ] [Thread-4 (]: 7 of 24 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.13s]
[0m13:04:40.902020 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:04:40.902020 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:04:40.903021 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_products_product_category_name ................ [RUN]
[0m13:04:40.903021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f)
[0m13:04:40.903021 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:04:40.907130 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:04:40.907130 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:04:40.908280 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:04:40.908280 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.909282 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:04:40.911987 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:04:40.914072 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:04:40.914576 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: BEGIN
[0m13:04:40.915579 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:40.940771 [debug] [Thread-3 (]: SQL status: BEGIN in 0.148 seconds
[0m13:04:40.942274 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:04:40.942839 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.958049 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m13:04:40.959049 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:04:40.960186 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category_name
from "ecommerce_raw"."public"."stg_products"
where product_category_name is null



  
  
      
    ) dbt_internal_test
[0m13:04:40.980369 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.091 seconds
[0m13:04:40.981438 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.073 seconds
[0m13:04:40.981940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m13:04:40.983445 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:04:40.983445 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:04:40.984949 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: ROLLBACK
[0m13:04:40.985982 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:04:40.985982 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:04:40.985982 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: Close
[0m13:04:40.986987 [info ] [Thread-2 (]: 9 of 24 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.16s]
[0m13:04:40.986987 [info ] [Thread-1 (]: 10 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.14s]
[0m13:04:40.989318 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:04:40.988052 [error] [Thread-4 (]: 11 of 24 FAIL 610 not_null_stg_products_product_category_name .................. [[31mFAIL 610[0m in 0.09s]
[0m13:04:40.990408 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:04:40.990408 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:04:40.991540 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:04:40.992043 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:04:40.993044 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:04:40.992043 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:04:40.993044 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.050 seconds
[0m13:04:40.993044 [info ] [Thread-1 (]: 13 of 24 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:04:40.994105 [info ] [Thread-4 (]: 14 of 24 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:04:40.994105 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:04:40.995462 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:04:40.996474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:04:40.996474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:04:40.996474 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:04:40.997777 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:04:40.997777 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:04:40.997777 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:04:41.001907 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:04:41.004928 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:04:41.013219 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:04:41.014174 [info ] [Thread-3 (]: 8 of 24 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.24s]
[0m13:04:41.014174 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:04:41.015478 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:04:41.015478 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:04:41.018880 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:04:41.015478 [info ] [Thread-3 (]: 15 of 24 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:04:41.018880 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:04:41.020130 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:04:41.020130 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:04:41.023013 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:04:41.023013 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:04:41.023013 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:04:41.025369 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:04:41.030731 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:04:41.030731 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:04:41.030731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:41.032236 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:04:41.033749 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:04:41.033749 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:04:41.034297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:41.034750 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:04:41.034750 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:04:41.036909 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:04:41.037933 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:41.039146 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:04:41.040167 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:04:41.040167 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:41.083026 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m13:04:41.083529 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:04:41.084128 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.084128 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m13:04:41.084128 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:04:41.085129 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.086633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:04:41.089083 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:04:41.089083 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:04:41.090086 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:04:41.090086 [info ] [Thread-1 (]: 13 of 24 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.09s]
[0m13:04:41.091117 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:04:41.091117 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:04:41.092117 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.092619 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:04:41.093123 [info ] [Thread-1 (]: 16 of 24 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:04:41.093123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:04:41.094501 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:04:41.102007 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:04:41.104117 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:04:41.109517 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:04:41.110517 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:04:41.112021 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:04:41.113024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:41.169928 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m13:04:41.170928 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:04:41.170928 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.186991 [debug] [Thread-2 (]: SQL status: BEGIN in 0.155 seconds
[0m13:04:41.186991 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:04:41.187991 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.195012 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m13:04:41.198013 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:04:41.199014 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:04:41.200014 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.21s]
[0m13:04:41.202518 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:04:41.203021 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:04:41.204034 [info ] [Thread-2 (]: 17 of 24 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:04:41.205037 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:04:41.205037 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.120 seconds
[0m13:04:41.206036 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.113 seconds
[0m13:04:41.206036 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:04:41.208390 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:04:41.209394 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:04:41.215436 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:04:41.216846 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:04:41.216846 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:04:41.217925 [info ] [Thread-3 (]: 15 of 24 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.20s]
[0m13:04:41.217925 [info ] [Thread-4 (]: 14 of 24 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.22s]
[0m13:04:41.219151 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:04:41.220436 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:04:41.220436 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:04:41.220436 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:04:41.221940 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:04:41.226147 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:04:41.226147 [info ] [Thread-3 (]: 18 of 24 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:04:41.226147 [info ] [Thread-4 (]: 19 of 24 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:04:41.227597 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:04:41.227597 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:04:41.228601 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:04:41.228601 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:04:41.236715 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:04:41.235715 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:04:41.242888 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:04:41.243954 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:04:41.243954 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:41.246013 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:04:41.314696 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:04:41.315697 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.144 seconds
[0m13:04:41.315697 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m13:04:41.315697 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:04:41.317865 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:04:41.317865 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:04:41.319897 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:04:41.319897 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:04:41.321161 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:04:41.321161 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:04:41.322161 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:04:41.323195 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:41.323195 [info ] [Thread-1 (]: 16 of 24 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.23s]
[0m13:04:41.324209 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:04:41.324209 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:04:41.325621 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:04:41.325621 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:04:41.326632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:41.325621 [info ] [Thread-1 (]: 20 of 24 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:04:41.326632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:04:41.327959 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:04:41.332462 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:04:41.334507 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:04:41.339521 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:04:41.342026 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:04:41.343537 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:04:41.343537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:04:41.371211 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:04:41.371211 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:04:41.372213 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.374326 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:04:41.376326 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:04:41.377326 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:04:41.377326 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:04:41.378327 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:04:41.378327 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.378327 [info ] [Thread-3 (]: 18 of 24 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.15s]
[0m13:04:41.379327 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:04:41.380327 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:04:41.380327 [info ] [Thread-3 (]: 21 of 24 START test unique_stg_items_ordered_item_id ........................... [RUN]
[0m13:04:41.381327 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:04:41.381327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83)
[0m13:04:41.382830 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:04:41.383804 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:04:41.387356 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:04:41.387356 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:04:41.388377 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m13:04:41.388377 [info ] [Thread-4 (]: 19 of 24 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.16s]
[0m13:04:41.389492 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:04:41.389492 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:04:41.390492 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.390492 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:04:41.391996 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:04:41.395053 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:04:41.396472 [info ] [Thread-4 (]: 22 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:04:41.396472 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:04:41.397495 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:04:41.400541 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:41.402044 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:04:41.402044 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: BEGIN
[0m13:04:41.403051 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:41.403560 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:04:41.406561 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:41.409287 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:41.409287 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:04:41.410287 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:04:41.438349 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.116 seconds
[0m13:04:41.439351 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:04:41.440351 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:04:41.440351 [info ] [Thread-2 (]: 17 of 24 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.24s]
[0m13:04:41.442104 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:04:41.442104 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:04:41.443107 [info ] [Thread-2 (]: 23 of 24 START test unique_stg_products_product_id ............................. [RUN]
[0m13:04:41.443107 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:04:41.444180 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:04:41.448444 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:04:41.449444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m13:04:41.449444 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:04:41.450444 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.450444 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:04:41.453454 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:04:41.454465 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:04:41.455867 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:04:41.456907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m13:04:41.456907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:04:41.457893 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:04:41.457893 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.505547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:04:41.505547 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:04:41.506547 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.513883 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.063 seconds
[0m13:04:41.514884 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: ROLLBACK
[0m13:04:41.515884 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: Close
[0m13:04:41.516885 [error] [Thread-3 (]: 21 of 24 FAIL 21 unique_stg_items_ordered_item_id .............................. [[31mFAIL 21[0m in 0.14s]
[0m13:04:41.517885 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:04:41.517885 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:04:41.517885 [info ] [Thread-3 (]: 24 of 24 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:04:41.518885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:04:41.518885 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:04:41.522901 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:04:41.524912 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:04:41.529038 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:04:41.529038 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.023 seconds
[0m13:04:41.530522 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:04:41.530522 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:04:41.532027 [info ] [Thread-2 (]: 23 of 24 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:04:41.533535 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:04:41.534247 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:04:41.534247 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:04:41.534247 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:04:41.558313 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.100 seconds
[0m13:04:41.559314 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:04:41.560699 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:04:41.560699 [info ] [Thread-4 (]: 22 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.16s]
[0m13:04:41.560699 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:04:41.576548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m13:04:41.576548 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.184 seconds
[0m13:04:41.577566 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:04:41.578936 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:04:41.578936 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:04:41.578936 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:04:41.580022 [error] [Thread-1 (]: 20 of 24 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.25s]
[0m13:04:41.581027 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:04:41.583493 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:04:41.584503 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:04:41.584503 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:04:41.585503 [info ] [Thread-3 (]: 24 of 24 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.07s]
[0m13:04:41.586007 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:04:41.587203 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:41.587203 [debug] [MainThread]: On master: BEGIN
[0m13:04:41.588209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:04:41.726705 [debug] [MainThread]: SQL status: BEGIN in 0.139 seconds
[0m13:04:41.727955 [debug] [MainThread]: On master: COMMIT
[0m13:04:41.727955 [debug] [MainThread]: Using postgres connection "master"
[0m13:04:41.728958 [debug] [MainThread]: On master: COMMIT
[0m13:04:41.728958 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:04:41.728958 [debug] [MainThread]: On master: Close
[0m13:04:41.729960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:04:41.729960 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:04:41.729960 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:04:41.729960 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:04:41.730960 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:04:41.730960 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:04:41.730960 [info ] [MainThread]: 
[0m13:04:41.731961 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 1.51 seconds (1.51s).
[0m13:04:41.735394 [debug] [MainThread]: Command end result
[0m13:04:41.758753 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:04:41.761265 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:04:41.767819 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:04:41.769233 [info ] [MainThread]: 
[0m13:04:41.769233 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:04:41.769233 [info ] [MainThread]: 
[0m13:04:41.770240 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:04:41.770240 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:04:41.771242 [info ] [MainThread]: 
[0m13:04:41.771242 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:04:41.771242 [info ] [MainThread]: 
[0m13:04:41.772243 [error] [MainThread]: [31mFailure in test not_null_stg_products_product_category_name (models\staging\_staging_test.yml)[0m
[0m13:04:41.772243 [error] [MainThread]:   Got 610 results, configured to fail if != 0
[0m13:04:41.772243 [info ] [MainThread]: 
[0m13:04:41.773340 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_category_name.sql
[0m13:04:41.773340 [info ] [MainThread]: 
[0m13:04:41.773340 [error] [MainThread]: [31mFailure in test unique_stg_items_ordered_item_id (models\staging\_staging_test.yml)[0m
[0m13:04:41.774362 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m13:04:41.774362 [info ] [MainThread]: 
[0m13:04:41.775368 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_items_ordered_item_id.sql
[0m13:04:41.775368 [info ] [MainThread]: 
[0m13:04:41.775368 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:04:41.776378 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:04:41.776378 [info ] [MainThread]: 
[0m13:04:41.777396 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:04:41.777396 [info ] [MainThread]: 
[0m13:04:41.777396 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=4 SKIP=0 TOTAL=24
[0m13:04:41.778429 [debug] [MainThread]: Command `dbt test` failed at 13:04:41.778429 after 2.68 seconds
[0m13:04:41.779430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A8686DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A85F022A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024A841BBE60>]}
[0m13:04:41.779430 [debug] [MainThread]: Flushing usage events
[0m13:04:43.173190 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:10:58.356920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86F0C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86EE2930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86EE3EF0>]}


============================== 13:10:58.360517 | e4d3337d-cfb5-4bfc-b9ba-7247bfa19316 ==============================
[0m13:10:58.360517 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:10:58.362020 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m13:10:58.544164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86BBBBF0>]}
[0m13:10:58.597335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86F489B0>]}
[0m13:10:58.598338 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:10:58.996805 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:10:59.190603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:10:59.190603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:10:59.196614 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:10:59.232105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C884E39B0>]}
[0m13:10:59.304707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:10:59.322619 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:10:59.351915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C888BB500>]}
[0m13:10:59.351915 [info ] [MainThread]: Found 10 models, 24 data tests, 9 sources, 447 macros
[0m13:10:59.351915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88857890>]}
[0m13:10:59.355370 [info ] [MainThread]: 
[0m13:10:59.355370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:10:59.356804 [info ] [MainThread]: 
[0m13:10:59.356804 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:10:59.360325 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:10:59.510601 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:10:59.510601 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:10:59.510601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:59.556015 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m13:10:59.557351 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:10:59.559354 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:10:59.563885 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:10:59.563885 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:10:59.563885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:10:59.700757 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m13:10:59.700757 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:10:59.700757 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:10:59.709271 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.008 seconds
[0m13:10:59.711289 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:10:59.711289 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:10:59.717822 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:59.717822 [debug] [MainThread]: On master: BEGIN
[0m13:10:59.717822 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:10:59.755468 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m13:10:59.755468 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:59.755468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:10:59.763037 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:10:59.765054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88D34500>]}
[0m13:10:59.765054 [debug] [MainThread]: On master: ROLLBACK
[0m13:10:59.766056 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:59.766056 [debug] [MainThread]: On master: BEGIN
[0m13:10:59.766056 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:10:59.767058 [debug] [MainThread]: On master: COMMIT
[0m13:10:59.767058 [debug] [MainThread]: Using postgres connection "master"
[0m13:10:59.767058 [debug] [MainThread]: On master: COMMIT
[0m13:10:59.767058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:10:59.768060 [debug] [MainThread]: On master: Close
[0m13:10:59.771254 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:10:59.772253 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:10:59.772253 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_geolocation
[0m13:10:59.772253 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:10:59.772253 [info ] [Thread-1 (]: 1 of 10 START sql table model public.my_first_dbt_model ........................ [RUN]
[0m13:10:59.773662 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m13:10:59.773662 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_geolocation ............................ [RUN]
[0m13:10:59.774618 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:10:59.774618 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_items_ordered .......................... [RUN]
[0m13:10:59.775754 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:10:59.775754 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_geolocation'
[0m13:10:59.775754 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:10:59.776760 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:10:59.776760 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:10:59.776760 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_geolocation
[0m13:10:59.782788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:10:59.782788 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:10:59.785977 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:10:59.787996 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_geolocation"
[0m13:10:59.790002 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:10:59.791006 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:10:59.816336 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:10:59.825105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:10:59.831155 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:10:59.840555 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:10:59.840555 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_geolocation
[0m13:10:59.843567 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:10:59.846573 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_geolocation"
[0m13:10:59.847573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.848582 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:10:59.848582 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:10:59.848582 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:10:59.848582 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.849809 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:10:59.849809 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.850818 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: BEGIN
[0m13:10:59.850818 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:10:59.850818 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:10:59.850818 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:10:59.850818 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:10:59.892148 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m13:10:59.893151 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.893151 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:10:59.897444 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m13:10:59.906740 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.906740 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:10:59.906740 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m13:10:59.907744 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m13:10:59.907744 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:59.907744 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.908755 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.910928 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.910928 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:10:59.911928 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */

  create view "ecommerce_raw"."public"."stg_geolocation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_geolocation_dataset"
),

renamed as (
    select
        geolocation_zip_code_prefix as zip_code,
        geolocation_lat as latitude,
        geolocation_lng as longitude,
        geolocation_city as city,
        geolocation_state as state
    from source
)

select * from renamed
  );
[0m13:10:59.912431 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:10:59.912934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:10:59.924274 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:10:59.927330 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:10:59.927330 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:10:59.930351 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.930351 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.932857 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.932857 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
alter table "ecommerce_raw"."public"."stg_geolocation" rename to "stg_geolocation__dbt_backup"
[0m13:10:59.933868 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:10:59.933868 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:10:59.934872 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:10:59.936919 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.936919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:10:59.936919 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:10:59.937921 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
alter table "ecommerce_raw"."public"."stg_geolocation__dbt_tmp" rename to "stg_geolocation"
[0m13:10:59.942997 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:10:59.946439 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.950450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:10:59.950450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:10:59.950450 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:10:59.950450 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:10:59.952956 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m13:10:59.952956 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.952956 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: COMMIT
[0m13:10:59.954127 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:10:59.955132 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:10:59.955132 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:10:59.956187 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.958260 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_geolocation__dbt_backup"
[0m13:10:59.958260 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:10:59.958260 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:10:59.960779 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_geolocation"
[0m13:10:59.963767 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:10:59.963767 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_geolocation"} */
drop view if exists "ecommerce_raw"."public"."stg_geolocation__dbt_backup" cascade
[0m13:10:59.965111 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:10:59.967157 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:10:59.968166 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:10:59.968166 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:10:59.969523 [debug] [Thread-3 (]: On model.dbt_project.stg_geolocation: Close
[0m13:10:59.969523 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:10:59.970527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8430BBC0>]}
[0m13:10:59.970527 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88E33F20>]}
[0m13:10:59.972031 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:10:59.972031 [info ] [Thread-1 (]: 1 of 10 OK created sql table model public.my_first_dbt_model ................... [[32mSELECT 2[0m in 0.19s]
[0m13:10:59.973033 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_geolocation ....................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:10:59.974148 [debug] [Thread-4 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:10:59.975151 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:10:59.975151 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_geolocation
[0m13:10:59.976157 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_name_translation
[0m13:10:59.976157 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88E318E0>]}
[0m13:10:59.977172 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_order_payment
[0m13:10:59.977172 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_name_translation ....................... [RUN]
[0m13:10:59.978181 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m13:10:59.979342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_name_translation)
[0m13:10:59.978181 [info ] [Thread-3 (]: 6 of 10 START sql view model public.stg_order_payment .......................... [RUN]
[0m13:10:59.979342 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:10:59.980342 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:10:59.980342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_geolocation, now model.dbt_project.stg_order_payment)
[0m13:10:59.980342 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_orders
[0m13:10:59.982853 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:10:59.983767 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:10:59.983767 [info ] [Thread-4 (]: 7 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m13:10:59.987078 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:10:59.988083 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m13:10:59.988083 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_orders
[0m13:10:59.991587 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:10:59.992092 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:10:59.996946 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:10:59.997970 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:11:00.002066 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:11:00.003074 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_orders
[0m13:11:00.008446 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:11:00.009449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.009449 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.010513 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m13:11:00.010513 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:11:00.010513 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:11:00.012024 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:11:00.012024 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.012024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:00.013033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:00.013543 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:11:00.013543 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:11:00.014545 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:00.019124 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:11:00.023224 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:11:00.023224 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:11:00.024099 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.031451 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:11:00.031955 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:11:00.032958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.034928 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:11:00.035929 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:11:00.035929 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:11:00.038190 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.040316 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:11:00.041316 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:11:00.041316 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:11:00.043769 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:11:00.045165 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:11:00.045165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88EEA5D0>]}
[0m13:11:00.046169 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:11:00.046169 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:11:00.047618 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m13:11:00.047618 [info ] [Thread-2 (]: 8 of 10 START sql view model public.stg_products ............................... [RUN]
[0m13:11:00.048618 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_products)
[0m13:11:00.049618 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m13:11:00.053126 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:11:00.054256 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m13:11:00.058729 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:11:00.060230 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.060230 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m13:11:00.061231 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:11:00.062233 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:00.062233 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.063298 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select order_id from renamed where payment_type = 'credit_card'
  );
[0m13:11:00.065450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m13:11:00.065450 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.065450 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:11:00.068739 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:11:00.072783 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.072783 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:11:00.073882 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:11:00.077039 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.077039 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:11:00.078043 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.078043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:00.081059 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.083345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.084370 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:11:00.084370 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:11:00.085420 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.085420 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.087460 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:11:00.088463 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:11:00.088463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.088463 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.089481 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:11:00.089481 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:11:00.090624 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.093129 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:11:00.093129 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:11:00.093997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:11:00.096068 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:11:00.096068 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:11:00.097182 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:11:00.097182 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:11:00.099184 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:11:00.099184 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:11:00.100283 [debug] [Thread-1 (]: On model.dbt_project.stg_name_translation: Close
[0m13:11:00.101950 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: Close
[0m13:11:00.101950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8932F110>]}
[0m13:11:00.102956 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88E47440>]}
[0m13:11:00.102956 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m13:11:00.102956 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.12s]
[0m13:11:00.104103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.104103 [info ] [Thread-3 (]: 6 of 10 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:11:00.105110 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:11:00.106130 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:11:00.106130 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:11:00.106130 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m13:11:00.107138 [debug] [Thread-3 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:11:00.108141 [info ] [Thread-1 (]: 9 of 10 START sql view model public.stg_sellers ................................ [RUN]
[0m13:11:00.108141 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m13:11:00.108141 [info ] [Thread-3 (]: 10 of 10 START sql view model public.my_second_dbt_model ....................... [RUN]
[0m13:11:00.109145 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:11:00.109145 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.my_second_dbt_model)
[0m13:11:00.112185 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:11:00.112689 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:11:00.113192 [debug] [Thread-3 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:11:00.117534 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.175222 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:11:00.175222 [debug] [Thread-4 (]: SQL status: BEGIN in 0.161 seconds
[0m13:11:00.175222 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:11:00.176225 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m13:11:00.176225 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.179271 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:11:00.180271 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:11:00.180271 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:11:00.181279 [debug] [Thread-3 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:11:00.183820 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.186841 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:11:00.186841 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.187939 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:11:00.187939 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:11:00.188980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:00.188980 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:00.190279 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:11:00.191347 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:11:00.191347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.191347 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:11:00.192348 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:11:00.192850 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:11:00.195494 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.196499 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:00.196499 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:11:00.197502 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.197502 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.200705 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:11:00.203213 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.204476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:11:00.204476 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:11:00.204476 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:11:00.205484 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:11:00.207515 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:11:00.207515 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:11:00.208642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.209642 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m13:11:00.210642 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:11:00.210642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88EF22D0>]}
[0m13:11:00.212147 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.210642 [info ] [Thread-2 (]: 8 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:11:00.214655 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:11:00.215663 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m13:11:00.215663 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:11:00.216770 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:11:00.217776 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:11:00.219903 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: Close
[0m13:11:00.219903 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88E47590>]}
[0m13:11:00.219903 [info ] [Thread-4 (]: 7 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.23s]
[0m13:11:00.221318 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_orders
[0m13:11:00.230875 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m13:11:00.230875 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.230875 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:11:00.236451 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:11:00.239623 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.239623 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:11:00.239623 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m13:11:00.240626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:00.240626 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:11:00.243132 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.244230 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:11:00.244230 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:11:00.245246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:00.246263 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:11:00.246263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.247267 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:11:00.248272 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.250349 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:11:00.250349 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:11:00.251726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:11:00.255381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:11:00.255381 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:11:00.256397 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:11:00.256397 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:11:00.258404 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:11:00.258404 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:11:00.258404 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:11:00.259907 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m13:11:00.259907 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:11:00.260928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88ED5160>]}
[0m13:11:00.260928 [info ] [Thread-1 (]: 9 of 10 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m13:11:00.261928 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:11:00.261928 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m13:11:00.264018 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:11:00.265067 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:11:00.265067 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:11:00.266145 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:11:00.267239 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:11:00.268251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e4d3337d-cfb5-4bfc-b9ba-7247bfa19316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C88E71BE0>]}
[0m13:11:00.268251 [info ] [Thread-3 (]: 10 of 10 OK created sql view model public.my_second_dbt_model .................. [[32mCREATE VIEW[0m in 0.16s]
[0m13:11:00.269254 [debug] [Thread-3 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:11:00.270254 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:00.270254 [debug] [MainThread]: On master: BEGIN
[0m13:11:00.271449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:00.307051 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:11:00.307051 [debug] [MainThread]: On master: COMMIT
[0m13:11:00.308054 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:00.308054 [debug] [MainThread]: On master: COMMIT
[0m13:11:00.308054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:00.308054 [debug] [MainThread]: On master: Close
[0m13:11:00.309459 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:00.309459 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:11:00.309459 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:11:00.310466 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:11:00.310466 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:11:00.310466 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:11:00.310466 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:11:00.310466 [info ] [MainThread]: 
[0m13:11:00.310466 [info ] [MainThread]: Finished running 1 table model, 9 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m13:11:00.312973 [debug] [MainThread]: Command end result
[0m13:11:00.336675 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:11:00.339961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:11:00.345985 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:11:00.345985 [info ] [MainThread]: 
[0m13:11:00.346997 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:11:00.346997 [info ] [MainThread]: 
[0m13:11:00.348109 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m13:11:00.349114 [debug] [MainThread]: Command `dbt run` succeeded at 13:11:00.349114 after 2.09 seconds
[0m13:11:00.349114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8645EC00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86C8BE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C86BBB320>]}
[0m13:11:00.349114 [debug] [MainThread]: Flushing usage events
[0m13:11:02.005975 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:11:15.290280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E494AA5EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4980093D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E497D07FB0>]}


============================== 13:11:15.293817 | b35462c7-a0d9-4a39-865b-53859065902d ==============================
[0m13:11:15.293817 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:11:15.294819 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt test', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:11:15.477814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4981CDDF0>]}
[0m13:11:15.532243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E497A07080>]}
[0m13:11:15.534119 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:11:15.939058 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:11:16.132850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:11:16.132850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:11:16.137859 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:11:16.173038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E499729DF0>]}
[0m13:11:16.244662 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:11:16.263207 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:11:16.302077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E499E69D30>]}
[0m13:11:16.302077 [info ] [MainThread]: Found 10 models, 24 data tests, 9 sources, 447 macros
[0m13:11:16.303080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E499E054F0>]}
[0m13:11:16.305507 [info ] [MainThread]: 
[0m13:11:16.305507 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:11:16.306805 [info ] [MainThread]: 
[0m13:11:16.306805 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:11:16.312361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:11:16.457254 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:11:16.458310 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:11:16.458310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:11:16.501258 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m13:11:16.501258 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:11:16.501258 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:11:16.508076 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m13:11:16.509091 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:11:16.509091 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:11:16.516030 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:16.516030 [debug] [MainThread]: On master: BEGIN
[0m13:11:16.516030 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:11:16.550489 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:11:16.551993 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:16.551993 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:11:16.557773 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:11:16.561274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b35462c7-a0d9-4a39-865b-53859065902d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E499767D10>]}
[0m13:11:16.561274 [debug] [MainThread]: On master: ROLLBACK
[0m13:11:16.561274 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:16.562274 [debug] [MainThread]: On master: BEGIN
[0m13:11:16.562777 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:11:16.562777 [debug] [MainThread]: On master: COMMIT
[0m13:11:16.562777 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:16.562777 [debug] [MainThread]: On master: COMMIT
[0m13:11:16.563854 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:16.563854 [debug] [MainThread]: On master: Close
[0m13:11:16.567857 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:11:16.567857 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:16.568857 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:11:16.568857 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:11:16.568857 [info ] [Thread-1 (]: 1 of 24 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:11:16.568857 [info ] [Thread-2 (]: 2 of 24 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:11:16.570193 [info ] [Thread-3 (]: 3 of 24 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:11:16.570193 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:11:16.570193 [info ] [Thread-4 (]: 4 of 24 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:11:16.571460 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:11:16.571963 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:11:16.571963 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:11:16.571963 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m13:11:16.572965 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:16.572965 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:11:16.586552 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:11:16.586552 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:11:16.589709 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:16.594719 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:11:16.596970 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:11:16.598429 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:11:16.614338 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:11:16.614338 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:11:16.615341 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:11:16.615341 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:16.617590 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:11:16.619633 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:11:16.619633 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:11:16.622148 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:16.622148 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:11:16.623151 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:11:16.624039 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:11:16.624039 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:11:16.624039 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:11:16.625187 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:11:16.625187 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:16.625187 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:11:16.625187 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:11:16.626691 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:11:16.626691 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:11:16.666536 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:11:16.666536 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:11:16.667606 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.669606 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:11:16.673113 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:11:16.673616 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:11:16.673616 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:11:16.673616 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:11:16.674717 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.674717 [error] [Thread-1 (]: 1 of 24 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.10s]
[0m13:11:16.675909 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:11:16.675909 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:11:16.677035 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m13:11:16.678038 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:11:16.677035 [info ] [Thread-1 (]: 5 of 24 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m13:11:16.678038 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.678038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m13:11:16.679283 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:11:16.682794 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:11:16.682794 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:16.684124 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:11:16.685125 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:11:16.686295 [info ] [Thread-2 (]: 2 of 24 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.11s]
[0m13:11:16.686295 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:11:16.687308 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:11:16.689295 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:11:16.690295 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:11:16.691298 [info ] [Thread-2 (]: 6 of 24 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:11:16.691298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:11:16.692296 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:11:16.695813 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:11:16.696813 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:11:16.696813 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m13:11:16.696813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:16.697814 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:11:16.699815 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:11:16.700815 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:11:16.700815 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:11:16.702319 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:16.729936 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.054 seconds
[0m13:11:16.731936 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:11:16.732439 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:11:16.732942 [info ] [Thread-3 (]: 3 of 24 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.16s]
[0m13:11:16.734498 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:11:16.734498 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:11:16.735636 [info ] [Thread-3 (]: 7 of 24 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:11:16.735636 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:11:16.736637 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:11:16.743051 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:11:16.744141 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:11:16.744141 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:11:16.745257 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.745257 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:11:16.748699 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:11:16.748699 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:11:16.749736 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:11:16.749736 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.750982 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:11:16.750982 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:11:16.751996 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:16.789822 [debug] [Thread-4 (]: SQL status: BEGIN in 0.163 seconds
[0m13:11:16.789822 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:11:16.789822 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.802929 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m13:11:16.802929 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:11:16.803978 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.814949 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.064 seconds
[0m13:11:16.816950 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:11:16.817950 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:11:16.817950 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.028 seconds
[0m13:11:16.821342 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:11:16.822846 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.076 seconds
[0m13:11:16.822342 [info ] [Thread-2 (]: 6 of 24 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.13s]
[0m13:11:16.824864 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m13:11:16.824864 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:11:16.825865 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:11:16.826864 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:11:16.828191 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m13:11:16.826864 [info ] [Thread-4 (]: 4 of 24 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.25s]
[0m13:11:16.828191 [info ] [Thread-2 (]: 8 of 24 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:11:16.829221 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:11:16.830422 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:11:16.830422 [info ] [Thread-1 (]: 5 of 24 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.15s]
[0m13:11:16.830422 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:11:16.831925 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:11:16.831925 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:11:16.837552 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:11:16.832927 [info ] [Thread-4 (]: 9 of 24 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:11:16.838557 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:11:16.838557 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:11:16.839952 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:11:16.838557 [info ] [Thread-1 (]: 10 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:11:16.844109 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:11:16.845175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:11:16.845175 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:11:16.845175 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:11:16.848179 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:11:16.852354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:11:16.852868 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:11:16.854902 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:11:16.855911 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.052 seconds
[0m13:11:16.857981 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:11:16.858980 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:11:16.858980 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:11:16.860212 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:11:16.860212 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:11:16.862729 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:11:16.863241 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:11:16.864282 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:16.864282 [info ] [Thread-3 (]: 7 of 24 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.13s]
[0m13:11:16.864282 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:11:16.865287 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:11:16.866459 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:16.866459 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:11:16.867470 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:11:16.868464 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:11:16.867470 [info ] [Thread-3 (]: 11 of 24 START test not_null_stg_products_product_category_name ................ [RUN]
[0m13:11:16.868464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:16.869464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f)
[0m13:11:16.870464 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:11:16.874112 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:11:16.875622 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:11:16.879622 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:11:16.880623 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:11:16.882127 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: BEGIN
[0m13:11:16.882127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:16.912932 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:11:16.912932 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:11:16.912932 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.916108 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m13:11:16.916108 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:11:16.916108 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.919614 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:11:16.920614 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:11:16.920614 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:16.965127 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.048 seconds
[0m13:11:16.966159 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m13:11:16.967332 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:11:16.969348 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:11:16.969348 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:11:16.969348 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:11:16.970592 [info ] [Thread-1 (]: 10 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m13:11:16.970592 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:11:16.970592 [info ] [Thread-4 (]: 9 of 24 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.13s]
[0m13:11:16.972095 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:11:16.972095 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:11:16.973097 [info ] [Thread-1 (]: 12 of 24 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:11:16.973097 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:11:16.974137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:11:16.974137 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:11:16.974137 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:11:16.977726 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:11:16.978742 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:11:16.978742 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:11:16.982510 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:11:16.983013 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:11:16.986059 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:11:16.987062 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:11:16.988510 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:11:16.988510 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:11:16.989849 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:11:16.989849 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:16.990853 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:11:16.990853 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:11:16.990853 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:17.028319 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m13:11:17.028319 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:11:17.028319 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category_name
from "ecommerce_raw"."public"."stg_products"
where product_category_name is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.032256 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:11:17.033257 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:11:17.033760 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.035805 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m13:11:17.036836 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:11:17.036836 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.039485 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:11:17.040785 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:11:17.040785 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:11:17.042289 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.06s]
[0m13:11:17.042800 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:11:17.043809 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:11:17.043809 [info ] [Thread-4 (]: 14 of 24 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:11:17.044811 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:11:17.044811 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:11:17.052973 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:11:17.053931 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:11:17.057364 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:11:17.058364 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:11:17.058364 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:11:17.059672 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:17.062171 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.033 seconds
[0m13:11:17.062171 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:11:17.064405 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: ROLLBACK
[0m13:11:17.065410 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:11:17.066415 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:11:17.066415 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: Close
[0m13:11:17.067443 [info ] [Thread-1 (]: 12 of 24 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m13:11:17.068445 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:11:17.067443 [error] [Thread-3 (]: 11 of 24 FAIL 610 not_null_stg_products_product_category_name .................. [[31mFAIL 610[0m in 0.20s]
[0m13:11:17.069472 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:11:17.070473 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:11:17.070473 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:11:17.070473 [info ] [Thread-1 (]: 15 of 24 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:11:17.072980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:11:17.071977 [info ] [Thread-3 (]: 16 of 24 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:11:17.072980 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:11:17.074108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:11:17.080602 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:11:17.080602 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.167 seconds
[0m13:11:17.080602 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:11:17.083107 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:11:17.088324 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:11:17.088324 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:11:17.088324 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:11:17.092322 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:11:17.092834 [info ] [Thread-2 (]: 8 of 24 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.26s]
[0m13:11:17.094654 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:11:17.094654 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:11:17.094654 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:11:17.097706 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:11:17.097706 [info ] [Thread-2 (]: 17 of 24 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:11:17.098923 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:11:17.098923 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:11:17.100065 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:11:17.101069 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:11:17.101069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:17.101069 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:11:17.106541 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:11:17.107664 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:11:17.107664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:11:17.108873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:17.108873 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:11:17.108873 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.109881 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:11:17.111942 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:11:17.114311 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:11:17.114819 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:11:17.115975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:17.155169 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m13:11:17.155169 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:11:17.155169 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.158683 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:11:17.158683 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:11:17.159690 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.230830 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.120 seconds
[0m13:11:17.232847 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:11:17.233860 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:11:17.234861 [info ] [Thread-4 (]: 14 of 24 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.19s]
[0m13:11:17.235862 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:11:17.235862 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:11:17.236862 [info ] [Thread-4 (]: 18 of 24 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:11:17.236862 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:11:17.237863 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:11:17.243795 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:17.245128 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.085 seconds
[0m13:11:17.246486 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:11:17.247618 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:11:17.248619 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:11:17.248619 [info ] [Thread-3 (]: 16 of 24 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.17s]
[0m13:11:17.254444 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:17.254444 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:11:17.255446 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:17.256447 [info ] [Thread-3 (]: 19 of 24 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:11:17.257446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:11:17.257446 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:17.258539 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:17.258539 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:11:17.258539 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.103 seconds
[0m13:11:17.320870 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:17.320870 [debug] [Thread-2 (]: SQL status: BEGIN in 0.206 seconds
[0m13:11:17.322375 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:17.322883 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:11:17.323813 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:11:17.325124 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:11:17.325124 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:11:17.326550 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:17.325124 [info ] [Thread-1 (]: 15 of 24 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.25s]
[0m13:11:17.329380 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:17.330381 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:11:17.330381 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:11:17.331381 [info ] [Thread-1 (]: 20 of 24 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:11:17.332382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:11:17.332382 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:17.332886 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:11:17.334026 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:11:17.338827 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:11:17.340185 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:17.342039 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:11:17.345546 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:11:17.347919 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:11:17.347919 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:11:17.348952 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:11:17.372855 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:11:17.373828 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:11:17.373828 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.375168 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:11:17.377170 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:11:17.378170 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:11:17.378170 [info ] [Thread-4 (]: 18 of 24 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.14s]
[0m13:11:17.379526 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:11:17.380525 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:11:17.380525 [info ] [Thread-4 (]: 21 of 24 START test unique_stg_items_ordered_item_id ........................... [RUN]
[0m13:11:17.380525 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83)
[0m13:11:17.382028 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:11:17.386157 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:11:17.387179 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m13:11:17.387179 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:11:17.388179 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.388179 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:11:17.392686 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:11:17.392686 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:11:17.394159 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:11:17.394159 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:11:17.396570 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:11:17.395523 [info ] [Thread-3 (]: 19 of 24 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.14s]
[0m13:11:17.397637 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m13:11:17.397637 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: BEGIN
[0m13:11:17.398721 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:11:17.398721 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:11:17.398721 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:17.400136 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:11:17.400136 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.400136 [info ] [Thread-3 (]: 22 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:11:17.401440 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:11:17.401942 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:11:17.407404 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:11:17.408404 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:11:17.413039 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:11:17.414572 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:11:17.415595 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:11:17.415595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:11:17.437060 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.112 seconds
[0m13:11:17.439063 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:11:17.439063 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:11:17.439063 [info ] [Thread-2 (]: 17 of 24 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.34s]
[0m13:11:17.440446 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:11:17.440446 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:11:17.441950 [info ] [Thread-2 (]: 23 of 24 START test unique_stg_products_product_id ............................. [RUN]
[0m13:11:17.441950 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:11:17.442953 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:11:17.447460 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:11:17.448466 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:11:17.448466 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:11:17.449481 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.449481 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:11:17.452246 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:11:17.454431 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:11:17.454431 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:11:17.455549 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:11:17.461940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m13:11:17.463091 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:11:17.464189 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.510278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m13:11:17.511278 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:11:17.511278 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.513793 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.063 seconds
[0m13:11:17.516003 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: ROLLBACK
[0m13:11:17.516003 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: Close
[0m13:11:17.517054 [error] [Thread-4 (]: 21 of 24 FAIL 21 unique_stg_items_ordered_item_id .............................. [[31mFAIL 21[0m in 0.14s]
[0m13:11:17.518470 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:11:17.518470 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:11:17.519472 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:11:17.520473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:11:17.520473 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:11:17.524484 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:11:17.526484 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:11:17.534026 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:11:17.536028 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:11:17.537028 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:11:17.538028 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:11:17.538028 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:11:17.539465 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:11:17.540529 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:11:17.540529 [info ] [Thread-2 (]: 23 of 24 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.10s]
[0m13:11:17.542036 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:11:17.567262 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.103 seconds
[0m13:11:17.569262 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:11:17.569262 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:11:17.569262 [info ] [Thread-3 (]: 22 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m13:11:17.570426 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:11:17.588310 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.188 seconds
[0m13:11:17.590518 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:11:17.590518 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:11:17.590518 [error] [Thread-1 (]: 20 of 24 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.26s]
[0m13:11:17.592022 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:11:17.676328 [debug] [Thread-4 (]: SQL status: BEGIN in 0.139 seconds
[0m13:11:17.677643 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:11:17.677643 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:11:17.680670 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:11:17.682174 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:11:17.682174 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:11:17.683176 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.16s]
[0m13:11:17.684319 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:11:17.685320 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:17.685320 [debug] [MainThread]: On master: BEGIN
[0m13:11:17.685320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:11:17.719668 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:11:17.720983 [debug] [MainThread]: On master: COMMIT
[0m13:11:17.720983 [debug] [MainThread]: Using postgres connection "master"
[0m13:11:17.721983 [debug] [MainThread]: On master: COMMIT
[0m13:11:17.721983 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:11:17.721983 [debug] [MainThread]: On master: Close
[0m13:11:17.721983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:11:17.723225 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:11:17.723225 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:11:17.723225 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:11:17.723225 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:11:17.724244 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:11:17.724244 [info ] [MainThread]: 
[0m13:11:17.724244 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m13:11:17.727748 [debug] [MainThread]: Command end result
[0m13:11:17.750515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:11:17.754524 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:11:17.760630 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:11:17.762133 [info ] [MainThread]: 
[0m13:11:17.762133 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:11:17.763136 [info ] [MainThread]: 
[0m13:11:17.763136 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:11:17.763136 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:11:17.764258 [info ] [MainThread]: 
[0m13:11:17.764258 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:11:17.765258 [info ] [MainThread]: 
[0m13:11:17.765258 [error] [MainThread]: [31mFailure in test not_null_stg_products_product_category_name (models\staging\_staging_test.yml)[0m
[0m13:11:17.765258 [error] [MainThread]:   Got 610 results, configured to fail if != 0
[0m13:11:17.766271 [info ] [MainThread]: 
[0m13:11:17.766271 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_category_name.sql
[0m13:11:17.766271 [info ] [MainThread]: 
[0m13:11:17.767275 [error] [MainThread]: [31mFailure in test unique_stg_items_ordered_item_id (models\staging\_staging_test.yml)[0m
[0m13:11:17.767275 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m13:11:17.767275 [info ] [MainThread]: 
[0m13:11:17.768434 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_items_ordered_item_id.sql
[0m13:11:17.768434 [info ] [MainThread]: 
[0m13:11:17.768434 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:11:17.769441 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:11:17.769441 [info ] [MainThread]: 
[0m13:11:17.769441 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:11:17.770447 [info ] [MainThread]: 
[0m13:11:17.770447 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=4 SKIP=0 TOTAL=24
[0m13:11:17.770447 [debug] [MainThread]: Command `dbt test` failed at 13:11:17.770447 after 2.58 seconds
[0m13:11:17.771950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4982D9520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E49A2F15B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E497875220>]}
[0m13:11:17.771950 [debug] [MainThread]: Flushing usage events
[0m13:11:19.154263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:52.668386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA4625EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA79A2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA4F60290>]}


============================== 13:16:52.672399 | 8fffd7cb-4520-4ce7-b789-426125e26cdc ==============================
[0m13:16:52.672399 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:16:52.672901 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:16:52.860964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA91E4080>]}
[0m13:16:52.913186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA5C5E840>]}
[0m13:16:52.915206 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:16:53.317664 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:16:53.510871 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m13:16:53.511871 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\staging\stg_geolocation.sql
[0m13:16:53.587844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9267BC0>]}
[0m13:16:53.664109 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:16:53.686670 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:16:53.717683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9286690>]}
[0m13:16:53.717683 [info ] [MainThread]: Found 9 models, 24 data tests, 9 sources, 447 macros
[0m13:16:53.718682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9303C80>]}
[0m13:16:53.720896 [info ] [MainThread]: 
[0m13:16:53.721888 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:16:53.721888 [info ] [MainThread]: 
[0m13:16:53.723041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:16:53.726155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:16:53.875141 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:16:53.875141 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:16:53.876145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:53.925619 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m13:16:53.926626 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:16:53.928632 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:16:53.934190 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:16:53.934190 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:16:53.934190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:54.078817 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m13:16:54.078817 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:16:54.079820 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:16:54.085854 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m13:16:54.087007 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:16:54.088009 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:16:54.093999 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.093999 [debug] [MainThread]: On master: BEGIN
[0m13:16:54.095011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:16:54.236414 [debug] [MainThread]: SQL status: BEGIN in 0.142 seconds
[0m13:16:54.237431 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.237431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:16:54.244864 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m13:16:54.247874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA995FE30>]}
[0m13:16:54.247874 [debug] [MainThread]: On master: ROLLBACK
[0m13:16:54.248893 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.248893 [debug] [MainThread]: On master: BEGIN
[0m13:16:54.248893 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:16:54.249896 [debug] [MainThread]: On master: COMMIT
[0m13:16:54.249896 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.249896 [debug] [MainThread]: On master: COMMIT
[0m13:16:54.249896 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:54.250899 [debug] [MainThread]: On master: Close
[0m13:16:54.253917 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:16:54.254921 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:16:54.254921 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:16:54.254921 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:16:54.255923 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:16:54.255923 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:16:54.256994 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:16:54.258012 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:16:54.256994 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:16:54.258012 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:16:54.258012 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:16:54.259292 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:16:54.259292 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:16:54.259292 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:16:54.260296 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:16:54.265845 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:16:54.265845 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:16:54.268368 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:16:54.271882 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:16:54.274616 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:16:54.275620 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:16:54.288870 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:16:54.304361 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:16:54.309480 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:16:54.320221 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:16:54.325844 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:16:54.328865 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:16:54.331870 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:16:54.333232 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.333232 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:16:54.334257 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:16:54.334923 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.334923 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.334923 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.335934 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:16:54.335934 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:16:54.335934 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:16:54.337021 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:16:54.337021 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:16:54.337021 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:16:54.378102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m13:16:54.379105 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.379105 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:16:54.381142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:16:54.381142 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.381142 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:16:54.384618 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m13:16:54.384618 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.384618 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:16:54.385621 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m13:16:54.393174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.394164 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:16:54.394164 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:16:54.394164 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:16:54.397191 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.398194 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m13:16:54.401252 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.401252 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:16:54.402253 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:54.402756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.402756 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:16:54.404270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.405276 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:16:54.405276 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:16:54.406279 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:16:54.408286 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.408286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:16:54.409290 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:16:54.409290 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:54.411296 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.424969 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:16:54.424969 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m13:16:54.425974 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:16:54.425974 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:16:54.425974 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.426976 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:16:54.429985 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.430984 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:16:54.430984 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.430984 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:54.431985 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:16:54.431985 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:16:54.432991 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:16:54.433801 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:16:54.433801 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.433801 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:54.438829 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:16:54.439833 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m13:16:54.439833 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:16:54.442338 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.445864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:16:54.447988 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:16:54.448990 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:16:54.448990 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:16:54.448990 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:54.451998 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:16:54.453834 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:16:54.454847 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:16:54.454847 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:16:54.454847 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:16:54.455849 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:16:54.456851 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:16:54.456851 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:16:54.458860 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:16:54.459862 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:16:54.459862 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.460865 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:16:54.461865 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:16:54.461865 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:16:54.464097 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:16:54.465098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA512BB00>]}
[0m13:16:54.465098 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9266A80>]}
[0m13:16:54.465098 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:54.465098 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FAA1769C0>]}
[0m13:16:54.466588 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m13:16:54.469123 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:16:54.467092 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:16:54.470126 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:16:54.470126 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:16:54.471133 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:16:54.471133 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:16:54.472132 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m13:16:54.472132 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:16:54.473192 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:16:54.473192 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m13:16:54.474205 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m13:16:54.474205 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:16:54.474745 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:16:54.475754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_order_payment)
[0m13:16:54.474745 [info ] [Thread-3 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:16:54.475754 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:16:54.475754 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:16:54.476776 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:16:54.476776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m13:16:54.477779 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:16:54.477779 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m13:16:54.481057 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:16:54.481057 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m13:16:54.485080 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:16:54.486089 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FAA1D0A70>]}
[0m13:16:54.488095 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:16:54.488095 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:16:54.489102 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:16:54.490128 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:16:54.490128 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m13:16:54.494251 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:16:54.494251 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m13:16:54.495254 [info ] [Thread-4 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:16:54.495254 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m13:16:54.498267 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:16:54.499275 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m13:16:54.502282 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:16:54.502785 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.502785 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:16:54.502785 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:16:54.505908 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:16:54.506987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:54.506987 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.508030 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.509036 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:16:54.509036 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m13:16:54.509036 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:16:54.510406 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m13:16:54.510406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:16:54.513949 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:16:54.515959 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.515959 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:16:54.516994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:16:54.552234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m13:16:54.552738 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.552738 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select order_id from renamed where payment_type = 'credit_card'
  );
[0m13:16:54.557511 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:16:54.557511 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.557511 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:16:54.558514 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:16:54.560519 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.562023 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:16:54.562023 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:16:54.562023 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:54.563026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.565029 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.565029 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:16:54.566031 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:16:54.566031 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m13:16:54.567032 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.567032 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:16:54.567535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:54.567535 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:16:54.570546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.570546 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:16:54.572050 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:16:54.572050 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:16:54.573058 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.575570 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.575570 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:16:54.575570 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:54.576574 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:16:54.576574 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:16:54.579584 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.580587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:16:54.635009 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.635009 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:16:54.637014 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:16:54.638019 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:16:54.638019 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:16:54.639022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:16:54.639022 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:54.641027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.642027 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:16:54.643033 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:16:54.644047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:16:54.644047 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:16:54.644047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.646053 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.647056 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:16:54.647056 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:16:54.647056 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:16:54.648058 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:16:54.649060 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m13:16:54.650062 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m13:16:54.651175 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:16:54.651175 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:16:54.652179 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.652179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FAA19C4A0>]}
[0m13:16:54.654218 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:16:54.656245 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:16:54.656245 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m13:16:54.657267 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.656245 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:16:54.657267 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:16:54.658271 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:16:54.658271 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:16:54.659276 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:16:54.659276 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:54.659276 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:16:54.662283 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:16:54.662283 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m13:16:54.662786 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:16:54.663798 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:16:54.662786 [info ] [Thread-1 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:16:54.665810 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:16:54.667315 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m13:16:54.668330 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:16:54.668330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.my_second_dbt_model)
[0m13:16:54.669340 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:16:54.669340 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9C72CF0>]}
[0m13:16:54.670342 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:16:54.670342 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:16:54.671346 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:16:54.673740 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:16:54.671346 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m13:16:54.675888 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m13:16:54.675888 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:16:54.676890 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m13:16:54.677895 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m13:16:54.678901 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9267800>]}
[0m13:16:54.678901 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:16:54.679905 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9BFD490>]}
[0m13:16:54.679905 [info ] [Thread-3 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m13:16:54.684312 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:16:54.685317 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m13:16:54.684312 [info ] [Thread-4 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m13:16:54.686323 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m13:16:54.687545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:16:54.687545 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:16:54.687545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:16:54.723803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m13:16:54.724805 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:16:54.724805 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:16:54.728819 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:16:54.731973 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:16:54.731973 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:16:54.732476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:16:54.733876 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:16:54.733876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:16:54.733876 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:16:54.734892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:16:54.736898 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:16:54.736898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:16:54.737903 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:16:54.737903 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:16:54.738907 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:16:54.739909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fffd7cb-4520-4ce7-b789-426125e26cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA9C729F0>]}
[0m13:16:54.739909 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:16:54.740912 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:16:54.741911 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.741911 [debug] [MainThread]: On master: BEGIN
[0m13:16:54.742960 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:16:54.777333 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:16:54.777333 [debug] [MainThread]: On master: COMMIT
[0m13:16:54.778336 [debug] [MainThread]: Using postgres connection "master"
[0m13:16:54.778336 [debug] [MainThread]: On master: COMMIT
[0m13:16:54.778336 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:16:54.778336 [debug] [MainThread]: On master: Close
[0m13:16:54.779342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:54.779342 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:16:54.779342 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:16:54.780345 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:16:54.780345 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:16:54.780345 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:16:54.780345 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:16:54.781349 [info ] [MainThread]: 
[0m13:16:54.781349 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 1.06 seconds (1.06s).
[0m13:16:54.782853 [debug] [MainThread]: Command end result
[0m13:16:54.808274 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:16:54.811302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:16:54.817937 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:16:54.817937 [info ] [MainThread]: 
[0m13:16:54.818937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:16:54.818937 [info ] [MainThread]: 
[0m13:16:54.818937 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:16:54.820365 [debug] [MainThread]: Command `dbt run` succeeded at 13:16:54.820365 after 2.25 seconds
[0m13:16:54.820365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA7512CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA79A2960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016FA7B3B710>]}
[0m13:16:54.821868 [debug] [MainThread]: Flushing usage events
[0m13:16:56.563165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:02.680111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E64D22ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E64D23530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E64D23170>]}


============================== 13:17:02.683123 | 98e5e56e-bf4d-4eba-9c08-4903ee40678e ==============================
[0m13:17:02.683123 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:17:02.684133 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:17:02.866596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E634A6F00>]}
[0m13:17:02.919843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E652250A0>]}
[0m13:17:02.920846 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:17:03.319716 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:17:03.522834 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:17:03.522834 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:17:03.560428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E66E50380>]}
[0m13:17:03.631178 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:17:03.649272 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:17:03.687846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E674108F0>]}
[0m13:17:03.687846 [info ] [MainThread]: Found 9 models, 24 data tests, 9 sources, 447 macros
[0m13:17:03.689349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E66E50230>]}
[0m13:17:03.691869 [info ] [MainThread]: 
[0m13:17:03.691869 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:17:03.691869 [info ] [MainThread]: 
[0m13:17:03.692877 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:17:03.697222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:17:03.843100 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:17:03.844277 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:17:03.844277 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:03.888219 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m13:17:03.889219 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:17:03.889722 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:17:03.896356 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m13:17:03.897377 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:17:03.898379 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:17:03.904527 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:03.904527 [debug] [MainThread]: On master: BEGIN
[0m13:17:03.905529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:17:03.942434 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m13:17:03.942936 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:03.942936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:17:03.949964 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:17:03.952471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98e5e56e-bf4d-4eba-9c08-4903ee40678e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E67410C80>]}
[0m13:17:03.952471 [debug] [MainThread]: On master: ROLLBACK
[0m13:17:03.952974 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:03.952974 [debug] [MainThread]: On master: BEGIN
[0m13:17:03.954652 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:17:03.954652 [debug] [MainThread]: On master: COMMIT
[0m13:17:03.954652 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:03.954652 [debug] [MainThread]: On master: COMMIT
[0m13:17:03.955941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:17:03.955941 [debug] [MainThread]: On master: Close
[0m13:17:03.959969 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:17:03.959969 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:17:03.960972 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:17:03.960972 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:17:03.960972 [info ] [Thread-1 (]: 1 of 24 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:17:03.961972 [info ] [Thread-2 (]: 2 of 24 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:17:03.962475 [info ] [Thread-3 (]: 3 of 24 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:17:03.962977 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:17:03.962977 [info ] [Thread-4 (]: 4 of 24 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:17:03.963985 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:17:03.963985 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:17:03.963985 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:17:03.964986 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m13:17:03.964986 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:17:03.964986 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:17:03.980541 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:17:03.980541 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:17:03.984550 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:17:03.987551 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:17:03.991075 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:17:03.992583 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:17:04.010987 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:17:04.010987 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:17:04.011988 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:17:04.011988 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:17:04.014718 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:17:04.016748 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:17:04.018726 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:17:04.019726 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:17:04.019726 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:17:04.020727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:17:04.020727 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:17:04.022230 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:17:04.022230 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:17:04.022230 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:17:04.023232 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:17:04.023735 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:17:04.023735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:17:04.023735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:17:04.024737 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:17:04.068082 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:17:04.068082 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:17:04.069082 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.069082 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m13:17:04.070082 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:17:04.070082 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.070082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:17:04.074676 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:17:04.074676 [debug] [Thread-1 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:17:04.075684 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m13:17:04.075684 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:17:04.076859 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.076859 [error] [Thread-1 (]: 1 of 24 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.11s]
[0m13:17:04.076859 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m13:17:04.077865 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:17:04.077865 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:17:04.078868 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:17:04.078868 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.079875 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:17:04.079875 [info ] [Thread-1 (]: 5 of 24 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m13:17:04.081274 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:17:04.082274 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m13:17:04.082777 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:17:04.082777 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:17:04.086798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:17:04.087802 [info ] [Thread-2 (]: 2 of 24 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.12s]
[0m13:17:04.087802 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:17:04.087802 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:17:04.089306 [info ] [Thread-2 (]: 6 of 24 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:17:04.089306 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:17:04.090326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:17:04.094030 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:17:04.094030 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:17:04.098033 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:17:04.099033 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:17:04.100034 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:17:04.100034 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m13:17:04.102124 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:17:04.103155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:04.104174 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:17:04.105193 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:17:04.105193 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:17:04.128390 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.048 seconds
[0m13:17:04.129390 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.058 seconds
[0m13:17:04.130391 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:17:04.131895 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:17:04.131895 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:17:04.132896 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:17:04.133399 [info ] [Thread-3 (]: 3 of 24 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.17s]
[0m13:17:04.134401 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:17:04.133399 [info ] [Thread-4 (]: 4 of 24 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.17s]
[0m13:17:04.135402 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:17:04.135402 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:17:04.136402 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:17:04.136402 [info ] [Thread-3 (]: 7 of 24 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:17:04.137402 [info ] [Thread-4 (]: 8 of 24 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:17:04.137402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:17:04.138402 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:17:04.138402 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:17:04.139402 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:17:04.143903 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:17:04.148166 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:17:04.150167 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:17:04.152671 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:17:04.153173 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:17:04.157904 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:17:04.158907 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m13:17:04.158907 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m13:17:04.158907 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:17:04.159912 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:17:04.159912 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:17:04.160918 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.160918 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.160918 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:17:04.161918 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:17:04.161918 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:17:04.161918 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.163264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:17:04.212044 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:17:04.212548 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:17:04.212548 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.216178 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m13:17:04.216178 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:17:04.216178 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.230433 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m13:17:04.233447 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m13:17:04.234449 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m13:17:04.235580 [info ] [Thread-1 (]: 5 of 24 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.15s]
[0m13:17:04.236580 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:17:04.236580 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:17:04.237581 [info ] [Thread-1 (]: 9 of 24 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:17:04.239582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:17:04.239582 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:17:04.244043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:17:04.246127 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:17:04.248223 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:17:04.250254 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:17:04.250254 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:17:04.251267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:04.266119 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.053 seconds
[0m13:17:04.268131 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:17:04.268131 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:17:04.269134 [info ] [Thread-3 (]: 7 of 24 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.13s]
[0m13:17:04.269134 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:17:04.270136 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:17:04.270136 [info ] [Thread-3 (]: 10 of 24 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:17:04.271136 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:17:04.271136 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.054 seconds
[0m13:17:04.271136 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:17:04.273140 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:17:04.276908 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:17:04.276908 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:17:04.277949 [info ] [Thread-4 (]: 8 of 24 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.14s]
[0m13:17:04.278955 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:17:04.278955 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:17:04.278955 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:17:04.281968 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:17:04.282471 [info ] [Thread-4 (]: 11 of 24 START test not_null_stg_products_product_category_name ................ [RUN]
[0m13:17:04.282974 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f)
[0m13:17:04.282974 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:17:04.287016 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:17:04.287016 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:17:04.288024 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:17:04.288024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:17:04.289023 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:17:04.290529 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:17:04.293034 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:17:04.293034 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: BEGIN
[0m13:17:04.294168 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.337054 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m13:17:04.337054 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"
[0m13:17:04.338056 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.175 seconds
[0m13:17:04.338056 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_category_name
from "ecommerce_raw"."public"."stg_products"
where product_category_name is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.339058 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:17:04.340235 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:17:04.340235 [info ] [Thread-2 (]: 6 of 24 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.25s]
[0m13:17:04.341239 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:17:04.341239 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:17:04.342240 [info ] [Thread-2 (]: 12 of 24 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:17:04.342746 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:17:04.342746 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:17:04.346283 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:17:04.347298 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:17:04.350305 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:17:04.350305 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m13:17:04.351309 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: ROLLBACK
[0m13:17:04.352309 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f: Close
[0m13:17:04.352812 [error] [Thread-4 (]: 11 of 24 FAIL 610 not_null_stg_products_product_category_name .................. [[31mFAIL 610[0m in 0.07s]
[0m13:17:04.353779 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:17:04.353779 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f
[0m13:17:04.353779 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:17:04.354950 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:17:04.354950 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:17:04.355950 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:17:04.357098 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_category_name.6d5d02313f, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:17:04.357098 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:17:04.360481 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:17:04.361986 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:17:04.364478 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:17:04.366491 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:17:04.366491 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:17:04.367502 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.402149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.151 seconds
[0m13:17:04.402149 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:17:04.403363 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.408408 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m13:17:04.408408 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:17:04.408408 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.411919 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:17:04.412927 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:17:04.412927 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:17:04.414067 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.06s]
[0m13:17:04.415074 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:17:04.415074 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:17:04.415074 [info ] [Thread-4 (]: 14 of 24 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:17:04.416080 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:17:04.416080 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:17:04.425307 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:17:04.427315 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:17:04.429321 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:17:04.430324 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:17:04.431525 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:17:04.432029 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.435612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.147 seconds
[0m13:17:04.435612 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:17:04.436615 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.437633 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m13:17:04.439638 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:17:04.439638 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:17:04.440641 [info ] [Thread-1 (]: 9 of 24 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.20s]
[0m13:17:04.440641 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:17:04.442145 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:17:04.442145 [info ] [Thread-1 (]: 15 of 24 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:17:04.443650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:17:04.444171 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:17:04.449311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:17:04.450314 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m13:17:04.451317 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:17:04.452317 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:17:04.452820 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:17:04.452820 [info ] [Thread-3 (]: 10 of 24 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.18s]
[0m13:17:04.455846 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:17:04.456854 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:17:04.456854 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:17:04.457857 [info ] [Thread-3 (]: 16 of 24 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:17:04.457857 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:17:04.457857 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:17:04.458861 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:17:04.465248 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:17:04.465248 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:17:04.465248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:04.466676 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:17:04.469871 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:17:04.470872 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:17:04.470872 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:17:04.470872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:17:04.512127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:17:04.512630 [debug] [Thread-2 (]: SQL status: BEGIN in 0.157 seconds
[0m13:17:04.512630 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:17:04.513133 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:17:04.513133 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.513133 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.514143 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m13:17:04.515144 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:17:04.515144 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.519682 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:17:04.520685 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:17:04.520685 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:17:04.522188 [info ] [Thread-2 (]: 12 of 24 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.18s]
[0m13:17:04.523189 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:17:04.523693 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:17:04.524705 [info ] [Thread-2 (]: 17 of 24 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:17:04.524705 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:17:04.525706 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:17:04.535719 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:17:04.537212 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:17:04.541212 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:17:04.543221 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:17:04.544246 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:17:04.544977 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:17:04.579750 [debug] [Thread-4 (]: SQL status: BEGIN in 0.148 seconds
[0m13:17:04.580750 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:17:04.580750 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.595368 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.080 seconds
[0m13:17:04.598369 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:17:04.599369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m13:17:04.599369 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:17:04.600793 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:17:04.600793 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:17:04.602299 [info ] [Thread-3 (]: 16 of 24 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.14s]
[0m13:17:04.603833 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:17:04.603833 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:17:04.604835 [info ] [Thread-3 (]: 18 of 24 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:17:04.605835 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:17:04.605835 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:17:04.615878 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:17:04.617878 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:17:04.620879 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:17:04.622900 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:17:04.623913 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:17:04.623913 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.110 seconds
[0m13:17:04.624916 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:17:04.626929 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:17:04.627930 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:17:04.627930 [info ] [Thread-1 (]: 15 of 24 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.18s]
[0m13:17:04.628929 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:17:04.629930 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:17:04.629930 [info ] [Thread-1 (]: 19 of 24 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:17:04.630929 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:17:04.631930 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:17:04.637717 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:17:04.639068 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:17:04.646114 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:17:04.647116 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:17:04.648114 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:17:04.648114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:04.677378 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:17:04.677378 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:17:04.678440 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.679760 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:17:04.681986 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:17:04.682993 [debug] [Thread-3 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:17:04.682993 [info ] [Thread-3 (]: 18 of 24 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:17:04.684015 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:17:04.685038 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:17:04.685038 [info ] [Thread-3 (]: 20 of 24 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:17:04.686043 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:17:04.686043 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:17:04.746726 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:17:04.747728 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.166 seconds
[0m13:17:04.747728 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.146 seconds
[0m13:17:04.747728 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m13:17:04.749733 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:17:04.750735 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:17:04.750735 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:17:04.750735 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:17:04.750735 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:17:04.752238 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:17:04.752238 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.754744 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:17:04.754744 [info ] [Thread-4 (]: 14 of 24 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.34s]
[0m13:17:04.755747 [info ] [Thread-2 (]: 17 of 24 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.23s]
[0m13:17:04.756762 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:17:04.756762 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:17:04.757772 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:17:04.757772 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:17:04.758794 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:17:04.759788 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:17:04.760859 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:17:04.762362 [info ] [Thread-4 (]: 21 of 24 START test unique_stg_items_ordered_item_id ........................... [RUN]
[0m13:17:04.762880 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:17:04.762880 [info ] [Thread-2 (]: 22 of 24 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:17:04.763738 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83)
[0m13:17:04.764241 [debug] [Thread-1 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:17:04.764241 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:17:04.764241 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:17:04.765244 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:17:04.765244 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:17:04.765244 [info ] [Thread-1 (]: 19 of 24 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.13s]
[0m13:17:04.769272 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:17:04.774019 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:17:04.774019 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:17:04.775268 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:17:04.776280 [info ] [Thread-1 (]: 23 of 24 START test unique_stg_products_product_id ............................. [RUN]
[0m13:17:04.776280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:17:04.777291 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:17:04.777291 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:17:04.781310 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:17:04.782310 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:17:04.784173 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:17:04.786181 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:17:04.787184 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:17:04.788202 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:17:04.789705 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:17:04.789705 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:17:04.790786 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: BEGIN
[0m13:17:04.790786 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:17:04.790786 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.790786 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:17:04.792291 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:17:04.792807 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:17:04.792807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:17:04.838688 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m13:17:04.839692 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:17:04.839692 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.842202 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m13:17:04.842202 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:17:04.843204 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.899389 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.059 seconds
[0m13:17:04.900491 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: ROLLBACK
[0m13:17:04.901995 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: Close
[0m13:17:04.901995 [error] [Thread-4 (]: 21 of 24 FAIL 21 unique_stg_items_ordered_item_id .............................. [[31mFAIL 21[0m in 0.14s]
[0m13:17:04.902998 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:17:04.904117 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:17:04.904117 [info ] [Thread-4 (]: 24 of 24 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:17:04.905124 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:17:04.905124 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:17:04.908405 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:17:04.909408 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:17:04.912921 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:17:04.913884 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m13:17:04.913884 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:17:04.914885 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.914885 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:17:04.915981 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:17:04.915981 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:17:04.936846 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.093 seconds
[0m13:17:04.938852 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:17:04.938852 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:17:04.939855 [info ] [Thread-2 (]: 22 of 24 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.18s]
[0m13:17:04.940861 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:17:04.947988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m13:17:04.948991 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:17:04.948991 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:04.969730 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m13:17:04.970732 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:17:04.972235 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:17:04.972235 [info ] [Thread-1 (]: 23 of 24 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.20s]
[0m13:17:04.973241 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:17:05.036337 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.122 seconds
[0m13:17:05.038356 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:17:05.038356 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:17:05.039361 [error] [Thread-3 (]: 20 of 24 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.35s]
[0m13:17:05.040363 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:17:05.065188 [debug] [Thread-4 (]: SQL status: BEGIN in 0.149 seconds
[0m13:17:05.065188 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:17:05.066191 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:17:05.069211 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:17:05.070216 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:17:05.070216 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:17:05.071218 [info ] [Thread-4 (]: 24 of 24 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.17s]
[0m13:17:05.071218 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:17:05.073492 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:05.073492 [debug] [MainThread]: On master: BEGIN
[0m13:17:05.073492 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:17:05.109219 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:17:05.109219 [debug] [MainThread]: On master: COMMIT
[0m13:17:05.110221 [debug] [MainThread]: Using postgres connection "master"
[0m13:17:05.110221 [debug] [MainThread]: On master: COMMIT
[0m13:17:05.110221 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:17:05.111224 [debug] [MainThread]: On master: Close
[0m13:17:05.111224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:05.112224 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:17:05.112224 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:17:05.112224 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:17:05.112224 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:17:05.112224 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:17:05.113393 [info ] [MainThread]: 
[0m13:17:05.113393 [info ] [MainThread]: Finished running 24 data tests in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m13:17:05.117417 [debug] [MainThread]: Command end result
[0m13:17:05.141995 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:17:05.145656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:17:05.152442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:17:05.152945 [info ] [MainThread]: 
[0m13:17:05.152945 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:17:05.153956 [info ] [MainThread]: 
[0m13:17:05.153956 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:17:05.154958 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:17:05.154958 [info ] [MainThread]: 
[0m13:17:05.154958 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:17:05.155958 [info ] [MainThread]: 
[0m13:17:05.155958 [error] [MainThread]: [31mFailure in test not_null_stg_products_product_category_name (models\staging\_staging_test.yml)[0m
[0m13:17:05.156958 [error] [MainThread]:   Got 610 results, configured to fail if != 0
[0m13:17:05.156958 [info ] [MainThread]: 
[0m13:17:05.156958 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\not_null_stg_products_product_category_name.sql
[0m13:17:05.156958 [info ] [MainThread]: 
[0m13:17:05.157958 [error] [MainThread]: [31mFailure in test unique_stg_items_ordered_item_id (models\staging\_staging_test.yml)[0m
[0m13:17:05.157958 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m13:17:05.158958 [info ] [MainThread]: 
[0m13:17:05.158958 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_items_ordered_item_id.sql
[0m13:17:05.158958 [info ] [MainThread]: 
[0m13:17:05.159959 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:17:05.159959 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:17:05.159959 [info ] [MainThread]: 
[0m13:17:05.159959 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:17:05.161141 [info ] [MainThread]: 
[0m13:17:05.161141 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=4 SKIP=0 TOTAL=24
[0m13:17:05.163148 [debug] [MainThread]: Command `dbt test` failed at 13:17:05.162645 after 2.58 seconds
[0m13:17:05.163148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E656EEED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6295BFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E62C237D0>]}
[0m13:17:05.163148 [debug] [MainThread]: Flushing usage events
[0m13:17:06.544839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:25.624288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA86C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA1D3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA1D3AD0>]}


============================== 13:25:25.629641 | 373a0563-2797-4e41-b054-d01f7766e5e0 ==============================
[0m13:25:25.629641 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:25:25.629641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:25:25.863179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA984CB0>]}
[0m13:25:25.916894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EAD83440>]}
[0m13:25:25.919010 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:25:26.323660 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:25:26.521101 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:26.522101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:26.559283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC1278F0>]}
[0m13:25:26.632285 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:25:26.655406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:25:26.701044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC812360>]}
[0m13:25:26.702039 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:25:26.703047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC0A4D70>]}
[0m13:25:26.705094 [info ] [MainThread]: 
[0m13:25:26.706097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:26.706097 [info ] [MainThread]: 
[0m13:25:26.707110 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:26.711380 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:25:26.909036 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:25:26.910051 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:25:26.910051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:26.997703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.087 seconds
[0m13:25:26.998705 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:25:27.000739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:25:27.005757 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:25:27.005757 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:25:27.005757 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:27.040463 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m13:25:27.041966 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:25:27.041966 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:25:27.057731 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.015 seconds
[0m13:25:27.059086 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:25:27.059086 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:25:27.066199 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.066199 [debug] [MainThread]: On master: BEGIN
[0m13:25:27.066199 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:27.207539 [debug] [MainThread]: SQL status: BEGIN in 0.141 seconds
[0m13:25:27.207539 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.207539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:25:27.223199 [debug] [MainThread]: SQL status: SELECT 9 in 0.015 seconds
[0m13:25:27.225725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECB49280>]}
[0m13:25:27.226724 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:27.226724 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.226724 [debug] [MainThread]: On master: BEGIN
[0m13:25:27.226724 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:25:27.228152 [debug] [MainThread]: On master: COMMIT
[0m13:25:27.228152 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.228152 [debug] [MainThread]: On master: COMMIT
[0m13:25:27.228152 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:25:27.228152 [debug] [MainThread]: On master: Close
[0m13:25:27.233838 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:25:27.233838 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:25:27.233838 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:25:27.234903 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:25:27.234903 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:25:27.234903 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:25:27.235939 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:25:27.237079 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:25:27.235939 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:25:27.237079 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:25:27.237079 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:25:27.237079 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:25:27.238476 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:25:27.238476 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:25:27.238476 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:25:27.245170 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:25:27.246176 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:25:27.248186 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:25:27.250189 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:25:27.252234 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:25:27.253244 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:25:27.254379 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:25:27.287933 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:25:27.287933 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:25:27.305308 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:25:27.304305 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:25:27.308402 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:25:27.310632 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:25:27.312139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.312139 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:25:27.313148 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:27.313148 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.314309 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:25:27.314309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.314309 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:27.315351 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:25:27.315351 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.316487 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:27.316487 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:25:27.316487 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:27.357423 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m13:25:27.358426 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.358426 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:25:27.359627 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m13:25:27.359627 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.359627 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:25:27.363134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:25:27.364159 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.364159 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:25:27.367710 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m13:25:27.367710 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.367710 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:25:27.370876 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.012 seconds
[0m13:25:27.370876 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:25:27.370876 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:25:27.379453 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.380456 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m13:25:27.382960 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.385412 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.385412 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:25:27.388641 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.388641 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:25:27.388641 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:25:27.389646 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:25:27.390650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.390650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.390650 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:25:27.390650 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:25:27.394041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.395663 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.397698 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.399960 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.400963 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:25:27.400963 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:25:27.400963 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:25:27.401965 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:25:27.401965 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:25:27.403201 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.403201 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.413228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:25:27.417500 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:25:27.420518 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:25:27.422021 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:25:27.423022 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:25:27.423525 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.423525 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.423525 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.424579 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.424579 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:25:27.424579 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:25:27.424579 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:25:27.425853 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:25:27.426544 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:25:27.427563 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:25:27.427563 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:25:27.427563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:25:27.433182 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:25:27.435274 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:25:27.436526 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:25:27.438529 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:25:27.442833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:25:27.443852 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:25:27.443852 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:25:27.446342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:25:27.446342 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:25:27.447632 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:25:27.447632 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:25:27.447632 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:25:27.450797 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:25:27.450797 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:25:27.450797 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:25:27.453822 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:25:27.453822 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m13:25:27.454825 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:25:27.455829 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:25:27.456843 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:25:27.460495 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E802BB30>]}
[0m13:25:27.460495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECAAD820>]}
[0m13:25:27.460495 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EC813B30>]}
[0m13:25:27.460495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECC0BEF0>]}
[0m13:25:27.461999 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:25:27.463001 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:25:27.463001 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:25:27.464019 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:25:27.464019 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m13:25:27.464019 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:25:27.465310 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:25:27.465310 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_order_payment
[0m13:25:27.466313 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:25:27.466313 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m13:25:27.466313 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m13:25:27.466313 [info ] [Thread-3 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:25:27.467751 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m13:25:27.467751 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:25:27.468755 [info ] [Thread-4 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:25:27.468755 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_order_payment)
[0m13:25:27.469758 [info ] [Thread-1 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:25:27.469758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:25:27.469758 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m13:25:27.470761 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:25:27.470761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_sellers)
[0m13:25:27.470761 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m13:25:27.470761 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m13:25:27.473778 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:25:27.473778 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:25:27.476929 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:25:27.479375 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:25:27.481379 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:25:27.482517 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:25:27.485223 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:25:27.485223 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m13:25:27.486390 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m13:25:27.486390 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m13:25:27.489508 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:25:27.493519 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:25:27.496754 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:25:27.497758 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.497758 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:25:27.498780 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:27.498780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.499782 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.499782 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.500783 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:25:27.500783 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m13:25:27.500783 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:25:27.500783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:27.500783 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:27.502286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:27.541982 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m13:25:27.541982 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.543329 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:25:27.544779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m13:25:27.544779 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.545782 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:25:27.547036 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m13:25:27.547036 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.548098 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:25:27.548098 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:25:27.550550 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.550550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:25:27.552053 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:25:27.554303 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.555471 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m13:25:27.555471 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:25:27.555471 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.556484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.556484 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:25:27.556484 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:25:27.559543 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.559543 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:25:27.560883 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.562386 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:25:27.564963 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.564963 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:25:27.564963 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:25:27.566067 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:25:27.566067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:25:27.568118 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.570125 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:25:27.570125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:25:27.570125 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:25:27.570125 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:25:27.571614 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.572117 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:25:27.575289 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.575289 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:25:27.576292 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.576292 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.576292 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:25:27.576292 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:25:27.579547 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.579547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:25:27.579547 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:25:27.579547 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:25:27.580942 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:25:27.582960 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:25:27.583913 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:25:27.583913 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:25:27.586970 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:25:27.587973 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:25:27.587973 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.590005 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:25:27.590005 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:25:27.590005 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:25:27.591294 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:25:27.591294 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.591294 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:25:27.592294 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:25:27.592798 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:25:27.647975 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:25:27.647975 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.056 seconds
[0m13:25:27.649178 [debug] [Thread-2 (]: SQL status: COMMIT in 0.056 seconds
[0m13:25:27.649178 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.057 seconds
[0m13:25:27.649178 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:25:27.651183 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m13:25:27.652183 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:25:27.654109 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: Close
[0m13:25:27.654109 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:25:27.655137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:25:27.655137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECC009E0>]}
[0m13:25:27.656155 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECC022D0>]}
[0m13:25:27.656155 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:25:27.657564 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:25:27.656155 [info ] [Thread-1 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m13:25:27.657564 [info ] [Thread-3 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:25:27.659675 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m13:25:27.659675 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:25:27.659675 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m13:25:27.660683 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:25:27.662186 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m13:25:27.662186 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECC03830>]}
[0m13:25:27.662186 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:25:27.664439 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ECC01460>]}
[0m13:25:27.663187 [info ] [Thread-4 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:25:27.664439 [info ] [Thread-1 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:25:27.665843 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m13:25:27.664439 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m13:25:27.665843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now model.dbt_project.my_second_dbt_model)
[0m13:25:27.666861 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m13:25:27.666861 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:25:27.670009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:25:27.671248 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:25:27.674776 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:25:27.675776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:25:27.675776 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:25:27.677011 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:27.815029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m13:25:27.816033 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:25:27.816033 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:25:27.821310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:25:27.823814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:25:27.823814 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:25:27.824846 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:25:27.825849 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:25:27.825849 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:25:27.826853 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:25:27.827857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:25:27.829864 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:25:27.829864 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:25:27.830867 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:25:27.830867 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:25:27.832876 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:25:27.832876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '373a0563-2797-4e41-b054-d01f7766e5e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1ED075A90>]}
[0m13:25:27.833897 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:25:27.833897 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:25:27.835188 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.836294 [debug] [MainThread]: On master: BEGIN
[0m13:25:27.836294 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:27.869611 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:25:27.870872 [debug] [MainThread]: On master: COMMIT
[0m13:25:27.870872 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:27.870872 [debug] [MainThread]: On master: COMMIT
[0m13:25:27.870872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:25:27.870872 [debug] [MainThread]: On master: Close
[0m13:25:27.872376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:27.872884 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:25:27.872884 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:25:27.872884 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:25:27.872884 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:25:27.873896 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m13:25:27.873896 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:25:27.873896 [info ] [MainThread]: 
[0m13:25:27.873896 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m13:25:27.875897 [debug] [MainThread]: Command end result
[0m13:25:27.900242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:25:27.903259 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:25:27.909303 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:25:27.909303 [info ] [MainThread]: 
[0m13:25:27.909303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:27.910569 [info ] [MainThread]: 
[0m13:25:27.910569 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:25:27.912072 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:27.912072 after 2.39 seconds
[0m13:25:27.912072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1E6E4CB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA22E030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1EA919D90>]}
[0m13:25:27.913075 [debug] [MainThread]: Flushing usage events
[0m13:25:29.631793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:25:33.598802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4BA6B7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4EEA3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4F6F8860>]}


============================== 13:25:33.602826 | 0d85e4db-e311-4068-8a0d-3e9ef90e9237 ==============================
[0m13:25:33.602826 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:25:33.602826 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m13:25:33.789247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4F8BBE90>]}
[0m13:25:33.842169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4F7EA450>]}
[0m13:25:33.844197 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:25:34.236231 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:25:34.431244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:34.432245 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:34.472627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C50DB4500>]}
[0m13:25:34.544068 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:25:34.561967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:25:34.603815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C510093A0>]}
[0m13:25:34.604483 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:25:34.604483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4F8B83B0>]}
[0m13:25:34.607626 [info ] [MainThread]: 
[0m13:25:34.607626 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:34.608631 [info ] [MainThread]: 
[0m13:25:34.608631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:25:34.613153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:25:34.760633 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:25:34.762136 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:25:34.762136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:34.813433 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m13:25:34.813433 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:25:34.814434 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:25:34.819466 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m13:25:34.820472 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:25:34.821975 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:25:34.827998 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:34.829004 [debug] [MainThread]: On master: BEGIN
[0m13:25:34.829004 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:34.864539 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:25:34.864539 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:34.864539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:25:34.870574 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:25:34.874115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d85e4db-e311-4068-8a0d-3e9ef90e9237', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4F438AA0>]}
[0m13:25:34.874115 [debug] [MainThread]: On master: ROLLBACK
[0m13:25:34.875118 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:34.875118 [debug] [MainThread]: On master: BEGIN
[0m13:25:34.875118 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:25:34.876120 [debug] [MainThread]: On master: COMMIT
[0m13:25:34.876120 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:34.876120 [debug] [MainThread]: On master: COMMIT
[0m13:25:34.876120 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:25:34.877139 [debug] [MainThread]: On master: Close
[0m13:25:34.880167 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:25:34.881171 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:25:34.881171 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:25:34.881171 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:25:34.882172 [info ] [Thread-1 (]: 1 of 22 START test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [RUN]
[0m13:25:34.882172 [info ] [Thread-2 (]: 2 of 22 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:25:34.882172 [info ] [Thread-3 (]: 3 of 22 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:25:34.883458 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd'
[0m13:25:34.883458 [info ] [Thread-4 (]: 4 of 22 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:25:34.884410 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:25:34.884913 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:25:34.884913 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:25:34.884913 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:25:34.885916 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:25:34.885916 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:25:34.897162 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:25:34.904821 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:25:34.907834 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:25:34.910874 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:25:34.912891 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:25:34.912891 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:25:34.928691 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:25:34.930706 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:25:34.932211 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:25:34.934377 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:25:34.935377 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:25:34.935377 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:25:34.936390 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:25:34.936390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:34.937396 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:25:34.937396 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:25:34.938402 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:25:34.938402 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:34.938402 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:34.982225 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m13:25:34.983599 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:25:34.983599 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:25:34.984617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m13:25:34.985627 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:25:34.985627 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:25:34.985627 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:25:34.989649 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:25:34.990652 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:25:34.992157 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:25:34.992157 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:25:34.992157 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m13:25:34.993159 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:25:34.993159 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:25:34.994153 [error] [Thread-2 (]: 2 of 22 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.11s]
[0m13:25:34.994153 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:34.995444 [info ] [Thread-3 (]: 3 of 22 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.11s]
[0m13:25:34.995444 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:25:34.996452 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:25:34.997603 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:25:34.998108 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:25:34.998108 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:25:34.998108 [error] [Thread-1 (]: 1 of 22 ERROR dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [[31mERROR[0m in 0.11s]
[0m13:25:34.999126 [info ] [Thread-2 (]: 5 of 22 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:25:34.999126 [info ] [Thread-3 (]: 6 of 22 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:25:35.000130 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:25:35.000130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m13:25:35.001134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:25:35.001134 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:25:35.001134 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:25:35.002134 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:25:35.002638 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:25:35.002638 [info ] [Thread-1 (]: 7 of 22 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:25:35.007176 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:25:35.010195 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:25:35.011200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:25:35.011200 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:25:35.016148 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:25:35.016148 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:25:35.017161 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:25:35.019182 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:25:35.021610 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:25:35.022115 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:25:35.024386 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:25:35.025386 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:25:35.026396 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:25:35.026396 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:25:35.027404 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:35.027404 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:25:35.027404 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:25:35.028852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:35.028852 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:25:35.028852 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:25:35.073176 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:25:35.074354 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:25:35.074354 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.076669 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:25:35.076669 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:25:35.077677 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.080061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:25:35.081071 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:25:35.081071 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.141016 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m13:25:35.142017 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.146 seconds
[0m13:25:35.143333 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:25:35.144241 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:25:35.144241 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:25:35.144241 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:25:35.145345 [info ] [Thread-2 (]: 5 of 22 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.15s]
[0m13:25:35.146349 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:25:35.146349 [info ] [Thread-4 (]: 4 of 22 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.26s]
[0m13:25:35.147363 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:25:35.148368 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:25:35.148368 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:25:35.148368 [info ] [Thread-2 (]: 8 of 22 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:25:35.149374 [info ] [Thread-4 (]: 9 of 22 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:25:35.149374 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:25:35.150379 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:25:35.150379 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:25:35.151397 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:25:35.154936 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:25:35.159029 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:25:35.160033 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:25:35.164065 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:25:35.165074 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:25:35.167088 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:25:35.169232 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:25:35.169232 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:25:35.170357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:35.170357 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:25:35.171577 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:25:35.172081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:35.183114 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.105 seconds
[0m13:25:35.185313 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:25:35.186326 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:25:35.186326 [info ] [Thread-3 (]: 6 of 22 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.19s]
[0m13:25:35.187347 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:25:35.188349 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:35.188349 [info ] [Thread-3 (]: 10 of 22 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:25:35.189608 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:25:35.189608 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:35.193628 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:35.195630 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:35.198134 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:35.200153 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:35.201153 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:25:35.201153 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:35.207108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.126 seconds
[0m13:25:35.209116 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:25:35.210123 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:25:35.211126 [info ] [Thread-1 (]: 7 of 22 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.20s]
[0m13:25:35.212126 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:25:35.212630 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:25:35.213132 [info ] [Thread-1 (]: 11 of 22 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:25:35.214145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:25:35.214145 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:25:35.220750 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:25:35.222253 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:25:35.226780 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:25:35.228790 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m13:25:35.228790 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:25:35.229883 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.229883 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:25:35.230881 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:25:35.230881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:35.254277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:25:35.254277 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:25:35.254277 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.275323 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.046 seconds
[0m13:25:35.277504 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:25:35.277504 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:25:35.278616 [info ] [Thread-2 (]: 8 of 22 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.13s]
[0m13:25:35.279622 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:25:35.279622 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:25:35.279622 [info ] [Thread-2 (]: 12 of 22 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:25:35.280742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:25:35.280742 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:25:35.284447 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:25:35.285452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m13:25:35.286478 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:25:35.286478 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.286478 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:25:35.288518 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:25:35.290425 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:25:35.290425 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:25:35.291484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:35.310290 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.023 seconds
[0m13:25:35.311966 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:25:35.311966 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:25:35.312970 [info ] [Thread-1 (]: 11 of 22 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.10s]
[0m13:25:35.314075 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:25:35.314075 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:25:35.314075 [info ] [Thread-1 (]: 13 of 22 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:25:35.315111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:25:35.315111 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:25:35.322979 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:25:35.324662 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:25:35.327725 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:25:35.328752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.158 seconds
[0m13:25:35.328752 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:25:35.328752 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.329955 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:25:35.329955 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:25:35.329955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:35.335930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:25:35.335930 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:25:35.336949 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.340439 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:25:35.342030 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:25:35.343032 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:25:35.343032 [info ] [Thread-2 (]: 12 of 22 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.06s]
[0m13:25:35.344196 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:25:35.345199 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:25:35.345199 [info ] [Thread-2 (]: 14 of 22 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:25:35.346274 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:25:35.346274 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:25:35.352046 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:25:35.353050 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:25:35.357862 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:25:35.358886 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:25:35.358886 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.104 seconds
[0m13:25:35.359886 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:25:35.360886 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:25:35.362389 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:25:35.362906 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:25:35.362906 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:25:35.362906 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:25:35.363968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:35.363968 [info ] [Thread-4 (]: 9 of 22 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.21s]
[0m13:25:35.363968 [info ] [Thread-3 (]: 10 of 22 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.17s]
[0m13:25:35.365172 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:25:35.366364 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:25:35.366364 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:25:35.367363 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:25:35.367363 [info ] [Thread-4 (]: 15 of 22 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:25:35.368364 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:25:35.367363 [info ] [Thread-3 (]: 16 of 22 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:25:35.368364 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:25:35.369365 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:25:35.375590 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:25:35.376606 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:25:35.377667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:25:35.383150 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:25:35.383150 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:25:35.384169 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:25:35.384169 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.387391 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:25:35.387391 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:25:35.390630 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:25:35.390630 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:25:35.390630 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:25:35.392133 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:35.393135 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:25:35.393639 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:25:35.393639 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:35.444894 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m13:25:35.445908 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:25:35.445908 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.450001 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m13:25:35.450001 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:25:35.451001 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.499511 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.112 seconds
[0m13:25:35.502026 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:25:35.502026 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:25:35.503532 [info ] [Thread-1 (]: 13 of 22 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.19s]
[0m13:25:35.504534 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:25:35.504534 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:25:35.505535 [info ] [Thread-1 (]: 17 of 22 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:25:35.506658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:25:35.506658 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:25:35.516169 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:25:35.517232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.153 seconds
[0m13:25:35.518250 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:25:35.518250 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:25:35.519506 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:25:35.523532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:25:35.525339 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:25:35.526340 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:25:35.526340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:35.535609 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.089 seconds
[0m13:25:35.537609 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:25:35.538877 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:25:35.539879 [info ] [Thread-4 (]: 15 of 22 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.17s]
[0m13:25:35.540879 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:25:35.540879 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:25:35.542382 [info ] [Thread-4 (]: 18 of 22 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:25:35.542896 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:25:35.542896 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:25:35.550761 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:25:35.552778 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:25:35.557792 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:25:35.559794 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:25:35.559794 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:25:35.560799 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:35.598115 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.146 seconds
[0m13:25:35.599438 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:25:35.600457 [debug] [Thread-1 (]: SQL status: BEGIN in 0.074 seconds
[0m13:25:35.600457 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:25:35.600457 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:25:35.600457 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.601960 [info ] [Thread-3 (]: 16 of 22 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.23s]
[0m13:25:35.603467 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:25:35.603467 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:25:35.604470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:25:35.604470 [info ] [Thread-3 (]: 19 of 22 START test unique_stg_customers_customer_unique_id .................... [RUN]
[0m13:25:35.607574 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:25:35.607574 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4)
[0m13:25:35.608657 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:25:35.609661 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:25:35.615499 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:25:35.615499 [info ] [Thread-1 (]: 17 of 22 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.11s]
[0m13:25:35.616508 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:25:35.616508 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:25:35.617713 [info ] [Thread-1 (]: 20 of 22 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:25:35.618715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:25:35.618715 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:25:35.620197 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:25:35.622813 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:25:35.630638 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:35.630638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.070 seconds
[0m13:25:35.632142 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:25:35.632142 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.633648 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:25:35.634494 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: BEGIN
[0m13:25:35.634494 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:25:35.635516 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:25:35.709298 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.190 seconds
[0m13:25:35.710300 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:35.711537 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.078 seconds
[0m13:25:35.711537 [debug] [Thread-3 (]: SQL status: BEGIN in 0.077 seconds
[0m13:25:35.713042 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:25:35.714751 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:25:35.714751 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:25:35.715793 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_unique_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is not null
group by customer_unique_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.715793 [debug] [Thread-4 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:25:35.716808 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:25:35.717867 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:35.717867 [info ] [Thread-4 (]: 18 of 22 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.17s]
[0m13:25:35.719967 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:25:35.718955 [info ] [Thread-2 (]: 14 of 22 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.37s]
[0m13:25:35.720988 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:25:35.720988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:35.721980 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:25:35.722988 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:25:35.722988 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:25:35.724190 [info ] [Thread-4 (]: 21 of 22 START test unique_stg_products_product_id ............................. [RUN]
[0m13:25:35.725314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:25:35.724190 [info ] [Thread-2 (]: 22 of 22 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:25:35.725314 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:25:35.726502 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:25:35.730894 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:25:35.732399 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:25:35.738701 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:25:35.740755 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:25:35.744893 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:25:35.745896 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:25:35.748897 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:25:35.749907 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:25:35.749907 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:25:35.749907 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:25:35.751295 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:25:35.752297 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:25:35.752804 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:25:35.774940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m13:25:35.776254 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:25:35.776254 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.800862 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:25:35.800862 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:25:35.800862 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.805900 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:25:35.807948 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:25:35.807948 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:25:35.808951 [info ] [Thread-2 (]: 22 of 22 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:25:35.809976 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:25:35.869828 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.093 seconds
[0m13:25:35.870942 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:25:35.871943 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:25:35.871943 [info ] [Thread-1 (]: 20 of 22 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.25s]
[0m13:25:35.873094 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:25:35.882973 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.166 seconds
[0m13:25:35.885317 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: ROLLBACK
[0m13:25:35.885317 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: Close
[0m13:25:35.886405 [error] [Thread-3 (]: 19 of 22 FAIL 96096 unique_stg_customers_customer_unique_id .................... [[31mFAIL 96096[0m in 0.28s]
[0m13:25:35.887412 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:25:35.897067 [debug] [Thread-4 (]: SQL status: BEGIN in 0.147 seconds
[0m13:25:35.897067 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:25:35.898570 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:25:35.910976 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.012 seconds
[0m13:25:35.912982 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:25:35.912982 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:25:35.914181 [info ] [Thread-4 (]: 21 of 22 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.19s]
[0m13:25:35.915391 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:25:35.916707 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:35.916707 [debug] [MainThread]: On master: BEGIN
[0m13:25:35.917707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:25:35.952874 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:25:35.953827 [debug] [MainThread]: On master: COMMIT
[0m13:25:35.953827 [debug] [MainThread]: Using postgres connection "master"
[0m13:25:35.954331 [debug] [MainThread]: On master: COMMIT
[0m13:25:35.954331 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:25:35.954331 [debug] [MainThread]: On master: Close
[0m13:25:35.955333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:35.955333 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:25:35.955333 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:25:35.956333 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:25:35.956333 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4' was properly closed.
[0m13:25:35.956333 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:25:35.956333 [info ] [MainThread]: 
[0m13:25:35.957334 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 1.35 seconds (1.35s).
[0m13:25:35.960446 [debug] [MainThread]: Command end result
[0m13:25:35.986536 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:25:35.989537 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:25:35.996551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:25:35.997551 [info ] [MainThread]: 
[0m13:25:35.997551 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:25:35.998551 [info ] [MainThread]: 
[0m13:25:35.998551 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:25:35.998551 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:25:35.999670 [info ] [MainThread]: 
[0m13:25:35.999670 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:25:35.999670 [info ] [MainThread]: 
[0m13:25:36.000697 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:25:36.000697 [info ] [MainThread]: 
[0m13:25:36.000697 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_unique_id (models\staging\_staging_test.yml)[0m
[0m13:25:36.000697 [error] [MainThread]:   Got 96096 results, configured to fail if != 0
[0m13:25:36.002201 [info ] [MainThread]: 
[0m13:25:36.002201 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_unique_id.sql
[0m13:25:36.002201 [info ] [MainThread]: 
[0m13:25:36.003203 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=3 SKIP=0 TOTAL=22
[0m13:25:36.004301 [debug] [MainThread]: Command `dbt test` failed at 13:25:36.004301 after 2.50 seconds
[0m13:25:36.004301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4EFE8800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C4EFE95E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025C51C63C20>]}
[0m13:25:36.005306 [debug] [MainThread]: Flushing usage events
[0m13:25:37.410658 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:27:17.284135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EEA974A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EE9DBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203EF064710>]}


============================== 13:27:17.288220 | 29e4a934-ae28-4224-bbb2-0115a3109c0d ==============================
[0m13:27:17.288220 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:27:17.289223 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:27:17.472896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F1936300>]}
[0m13:27:17.526121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F19D8440>]}
[0m13:27:17.527132 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:27:17.925609 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:27:18.115371 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:18.116379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:18.120410 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds
[0m13:27:18.154578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F2F30080>]}
[0m13:27:18.226941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:27:18.246289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:27:18.277315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3197F50>]}
[0m13:27:18.277315 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:27:18.278436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F1B5AFF0>]}
[0m13:27:18.280738 [info ] [MainThread]: 
[0m13:27:18.280738 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:18.282243 [info ] [MainThread]: 
[0m13:27:18.282243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:27:18.286611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:27:18.437960 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:27:18.437960 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:27:18.438967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:18.483788 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m13:27:18.484806 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:27:18.486988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:27:18.492021 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:27:18.492021 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:27:18.492021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:18.527092 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m13:27:18.527092 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:27:18.527092 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:27:18.533879 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m13:27:18.535382 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:27:18.535382 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:27:18.542140 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:18.542643 [debug] [MainThread]: On master: BEGIN
[0m13:27:18.542643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:18.575875 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:27:18.576903 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:18.576903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:27:18.584336 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m13:27:18.587343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3008890>]}
[0m13:27:18.587343 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:18.588355 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:18.588355 [debug] [MainThread]: On master: BEGIN
[0m13:27:18.589376 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:27:18.589376 [debug] [MainThread]: On master: COMMIT
[0m13:27:18.589376 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:18.589376 [debug] [MainThread]: On master: COMMIT
[0m13:27:18.590381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:18.590381 [debug] [MainThread]: On master: Close
[0m13:27:18.594081 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:27:18.595085 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:27:18.595085 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:27:18.595085 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:27:18.596089 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:27:18.596089 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:27:18.597106 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:27:18.597106 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:27:18.597106 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:27:18.598110 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:27:18.598110 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:27:18.599113 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:27:18.599113 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:27:18.599113 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:27:18.600275 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:27:18.606307 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:27:18.606307 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:27:18.609317 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:27:18.611938 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:27:18.614042 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:27:18.615044 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:27:18.646993 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:27:18.646993 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:27:18.650520 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:27:18.650520 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:27:18.667282 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:27:18.670294 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:27:18.673791 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:27:18.673791 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.675137 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:27:18.675137 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.675137 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:27:18.676187 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.676187 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:27:18.676187 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.677194 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:27:18.677194 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:27:18.678198 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:27:18.678198 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:27:18.678198 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:27:18.722118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:27:18.723372 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.723372 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:27:18.724552 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:27:18.724552 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.724552 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:27:18.729280 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:27:18.729280 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.730285 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.006 seconds
[0m13:27:18.730285 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:27:18.739262 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.739262 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:27:18.740649 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m13:27:18.740649 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:27:18.743162 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.744309 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.744309 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:27:18.745313 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:27:18.745313 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:18.745313 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:27:18.748368 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.748368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:27:18.750491 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.751994 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:27:18.751994 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:27:18.754999 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.754999 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:27:18.758162 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.759167 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:27:18.759167 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:27:18.759167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:18.760240 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:18.774360 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:27:18.774360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:27:18.774360 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m13:27:18.777547 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.777547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.779562 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.782065 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:27:18.783073 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:27:18.783073 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:27:18.784159 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:27:18.784159 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.784159 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:27:18.785162 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:18.785162 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:18.785162 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:27:18.786337 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:27:18.787341 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:27:18.788575 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:27:18.793597 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:27:18.793976 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.794977 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:27:18.795977 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.800095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:27:18.800095 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:27:18.803084 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:27:18.803084 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:27:18.803084 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:27:18.804130 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:27:18.805135 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:27:18.806140 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:27:18.807161 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:27:18.807161 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:27:18.808167 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:27:18.808167 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:27:18.810171 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:27:18.812011 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:27:18.812011 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:27:18.813013 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:27:18.814147 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:27:18.816220 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:27:18.816220 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:27:18.818227 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:27:18.819657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F2DDABD0>]}
[0m13:27:18.819657 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F37F0C80>]}
[0m13:27:18.819657 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F384D160>]}
[0m13:27:18.820659 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:27:18.820659 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m13:27:18.820659 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:27:18.823166 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:27:18.822163 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:27:18.824248 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:27:18.824248 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:27:18.825383 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:27:18.825383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3856540>]}
[0m13:27:18.826387 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m13:27:18.826387 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m13:27:18.826387 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m13:27:18.827730 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:27:18.827730 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:27:18.828733 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:27:18.829735 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:27:18.828733 [info ] [Thread-4 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:27:18.829735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_order_payment)
[0m13:27:18.829735 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:27:18.831096 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m13:27:18.831096 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m13:27:18.832096 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:27:18.832096 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m13:27:18.832096 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m13:27:18.832096 [info ] [Thread-3 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:27:18.835912 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:27:18.838275 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:27:18.840285 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:27:18.840285 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m13:27:18.841301 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:27:18.843828 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:27:18.844434 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:27:18.847623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:27:18.847623 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m13:27:18.847623 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m13:27:18.852143 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:27:18.852143 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m13:27:18.855500 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:27:18.858570 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:27:18.859574 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:18.859574 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:27:18.860580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:27:18.860580 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.860580 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:18.862084 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:27:18.862084 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.862084 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m13:27:18.863086 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:27:18.863086 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:27:18.863086 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:27:18.863963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:18.905868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m13:27:18.905868 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.905868 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:27:18.909105 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m13:27:18.909105 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.909105 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:27:18.911916 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:27:18.915081 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.915081 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:27:18.916084 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:27:18.918106 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.918106 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:27:18.919489 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:18.919489 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:18.922002 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.924508 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.924508 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:27:18.924508 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:27:18.925905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:18.925905 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:18.926919 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:27:18.927926 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:27:18.927926 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.927926 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.929404 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:27:18.929404 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:27:18.931007 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:27:18.933011 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:27:18.933011 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m13:27:18.933011 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:27:18.935287 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:27:18.935790 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:27:18.935790 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:27:18.936849 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:27:18.936849 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:27:18.938198 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:27:18.939205 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m13:27:18.940277 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m13:27:18.940277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F374A3C0>]}
[0m13:27:18.941423 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3C3E600>]}
[0m13:27:18.941926 [info ] [Thread-3 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m13:27:18.942928 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m13:27:18.941926 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m13:27:18.942928 [debug] [Thread-3 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:27:18.943918 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m13:27:18.943918 [info ] [Thread-3 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:27:18.945164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now model.dbt_project.my_second_dbt_model)
[0m13:27:18.945164 [debug] [Thread-3 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:27:18.948314 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:27:18.949317 [debug] [Thread-3 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:27:18.952322 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:27:18.952824 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:27:18.952824 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:27:18.953839 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:27:18.993968 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m13:27:18.993968 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:27:18.993968 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:27:18.998499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.138 seconds
[0m13:27:18.998499 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:18.998499 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:27:18.999525 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:27:19.002195 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:27:19.003197 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:27:19.003700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:27:19.003700 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:19.007566 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:19.009590 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:27:19.009590 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:27:19.009590 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:27:19.009590 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:27:19.010867 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:19.063139 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:19.063139 [debug] [Thread-3 (]: SQL status: COMMIT in 0.053 seconds
[0m13:27:19.064457 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:27:19.065461 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:27:19.066461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.203 seconds
[0m13:27:19.066461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:27:19.066461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:19.067556 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:19.067556 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:27:19.068728 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:27:19.069731 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:27:19.069731 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:19.069731 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:27:19.070748 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:27:19.070748 [debug] [Thread-3 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:27:19.072251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3C74A40>]}
[0m13:27:19.073253 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:27:19.072251 [info ] [Thread-3 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:27:19.074758 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:27:19.075906 [debug] [Thread-3 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:27:19.076907 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:27:19.076907 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:27:19.080429 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:19.080429 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:27:19.080429 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:27:19.081933 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:27:19.084447 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:19.084447 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:27:19.084447 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:27:19.085452 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m13:27:19.086456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F19F9880>]}
[0m13:27:19.086456 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:27:19.088471 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:27:19.087466 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m13:27:19.089474 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:19.089474 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:27:19.090563 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:27:19.090563 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:27:19.093979 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:27:19.093979 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:27:19.093979 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:27:19.096078 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:27:19.097082 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m13:27:19.098085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '29e4a934-ae28-4224-bbb2-0115a3109c0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F3C55400>]}
[0m13:27:19.098085 [info ] [Thread-4 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m13:27:19.099089 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m13:27:19.100094 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:19.100094 [debug] [MainThread]: On master: BEGIN
[0m13:27:19.101097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:19.244178 [debug] [MainThread]: SQL status: BEGIN in 0.143 seconds
[0m13:27:19.244178 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.244178 [debug] [MainThread]: Using postgres connection "master"
[0m13:27:19.245181 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.245181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:27:19.245181 [debug] [MainThread]: On master: Close
[0m13:27:19.245181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:19.246189 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:27:19.246189 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:27:19.246189 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m13:27:19.246189 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:27:19.247210 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:27:19.247210 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:27:19.247210 [info ] [MainThread]: 
[0m13:27:19.248213 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:27:19.249216 [debug] [MainThread]: Command end result
[0m13:27:19.274414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:27:19.277436 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:27:19.282974 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:27:19.282974 [info ] [MainThread]: 
[0m13:27:19.284100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:27:19.284100 [info ] [MainThread]: 
[0m13:27:19.285107 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:27:19.286111 [debug] [MainThread]: Command `dbt run` succeeded at 13:27:19.286111 after 2.10 seconds
[0m13:27:19.286111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F0D57B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F0D559D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203F19BA330>]}
[0m13:27:19.287130 [debug] [MainThread]: Flushing usage events
[0m13:27:20.992045 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:30:18.192184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205CC23800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205EFC9250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205EFCBA70>]}


============================== 13:30:18.196274 | 09e6a6c5-9cea-4202-80f8-98ea875adec2 ==============================
[0m13:30:18.196274 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:30:18.197277 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:30:18.382819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205FB18230>]}
[0m13:30:18.435921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205F348A40>]}
[0m13:30:18.436924 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:30:18.825976 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:30:19.013796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:19.014799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:19.052980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205F49B3E0>]}
[0m13:30:19.125268 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:30:19.143902 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:30:19.174996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220615B2840>]}
[0m13:30:19.174996 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:30:19.175999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022060F464B0>]}
[0m13:30:19.178015 [info ] [MainThread]: 
[0m13:30:19.178015 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:30:19.179065 [info ] [MainThread]: 
[0m13:30:19.179065 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:30:19.183122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:30:19.333245 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:30:19.333245 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:30:19.333245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:19.377865 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m13:30:19.378870 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:30:19.380873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:30:19.385761 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:30:19.386763 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:30:19.386763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:19.420887 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m13:30:19.420887 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:30:19.420887 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:30:19.427769 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m13:30:19.428808 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:30:19.429811 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:30:19.435858 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:19.435858 [debug] [MainThread]: On master: BEGIN
[0m13:30:19.435858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:30:19.470179 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:30:19.470179 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:19.471182 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:30:19.478242 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m13:30:19.480247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220615E3290>]}
[0m13:30:19.481249 [debug] [MainThread]: On master: ROLLBACK
[0m13:30:19.481249 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:19.481249 [debug] [MainThread]: On master: BEGIN
[0m13:30:19.482250 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:30:19.482753 [debug] [MainThread]: On master: COMMIT
[0m13:30:19.482753 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:19.483256 [debug] [MainThread]: On master: COMMIT
[0m13:30:19.483256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:19.483256 [debug] [MainThread]: On master: Close
[0m13:30:19.487294 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:30:19.487294 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:30:19.488296 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:30:19.488296 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:30:19.488296 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:30:19.489298 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:30:19.489298 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:30:19.490301 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:30:19.490301 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:30:19.491304 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:30:19.491304 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:30:19.492305 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:30:19.492808 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:30:19.492808 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:30:19.492808 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:30:19.499743 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:30:19.499743 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:30:19.502249 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:30:19.504296 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:30:19.506320 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:30:19.507325 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:30:19.507325 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:30:19.553784 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:30:19.556872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:30:19.557874 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:30:19.557874 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:30:19.560884 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:30:19.564391 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:30:19.565395 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.565395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.566410 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:30:19.566410 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:30:19.566410 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.567582 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.567582 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:30:19.567582 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:30:19.568585 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:30:19.568585 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:30:19.568585 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:30:19.569587 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:30:19.612090 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m13:30:19.613562 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.613562 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:30:19.614832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:30:19.614832 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.614832 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:30:19.619997 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:30:19.619997 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:30:19.621023 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m13:30:19.621023 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.626925 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.632442 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.632944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m13:30:19.632944 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:30:19.632944 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:30:19.633955 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:30:19.633955 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.634958 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:30:19.634958 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.634958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.637975 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.639980 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.639980 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:30:19.640983 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:30:19.640983 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:30:19.640983 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:30:19.643993 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.646512 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.646512 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:30:19.647755 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:30:19.647755 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.647755 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.662324 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:30:19.662886 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:30:19.662886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m13:30:19.664844 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:30:19.666849 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.667854 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.669859 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.669859 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.670864 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:30:19.670864 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:30:19.671864 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:30:19.673107 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:30:19.674133 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.674133 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.674133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:30:19.676138 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:30:19.676138 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:30:19.677156 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:30:19.682729 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:30:19.683231 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.685217 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:30:19.685217 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.689231 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:30:19.689231 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:30:19.692237 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:30:19.692740 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:30:19.693243 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:30:19.693243 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:30:19.694254 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:30:19.696267 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:30:19.696267 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:30:19.697270 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:30:19.697270 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:30:19.697270 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:30:19.699281 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:30:19.701286 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:30:19.702789 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:30:19.703790 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:30:19.703790 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:30:19.705816 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:30:19.706831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205CD1BB90>]}
[0m13:30:19.706831 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220619E3EC0>]}
[0m13:30:19.706831 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:30:19.706831 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:30:19.708091 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.21s]
[0m13:30:19.710104 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:30:19.708091 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:30:19.711335 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:30:19.711335 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:30:19.712336 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:30:19.712839 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220615D4290>]}
[0m13:30:19.712839 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m13:30:19.713850 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220619AB6E0>]}
[0m13:30:19.713850 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m13:30:19.714873 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:30:19.714873 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:30:19.715876 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:30:19.716971 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:30:19.715876 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:30:19.716971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_order_payment)
[0m13:30:19.717982 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:30:19.717982 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m13:30:19.717982 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:30:19.718985 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:30:19.718985 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m13:30:19.719995 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m13:30:19.719995 [info ] [Thread-4 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:30:19.722502 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:30:19.723005 [info ] [Thread-3 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:30:19.724954 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:30:19.725956 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m13:30:19.725956 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m13:30:19.727011 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m13:30:19.727011 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:30:19.730032 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:30:19.730032 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:30:19.733051 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:30:19.733051 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m13:30:19.736080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:30:19.739109 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:30:19.740112 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m13:30:19.740112 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m13:30:19.743986 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:30:19.747520 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:30:19.747520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.748523 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.748523 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:30:19.749534 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:30:19.749534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:19.749534 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.750707 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:30:19.750707 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.750707 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m13:30:19.750707 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:30:19.752210 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:30:19.752210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:30:19.801212 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:30:19.802212 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.802716 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:30:19.803219 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:30:19.803219 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.803219 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:30:19.808248 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:30:19.808248 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:30:19.811260 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.814309 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.814309 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:30:19.814309 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:30:19.815318 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.816322 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.818346 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.820417 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.820417 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:30:19.820417 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:30:19.821920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.821920 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.822925 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:30:19.825028 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:30:19.825028 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.825028 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.826031 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:30:19.826031 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:30:19.828047 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:30:19.829068 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:30:19.830071 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:30:19.830071 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:30:19.832578 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:30:19.832578 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:30:19.833081 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:30:19.833980 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:30:19.833980 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:30:19.835042 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:30:19.836045 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m13:30:19.837048 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m13:30:19.838052 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022061DB3C50>]}
[0m13:30:19.838052 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022061D91190>]}
[0m13:30:19.839068 [info ] [Thread-4 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m13:30:19.840071 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m13:30:19.839068 [info ] [Thread-3 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m13:30:19.840071 [debug] [Thread-4 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:30:19.841081 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m13:30:19.841081 [info ] [Thread-4 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:30:19.842081 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.my_second_dbt_model)
[0m13:30:19.842081 [debug] [Thread-4 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:30:19.844133 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:30:19.845636 [debug] [Thread-4 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:30:19.848658 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:30:19.849712 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:30:19.849712 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:30:19.849712 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:30:19.896131 [debug] [Thread-1 (]: SQL status: BEGIN in 0.146 seconds
[0m13:30:19.896131 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.897133 [debug] [Thread-2 (]: SQL status: BEGIN in 0.146 seconds
[0m13:30:19.897133 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:30:19.897133 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.898181 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:30:19.902242 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:30:19.904544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.905546 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:30:19.905546 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:30:19.909557 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.909557 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:30:19.910559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.959381 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.960448 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m13:30:19.960448 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:30:19.962954 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.963855 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:30:19.963855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:30:19.963855 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.965873 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:30:19.966878 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:30:19.966878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.967881 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.967881 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:30:19.967881 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:30:19.969888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:30:19.971891 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:30:19.971891 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m13:30:19.972897 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:30:19.974907 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:30:19.974907 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:30:19.975943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:30:19.975943 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:30:19.976958 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:30:19.977963 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:30:19.978966 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m13:30:19.979968 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m13:30:19.980971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022060E54080>]}
[0m13:30:19.980971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022061DFB590>]}
[0m13:30:19.981971 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.26s]
[0m13:30:19.983164 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:30:19.981971 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.26s]
[0m13:30:19.983164 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m13:30:19.987499 [debug] [Thread-4 (]: SQL status: BEGIN in 0.137 seconds
[0m13:30:19.988504 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:30:19.988504 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:30:19.994192 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:30:19.997209 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:30:19.997209 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:30:19.998213 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:30:19.999219 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:30:20.000222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:30:20.000222 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:30:20.001397 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:30:20.003420 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:30:20.003771 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:30:20.003771 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:30:20.004774 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:30:20.005798 [debug] [Thread-4 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:30:20.005798 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09e6a6c5-9cea-4202-80f8-98ea875adec2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022061DF8380>]}
[0m13:30:20.006947 [info ] [Thread-4 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.16s]
[0m13:30:20.006947 [debug] [Thread-4 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:30:20.007951 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:20.008954 [debug] [MainThread]: On master: BEGIN
[0m13:30:20.008954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:30:20.045125 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:30:20.045125 [debug] [MainThread]: On master: COMMIT
[0m13:30:20.046124 [debug] [MainThread]: Using postgres connection "master"
[0m13:30:20.046124 [debug] [MainThread]: On master: COMMIT
[0m13:30:20.046627 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:30:20.046627 [debug] [MainThread]: On master: Close
[0m13:30:20.046627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:20.046627 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:30:20.047784 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:30:20.047784 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m13:30:20.047784 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:30:20.047784 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:30:20.048785 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:30:20.048785 [info ] [MainThread]: 
[0m13:30:20.048785 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m13:30:20.051082 [debug] [MainThread]: Command end result
[0m13:30:20.074797 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:30:20.077247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:30:20.083661 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:30:20.083661 [info ] [MainThread]: 
[0m13:30:20.083661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:20.084665 [info ] [MainThread]: 
[0m13:30:20.084665 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:30:20.085892 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:20.085892 after 1.99 seconds
[0m13:30:20.085892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205EE91430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205EEE8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002205EEEBDA0>]}
[0m13:30:20.086896 [debug] [MainThread]: Flushing usage events
[0m13:30:22.008302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:32:57.000355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2D36B2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F910560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2FDD9AF0>]}


============================== 13:32:57.004886 | a46e0305-d01c-4dcf-b048-aea1c3d41b99 ==============================
[0m13:32:57.004886 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:32:57.006181 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'write_json': 'True', 'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:32:57.218636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2D494440>]}
[0m13:32:57.272296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F3707A0>]}
[0m13:32:57.273646 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:32:57.710108 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:32:57.919931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:32:57.919931 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:32:57.958992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3018ACC0>]}
[0m13:32:58.030555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:32:58.049623 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:32:58.080500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A31A5A450>]}
[0m13:32:58.080500 [info ] [MainThread]: Found 9 models, 23 data tests, 9 sources, 447 macros
[0m13:32:58.080500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A316AF650>]}
[0m13:32:58.083848 [info ] [MainThread]: 
[0m13:32:58.083848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:58.085270 [info ] [MainThread]: 
[0m13:32:58.085270 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:32:58.089276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:32:58.249381 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:32:58.249381 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:32:58.249381 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:58.403403 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.153 seconds
[0m13:32:58.403869 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:32:58.405873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:32:58.410365 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:32:58.411368 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:32:58.411368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:58.445398 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m13:32:58.445398 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:32:58.445398 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:32:58.452836 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m13:32:58.453847 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:32:58.453847 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:32:58.460947 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.460947 [debug] [MainThread]: On master: BEGIN
[0m13:32:58.460947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:58.496957 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m13:32:58.497986 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.497986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:32:58.505180 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:32:58.507340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A31ABF410>]}
[0m13:32:58.508343 [debug] [MainThread]: On master: ROLLBACK
[0m13:32:58.508343 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.508343 [debug] [MainThread]: On master: BEGIN
[0m13:32:58.509345 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:32:58.509345 [debug] [MainThread]: On master: COMMIT
[0m13:32:58.509345 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.509345 [debug] [MainThread]: On master: COMMIT
[0m13:32:58.510383 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:58.510383 [debug] [MainThread]: On master: Close
[0m13:32:58.514392 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:32:58.514392 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:32:58.515392 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:32:58.515392 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:32:58.515392 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:32:58.515392 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:32:58.516768 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:32:58.517813 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:32:58.516768 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:32:58.517813 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:32:58.517813 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:32:58.519225 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:32:58.519225 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:32:58.519225 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:32:58.520231 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:32:58.526242 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:32:58.526242 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:32:58.529365 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:32:58.531373 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:32:58.533802 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:32:58.534307 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:32:58.545199 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:32:58.568147 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:32:58.569193 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:32:58.569193 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:32:58.584260 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:32:58.587666 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:32:58.590668 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:32:58.590668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.590668 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:32:58.592172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:32:58.593174 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.593174 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.593174 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:32:58.594214 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:32:58.594770 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.594770 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:32:58.594770 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:32:58.595882 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:32:58.595882 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:32:58.634425 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m13:32:58.635503 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.635503 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:32:58.640682 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m13:32:58.640682 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.640682 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:32:58.643185 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m13:32:58.644224 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.644224 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:32:58.646444 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.010 seconds
[0m13:32:58.646444 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:32:58.654483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.655484 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m13:32:58.655484 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:32:58.655484 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.656636 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:32:58.658647 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.660670 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.662176 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:32:58.662176 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:32:58.662176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.663177 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:32:58.665200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.665200 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:32:58.665200 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:32:58.667721 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.667721 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:32:58.669097 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:32:58.669097 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:32:58.669097 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.672110 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.674144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.688709 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:32:58.688709 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:32:58.688709 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:32:58.689714 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:32:58.689714 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.691112 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:32:58.691112 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:32:58.692112 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.692112 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:58.692617 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:58.693120 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:32:58.694133 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:32:58.694133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.697136 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.698137 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.702827 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:32:58.703758 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:32:58.703758 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:32:58.703758 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:32:58.707899 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:32:58.710247 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:32:58.710247 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:32:58.711250 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:58.711250 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.713256 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:32:58.715326 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:32:58.717335 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:32:58.717335 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:32:58.717335 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:32:58.718339 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.718339 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:32:58.720345 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:32:58.720345 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:32:58.721730 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:32:58.722233 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:32:58.723235 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.724210 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:32:58.724210 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:32:58.726394 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:32:58.727806 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:32:58.728810 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A320FE330>]}
[0m13:32:58.728810 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:32:58.729885 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A321408C0>]}
[0m13:32:58.730897 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A320EC320>]}
[0m13:32:58.729885 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.20s]
[0m13:32:58.730897 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:32:58.730897 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:32:58.732918 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:32:58.732400 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.21s]
[0m13:32:58.733928 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:32:58.733928 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m13:32:58.733928 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:32:58.735414 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:32:58.735414 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m13:32:58.736522 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m13:32:58.735414 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:32:58.737555 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:32:58.737555 [info ] [Thread-2 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:32:58.738558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_order_payment)
[0m13:32:58.738558 [info ] [Thread-4 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:32:58.739638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:32:58.739638 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A320FB500>]}
[0m13:32:58.739638 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:32:58.739638 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m13:32:58.740914 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m13:32:58.743878 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:32:58.740914 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:32:58.743878 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m13:32:58.747111 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:32:58.747111 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:32:58.749454 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:32:58.750457 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m13:32:58.750457 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:32:58.750457 [info ] [Thread-3 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:32:58.754484 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:32:58.755487 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m13:32:58.755487 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m13:32:58.756506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m13:32:58.759005 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:32:58.764287 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:32:58.764287 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:32:58.764822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.767546 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:32:58.767546 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:32:58.768886 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.768886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:58.768886 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.770086 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m13:32:58.770086 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:32:58.770086 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m13:32:58.771089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:32:58.771089 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:32:58.774103 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:32:58.776153 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.776153 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:32:58.777261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:32:58.812922 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m13:32:58.812922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.813876 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:32:58.815766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:32:58.815766 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.815766 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:32:58.818084 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:32:58.821253 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.821253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:32:58.822254 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:32:58.822254 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:32:58.822758 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.825360 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.825360 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:32:58.825360 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.826365 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:32:58.828641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.828641 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:32:58.828641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.830930 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.831931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:32:58.831931 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:32:58.831931 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:32:58.833216 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:32:58.835803 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.835803 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.836811 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.836811 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:32:58.836811 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:32:58.837836 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:32:58.838839 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.838839 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.838839 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:32:58.839842 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.842663 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.844184 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:32:58.844184 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:32:58.845187 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:32:58.845187 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:32:58.847193 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:32:58.847193 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:32:58.848503 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.848503 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:32:58.849508 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:32:58.850512 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:32:58.850512 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:32:58.850512 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.852018 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m13:32:58.852018 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m13:32:58.853021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A320631D0>]}
[0m13:32:58.853904 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.853904 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:32:58.853524 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.11s]
[0m13:32:58.857628 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:32:58.858907 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m13:32:58.858907 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:32:58.859924 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:32:58.859924 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:32:58.860928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A32571730>]}
[0m13:32:58.860928 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:32:58.861928 [info ] [Thread-1 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:32:58.861928 [info ] [Thread-2 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m13:32:58.861928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.my_second_dbt_model)
[0m13:32:58.863390 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m13:32:58.863390 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:32:58.863390 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:32:58.865421 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m13:32:58.867616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:32:58.867616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A32572540>]}
[0m13:32:58.868620 [info ] [Thread-4 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:32:58.869650 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m13:32:58.869650 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:32:58.929424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:32:58.930512 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:32:58.930512 [debug] [Thread-3 (]: SQL status: BEGIN in 0.154 seconds
[0m13:32:58.932031 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:32:58.932031 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.932031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:58.933044 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:32:58.938391 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:32:58.940743 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.940743 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:32:58.943249 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:32:58.946754 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.946754 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:32:58.946754 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.949223 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:32:58.949223 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.949223 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:32:58.950223 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.952247 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:32:58.952247 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:32:58.953676 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:32:58.954662 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:32:58.956118 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m13:32:58.957119 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3207BAD0>]}
[0m13:32:58.957119 [info ] [Thread-3 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m13:32:58.958119 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m13:32:58.970739 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m13:32:58.972243 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:32:58.972243 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:32:58.977559 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:32:58.979565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:32:58.980567 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:32:58.980567 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:32:58.982070 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:32:58.982070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:32:58.983072 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:32:58.984110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:32:58.986190 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:32:58.986190 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:32:58.986190 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:32:58.987194 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:32:58.988197 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:32:58.988197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a46e0305-d01c-4dcf-b048-aea1c3d41b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A3254EB40>]}
[0m13:32:58.989200 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:32:58.990203 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:32:58.990203 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:58.991506 [debug] [MainThread]: On master: BEGIN
[0m13:32:58.992013 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:32:59.032082 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m13:32:59.033492 [debug] [MainThread]: On master: COMMIT
[0m13:32:59.033492 [debug] [MainThread]: Using postgres connection "master"
[0m13:32:59.033492 [debug] [MainThread]: On master: COMMIT
[0m13:32:59.033492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:32:59.033492 [debug] [MainThread]: On master: Close
[0m13:32:59.034945 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:59.034945 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:32:59.034945 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:32:59.035946 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:32:59.035946 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:32:59.035946 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:32:59.035946 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:32:59.035946 [info ] [MainThread]: 
[0m13:32:59.036946 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m13:32:59.039122 [debug] [MainThread]: Command end result
[0m13:32:59.063713 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:32:59.066795 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:32:59.072301 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:32:59.072301 [info ] [MainThread]: 
[0m13:32:59.072804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:59.073851 [info ] [MainThread]: 
[0m13:32:59.073851 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:32:59.074854 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:59.074854 after 2.18 seconds
[0m13:32:59.074854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F6901D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A2F690740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A32545B20>]}
[0m13:32:59.076094 [debug] [MainThread]: Flushing usage events
[0m13:33:00.750860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:07.785828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F56BA28D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F56AF4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F566A7FB0>]}


============================== 13:33:07.789944 | 74645547-437d-405f-8c22-cae0c6a736ba ==============================
[0m13:33:07.789944 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:33:07.789944 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt deps', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:33:07.924104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74645547-437d-405f-8c22-cae0c6a736ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F56F68980>]}
[0m13:33:07.955399 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:33:07.957609 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:33:07.959616 [debug] [MainThread]: Command `dbt deps` succeeded at 13:33:07.958612 after 0.27 seconds
[0m13:33:07.959616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F56CAA0F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F58479910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F56F68980>]}
[0m13:33:07.959616 [debug] [MainThread]: Flushing usage events
[0m13:33:09.364154 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:49.601931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F86182F00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F86028560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F85E9A300>]}


============================== 13:33:49.606366 | 3da41747-a372-4737-a97b-5adcaef92138 ==============================
[0m13:33:49.606366 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:33:49.606366 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True'}
[0m13:33:49.796530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F862FE5A0>]}
[0m13:33:49.850646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F87624C20>]}
[0m13:33:49.852150 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:33:50.244734 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:33:50.441936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:33:50.441936 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:33:50.481862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F8770AE70>]}
[0m13:33:50.558363 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:33:50.579273 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:33:50.622674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F87E55340>]}
[0m13:33:50.624200 [info ] [MainThread]: Found 9 models, 23 data tests, 9 sources, 447 macros
[0m13:33:50.624745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F87D02F60>]}
[0m13:33:50.628176 [info ] [MainThread]: 
[0m13:33:50.629241 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:50.629241 [info ] [MainThread]: 
[0m13:33:50.629241 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:33:50.634266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:33:50.785959 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:33:50.785959 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:33:50.785959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:50.940834 [debug] [ThreadPool]: SQL status: BEGIN in 0.155 seconds
[0m13:33:50.941834 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:33:50.942338 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:33:50.946153 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m13:33:50.948660 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:33:50.948660 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:33:50.954892 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:50.955892 [debug] [MainThread]: On master: BEGIN
[0m13:33:50.955892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:50.989630 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:33:50.989630 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:50.990700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:33:50.996565 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:33:50.998966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3da41747-a372-4737-a97b-5adcaef92138', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F87E56030>]}
[0m13:33:50.999969 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:50.999969 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:50.999969 [debug] [MainThread]: On master: BEGIN
[0m13:33:51.000972 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:33:51.000972 [debug] [MainThread]: On master: COMMIT
[0m13:33:51.000972 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:51.001973 [debug] [MainThread]: On master: COMMIT
[0m13:33:51.001973 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:51.001973 [debug] [MainThread]: On master: Close
[0m13:33:51.006080 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:33:51.006080 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:33:51.007081 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:51.007081 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:51.007081 [info ] [Thread-1 (]: 1 of 23 START test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [RUN]
[0m13:33:51.007081 [info ] [Thread-2 (]: 2 of 23 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:33:51.008380 [info ] [Thread-3 (]: 3 of 23 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:33:51.008380 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd'
[0m13:33:51.008380 [info ] [Thread-4 (]: 4 of 23 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:33:51.009409 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:33:51.009409 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:33:51.010411 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:33:51.010411 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:33:51.010411 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:33:51.010411 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:51.022085 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:51.029468 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:33:51.032976 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:51.037047 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:51.039371 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:51.039371 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:33:51.039371 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:51.054627 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:51.056797 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:33:51.059315 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:51.060450 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:51.060450 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:33:51.061962 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:33:51.061962 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:33:51.062972 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:51.062972 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:33:51.062972 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:33:51.064248 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:33:51.064248 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:33:51.066528 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:51.067758 [error] [Thread-1 (]: 1 of 23 ERROR dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [[31mERROR[0m in 0.06s]
[0m13:33:51.067758 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:33:51.068789 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:33:51.068789 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:33:51.070279 [info ] [Thread-1 (]: 5 of 23 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:33:51.071279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m13:33:51.071279 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:33:51.077796 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:33:51.081217 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:33:51.085536 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:33:51.087851 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:33:51.087851 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:33:51.088859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:33:51.110069 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:33:51.110069 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:33:51.111312 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.113716 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:51.117131 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:33:51.118138 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:33:51.118138 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m13:33:51.119205 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:33:51.119205 [info ] [Thread-3 (]: 3 of 23 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.11s]
[0m13:33:51.119205 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.120500 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:33:51.120500 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:33:51.120500 [info ] [Thread-3 (]: 6 of 23 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:33:51.120500 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:33:51.122002 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:33:51.126176 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:33:51.127267 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:33:51.130267 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:33:51.130267 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:33:51.131718 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:33:51.132222 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.134631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:33:51.134631 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:33:51.135687 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.174053 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m13:33:51.174053 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:33:51.175054 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.181313 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m13:33:51.181313 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.061 seconds
[0m13:33:51.182816 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:33:51.184347 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:33:51.185355 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:33:51.185355 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:33:51.186356 [info ] [Thread-4 (]: 4 of 23 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.18s]
[0m13:33:51.188357 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:33:51.187356 [info ] [Thread-1 (]: 5 of 23 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.12s]
[0m13:33:51.188357 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:33:51.189526 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:33:51.190528 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:33:51.190528 [info ] [Thread-4 (]: 7 of 23 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:33:51.192032 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:33:51.192032 [info ] [Thread-1 (]: 8 of 23 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:33:51.193035 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:33:51.193539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:33:51.197673 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:33:51.197673 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:33:51.202237 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:33:51.203742 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:33:51.206881 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:33:51.206881 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:33:51.211922 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:33:51.212997 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:33:51.212997 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:33:51.212997 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:33:51.214369 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:33:51.215375 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:33:51.215375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:51.223874 [debug] [Thread-2 (]: SQL status: BEGIN in 0.159 seconds
[0m13:33:51.223874 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:33:51.225075 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.226462 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:51.228806 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:33:51.229881 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:33:51.230970 [error] [Thread-2 (]: 2 of 23 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.22s]
[0m13:33:51.231973 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:33:51.231973 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:51.232976 [info ] [Thread-2 (]: 9 of 23 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:33:51.232976 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:33:51.234064 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:51.237510 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:51.237510 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.063 seconds
[0m13:33:51.239989 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:33:51.239989 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:33:51.241358 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:51.239989 [info ] [Thread-3 (]: 6 of 23 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.12s]
[0m13:33:51.243977 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:51.245168 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:33:51.245168 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:51.246529 [info ] [Thread-3 (]: 10 of 23 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:33:51.246529 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:33:51.247557 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:51.247557 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:51.252011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:51.252513 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:33:51.253016 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:33:51.254085 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:51.256097 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:51.258086 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:51.258086 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:33:51.258086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.264040 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m13:33:51.265137 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:33:51.265137 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.298781 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m13:33:51.298781 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:33:51.298781 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.302351 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m13:33:51.302853 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:33:51.302853 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.333043 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m13:33:51.334026 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.034 seconds
[0m13:33:51.335035 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:33:51.336036 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:33:51.337036 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:33:51.337036 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:33:51.337036 [info ] [Thread-3 (]: 10 of 23 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.09s]
[0m13:33:51.338367 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:33:51.338367 [info ] [Thread-2 (]: 9 of 23 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.11s]
[0m13:33:51.339369 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:33:51.339369 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:33:51.340427 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:33:51.340427 [info ] [Thread-3 (]: 11 of 23 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:33:51.340427 [info ] [Thread-2 (]: 12 of 23 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:33:51.341930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:33:51.341930 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:33:51.341930 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:33:51.342933 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:33:51.346475 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:33:51.349688 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:33:51.351959 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:33:51.351959 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:33:51.354147 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:33:51.355835 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:33:51.357993 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:33:51.357993 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:33:51.358993 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:33:51.358993 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.358993 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:33:51.358993 [debug] [Thread-4 (]: SQL status: BEGIN in 0.146 seconds
[0m13:33:51.360185 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:33:51.360185 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:33:51.361276 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.403646 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m13:33:51.403646 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:33:51.404771 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.415290 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.011 seconds
[0m13:33:51.416507 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.055 seconds
[0m13:33:51.417652 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:33:51.418767 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:33:51.418767 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:33:51.419818 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:33:51.419818 [info ] [Thread-3 (]: 11 of 23 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m13:33:51.420821 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:33:51.420821 [info ] [Thread-4 (]: 7 of 23 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.23s]
[0m13:33:51.422326 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:33:51.422896 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:33:51.422896 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.157 seconds
[0m13:33:51.424038 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:33:51.424038 [info ] [Thread-3 (]: 13 of 23 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:33:51.425065 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:33:51.426068 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:33:51.426068 [info ] [Thread-4 (]: 14 of 23 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:33:51.427072 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:33:51.427072 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:33:51.427072 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:33:51.435165 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:33:51.435165 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:33:51.435165 [info ] [Thread-1 (]: 8 of 23 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.24s]
[0m13:33:51.440738 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:33:51.440738 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:33:51.442240 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:33:51.442240 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:33:51.447531 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:33:51.443243 [info ] [Thread-1 (]: 15 of 23 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:33:51.447531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:33:51.448656 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:33:51.448656 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:33:51.450688 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:33:51.456268 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:33:51.457268 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:33:51.458268 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:33:51.458268 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.459268 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:33:51.459268 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:33:51.459268 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:33:51.461966 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:33:51.462969 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:33:51.463826 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:33:51.464947 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:33:51.464947 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:51.502836 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m13:33:51.503729 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:33:51.503729 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.506768 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m13:33:51.507794 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:33:51.507794 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.510956 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:33:51.511955 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:33:51.512459 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.512963 [debug] [Thread-2 (]: SQL status: BEGIN in 0.153 seconds
[0m13:33:51.514103 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:33:51.514103 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.517727 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:33:51.519759 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:33:51.520760 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:33:51.520760 [info ] [Thread-2 (]: 12 of 23 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.18s]
[0m13:33:51.522775 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:33:51.523788 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:51.524311 [info ] [Thread-2 (]: 16 of 23 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:33:51.525325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:33:51.525325 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:51.533841 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:51.535844 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:51.540845 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:51.542348 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:51.542860 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:33:51.543884 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:33:51.596936 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.084 seconds
[0m13:33:51.598937 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:33:51.600230 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:33:51.601474 [info ] [Thread-1 (]: 15 of 23 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.15s]
[0m13:33:51.601978 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:33:51.602981 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:33:51.603485 [info ] [Thread-1 (]: 17 of 23 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:33:51.604487 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:33:51.604487 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:33:51.613252 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:51.615520 [debug] [Thread-2 (]: SQL status: BEGIN in 0.072 seconds
[0m13:33:51.615520 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:33:51.616527 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:33:51.617528 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:33:51.620528 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:51.623537 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:51.623537 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:33:51.624539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:51.627540 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.123 seconds
[0m13:33:51.630577 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:33:51.632080 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:33:51.633083 [info ] [Thread-3 (]: 13 of 23 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.21s]
[0m13:33:51.634590 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:33:51.634590 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.127 seconds
[0m13:33:51.635590 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:51.637630 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:33:51.639630 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:33:51.638629 [info ] [Thread-3 (]: 18 of 23 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:33:51.640630 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:33:51.642136 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:51.647927 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:51.640630 [info ] [Thread-4 (]: 14 of 23 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.21s]
[0m13:33:51.649390 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:33:51.649390 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:33:51.650394 [info ] [Thread-4 (]: 19 of 23 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:33:51.650394 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:33:51.651899 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:51.652901 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:33:51.656431 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:51.662079 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:33:51.663085 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:51.664101 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:33:51.664101 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.665183 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:33:51.672072 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:33:51.674258 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:33:51.675565 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:33:51.675565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:33:51.682450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m13:33:51.682953 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:33:51.682953 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.685161 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:51.688536 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:33:51.689712 [debug] [Thread-1 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:33:51.690714 [info ] [Thread-1 (]: 17 of 23 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.09s]
[0m13:33:51.690714 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:33:51.692219 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:33:51.692219 [info ] [Thread-1 (]: 20 of 23 START test unique_stg_customers_customer_unique_id .................... [RUN]
[0m13:33:51.693221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4)
[0m13:33:51.693728 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:33:51.767363 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.151 seconds
[0m13:33:51.770394 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:33:51.770394 [debug] [Thread-4 (]: SQL status: BEGIN in 0.096 seconds
[0m13:33:51.772899 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:33:51.772899 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:33:51.772899 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.774366 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:33:51.775428 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:33:51.774366 [info ] [Thread-2 (]: 16 of 23 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.25s]
[0m13:33:51.780523 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:33:51.780523 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:33:51.782026 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:33:51.782026 [info ] [Thread-2 (]: 21 of 23 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:33:51.783027 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:33:51.783027 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:33:51.784096 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:33:51.789336 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:51.789336 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: BEGIN
[0m13:33:51.790359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:51.791366 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:33:51.795428 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:51.796432 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:51.796432 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:33:51.797536 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:33:51.833180 [debug] [Thread-3 (]: SQL status: BEGIN in 0.168 seconds
[0m13:33:51.833180 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:33:51.834196 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.836197 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:33:51.838425 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:33:51.838425 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:33:51.839428 [info ] [Thread-3 (]: 18 of 23 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.20s]
[0m13:33:51.840429 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:33:51.840429 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:33:51.841934 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:33:51.841934 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"
[0m13:33:51.843440 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_unique_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is not null
group by customer_unique_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.842937 [info ] [Thread-3 (]: 22 of 23 START test unique_stg_products_product_id ............................. [RUN]
[0m13:33:51.844012 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:33:51.844441 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:33:51.849443 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:33:51.850509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m13:33:51.850509 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:33:51.852013 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.852013 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:33:51.855978 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:33:51.858094 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:33:51.859097 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:33:51.860127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.913901 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m13:33:51.915050 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:33:51.915050 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:51.942150 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:33:51.943153 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:33:51.944231 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:33:51.945232 [info ] [Thread-3 (]: 22 of 23 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.10s]
[0m13:33:51.945232 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:33:51.946233 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:33:51.946233 [info ] [Thread-3 (]: 23 of 23 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:33:51.947233 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_products_product_id.7d950a1467, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:33:51.947233 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:33:51.950673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:33:51.953682 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:33:51.955694 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:33:51.957685 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:33:51.957685 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:33:51.957685 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:33:51.972890 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.120 seconds
[0m13:33:51.974904 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:33:51.974904 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:33:51.975904 [info ] [Thread-2 (]: 21 of 23 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m13:33:51.975904 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:33:51.978998 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.205 seconds
[0m13:33:51.980998 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:33:51.982512 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:33:51.983016 [error] [Thread-4 (]: 19 of 23 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.33s]
[0m13:33:51.983016 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:33:52.001902 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m13:33:52.002997 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:33:52.002997 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:33:52.007237 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:33:52.008237 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:33:52.008237 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:33:52.009515 [info ] [Thread-3 (]: 23 of 23 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.06s]
[0m13:33:52.009515 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:33:52.024194 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.181 seconds
[0m13:33:52.025204 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: ROLLBACK
[0m13:33:52.026321 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4: Close
[0m13:33:52.027326 [error] [Thread-1 (]: 20 of 23 FAIL 96096 unique_stg_customers_customer_unique_id .................... [[31mFAIL 96096[0m in 0.33s]
[0m13:33:52.027326 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4
[0m13:33:52.028326 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:52.029326 [debug] [MainThread]: On master: BEGIN
[0m13:33:52.029326 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:52.064279 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:33:52.064279 [debug] [MainThread]: On master: COMMIT
[0m13:33:52.064279 [debug] [MainThread]: Using postgres connection "master"
[0m13:33:52.065282 [debug] [MainThread]: On master: COMMIT
[0m13:33:52.065282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:33:52.065282 [debug] [MainThread]: On master: Close
[0m13:33:52.066284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:52.066284 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:33:52.066284 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_unique_id.cb125a52c4' was properly closed.
[0m13:33:52.066284 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:33:52.067284 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:33:52.067284 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:33:52.067284 [info ] [MainThread]: 
[0m13:33:52.067284 [info ] [MainThread]: Finished running 23 data tests in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m13:33:52.071371 [debug] [MainThread]: Command end result
[0m13:33:52.094948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:33:52.098125 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:33:52.104609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:33:52.104609 [info ] [MainThread]: 
[0m13:33:52.105610 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m13:33:52.105610 [info ] [MainThread]: 
[0m13:33:52.106752 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:33:52.106752 [info ] [MainThread]: 
[0m13:33:52.106752 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:33:52.107766 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:33:52.107766 [info ] [MainThread]: 
[0m13:33:52.107766 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:33:52.108771 [info ] [MainThread]: 
[0m13:33:52.108771 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:33:52.109785 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:33:52.109785 [info ] [MainThread]: 
[0m13:33:52.109785 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:33:52.109785 [info ] [MainThread]: 
[0m13:33:52.111224 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_unique_id (models\staging\_staging_test.yml)[0m
[0m13:33:52.111224 [error] [MainThread]:   Got 96096 results, configured to fail if != 0
[0m13:33:52.111224 [info ] [MainThread]: 
[0m13:33:52.112226 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_unique_id.sql
[0m13:33:52.112226 [info ] [MainThread]: 
[0m13:33:52.113228 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=4 SKIP=0 TOTAL=23
[0m13:33:52.114257 [debug] [MainThread]: Command `dbt test` failed at 13:33:52.114257 after 2.61 seconds
[0m13:33:52.114257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F85774230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F85774A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025F85774290>]}
[0m13:33:52.114257 [debug] [MainThread]: Flushing usage events
[0m13:33:53.525815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:42.668636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264856AB350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264883D8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264883D89E0>]}


============================== 13:34:42.672139 | 75ef832e-48e3-4de9-9e9c-fab2fb56570a ==============================
[0m13:34:42.672139 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:34:42.673142 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'target_path': 'None', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:34:42.863685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264885BBA10>]}
[0m13:34:42.917739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026488598530>]}
[0m13:34:42.919020 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:34:43.306039 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:34:43.497839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:43.498839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:43.536984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026487F20EC0>]}
[0m13:34:43.609987 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:34:43.627983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:34:43.659853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264885BBE00>]}
[0m13:34:43.659853 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:34:43.659853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026489AE4440>]}
[0m13:34:43.662859 [info ] [MainThread]: 
[0m13:34:43.663734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:43.663734 [info ] [MainThread]: 
[0m13:34:43.664882 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:43.668905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:34:43.818223 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:34:43.819224 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:34:43.819224 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:43.872044 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m13:34:43.873548 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:34:43.874862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:34:43.880153 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:34:43.881261 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:34:43.881261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:43.926461 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m13:34:43.927542 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:34:43.927542 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:43.936111 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.008 seconds
[0m13:34:43.937245 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:34:43.938360 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:34:43.944934 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:43.944934 [debug] [MainThread]: On master: BEGIN
[0m13:34:43.944934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:43.990710 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m13:34:43.990710 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:43.992214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:34:44.000021 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m13:34:44.003026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026488686240>]}
[0m13:34:44.004060 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:44.004060 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:44.004060 [debug] [MainThread]: On master: BEGIN
[0m13:34:44.005123 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:34:44.005123 [debug] [MainThread]: On master: COMMIT
[0m13:34:44.005123 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:44.005123 [debug] [MainThread]: On master: COMMIT
[0m13:34:44.006406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:44.006406 [debug] [MainThread]: On master: Close
[0m13:34:44.010989 [debug] [Thread-1 (]: Began running node model.dbt_project.my_first_dbt_model
[0m13:34:44.011989 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m13:34:44.011989 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:34:44.013027 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m13:34:44.013027 [info ] [Thread-1 (]: 1 of 9 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m13:34:44.013027 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m13:34:44.014296 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:34:44.015322 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.my_first_dbt_model'
[0m13:34:44.014296 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:34:44.015322 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:34:44.016432 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:34:44.016432 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_first_dbt_model
[0m13:34:44.016432 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:34:44.017488 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m13:34:44.017488 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:34:44.024827 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_first_dbt_model"
[0m13:34:44.025978 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:34:44.028024 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:34:44.031256 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:34:44.033775 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:34:44.034778 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_first_dbt_model
[0m13:34:44.034778 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m13:34:44.059185 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:34:44.059185 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:34:44.072399 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_first_dbt_model"
[0m13:34:44.094166 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:34:44.097871 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:34:44.100917 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:34:44.103201 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.104251 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.105259 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: BEGIN
[0m13:34:44.106261 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.106261 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:34:44.107262 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.107262 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:34:44.107262 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:34:44.108735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:44.108735 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:34:44.108735 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:44.109741 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:34:44.154138 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:34:44.154138 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.155295 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */

  
    

  create  table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:34:44.157452 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:34:44.158612 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.158612 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:34:44.159695 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m13:34:44.168911 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:34:44.168911 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.172566 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.172566 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m13:34:44.173068 [debug] [Thread-4 (]: SQL status: BEGIN in 0.063 seconds
[0m13:34:44.173068 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m13:34:44.173934 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:34:44.173934 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.173934 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.173934 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:34:44.175392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:44.175392 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:34:44.175392 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.178407 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.180410 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.180410 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:44.180410 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
alter table "ecommerce_raw"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:34:44.180410 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:34:44.183972 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.183972 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:34:44.185173 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:34:44.185173 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:44.185173 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.188560 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.203012 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:34:44.203515 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m13:34:44.204680 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:34:44.204680 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:34:44.204680 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.208022 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.208022 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.208022 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:34:44.209027 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:34:44.209027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.209027 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: COMMIT
[0m13:34:44.212749 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.213252 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:34:44.213252 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:34:44.214212 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:34:44.215391 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:34:44.215391 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:34:44.220398 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:34:44.220398 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.222912 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup"
[0m13:34:44.222912 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:34:44.228014 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:34:44.228014 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:34:44.231041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_first_dbt_model"
[0m13:34:44.232547 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:34:44.232547 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:34:44.233050 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_first_dbt_model"} */
drop table if exists "ecommerce_raw"."public"."my_first_dbt_model__dbt_backup" cascade
[0m13:34:44.233050 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.234027 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:34:44.234027 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:44.236354 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:34:44.236354 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:34:44.236354 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m13:34:44.237561 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:34:44.237561 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:34:44.239757 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:34:44.240761 [debug] [Thread-1 (]: On model.dbt_project.my_first_dbt_model: Close
[0m13:34:44.242771 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:34:44.242771 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:34:44.243903 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:34:44.244908 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:34:44.246122 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000264857AB680>]}
[0m13:34:44.247157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A3A7080>]}
[0m13:34:44.247157 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.247157 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.248315 [info ] [Thread-1 (]: 1 of 9 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.23s]
[0m13:34:44.249325 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m13:34:44.248315 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:34:44.250536 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m13:34:44.252039 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_first_dbt_model
[0m13:34:44.252039 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:34:44.253045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A2E6300>]}
[0m13:34:44.253045 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m13:34:44.253045 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A2E6A50>]}
[0m13:34:44.254184 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m13:34:44.254184 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m13:34:44.255187 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:34:44.255187 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.24s]
[0m13:34:44.256575 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m13:34:44.255187 [info ] [Thread-3 (]: 6 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m13:34:44.256575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.my_first_dbt_model, now model.dbt_project.stg_order_payment)
[0m13:34:44.257589 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:34:44.257589 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m13:34:44.258598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m13:34:44.258598 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:34:44.258598 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m13:34:44.259698 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m13:34:44.259698 [info ] [Thread-2 (]: 7 of 9 START sql view model public.stg_products ................................ [RUN]
[0m13:34:44.262811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:34:44.265721 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:34:44.262811 [info ] [Thread-4 (]: 8 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m13:34:44.265721 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_products)
[0m13:34:44.265721 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m13:34:44.267175 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m13:34:44.267175 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:34:44.270198 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:34:44.270198 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:34:44.273207 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:34:44.273207 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m13:34:44.276260 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:34:44.279622 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:34:44.280638 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m13:34:44.284071 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:34:44.285074 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m13:34:44.285074 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.288207 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:34:44.288207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.289240 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:34:44.289240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.290246 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:34:44.290246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:44.291260 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m13:34:44.291260 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.292249 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:44.292249 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:44.292249 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:34:44.293282 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:34:44.337490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m13:34:44.338779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m13:34:44.338779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.339788 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.339788 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:34:44.339788 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:34:44.340790 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m13:34:44.342293 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.342293 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:34:44.344887 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:44.345892 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:44.347901 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.349210 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m13:34:44.349210 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:34:44.351213 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.352217 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:34:44.352722 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.355260 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.355260 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:34:44.355260 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:34:44.356263 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:34:44.356263 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.358270 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.358270 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:34:44.359274 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:34:44.359274 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:34:44.361961 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.361961 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:44.364389 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.364389 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:34:44.364389 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:44.367419 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.367419 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:34:44.369522 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:34:44.369522 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.369522 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:34:44.370526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.370526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:44.372029 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:34:44.372029 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:34:44.373032 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:34:44.374133 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:34:44.374133 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.374133 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.377196 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.377196 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:34:44.378198 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:34:44.378198 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:34:44.378198 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:34:44.380459 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:34:44.381963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:34:44.381963 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:34:44.382966 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:44.382966 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:44.383904 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:34:44.385059 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:34:44.439740 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:34:44.440743 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:34:44.442247 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.443249 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:34:44.443249 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:34:44.443249 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.444296 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:34:44.444296 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:34:44.444296 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:34:44.446391 [debug] [Thread-1 (]: On model.dbt_project.stg_order_payment: Close
[0m13:34:44.446391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A2E6F60>]}
[0m13:34:44.447585 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:44.447585 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.447585 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.447585 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:34:44.449925 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:34:44.451938 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m13:34:44.451938 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m13:34:44.453281 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:34:44.453281 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:34:44.454299 [debug] [Thread-1 (]: Began running node model.dbt_project.my_second_dbt_model
[0m13:34:44.454299 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A37D460>]}
[0m13:34:44.454299 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A37F530>]}
[0m13:34:44.455548 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:34:44.455548 [info ] [Thread-1 (]: 9 of 9 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m13:34:44.456725 [info ] [Thread-2 (]: 7 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:34:44.456725 [info ] [Thread-3 (]: 6 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m13:34:44.457966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.my_second_dbt_model)
[0m13:34:44.457966 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m13:34:44.459032 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m13:34:44.459032 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:34:44.459032 [debug] [Thread-1 (]: Began compiling node model.dbt_project.my_second_dbt_model
[0m13:34:44.460343 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m13:34:44.463866 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.my_second_dbt_model"
[0m13:34:44.463866 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A7AC4D0>]}
[0m13:34:44.464890 [info ] [Thread-4 (]: 8 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m13:34:44.465896 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m13:34:44.465896 [debug] [Thread-1 (]: Began executing node model.dbt_project.my_second_dbt_model
[0m13:34:44.470324 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.my_second_dbt_model"
[0m13:34:44.471325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:34:44.471325 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: BEGIN
[0m13:34:44.472325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:44.514102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m13:34:44.514440 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:34:44.514440 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */

  create view "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "ecommerce_raw"."public"."my_first_dbt_model"
where id = 1
  );
[0m13:34:44.519608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:34:44.523117 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:34:44.523117 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
alter table "ecommerce_raw"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:34:44.524383 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:34:44.525389 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:34:44.525389 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:34:44.526391 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: COMMIT
[0m13:34:44.527395 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:34:44.529416 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup"
[0m13:34:44.529416 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.my_second_dbt_model"
[0m13:34:44.530419 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.my_second_dbt_model"} */
drop view if exists "ecommerce_raw"."public"."my_second_dbt_model__dbt_backup" cascade
[0m13:34:44.530419 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:34:44.531921 [debug] [Thread-1 (]: On model.dbt_project.my_second_dbt_model: Close
[0m13:34:44.532925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ef832e-48e3-4de9-9e9c-fab2fb56570a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002648A2EAD80>]}
[0m13:34:44.533428 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:34:44.533837 [debug] [Thread-1 (]: Finished running node model.dbt_project.my_second_dbt_model
[0m13:34:44.534838 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:44.535881 [debug] [MainThread]: On master: BEGIN
[0m13:34:44.535881 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:44.579459 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m13:34:44.579459 [debug] [MainThread]: On master: COMMIT
[0m13:34:44.580479 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:44.580479 [debug] [MainThread]: On master: COMMIT
[0m13:34:44.580479 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:44.580479 [debug] [MainThread]: On master: Close
[0m13:34:44.580479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:44.580479 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:34:44.581982 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:34:44.581982 [debug] [MainThread]: Connection 'model.dbt_project.my_second_dbt_model' was properly closed.
[0m13:34:44.581982 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:34:44.581982 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:34:44.582983 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:34:44.582983 [info ] [MainThread]: 
[0m13:34:44.583486 [info ] [MainThread]: Finished running 1 table model, 8 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:34:44.584631 [debug] [MainThread]: Command end result
[0m13:34:44.609281 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:34:44.613006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:34:44.618918 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:34:44.618918 [info ] [MainThread]: 
[0m13:34:44.618918 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:44.620135 [info ] [MainThread]: 
[0m13:34:44.620135 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:34:44.622138 [debug] [MainThread]: Command `dbt run` succeeded at 13:34:44.621138 after 2.05 seconds
[0m13:34:44.622138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026487966930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026487966180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026487967BF0>]}
[0m13:34:44.622138 [debug] [MainThread]: Flushing usage events
[0m13:34:46.310475 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:50.454830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427BECE7E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427C1CFD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427BD94170>]}


============================== 13:34:50.458860 | d2005c3c-180b-488d-8e80-c20bacf67ee2 ==============================
[0m13:34:50.458860 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:34:50.459866 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:34:50.652770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427C38B890>]}
[0m13:34:50.705837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427C7EA270>]}
[0m13:34:50.706840 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:34:51.097259 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:34:51.289458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:51.290462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:51.328129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427DA04A10>]}
[0m13:34:51.399906 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:34:51.418289 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:34:51.457794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427DFB8E30>]}
[0m13:34:51.458801 [info ] [MainThread]: Found 9 models, 22 data tests, 9 sources, 447 macros
[0m13:34:51.458801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427DC52750>]}
[0m13:34:51.461917 [info ] [MainThread]: 
[0m13:34:51.461917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:51.461917 [info ] [MainThread]: 
[0m13:34:51.463411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:51.467430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:34:51.614819 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:34:51.614819 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:34:51.615971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:51.656820 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m13:34:51.656820 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:34:51.656820 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:51.662887 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m13:34:51.663768 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:34:51.664781 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:34:51.670819 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:51.670819 [debug] [MainThread]: On master: BEGIN
[0m13:34:51.670819 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:51.705804 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:34:51.705804 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:51.706806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:34:51.712981 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m13:34:51.716000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2005c3c-180b-488d-8e80-c20bacf67ee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427C478620>]}
[0m13:34:51.716000 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:51.717013 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:51.717013 [debug] [MainThread]: On master: BEGIN
[0m13:34:51.717013 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:34:51.718017 [debug] [MainThread]: On master: COMMIT
[0m13:34:51.718017 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:51.718017 [debug] [MainThread]: On master: COMMIT
[0m13:34:51.719020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:51.719020 [debug] [MainThread]: On master: Close
[0m13:34:51.723031 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:34:51.723031 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:34:51.723886 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:34:51.723886 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:34:51.723886 [info ] [Thread-1 (]: 1 of 22 START test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [RUN]
[0m13:34:51.724902 [info ] [Thread-2 (]: 2 of 22 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m13:34:51.724902 [info ] [Thread-3 (]: 3 of 22 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m13:34:51.726116 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd'
[0m13:34:51.724902 [info ] [Thread-4 (]: 4 of 22 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:34:51.726116 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:34:51.727127 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_my_second_dbt_model_id.151b76d778'
[0m13:34:51.727127 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:34:51.728132 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:34:51.728132 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:34:51.728132 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:34:51.740269 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:34:51.747998 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:34:51.752009 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:34:51.756156 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:34:51.758633 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:34:51.775785 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:34:51.775785 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:34:51.778904 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:34:51.779907 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:34:51.781909 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:34:51.782412 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:34:51.782916 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m13:34:51.783928 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:51.783928 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:34:51.784994 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:34:51.784994 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m13:34:51.784994 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:34:51.786312 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:51.786312 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:34:51.789829 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:34:51.789829 [error] [Thread-1 (]: 1 of 22 ERROR dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [[31mERROR[0m in 0.06s]
[0m13:34:51.790855 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:34:51.790855 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:34:51.790855 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:34:51.792360 [info ] [Thread-1 (]: 5 of 22 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:34:51.793889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m13:34:51.793889 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:34:51.800423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:34:51.803433 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:34:51.808866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:34:51.810871 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:34:51.810871 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:34:51.812376 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:34:51.834462 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m13:34:51.835463 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m13:34:51.835463 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_second_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.837506 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:34:51.838509 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m13:34:51.842246 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m13:34:51.842246 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:34:51.843253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m13:34:51.843253 [debug] [Thread-3 (]: On test.dbt_project.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:34:51.843253 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from "ecommerce_raw"."public"."my_first_dbt_model"
where id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.844376 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:34:51.845378 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.844376 [info ] [Thread-3 (]: 3 of 22 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 0.12s]
[0m13:34:51.845378 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m13:34:51.846624 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:34:51.846624 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:34:51.848977 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m13:34:51.848977 [info ] [Thread-3 (]: 6 of 22 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:34:51.849978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m13:34:51.850481 [debug] [Thread-2 (]: On test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:34:51.850481 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:34:51.856502 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:34:51.856502 [error] [Thread-2 (]: 2 of 22 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 0.13s]
[0m13:34:51.857577 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:34:51.857577 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:34:51.858576 [info ] [Thread-2 (]: 7 of 22 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:34:51.858576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:34:51.859588 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:34:51.859588 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:34:51.863176 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:34:51.863176 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:34:51.867222 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:34:51.868237 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:34:51.868237 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.868237 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:34:51.869618 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:34:51.869618 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:51.870626 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:34:51.874719 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:34:51.874719 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:34:51.876752 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:34:51.877755 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:34:51.879032 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:34:51.879032 [info ] [Thread-4 (]: 4 of 22 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.15s]
[0m13:34:51.880079 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:34:51.881189 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:34:51.881189 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:51.882692 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:34:51.883196 [info ] [Thread-4 (]: 8 of 22 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:34:51.884207 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:34:51.885209 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:34:51.889311 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:34:51.890465 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:34:51.897647 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:34:51.897647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:34:51.899661 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:34:51.899661 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:34:51.900683 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:34:51.900683 [info ] [Thread-1 (]: 5 of 22 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.11s]
[0m13:34:51.902187 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:34:51.903190 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:34:51.903696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:34:51.903696 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:34:51.904699 [info ] [Thread-1 (]: 9 of 22 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:34:51.904699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:34:51.904699 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:34:51.909296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:34:51.910489 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:34:51.914193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:34:51.916665 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:34:51.917665 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:34:51.917665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:51.921952 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:34:51.921952 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:34:51.921952 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.930554 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:34:51.930554 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:34:51.932058 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.956578 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m13:34:51.956578 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:34:51.957579 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.969530 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:34:51.970529 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:34:51.970529 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:51.998086 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.075 seconds
[0m13:34:51.999090 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m13:34:52.000096 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:34:52.001098 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:34:52.002100 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:34:52.003106 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:34:52.004057 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:34:52.004057 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:34:52.005090 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:34:52.004057 [info ] [Thread-3 (]: 6 of 22 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.15s]
[0m13:34:52.006104 [info ] [Thread-2 (]: 7 of 22 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.15s]
[0m13:34:52.007320 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:34:52.006104 [info ] [Thread-1 (]: 9 of 22 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.10s]
[0m13:34:52.007320 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:34:52.008330 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:34:52.009395 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:34:52.009395 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:34:52.010396 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:34:52.009395 [info ] [Thread-3 (]: 10 of 22 START test not_null_stg_orders_order_id ............................... [RUN]
[0m13:34:52.010396 [info ] [Thread-2 (]: 11 of 22 START test not_null_stg_products_product_id ........................... [RUN]
[0m13:34:52.011619 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:34:52.010396 [info ] [Thread-1 (]: 12 of 22 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:34:52.012122 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:34:52.012122 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:34:52.013132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:34:52.013132 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:34:52.017621 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:34:52.018633 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:34:52.022151 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:34:52.023152 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.065 seconds
[0m13:34:52.026488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:34:52.027521 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:34:52.028531 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:34:52.029536 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:34:52.030576 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:34:52.033604 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:34:52.033604 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:34:52.033090 [info ] [Thread-4 (]: 8 of 22 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.15s]
[0m13:34:52.036680 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:34:52.038689 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:34:52.039694 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:34:52.039694 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:34:52.040694 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:34:52.040694 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:34:52.042199 [info ] [Thread-4 (]: 13 of 22 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:34:52.043209 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:52.043209 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:34:52.044245 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:34:52.044554 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:34:52.044554 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:34:52.045253 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:34:52.045253 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:34:52.046275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:52.046275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:52.055005 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:34:52.058035 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:34:52.060425 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:34:52.061934 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:34:52.062938 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:34:52.063441 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:34:52.093243 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m13:34:52.094242 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:34:52.094242 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.102404 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m13:34:52.102908 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:34:52.102908 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.104931 [debug] [Thread-2 (]: SQL status: BEGIN in 0.059 seconds
[0m13:34:52.104931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:34:52.105934 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:34:52.106950 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:34:52.106950 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.107953 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:34:52.108975 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.014 seconds
[0m13:34:52.107953 [info ] [Thread-1 (]: 12 of 22 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.10s]
[0m13:34:52.109991 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:34:52.111287 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:34:52.112287 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:34:52.112789 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:34:52.112789 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:34:52.112789 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:34:52.113694 [info ] [Thread-1 (]: 14 of 22 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:34:52.114708 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.113694 [info ] [Thread-3 (]: 10 of 22 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.10s]
[0m13:34:52.114708 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:34:52.115711 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:34:52.115711 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:34:52.116714 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:34:52.123361 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:34:52.124377 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m13:34:52.124377 [info ] [Thread-3 (]: 15 of 22 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:34:52.126764 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:34:52.126764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:34:52.127773 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:34:52.128856 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:34:52.128856 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:34:52.135924 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:34:52.137962 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:34:52.138967 [info ] [Thread-2 (]: 11 of 22 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.13s]
[0m13:34:52.139972 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:34:52.139972 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:34:52.143013 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:34:52.143013 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:34:52.141006 [info ] [Thread-2 (]: 16 of 22 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:34:52.144029 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:34:52.147544 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:34:52.147544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:34:52.148751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:52.148751 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:34:52.155432 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:34:52.156497 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:34:52.157728 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:34:52.157728 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:52.158948 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:34:52.163031 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:34:52.164090 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:34:52.165156 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:34:52.165156 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:52.196516 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m13:34:52.196516 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:34:52.197533 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.203562 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m13:34:52.204823 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:34:52.204823 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.209838 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:34:52.211195 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:34:52.211195 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:34:52.275262 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.159 seconds
[0m13:34:52.277262 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:34:52.277262 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:34:52.278510 [info ] [Thread-4 (]: 13 of 22 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.23s]
[0m13:34:52.279512 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:34:52.279512 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:34:52.280522 [info ] [Thread-4 (]: 17 of 22 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m13:34:52.280522 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m13:34:52.282026 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:34:52.290350 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:34:52.291359 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.085 seconds
[0m13:34:52.292862 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:34:52.292862 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:34:52.293876 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:34:52.293876 [info ] [Thread-3 (]: 15 of 22 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.17s]
[0m13:34:52.298836 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:34:52.298836 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.101 seconds
[0m13:34:52.299841 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:34:52.301016 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:34:52.302019 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:34:52.303022 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:34:52.303022 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:34:52.302019 [info ] [Thread-3 (]: 18 of 22 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m13:34:52.304162 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m13:34:52.304708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:34:52.305908 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:34:52.304708 [info ] [Thread-1 (]: 14 of 22 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.19s]
[0m13:34:52.305908 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:34:52.306945 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:34:52.310994 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:34:52.311995 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:34:52.311995 [info ] [Thread-1 (]: 19 of 22 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:34:52.313160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:34:52.313160 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:34:52.319349 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:34:52.320355 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:34:52.323872 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:34:52.324392 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:34:52.327540 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:34:52.328723 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:34:52.329734 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m13:34:52.329734 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:52.330745 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:34:52.330745 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:34:52.330745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:52.340649 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.128 seconds
[0m13:34:52.343157 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:34:52.343660 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:34:52.344357 [info ] [Thread-2 (]: 16 of 22 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.20s]
[0m13:34:52.346405 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:34:52.347404 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:34:52.347404 [info ] [Thread-2 (]: 20 of 22 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:34:52.348418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:34:52.348418 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:34:52.409342 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:34:52.409342 [debug] [Thread-4 (]: SQL status: BEGIN in 0.104 seconds
[0m13:34:52.410345 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m13:34:52.410345 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m13:34:52.411348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.081 seconds
[0m13:34:52.411348 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:34:52.411348 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.412347 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:34:52.412850 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:34:52.412850 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.413863 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.415430 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:34:52.416433 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:34:52.417435 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m13:34:52.417435 [debug] [Thread-4 (]: On test.dbt_project.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:34:52.418440 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:34:52.418440 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:34:52.420450 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m13:34:52.420450 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:34:52.420450 [info ] [Thread-4 (]: 17 of 22 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.14s]
[0m13:34:52.421953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:52.421953 [debug] [Thread-3 (]: On test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:34:52.422957 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m13:34:52.422957 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:34:52.424087 [info ] [Thread-3 (]: 18 of 22 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.12s]
[0m13:34:52.424087 [info ] [Thread-4 (]: 21 of 22 START test unique_stg_products_product_id ............................. [RUN]
[0m13:34:52.425153 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m13:34:52.425153 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:34:52.426156 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:34:52.426156 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:34:52.431239 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:34:52.426156 [info ] [Thread-3 (]: 22 of 22 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:34:52.431239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_my_second_dbt_model_id.57a0f8c493, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:34:52.432239 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:34:52.438825 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:34:52.438825 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:34:52.440835 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:34:52.442338 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:34:52.444902 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:34:52.445905 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:34:52.445905 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:34:52.445905 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:34:52.446909 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:34:52.446909 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:34:52.447912 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:34:52.472766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m13:34:52.473683 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:34:52.473683 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.489022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m13:34:52.489022 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:34:52.489022 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.493943 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m13:34:52.493943 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:34:52.494959 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:34:52.499091 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:34:52.500095 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:34:52.501098 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:34:52.501098 [info ] [Thread-3 (]: 22 of 22 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.07s]
[0m13:34:52.502100 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:34:52.513360 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m13:34:52.515112 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:34:52.516121 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:34:52.517122 [info ] [Thread-4 (]: 21 of 22 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:34:52.517122 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:34:52.557127 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.083 seconds
[0m13:34:52.559132 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:34:52.559132 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:34:52.560396 [info ] [Thread-2 (]: 20 of 22 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.21s]
[0m13:34:52.560396 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:34:52.574452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.158 seconds
[0m13:34:52.576999 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:34:52.576999 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:34:52.578002 [error] [Thread-1 (]: 19 of 22 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.26s]
[0m13:34:52.578002 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:34:52.580016 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.580016 [debug] [MainThread]: On master: BEGIN
[0m13:34:52.580016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:52.614925 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:34:52.614925 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.615929 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:52.615929 [debug] [MainThread]: On master: COMMIT
[0m13:34:52.615929 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:52.616946 [debug] [MainThread]: On master: Close
[0m13:34:52.616946 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:52.616946 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:34:52.617949 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:34:52.617949 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:34:52.617949 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:34:52.617949 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:34:52.618952 [info ] [MainThread]: 
[0m13:34:52.618952 [info ] [MainThread]: Finished running 22 data tests in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m13:34:52.621965 [debug] [MainThread]: Command end result
[0m13:34:52.645800 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:34:52.648826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:34:52.655082 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:34:52.655082 [info ] [MainThread]: 
[0m13:34:52.656086 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:34:52.656086 [info ] [MainThread]: 
[0m13:34:52.657088 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:34:52.657088 [info ] [MainThread]: 
[0m13:34:52.658269 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:34:52.658269 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:34:52.658269 [info ] [MainThread]: 
[0m13:34:52.659275 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:34:52.659275 [info ] [MainThread]: 
[0m13:34:52.659275 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:34:52.660278 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:34:52.660278 [info ] [MainThread]: 
[0m13:34:52.661286 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:34:52.661286 [info ] [MainThread]: 
[0m13:34:52.661286 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=3 SKIP=0 TOTAL=22
[0m13:34:52.662791 [debug] [MainThread]: Command `dbt test` failed at 13:34:52.662791 after 2.31 seconds
[0m13:34:52.663701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427B7B73E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427B7B7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002427C1CFD10>]}
[0m13:34:52.663701 [debug] [MainThread]: Flushing usage events
[0m13:34:54.055728 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:15.679577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B3163890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B30A0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B536F950>]}


============================== 13:36:15.684228 | 435f42b3-3cfa-4d48-a001-6682b20a97bd ==============================
[0m13:36:15.684228 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:36:15.684228 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:36:15.889064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B601BA10>]}
[0m13:36:15.942923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B5DD2CF0>]}
[0m13:36:15.944932 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:36:16.338774 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:36:16.533807 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 0 files changed.
[0m13:36:16.534816 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\example\my_first_dbt_model.sql
[0m13:36:16.534816 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\example\my_second_dbt_model.sql
[0m13:36:16.609611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B74F87D0>]}
[0m13:36:16.684863 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:36:16.702916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:36:16.735290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B775BA10>]}
[0m13:36:16.736290 [info ] [MainThread]: Found 7 models, 18 data tests, 9 sources, 447 macros
[0m13:36:16.736290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B7364C80>]}
[0m13:36:16.738673 [info ] [MainThread]: 
[0m13:36:16.738673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:16.739725 [info ] [MainThread]: 
[0m13:36:16.739725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:16.744189 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:36:16.900481 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:36:16.901984 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:36:16.901984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:16.947331 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.045 seconds
[0m13:36:16.948600 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:36:16.949664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:36:16.954712 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:36:16.955715 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:36:16.955715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:16.994675 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m13:36:16.995687 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:36:16.995687 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:36:17.004802 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.009 seconds
[0m13:36:17.006834 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:36:17.006834 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:36:17.014103 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.014557 [debug] [MainThread]: On master: BEGIN
[0m13:36:17.014557 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:17.052083 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m13:36:17.052083 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.053086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:36:17.060425 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m13:36:17.062930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B72A8D70>]}
[0m13:36:17.062930 [debug] [MainThread]: On master: ROLLBACK
[0m13:36:17.063803 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.063803 [debug] [MainThread]: On master: BEGIN
[0m13:36:17.063803 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:36:17.063803 [debug] [MainThread]: On master: COMMIT
[0m13:36:17.063803 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.065530 [debug] [MainThread]: On master: COMMIT
[0m13:36:17.065530 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:36:17.065530 [debug] [MainThread]: On master: Close
[0m13:36:17.069543 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m13:36:17.069543 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:36:17.070543 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m13:36:17.070543 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m13:36:17.070543 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:36:17.070543 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:36:17.072046 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:36:17.073048 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:36:17.072046 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:36:17.073048 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:36:17.074183 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:36:17.074183 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m13:36:17.074183 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m13:36:17.075255 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:36:17.075255 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:36:17.081258 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:36:17.082258 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:36:17.084326 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:36:17.086858 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:36:17.090290 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:36:17.091304 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m13:36:17.120404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:36:17.121908 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:36:17.121908 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:36:17.125423 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:36:17.126423 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:36:17.129526 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:36:17.129526 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.133546 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:36:17.133546 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:36:17.133546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.134982 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:17.135981 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:36:17.135981 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.136982 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.136982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:17.136982 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:36:17.138004 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:36:17.138004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:36:17.138004 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:17.181077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:36:17.182077 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.182580 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:36:17.184053 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:36:17.184053 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.184053 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:36:17.187781 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:36:17.194273 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.194273 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:36:17.195276 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:36:17.197539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.197539 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m13:36:17.197539 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:36:17.198840 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.198840 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:36:17.198840 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:36:17.201915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.201915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:36:17.201915 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:36:17.204073 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.205077 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:36:17.205077 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.212112 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:36:17.212112 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:36:17.219692 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:36:17.220695 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:36:17.224306 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.225309 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.225309 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.226311 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:36:17.226311 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:36:17.226311 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:36:17.227614 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:36:17.229701 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.230706 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:36:17.230706 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m13:36:17.230706 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:36:17.235716 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:36:17.238129 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:36:17.242148 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:36:17.242652 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:36:17.243155 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:36:17.243155 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:36:17.244282 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:36:17.245283 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:36:17.245283 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.245283 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:36:17.246358 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:36:17.247373 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:36:17.247373 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:36:17.249380 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:36:17.250393 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m13:36:17.252899 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:36:17.252899 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:36:17.255021 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:36:17.256063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B324BBC0>]}
[0m13:36:17.256063 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B7CF2EA0>]}
[0m13:36:17.257066 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:36:17.257066 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:36:17.258371 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m13:36:17.257066 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:36:17.259862 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m13:36:17.259862 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:36:17.260879 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B7D04C50>]}
[0m13:36:17.260879 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m13:36:17.260879 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m13:36:17.262383 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m13:36:17.262894 [info ] [Thread-1 (]: 5 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m13:36:17.263903 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:36:17.262894 [info ] [Thread-2 (]: 6 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:36:17.263903 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:36:17.263903 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m13:36:17.265407 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m13:36:17.265407 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m13:36:17.266422 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m13:36:17.266422 [info ] [Thread-3 (]: 7 of 7 START sql view model public.stg_sellers ................................. [RUN]
[0m13:36:17.268423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:36:17.270541 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:36:17.272045 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m13:36:17.272045 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:36:17.275260 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:36:17.276479 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m13:36:17.276479 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m13:36:17.281371 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:36:17.283888 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:36:17.284891 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m13:36:17.288919 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:36:17.290335 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.290335 [debug] [Thread-4 (]: SQL status: BEGIN in 0.152 seconds
[0m13:36:17.290335 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:36:17.291492 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.291997 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.291997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:17.291997 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.293004 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m13:36:17.293507 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:36:17.293897 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:36:17.293897 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:17.294509 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:17.300298 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:36:17.304119 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.304119 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:36:17.305159 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:36:17.309532 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.309532 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:36:17.310936 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:36:17.311940 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:36:17.312942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.312942 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:36:17.314107 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:36:17.316260 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:36:17.317265 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:36:17.317265 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:36:17.319275 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:36:17.320279 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m13:36:17.320279 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B7D08140>]}
[0m13:36:17.321286 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m13:36:17.322285 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:36:17.338821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m13:36:17.338821 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.340236 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:36:17.342290 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:36:17.342804 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.342804 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:36:17.344913 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:36:17.347975 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.348975 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:36:17.348975 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:36:17.352081 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.352081 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:36:17.352081 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.352081 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.355681 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.357695 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.357695 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:36:17.358698 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:36:17.358698 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.359729 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:36:17.360935 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:36:17.361935 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:36:17.362439 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.362942 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.362942 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m13:36:17.362942 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:36:17.363956 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:36:17.365460 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:36:17.366474 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:36:17.366474 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:36:17.368506 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:36:17.369579 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:36:17.369579 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:36:17.369579 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:36:17.370582 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:36:17.370582 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:36:17.372086 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m13:36:17.373087 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m13:36:17.374204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B7D05820>]}
[0m13:36:17.374204 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B824B890>]}
[0m13:36:17.375207 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m13:36:17.376211 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m13:36:17.376211 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m13:36:17.377214 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m13:36:17.440021 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m13:36:17.441024 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.441024 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:36:17.446340 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:36:17.448345 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.449348 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:36:17.449348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.452361 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.452361 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:36:17.452864 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m13:36:17.453876 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:36:17.454878 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.454878 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:36:17.455878 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:36:17.459016 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:36:17.459016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:36:17.460020 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:36:17.461033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:36:17.462033 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m13:36:17.463066 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '435f42b3-3cfa-4d48-a001-6682b20a97bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B824B890>]}
[0m13:36:17.463066 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m13:36:17.464077 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m13:36:17.465586 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.465586 [debug] [MainThread]: On master: BEGIN
[0m13:36:17.465586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:17.610018 [debug] [MainThread]: SQL status: BEGIN in 0.145 seconds
[0m13:36:17.611021 [debug] [MainThread]: On master: COMMIT
[0m13:36:17.611021 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:17.611021 [debug] [MainThread]: On master: COMMIT
[0m13:36:17.612021 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:36:17.612021 [debug] [MainThread]: On master: Close
[0m13:36:17.612021 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:17.612021 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:36:17.613096 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:36:17.613096 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:36:17.613096 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:36:17.614070 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:36:17.614070 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m13:36:17.614070 [info ] [MainThread]: 
[0m13:36:17.614070 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m13:36:17.616147 [debug] [MainThread]: Command end result
[0m13:36:17.685708 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:36:17.688709 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:36:17.695038 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:36:17.695038 [info ] [MainThread]: 
[0m13:36:17.695038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:36:17.696383 [info ] [MainThread]: 
[0m13:36:17.696383 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:36:17.697578 [debug] [MainThread]: Command `dbt run` succeeded at 13:36:17.697578 after 2.12 seconds
[0m13:36:17.698577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B3765340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B58E3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6B58E3170>]}
[0m13:36:17.698577 [debug] [MainThread]: Flushing usage events
[0m13:36:19.397221 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:23.582991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D7125A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23B86A4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23B86A780>]}


============================== 13:36:23.586915 | e3c04bd7-e559-4c98-8215-54592cb6367c ==============================
[0m13:36:23.586915 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:36:23.587922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:36:23.779465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23DBF2510>]}
[0m13:36:23.832254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D4A3B00>]}
[0m13:36:23.834768 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:36:24.228040 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:36:24.427356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:36:24.428358 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:36:24.466495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23F1D87D0>]}
[0m13:36:24.538178 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:36:24.557329 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:36:24.595839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23F747560>]}
[0m13:36:24.595839 [info ] [MainThread]: Found 7 models, 18 data tests, 9 sources, 447 macros
[0m13:36:24.596855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D3AD190>]}
[0m13:36:24.599880 [info ] [MainThread]: 
[0m13:36:24.599880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:36:24.599880 [info ] [MainThread]: 
[0m13:36:24.600883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:36:24.604969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:36:24.752859 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:36:24.752859 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:36:24.753870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:36:24.801334 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m13:36:24.802335 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:36:24.802838 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:36:24.809464 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m13:36:24.810948 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:36:24.811946 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:36:24.818440 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:24.818440 [debug] [MainThread]: On master: BEGIN
[0m13:36:24.818440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:36:24.858693 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m13:36:24.858693 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:24.859698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:36:24.868568 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m13:36:24.870944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c04bd7-e559-4c98-8215-54592cb6367c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23DCB8680>]}
[0m13:36:24.871944 [debug] [MainThread]: On master: ROLLBACK
[0m13:36:24.871944 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:24.871944 [debug] [MainThread]: On master: BEGIN
[0m13:36:24.871944 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:36:24.873282 [debug] [MainThread]: On master: COMMIT
[0m13:36:24.873282 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:24.873282 [debug] [MainThread]: On master: COMMIT
[0m13:36:24.873282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:36:24.874299 [debug] [MainThread]: On master: Close
[0m13:36:24.878329 [debug] [Thread-1 (]: Began running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:36:24.878329 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:36:24.878329 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:36:24.879335 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:36:24.879335 [info ] [Thread-1 (]: 1 of 18 START test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [RUN]
[0m13:36:24.879335 [info ] [Thread-2 (]: 2 of 18 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:36:24.880340 [info ] [Thread-3 (]: 3 of 18 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:36:24.880340 [info ] [Thread-4 (]: 4 of 18 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:36:24.881487 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd'
[0m13:36:24.881991 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:36:24.881991 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m13:36:24.881991 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m13:36:24.882994 [debug] [Thread-1 (]: Began compiling node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:36:24.883499 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:36:24.883499 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:36:24.883499 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:36:24.902809 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:36:24.905837 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:36:24.908863 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:36:24.910941 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:36:24.911964 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:36:24.929244 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:36:24.932249 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:36:24.932249 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:36:24.934270 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:36:24.935348 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:36:24.936353 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:36:24.936353 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:36:24.937365 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:36:24.937365 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:36:24.937365 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:36:24.938370 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:36:24.938370 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:36:24.939394 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:36:24.941900 [debug] [Thread-1 (]: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:24.941900 [error] [Thread-1 (]: 1 of 18 ERROR dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id  [[31mERROR[0m in 0.06s]
[0m13:36:24.943422 [debug] [Thread-1 (]: Finished running node test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd
[0m13:36:24.943422 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:36:24.944440 [debug] [Thread-7 (]: Marking all children of 'test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd' to be skipped because of status 'error'.  Reason: Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:36:24.944440 [info ] [Thread-1 (]: 5 of 18 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:36:24.945448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id.91a93849cd, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:36:24.946461 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:36:24.950672 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:36:24.953684 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:36:24.956719 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:36:24.958742 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:36:24.959743 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:36:24.960743 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:36:24.985805 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m13:36:24.985805 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:36:24.986806 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:24.987309 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:36:24.988312 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:36:24.988312 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:24.990321 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m13:36:24.991573 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:36:24.992076 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.004832 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m13:36:25.005837 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:36:25.006837 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.013215 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:36:25.019974 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:36:25.020974 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.029 seconds
[0m13:36:25.022980 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:36:25.022980 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:36:25.025425 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:36:25.024422 [info ] [Thread-2 (]: 2 of 18 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.14s]
[0m13:36:25.026426 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:36:25.027427 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:36:25.027427 [info ] [Thread-3 (]: 3 of 18 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.14s]
[0m13:36:25.029427 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:36:25.028426 [info ] [Thread-2 (]: 6 of 18 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:36:25.030427 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:36:25.030427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:36:25.031932 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:36:25.031932 [info ] [Thread-3 (]: 7 of 18 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:36:25.038794 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:36:25.039798 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:36:25.039798 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:36:25.046573 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:36:25.047607 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:36:25.050611 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:36:25.052115 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:36:25.056635 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:36:25.057641 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:36:25.058642 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.070 seconds
[0m13:36:25.059642 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:36:25.060643 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:36:25.062146 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:25.063149 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:36:25.064326 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:36:25.064326 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:36:25.065518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:25.065518 [info ] [Thread-4 (]: 4 of 18 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.18s]
[0m13:36:25.066606 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:36:25.067606 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:36:25.067606 [info ] [Thread-4 (]: 8 of 18 START test not_null_stg_orders_order_id ................................ [RUN]
[0m13:36:25.067606 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:36:25.068910 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:36:25.072928 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:36:25.075008 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:36:25.075008 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m13:36:25.079247 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:36:25.081277 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:36:25.082794 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:36:25.084082 [info ] [Thread-1 (]: 5 of 18 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.14s]
[0m13:36:25.084649 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:36:25.085691 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:36:25.085691 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:36:25.086671 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:36:25.087952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:25.086671 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_products_product_id ............................ [RUN]
[0m13:36:25.087952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:36:25.089126 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:36:25.095170 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:36:25.097194 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:36:25.101201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:36:25.103316 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:36:25.103316 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:36:25.104337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:25.118922 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m13:36:25.118922 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m13:36:25.118922 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:36:25.119933 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:36:25.119933 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.120933 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.138527 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m13:36:25.139527 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:36:25.139527 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.146751 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m13:36:25.147754 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:36:25.148759 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:36:25.149762 [info ] [Thread-3 (]: 7 of 18 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.11s]
[0m13:36:25.150762 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:36:25.150762 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:36:25.150762 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:36:25.152782 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:36:25.152267 [info ] [Thread-3 (]: 10 of 18 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:36:25.152782 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.153885 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:36:25.153885 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:36:25.157901 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:36:25.158908 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m13:36:25.161166 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:36:25.161166 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:36:25.163172 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:36:25.162170 [info ] [Thread-4 (]: 8 of 18 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.09s]
[0m13:36:25.166306 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:36:25.167509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m13:36:25.167509 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:36:25.169518 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:36:25.169518 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:36:25.170525 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:36:25.170525 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:36:25.170525 [info ] [Thread-4 (]: 11 of 18 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:36:25.170525 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:36:25.172029 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:36:25.173539 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.052 seconds
[0m13:36:25.173539 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:25.173035 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.08s]
[0m13:36:25.173539 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:36:25.176552 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:36:25.176552 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:36:25.184562 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:36:25.185563 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:36:25.185563 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:36:25.186563 [info ] [Thread-1 (]: 12 of 18 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:36:25.188067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:36:25.187066 [info ] [Thread-2 (]: 6 of 18 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.16s]
[0m13:36:25.189068 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:36:25.189068 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:36:25.190207 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:36:25.197277 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:36:25.200286 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:36:25.200286 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:36:25.201294 [info ] [Thread-2 (]: 13 of 18 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:36:25.202294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:36:25.202799 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:36:25.202799 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:36:25.207934 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:36:25.207934 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:36:25.210019 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:36:25.211021 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:36:25.211021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:25.212022 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:36:25.214582 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:36:25.215585 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:36:25.215585 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:36:25.216589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:25.216589 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:36:25.217592 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:36:25.217592 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:25.223153 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m13:36:25.223657 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:36:25.223657 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.227660 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:36:25.229660 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:36:25.230660 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:36:25.232164 [info ] [Thread-3 (]: 10 of 18 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m13:36:25.233167 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:36:25.233671 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:36:25.234194 [info ] [Thread-3 (]: 14 of 18 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:36:25.235051 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:36:25.236068 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:36:25.241172 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:36:25.243343 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:36:25.247533 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:36:25.248536 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:36:25.249544 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:36:25.249544 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:25.258890 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m13:36:25.259904 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:36:25.259904 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.268331 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m13:36:25.269490 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:36:25.269490 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.297850 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:36:25.298865 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:36:25.298865 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.339926 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.070 seconds
[0m13:36:25.342429 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:36:25.342931 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:36:25.342931 [info ] [Thread-2 (]: 13 of 18 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.14s]
[0m13:36:25.343946 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:36:25.345073 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:36:25.345073 [info ] [Thread-2 (]: 15 of 18 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:36:25.346084 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:36:25.347132 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:36:25.354479 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:36:25.356170 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:36:25.359204 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:36:25.361218 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:36:25.361218 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:36:25.362222 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:36:25.364329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m13:36:25.364329 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:36:25.364329 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:36:25.368708 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.108 seconds
[0m13:36:25.370711 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:36:25.372216 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:36:25.372216 [info ] [Thread-4 (]: 11 of 18 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.20s]
[0m13:36:25.373227 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:36:25.374258 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:36:25.374258 [info ] [Thread-4 (]: 16 of 18 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:36:25.375259 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:36:25.376259 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:36:25.383268 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:36:25.384992 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:36:25.388547 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:36:25.390538 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:36:25.392042 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:36:25.392042 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:36:25.417013 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m13:36:25.418021 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:36:25.418021 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:25.418021 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.118 seconds
[0m13:36:25.420031 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:36:25.420031 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:36:25.421034 [info ] [Thread-3 (]: 14 of 18 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.19s]
[0m13:36:25.422034 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:36:25.422034 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:36:25.422537 [info ] [Thread-3 (]: 17 of 18 START test unique_stg_products_product_id ............................. [RUN]
[0m13:36:25.423041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:36:25.424102 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:36:25.428791 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:36:25.429791 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:36:25.433824 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:36:25.434829 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:36:25.434829 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:36:25.435833 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:36:25.440906 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m13:36:25.442409 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:36:25.442921 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:25.466856 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.101 seconds
[0m13:36:25.467859 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:36:25.468865 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:36:25.468865 [info ] [Thread-1 (]: 12 of 18 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.28s]
[0m13:36:25.469870 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:36:25.470871 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:36:25.470871 [info ] [Thread-1 (]: 18 of 18 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:36:25.470871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:36:25.472377 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:36:25.476254 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:36:25.477257 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:36:25.480309 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:36:25.481319 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:36:25.481319 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:36:25.482822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:36:25.484362 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:36:25.484362 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:36:25.484362 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:25.508388 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.024 seconds
[0m13:36:25.510393 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:36:25.510393 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:36:25.511401 [info ] [Thread-3 (]: 17 of 18 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m13:36:25.512402 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:36:25.526341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m13:36:25.526341 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:36:25.526341 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:36:25.530367 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:36:25.532370 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:36:25.532873 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.089 seconds
[0m13:36:25.534367 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:36:25.534367 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:36:25.534367 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:36:25.535370 [info ] [Thread-1 (]: 18 of 18 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.06s]
[0m13:36:25.536373 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:36:25.536373 [info ] [Thread-4 (]: 16 of 18 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.16s]
[0m13:36:25.537376 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:36:25.568927 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.150 seconds
[0m13:36:25.569929 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:36:25.570931 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:36:25.571932 [error] [Thread-2 (]: 15 of 18 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.22s]
[0m13:36:25.571932 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:36:25.573271 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:25.573271 [debug] [MainThread]: On master: BEGIN
[0m13:36:25.574265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:36:25.613830 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m13:36:25.613830 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.613830 [debug] [MainThread]: Using postgres connection "master"
[0m13:36:25.614940 [debug] [MainThread]: On master: COMMIT
[0m13:36:25.614940 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:36:25.614940 [debug] [MainThread]: On master: Close
[0m13:36:25.615940 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:36:25.615940 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:36:25.615940 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:36:25.616941 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:36:25.616941 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:36:25.616941 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:36:25.616941 [info ] [MainThread]: 
[0m13:36:25.617941 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m13:36:25.620959 [debug] [MainThread]: Command end result
[0m13:36:25.705549 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:36:25.709577 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:36:25.715598 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:36:25.716603 [info ] [MainThread]: 
[0m13:36:25.716603 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:36:25.717606 [info ] [MainThread]: 
[0m13:36:25.717606 [error] [MainThread]:   Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:36:25.717606 [info ] [MainThread]: 
[0m13:36:25.718614 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:36:25.718614 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:36:25.719713 [info ] [MainThread]: 
[0m13:36:25.719713 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:36:25.719713 [info ] [MainThread]: 
[0m13:36:25.720717 [info ] [MainThread]: Done. PASS=16 WARN=0 ERROR=2 SKIP=0 TOTAL=18
[0m13:36:25.720717 [debug] [MainThread]: Command `dbt test` failed at 13:36:25.720717 after 2.24 seconds
[0m13:36:25.722221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D7125A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23D974980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F23F3D8FB0>]}
[0m13:36:25.722221 [debug] [MainThread]: Flushing usage events
[0m13:36:27.151121 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:36:43.577348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08DE24170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08D8FFE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08D8FEED0>]}


============================== 13:36:43.581356 | 78d57d19-bce9-4705-8b8e-31021584789f ==============================
[0m13:36:43.581356 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:36:43.581356 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt deps', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:36:43.715793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78d57d19-bce9-4705-8b8e-31021584789f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08DFBA0F0>]}
[0m13:36:43.746199 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:36:43.749212 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:36:43.749212 [debug] [MainThread]: Command `dbt deps` succeeded at 13:36:43.749212 after 0.27 seconds
[0m13:36:43.750672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08D88BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08DCFF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C08DCFC800>]}
[0m13:36:43.750672 [debug] [MainThread]: Flushing usage events
[0m13:36:45.153942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:24.835655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535704740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535125A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535125640>]}


============================== 13:39:24.839686 | dc1792d0-6e2c-4dcd-8574-cfe511b699f1 ==============================
[0m13:39:24.839686 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:39:24.840688 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'no_print': 'None', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:39:24.912794 [error] [MainThread]: Encountered an error:
'version'
[0m13:39:24.916812 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 251, in wrapper
    project = load_project(
              ^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\config\runtime.py", line 59, in load_project
    project = Project.from_project_root(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\config\project.py", line 752, in from_project_root
    return partial.render(renderer)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\config\project.py", line 321, in render
    return self.create_project(rendered)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\config\project.py", line 468, in create_project
    packages: PackageConfig = package_config_from_data(
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\config\project.py", line 139, in package_config_from_data
    PackageConfig.validate(packages_data)
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\contracts\project.py", line 140, in validate
    if not package["version"]:
           ~~~~~~~^^^^^^^^^^^
KeyError: 'version'

[0m13:39:24.917816 [debug] [MainThread]: Command `dbt deps` failed at 13:39:24.917816 after 0.19 seconds
[0m13:39:24.918820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535BADBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535D05E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E535AB4E00>]}
[0m13:39:24.918820 [debug] [MainThread]: Flushing usage events
[0m13:39:26.517389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:23.666416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC31B8B470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC34787D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC342FCF20>]}


============================== 13:41:23.670736 | 2157499b-3153-4aec-921c-85d669a0958f ==============================
[0m13:41:23.670736 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:41:23.670736 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:41:23.806725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2157499b-3153-4aec-921c-85d669a0958f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC349D2330>]}
[0m13:41:23.840036 [debug] [MainThread]: Set downloads directory='C:\Users\krang\AppData\Local\Temp\dbt-downloads-jt1fwzia'
[0m13:41:23.841039 [error] [MainThread]: Encountered an error:
">=1.0.0,<2.0.0" is not a valid semantic version.
[0m13:41:23.895089 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\main.py", line 455, in deps
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\task\deps.py", line 212, in run
    self.lock()
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\task\deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\deps\resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\deps\resolver.py", line 91, in from_contracts
    self.update_from(src)
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\deps\resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\deps\registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt_common\semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
dbt_common.exceptions.base.SemverError: ">=1.0.0,<2.0.0" is not a valid semantic version.

[0m13:41:23.896124 [debug] [MainThread]: Command `dbt deps` failed at 13:41:23.896124 after 0.34 seconds
[0m13:41:23.897131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC34755BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC346F82C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC35D89C70>]}
[0m13:41:23.897131 [debug] [MainThread]: Flushing usage events
[0m13:41:25.321093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:38.033011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FAB1DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA11FF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA11CD10>]}


============================== 13:44:38.037466 | 40e9eada-cadb-4e08-9d2c-c12487e9b900 ==============================
[0m13:44:38.037466 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:44:38.037466 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt deps', 'printer_width': '80', 'target_path': 'None'}
[0m13:44:38.183188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40e9eada-cadb-4e08-9d2c-c12487e9b900', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FAD060C0>]}
[0m13:44:38.219913 [debug] [MainThread]: Set downloads directory='C:\Users\krang\AppData\Local\Temp\dbt-downloads-9_wxru2z'
[0m13:44:38.219913 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:39.001308 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:44:39.002818 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:44:39.429061 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:44:39.442209 [info ] [MainThread]: Updating lock file in file path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform/package-lock.yml
[0m13:44:39.455096 [debug] [MainThread]: Set downloads directory='C:\Users\krang\AppData\Local\Temp\dbt-downloads-8r8ua3fa'
[0m13:44:39.458611 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:44:40.666191 [info ] [MainThread]: Installed from version 1.3.1
[0m13:44:40.667197 [info ] [MainThread]: Up to date!
[0m13:44:40.667197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '40e9eada-cadb-4e08-9d2c-c12487e9b900', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FACEE630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FACEDA60>]}
[0m13:44:40.670215 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:40.669212 after 2.74 seconds
[0m13:44:40.670215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA694F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224FA696A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224F4CD4E00>]}
[0m13:44:40.671215 [debug] [MainThread]: Flushing usage events
[0m13:44:42.401168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:53.761191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD4F32EA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD2AFFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD57D7530>]}


============================== 13:44:53.765679 | 355b2723-2a7f-4fd9-9474-de164b67e6db ==============================
[0m13:44:53.765679 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:44:53.765679 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:44:53.964043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '355b2723-2a7f-4fd9-9474-de164b67e6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5611550>]}
[0m13:44:54.019413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '355b2723-2a7f-4fd9-9474-de164b67e6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD553ACF0>]}
[0m13:44:54.020413 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:44:54.438470 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:44:54.518172 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:44:54.519190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '355b2723-2a7f-4fd9-9474-de164b67e6db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD71455B0>]}
[0m13:44:56.370852 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m13:44:56.485504 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  macro 'dbt_macro__test_unique_combination_of_columns' takes no keyword argument 'column_name'
[0m13:44:56.486506 [debug] [MainThread]: Command `dbt test` failed at 13:44:56.486506 after 2.82 seconds
[0m13:44:56.486506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD5430800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD7314050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016AD729F2F0>]}
[0m13:44:56.487524 [debug] [MainThread]: Flushing usage events
[0m13:44:58.078183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:11.093990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF514A1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF514B4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF514B440>]}


============================== 13:45:11.098243 | b079e88c-df65-438d-ab81-f7daabed1ba9 ==============================
[0m13:45:11.098243 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:45:11.098243 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:45:11.125054 [info ] [MainThread]: dbt version: 1.9.10
[0m13:45:11.125054 [info ] [MainThread]: python version: 3.12.5
[0m13:45:11.126117 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m13:45:11.126117 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m13:45:11.187956 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m13:45:11.188956 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m13:45:11.188956 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m13:45:11.190050 [info ] [MainThread]: adapter type: postgres
[0m13:45:11.191055 [info ] [MainThread]: adapter version: 1.9.1
[0m13:45:11.286011 [info ] [MainThread]: Configuration:
[0m13:45:11.287014 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:45:11.288071 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:45:11.288071 [info ] [MainThread]: Required dependencies:
[0m13:45:11.288071 [debug] [MainThread]: Executing "git --help"
[0m13:45:11.326227 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:45:11.326227 [debug] [MainThread]: STDERR: "b''"
[0m13:45:11.327230 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:45:11.327230 [info ] [MainThread]: Connection:
[0m13:45:11.328280 [info ] [MainThread]:   host: localhost
[0m13:45:11.328280 [info ] [MainThread]:   port: 5432
[0m13:45:11.329284 [info ] [MainThread]:   user: postgres
[0m13:45:11.329284 [info ] [MainThread]:   database: ecommerce_raw
[0m13:45:11.329284 [info ] [MainThread]:   schema: public
[0m13:45:11.329284 [info ] [MainThread]:   connect_timeout: 10
[0m13:45:11.330534 [info ] [MainThread]:   role: None
[0m13:45:11.330534 [info ] [MainThread]:   search_path: None
[0m13:45:11.330534 [info ] [MainThread]:   keepalives_idle: 0
[0m13:45:11.332037 [info ] [MainThread]:   sslmode: prefer
[0m13:45:11.332037 [info ] [MainThread]:   sslcert: None
[0m13:45:11.332037 [info ] [MainThread]:   sslkey: None
[0m13:45:11.333040 [info ] [MainThread]:   sslrootcert: None
[0m13:45:11.333040 [info ] [MainThread]:   application_name: dbt
[0m13:45:11.333981 [info ] [MainThread]:   retries: 1
[0m13:45:11.333981 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:45:11.729573 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:45:11.875293 [debug] [MainThread]: Using postgres connection "debug"
[0m13:45:11.876293 [debug] [MainThread]: On debug: select 1 as id
[0m13:45:11.876293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:11.924014 [debug] [MainThread]: SQL status: SELECT 1 in 0.048 seconds
[0m13:45:11.926021 [debug] [MainThread]: On debug: Close
[0m13:45:11.926021 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:45:11.926021 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:45:11.927016 [debug] [MainThread]: Command `dbt debug` succeeded at 13:45:11.927016 after 0.94 seconds
[0m13:45:11.928016 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:45:11.928016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF4A5C770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF4A5CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BCF4A5C080>]}
[0m13:45:11.928016 [debug] [MainThread]: Flushing usage events
[0m13:45:13.494241 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:17.880930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08784EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA087851F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08DC9340>]}


============================== 13:45:17.885467 | b215d266-2ccc-4760-b9e5-0ae7e9337353 ==============================
[0m13:45:17.885467 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:45:17.885467 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True'}
[0m13:45:18.080261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b215d266-2ccc-4760-b9e5-0ae7e9337353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA09232090>]}
[0m13:45:18.134112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b215d266-2ccc-4760-b9e5-0ae7e9337353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA08627470>]}
[0m13:45:18.136122 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:45:18.530940 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:45:18.609146 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:45:18.610148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b215d266-2ccc-4760-b9e5-0ae7e9337353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A9B5610>]}
[0m13:45:19.778475 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m13:45:19.895270 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  macro 'dbt_macro__test_unique_combination_of_columns' takes no keyword argument 'column_name'
[0m13:45:19.896337 [debug] [MainThread]: Command `dbt test` failed at 13:45:19.896337 after 2.12 seconds
[0m13:45:19.896337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA03064E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0A9B91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AA0920F620>]}
[0m13:45:19.897342 [debug] [MainThread]: Flushing usage events
[0m13:45:21.482875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:45:42.255301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2D14B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2FB48560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2F3DFB90>]}


============================== 13:45:42.259385 | c9ff4433-dcdd-4c06-af22-5589371b9c97 ==============================
[0m13:45:42.259385 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:45:42.259385 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m13:45:42.450692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9ff4433-dcdd-4c06-af22-5589371b9c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F30038110>]}
[0m13:45:42.504068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c9ff4433-dcdd-4c06-af22-5589371b9c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2D31F500>]}
[0m13:45:42.506081 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:45:42.898126 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:45:42.975899 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:45:42.976969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c9ff4433-dcdd-4c06-af22-5589371b9c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2FAEBC20>]}
[0m13:45:44.119350 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m13:45:44.228210 [error] [MainThread]: Encountered an error:
Compilation Error in test dbt_utils_unique_combination_of_columns_stg_items_ordered_item_id__order_id__item_id (models\staging\_staging_test.yml)
  macro 'dbt_macro__test_unique_combination_of_columns' takes no keyword argument 'column_name'
[0m13:45:44.230214 [debug] [MainThread]: Command `dbt run` failed at 13:45:44.229212 after 2.07 seconds
[0m13:45:44.230214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F3191B9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F2FE78980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F313DAAE0>]}
[0m13:45:44.230214 [debug] [MainThread]: Flushing usage events
[0m13:45:45.837629 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:57.983141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43DD94B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43DD94AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43DD94B30>]}


============================== 13:48:57.987151 | a2abba19-b2ad-42ad-9e03-13488c901f78 ==============================
[0m13:48:57.987151 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:48:57.988378 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'no_print': 'None', 'invocation_command': 'dbt clean', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:48:58.124458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2abba19-b2ad-42ad-9e03-13488c901f78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C437D4A270>]}
[0m13:48:58.364840 [debug] [MainThread]: Command `dbt clean` succeeded at 13:48:58.364840 after 0.49 seconds
[0m13:48:58.364840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43D5D8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43B5E5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C43B5E42C0>]}
[0m13:48:58.366097 [debug] [MainThread]: Flushing usage events
[0m13:48:59.865784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:50.325072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFD459580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFCFA7E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFAACD3A0>]}


============================== 13:49:50.330088 | 1809ec56-31f8-4ac6-a85d-de202303bf16 ==============================
[0m13:49:50.330088 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:49:50.331179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'use_colors': 'True', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m13:49:50.577216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1809ec56-31f8-4ac6-a85d-de202303bf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFD878830>]}
[0m13:49:50.636838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1809ec56-31f8-4ac6-a85d-de202303bf16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFCD28F20>]}
[0m13:49:50.638846 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:49:51.070934 [error] [MainThread]: Encountered an error:
Runtime Error
  Failed to read package: Runtime Error
    No dbt_project.yml found at expected path C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_packages\dbt_utils\dbt_project.yml
    Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
    

Error encountered in C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_packages\dbt_utils
[0m13:49:51.072941 [debug] [MainThread]: Command `dbt run` failed at 13:49:51.072941 after 0.87 seconds
[0m13:49:51.073971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFD8798E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFD87BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017DFEC346B0>]}
[0m13:49:51.074607 [debug] [MainThread]: Flushing usage events
[0m13:49:52.492797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:55.271187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226077BC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225DD3C710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002226001AD50>]}


============================== 13:49:55.274881 | 09660ee9-7cce-44df-b699-054dc1be7ed1 ==============================
[0m13:49:55.274881 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:49:55.275884 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt ', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m13:49:55.414256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09660ee9-7cce-44df-b699-054dc1be7ed1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002225DF38FB0>]}
[0m13:49:55.448238 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:49:55.497253 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:49:55.499462 [debug] [MainThread]: Command `cli deps` succeeded at 13:49:55.498256 after 0.34 seconds
[0m13:49:55.499462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022260913B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022260C393D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022260CEF320>]}
[0m13:49:55.499462 [debug] [MainThread]: Flushing usage events
[0m13:49:57.020434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:08.749121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C60EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C65F0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C60EEE40>]}


============================== 13:50:08.753146 | 2c9f19d7-f24a-464c-b7f8-fd2ec07b8996 ==============================
[0m13:50:08.753146 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:50:08.754169 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'invocation_command': 'dbt debug', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m13:50:08.778986 [info ] [MainThread]: dbt version: 1.9.10
[0m13:50:08.778986 [info ] [MainThread]: python version: 3.12.5
[0m13:50:08.778986 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m13:50:08.780421 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m13:50:08.841303 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m13:50:08.842303 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m13:50:08.842809 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m13:50:08.843743 [info ] [MainThread]: adapter type: postgres
[0m13:50:08.843743 [info ] [MainThread]: adapter version: 1.9.1
[0m13:50:08.930027 [info ] [MainThread]: Configuration:
[0m13:50:08.931027 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:50:08.931027 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:50:08.932030 [info ] [MainThread]: Required dependencies:
[0m13:50:08.932030 [debug] [MainThread]: Executing "git --help"
[0m13:50:08.966911 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:50:08.967935 [debug] [MainThread]: STDERR: "b''"
[0m13:50:08.967935 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:50:08.967935 [info ] [MainThread]: Connection:
[0m13:50:08.968953 [info ] [MainThread]:   host: localhost
[0m13:50:08.968953 [info ] [MainThread]:   port: 5432
[0m13:50:08.968953 [info ] [MainThread]:   user: postgres
[0m13:50:08.970043 [info ] [MainThread]:   database: ecommerce_raw
[0m13:50:08.970043 [info ] [MainThread]:   schema: public
[0m13:50:08.970043 [info ] [MainThread]:   connect_timeout: 10
[0m13:50:08.970043 [info ] [MainThread]:   role: None
[0m13:50:08.971050 [info ] [MainThread]:   search_path: None
[0m13:50:08.971050 [info ] [MainThread]:   keepalives_idle: 0
[0m13:50:08.972050 [info ] [MainThread]:   sslmode: prefer
[0m13:50:08.972050 [info ] [MainThread]:   sslcert: None
[0m13:50:08.972050 [info ] [MainThread]:   sslkey: None
[0m13:50:08.972050 [info ] [MainThread]:   sslrootcert: None
[0m13:50:08.972050 [info ] [MainThread]:   application_name: dbt
[0m13:50:08.973224 [info ] [MainThread]:   retries: 1
[0m13:50:08.974082 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:50:09.364293 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:50:09.555650 [debug] [MainThread]: Using postgres connection "debug"
[0m13:50:09.555650 [debug] [MainThread]: On debug: select 1 as id
[0m13:50:09.555650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:09.637268 [debug] [MainThread]: SQL status: SELECT 1 in 0.081 seconds
[0m13:50:09.638271 [debug] [MainThread]: On debug: Close
[0m13:50:09.638271 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:50:09.639306 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:50:09.640309 [debug] [MainThread]: Command `dbt debug` succeeded at 13:50:09.640309 after 0.99 seconds
[0m13:50:09.640309 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:50:09.641340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C65F0560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C5AB5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F9C60BDB20>]}
[0m13:50:09.641340 [debug] [MainThread]: Flushing usage events
[0m13:50:11.311901 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:04.613037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A73E36B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A970BCB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A9787D40>]}


============================== 13:51:04.617060 | 72bbf17a-e962-4728-bc8b-46cc90e6e601 ==============================
[0m13:51:04.617060 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:51:04.618062 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m13:51:04.806235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AA588D40>]}
[0m13:51:04.859927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A972A3F0>]}
[0m13:51:04.861929 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:51:05.258744 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:51:05.259746 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:51:05.259746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AA58B6B0>]}
[0m13:51:06.247545 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m13:51:06.469388 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_stg_order_payments_order_id.de5ce0ffc7' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m13:51:06.470484 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.relationships_stg_order_payments_order_id__order_id__ref_stg_orders_.6022349660' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m13:51:06.547159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ABAA0EC0>]}
[0m13:51:06.625771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:51:06.652123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:51:06.687093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ABADC350>]}
[0m13:51:06.688164 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m13:51:06.688164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AB9239B0>]}
[0m13:51:06.691194 [info ] [MainThread]: 
[0m13:51:06.692195 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:51:06.692195 [info ] [MainThread]: 
[0m13:51:06.692195 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:06.697525 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m13:51:06.850112 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m13:51:06.851114 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m13:51:06.851114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:06.912929 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.062 seconds
[0m13:51:06.913791 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m13:51:06.916339 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:51:06.920723 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:51:06.920723 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:51:06.920723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:07.067277 [debug] [ThreadPool]: SQL status: BEGIN in 0.145 seconds
[0m13:51:07.067277 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:51:07.067277 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:07.101163 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.033 seconds
[0m13:51:07.103170 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:51:07.103170 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:51:07.109559 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.110733 [debug] [MainThread]: On master: BEGIN
[0m13:51:07.110733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:07.169543 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m13:51:07.169543 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.170548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:51:07.190053 [debug] [MainThread]: SQL status: SELECT 9 in 0.020 seconds
[0m13:51:07.193074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AB89AED0>]}
[0m13:51:07.193074 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:07.193964 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.193964 [debug] [MainThread]: On master: BEGIN
[0m13:51:07.193964 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:51:07.195151 [debug] [MainThread]: On master: COMMIT
[0m13:51:07.195151 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.195151 [debug] [MainThread]: On master: COMMIT
[0m13:51:07.195151 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:07.196159 [debug] [MainThread]: On master: Close
[0m13:51:07.201280 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m13:51:07.202281 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m13:51:07.202785 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m13:51:07.202785 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m13:51:07.202785 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m13:51:07.203807 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_items_ordered ........................... [RUN]
[0m13:51:07.203807 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_name_translation ........................ [RUN]
[0m13:51:07.205055 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m13:51:07.205055 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_order_payment ........................... [RUN]
[0m13:51:07.206059 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m13:51:07.206059 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m13:51:07.206059 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m13:51:07.207064 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m13:51:07.207064 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m13:51:07.207064 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m13:51:07.214034 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m13:51:07.214539 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m13:51:07.216549 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m13:51:07.219554 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m13:51:07.222058 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m13:51:07.223568 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m13:51:07.255735 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m13:51:07.256735 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m13:51:07.256735 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m13:51:07.256735 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m13:51:07.260736 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m13:51:07.265748 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m13:51:07.268748 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m13:51:07.268748 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.269748 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m13:51:07.269748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:51:07.270749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.272254 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.272254 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.273257 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m13:51:07.273257 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m13:51:07.273761 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m13:51:07.274286 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:51:07.274762 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:51:07.274762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:07.320846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:51:07.320846 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.320846 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m13:51:07.322865 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:51:07.322865 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.322865 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m13:51:07.327862 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m13:51:07.328867 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.328867 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m13:51:07.331090 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m13:51:07.332092 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.332092 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m13:51:07.336132 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:51:07.336132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m13:51:07.337138 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m13:51:07.343157 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.343157 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m13:51:07.346593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.349623 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.349623 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m13:51:07.353135 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.353637 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m13:51:07.353637 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m13:51:07.353637 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m13:51:07.355645 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.355645 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:51:07.356653 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:51:07.356653 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:51:07.358661 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.361916 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.364380 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.367390 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.367390 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m13:51:07.367390 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m13:51:07.368392 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m13:51:07.368392 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m13:51:07.369396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.369396 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.370400 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.370400 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.384566 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:51:07.385569 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:51:07.388594 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:51:07.390604 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:51:07.390604 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.390604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.392107 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.392107 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.392107 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m13:51:07.393110 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m13:51:07.393110 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m13:51:07.393110 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m13:51:07.395283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:07.395283 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:07.395283 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:07.396293 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:07.402371 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m13:51:07.404270 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m13:51:07.406277 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m13:51:07.408378 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m13:51:07.412962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m13:51:07.414295 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m13:51:07.414295 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m13:51:07.415299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m13:51:07.415299 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m13:51:07.415299 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m13:51:07.416303 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m13:51:07.416303 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m13:51:07.420332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:07.420332 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:51:07.420332 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:51:07.421336 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:51:07.423734 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m13:51:07.424237 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m13:51:07.425240 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m13:51:07.426243 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m13:51:07.430280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9A74EB9E0>]}
[0m13:51:07.430280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9ABAA1670>]}
[0m13:51:07.431306 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AC12AE10>]}
[0m13:51:07.431306 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AC12A9F0>]}
[0m13:51:07.432306 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:51:07.432813 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:51:07.433891 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:51:07.434904 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m13:51:07.433891 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m13:51:07.434904 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m13:51:07.435907 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m13:51:07.435907 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m13:51:07.436924 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m13:51:07.436924 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m13:51:07.438089 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_sellers
[0m13:51:07.438089 [info ] [Thread-1 (]: 5 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m13:51:07.439092 [info ] [Thread-3 (]: 6 of 7 START sql view model public.stg_products ................................ [RUN]
[0m13:51:07.440095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m13:51:07.439092 [info ] [Thread-2 (]: 7 of 7 START sql view model public.stg_sellers ................................. [RUN]
[0m13:51:07.440095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m13:51:07.440095 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m13:51:07.441098 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m13:51:07.441098 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m13:51:07.443105 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m13:51:07.444119 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_sellers
[0m13:51:07.446126 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m13:51:07.449138 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m13:51:07.450142 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m13:51:07.454825 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m13:51:07.454825 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m13:51:07.458076 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m13:51:07.458076 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_sellers
[0m13:51:07.463096 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m13:51:07.464110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.465119 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m13:51:07.465119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:07.466132 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.466132 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m13:51:07.467619 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.467619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:51:07.468618 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: BEGIN
[0m13:51:07.468618 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:51:07.520393 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m13:51:07.521397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.521397 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m13:51:07.528965 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:51:07.533955 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.535027 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m13:51:07.535027 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m13:51:07.536041 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.536041 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m13:51:07.537046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.542565 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.543069 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m13:51:07.545085 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.545085 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:51:07.548086 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:51:07.554134 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.554726 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.555739 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m13:51:07.555739 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m13:51:07.557740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.557740 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:07.563752 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.567755 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m13:51:07.567755 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m13:51:07.569755 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m13:51:07.569755 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m13:51:07.571028 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.573036 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:51:07.574050 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:51:07.574580 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.576593 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m13:51:07.576593 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m13:51:07.578097 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AC12A600>]}
[0m13:51:07.579169 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:07.584192 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m13:51:07.579169 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.14s]
[0m13:51:07.586194 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m13:51:07.586194 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m13:51:07.587429 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m13:51:07.589564 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:51:07.592069 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: Close
[0m13:51:07.593577 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AC12AFF0>]}
[0m13:51:07.594344 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m13:51:07.596582 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_sellers
[0m13:51:07.633062 [debug] [Thread-3 (]: SQL status: BEGIN in 0.165 seconds
[0m13:51:07.634078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.634078 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m13:51:07.643121 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:51:07.646100 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.647124 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m13:51:07.648274 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.651397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.652397 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m13:51:07.652899 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:07.654939 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m13:51:07.654939 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.655947 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m13:51:07.657022 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:07.660083 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m13:51:07.661153 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m13:51:07.662154 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m13:51:07.663160 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:07.665173 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m13:51:07.666173 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72bbf17a-e962-4728-bc8b-46cc90e6e601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AC1D47D0>]}
[0m13:51:07.666173 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.23s]
[0m13:51:07.667173 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m13:51:07.669470 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.669470 [debug] [MainThread]: On master: BEGIN
[0m13:51:07.669470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:07.723308 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m13:51:07.724892 [debug] [MainThread]: On master: COMMIT
[0m13:51:07.724892 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:07.724892 [debug] [MainThread]: On master: COMMIT
[0m13:51:07.725906 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:07.725906 [debug] [MainThread]: On master: Close
[0m13:51:07.725906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:07.726910 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m13:51:07.726910 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:51:07.726910 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m13:51:07.726910 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m13:51:07.727916 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m13:51:07.727916 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m13:51:07.727916 [info ] [MainThread]: 
[0m13:51:07.728923 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m13:51:07.730962 [debug] [MainThread]: Command end result
[0m13:51:07.762242 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:51:07.766389 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:51:07.774387 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:51:07.775407 [info ] [MainThread]: 
[0m13:51:07.775407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:07.776406 [info ] [MainThread]: 
[0m13:51:07.776406 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:51:07.779077 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:07.778573 after 3.27 seconds
[0m13:51:07.779077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AA20A0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AA110A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9AA1120C0>]}
[0m13:51:07.780079 [debug] [MainThread]: Flushing usage events
[0m13:51:09.652959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:36.786484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A43689B620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A433EA0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A436870560>]}


============================== 13:59:36.792466 | a75a6e8f-e983-4208-8630-56c2edccb5b3 ==============================
[0m13:59:36.792466 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:59:36.792466 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'printer_width': '80', 'write_json': 'True'}
[0m13:59:36.826148 [info ] [MainThread]: dbt version: 1.9.10
[0m13:59:36.826148 [info ] [MainThread]: python version: 3.12.5
[0m13:59:36.827157 [info ] [MainThread]: python path: C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Scripts\python.exe
[0m13:59:36.827157 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m13:59:36.905198 [info ] [MainThread]: Using profiles dir at C:\Users\krang\.dbt
[0m13:59:36.905198 [info ] [MainThread]: Using profiles.yml file at C:\Users\krang\.dbt\profiles.yml
[0m13:59:36.906289 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\dbt_project.yml
[0m13:59:36.908056 [info ] [MainThread]: adapter type: postgres
[0m13:59:36.908056 [info ] [MainThread]: adapter version: 1.9.1
[0m13:59:36.994400 [info ] [MainThread]: Configuration:
[0m13:59:36.995402 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:59:36.995402 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:59:36.996409 [info ] [MainThread]: Required dependencies:
[0m13:59:36.996409 [debug] [MainThread]: Executing "git --help"
[0m13:59:37.030702 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:59:37.030702 [debug] [MainThread]: STDERR: "b''"
[0m13:59:37.031716 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:59:37.031716 [info ] [MainThread]: Connection:
[0m13:59:37.031716 [info ] [MainThread]:   host: localhost
[0m13:59:37.032718 [info ] [MainThread]:   port: 5432
[0m13:59:37.032718 [info ] [MainThread]:   user: postgres
[0m13:59:37.032718 [info ] [MainThread]:   database: ecommerce_raw
[0m13:59:37.033727 [info ] [MainThread]:   schema: public
[0m13:59:37.033727 [info ] [MainThread]:   connect_timeout: 10
[0m13:59:37.033727 [info ] [MainThread]:   role: None
[0m13:59:37.034738 [info ] [MainThread]:   search_path: None
[0m13:59:37.034738 [info ] [MainThread]:   keepalives_idle: 0
[0m13:59:37.034738 [info ] [MainThread]:   sslmode: prefer
[0m13:59:37.035826 [info ] [MainThread]:   sslcert: None
[0m13:59:37.035826 [info ] [MainThread]:   sslkey: None
[0m13:59:37.035826 [info ] [MainThread]:   sslrootcert: None
[0m13:59:37.036830 [info ] [MainThread]:   application_name: dbt
[0m13:59:37.036830 [info ] [MainThread]:   retries: 1
[0m13:59:37.036830 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:59:37.439291 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:59:37.633028 [debug] [MainThread]: Using postgres connection "debug"
[0m13:59:37.633028 [debug] [MainThread]: On debug: select 1 as id
[0m13:59:37.633028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:37.727137 [debug] [MainThread]: SQL status: SELECT 1 in 0.093 seconds
[0m13:59:37.728304 [debug] [MainThread]: On debug: Close
[0m13:59:37.729424 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:59:37.729424 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:59:37.730604 [debug] [MainThread]: Command `dbt debug` succeeded at 13:59:37.730604 after 1.05 seconds
[0m13:59:37.731604 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:59:37.731604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4365DCC50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4344B6F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4344B78F0>]}
[0m13:59:37.731604 [debug] [MainThread]: Flushing usage events
[0m13:59:39.450848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:59:45.819525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C4160B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C41931070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C43AE0560>]}


============================== 13:59:45.823551 | aeae1b88-ba84-4033-91d1-2e902384c2df ==============================
[0m13:59:45.823551 [info ] [MainThread]: Running with dbt=1.9.10
[0m13:59:45.824556 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m13:59:46.065216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C41734710>]}
[0m13:59:46.117733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C444FAB70>]}
[0m13:59:46.119734 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m13:59:46.508817 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m13:59:46.587893 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:59:46.588915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C45B8FCB0>]}
[0m13:59:47.519303 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m13:59:47.659118 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_stg_order_payments_order_id.de5ce0ffc7' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m13:59:47.660160 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.relationships_stg_order_payments_order_id__order_id__ref_stg_orders_.6022349660' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m13:59:47.721726 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- seeds.dbt_project
[0m13:59:47.729987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C45C7A720>]}
[0m13:59:47.799587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:59:47.824544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:59:47.868012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C4467BD40>]}
[0m13:59:47.869079 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m13:59:47.869079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C45C3FEF0>]}
[0m13:59:47.872331 [info ] [MainThread]: 
[0m13:59:47.872331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:59:47.873481 [info ] [MainThread]: 
[0m13:59:47.873481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:59:47.877591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m13:59:48.027864 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:59:48.027864 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m13:59:48.028872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:59:48.072237 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m13:59:48.072237 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m13:59:48.072237 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:59:48.095736 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.022 seconds
[0m13:59:48.096754 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m13:59:48.096754 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m13:59:48.103037 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.104037 [debug] [MainThread]: On master: BEGIN
[0m13:59:48.104037 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:59:48.141452 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m13:59:48.142457 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.142457 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m13:59:48.153490 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m13:59:48.155783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeae1b88-ba84-4033-91d1-2e902384c2df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C4618E150>]}
[0m13:59:48.156786 [debug] [MainThread]: On master: ROLLBACK
[0m13:59:48.156786 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.156786 [debug] [MainThread]: On master: BEGIN
[0m13:59:48.157789 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:59:48.157789 [debug] [MainThread]: On master: COMMIT
[0m13:59:48.157789 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:48.157789 [debug] [MainThread]: On master: COMMIT
[0m13:59:48.158908 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:59:48.158908 [debug] [MainThread]: On master: Close
[0m13:59:48.163941 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:59:48.165042 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:59:48.165042 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:59:48.165042 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:59:48.165042 [info ] [Thread-1 (]: 1 of 19 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m13:59:48.166045 [info ] [Thread-2 (]: 2 of 19 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m13:59:48.166045 [info ] [Thread-3 (]: 3 of 19 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m13:59:48.167047 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m13:59:48.166045 [info ] [Thread-4 (]: 4 of 19 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m13:59:48.167047 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m13:59:48.168184 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505'
[0m13:59:48.168184 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:59:48.168184 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m13:59:48.169229 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:59:48.169229 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:59:48.180234 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:59:48.180234 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:59:48.183732 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:59:48.186895 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:59:48.189913 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:59:48.190919 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:59:48.205216 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:59:48.205216 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:59:48.206601 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:59:48.209622 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:59:48.210622 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:59:48.212687 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:59:48.212687 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:59:48.214896 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:59:48.214896 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m13:59:48.216247 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:59:48.216247 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:59:48.217256 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m13:59:48.217256 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:59:48.217256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:59:48.217256 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m13:59:48.218641 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:59:48.219642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:59:48.219642 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m13:59:48.219642 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:59:48.263013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:59:48.263013 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m13:59:48.263013 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.264403 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m13:59:48.265406 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m13:59:48.265406 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.270238 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m13:59:48.270238 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m13:59:48.271241 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.274632 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m13:59:48.274632 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m13:59:48.275741 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.407723 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.142 seconds
[0m13:59:48.407723 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.144 seconds
[0m13:59:48.412658 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m13:59:48.413801 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m13:59:48.413801 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.138 seconds
[0m13:59:48.415017 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m13:59:48.415017 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m13:59:48.416017 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m13:59:48.416017 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m13:59:48.417017 [info ] [Thread-2 (]: 2 of 19 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.25s]
[0m13:59:48.417017 [info ] [Thread-1 (]: 1 of 19 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.25s]
[0m13:59:48.418231 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m13:59:48.418231 [info ] [Thread-4 (]: 4 of 19 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.25s]
[0m13:59:48.418231 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m13:59:48.419678 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:59:48.420682 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m13:59:48.420682 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:59:48.421687 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:59:48.420682 [info ] [Thread-2 (]: 5 of 19 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m13:59:48.421687 [info ] [Thread-1 (]: 6 of 19 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m13:59:48.422710 [info ] [Thread-4 (]: 7 of 19 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m13:59:48.422710 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m13:59:48.422710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m13:59:48.423970 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m13:59:48.423970 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:59:48.423970 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:59:48.425235 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:59:48.428576 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:59:48.431797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:59:48.435493 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:59:48.436493 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.165 seconds
[0m13:59:48.437552 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m13:59:48.437552 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m13:59:48.439020 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:59:48.441023 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:59:48.442023 [info ] [Thread-3 (]: 3 of 19 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.27s]
[0m13:59:48.442023 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:59:48.443044 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:59:48.443044 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m13:59:48.445053 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:59:48.447082 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:59:48.448086 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:59:48.448086 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:48.449091 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m13:59:48.449091 [info ] [Thread-3 (]: 8 of 19 START test not_null_stg_orders_order_id ................................ [RUN]
[0m13:59:48.450265 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:48.450265 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m13:59:48.450265 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:59:48.451268 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:59:48.451268 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:48.451268 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m13:59:48.451268 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m13:59:48.456962 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:48.458047 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:59:48.458047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:48.459046 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:48.463446 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:48.465446 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:48.465446 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m13:59:48.466454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:48.497688 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m13:59:48.498878 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m13:59:48.498878 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.504074 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m13:59:48.504074 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m13:59:48.505577 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.509580 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m13:59:48.509580 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m13:59:48.510580 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.514941 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m13:59:48.514941 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m13:59:48.516174 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.551986 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.053 seconds
[0m13:59:48.553994 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m13:59:48.553994 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m13:59:48.554998 [info ] [Thread-2 (]: 5 of 19 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.13s]
[0m13:59:48.556026 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m13:59:48.556026 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:59:48.557154 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_products_product_id ............................ [RUN]
[0m13:59:48.557154 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m13:59:48.557154 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:59:48.561587 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:59:48.563588 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:59:48.568031 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:59:48.568031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m13:59:48.570151 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m13:59:48.570151 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m13:59:48.570151 [info ] [Thread-1 (]: 6 of 19 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.15s]
[0m13:59:48.571610 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:59:48.573083 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m13:59:48.573083 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m13:59:48.573083 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:59:48.573083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:48.574482 [info ] [Thread-1 (]: 10 of 19 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m13:59:48.575486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m13:59:48.575486 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:59:48.579569 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:59:48.581597 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:59:48.583993 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:59:48.585436 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:59:48.586454 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m13:59:48.586454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:48.596619 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.080 seconds
[0m13:59:48.596619 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.092 seconds
[0m13:59:48.598982 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m13:59:48.601015 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m13:59:48.601015 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m13:59:48.602016 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m13:59:48.602016 [info ] [Thread-3 (]: 8 of 19 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.15s]
[0m13:59:48.604188 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m13:59:48.603028 [info ] [Thread-4 (]: 7 of 19 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.18s]
[0m13:59:48.604188 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:59:48.604188 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m13:59:48.605691 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:59:48.605691 [info ] [Thread-3 (]: 11 of 19 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m13:59:48.606710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m13:59:48.605691 [info ] [Thread-4 (]: 12 of 19 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m13:59:48.606710 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:59:48.607906 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m13:59:48.612912 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:59:48.612912 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:59:48.618384 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:59:48.620689 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:59:48.622689 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:59:48.623690 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:59:48.623690 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m13:59:48.626742 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:59:48.626742 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m13:59:48.627742 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.627742 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:59:48.628751 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m13:59:48.628751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:48.628751 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:59:48.630200 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m13:59:48.630200 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:59:48.632719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m13:59:48.633728 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m13:59:48.633728 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.639126 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:59:48.641126 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m13:59:48.642125 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m13:59:48.642125 [info ] [Thread-1 (]: 10 of 19 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.07s]
[0m13:59:48.643545 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m13:59:48.644553 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:59:48.644553 [info ] [Thread-1 (]: 13 of 19 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m13:59:48.645731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m13:59:48.645731 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:59:48.652296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:59:48.652296 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.024 seconds
[0m13:59:48.654299 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m13:59:48.654299 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m13:59:48.656602 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:59:48.655597 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_products_product_id .................................. [[32mPASS[0m in 0.10s]
[0m13:59:48.659736 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:59:48.659736 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m13:59:48.660843 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:59:48.660843 [info ] [Thread-2 (]: 14 of 19 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m13:59:48.661847 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m13:59:48.661847 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:59:48.663099 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:59:48.668103 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:59:48.668103 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m13:59:48.669317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:48.670680 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:59:48.672999 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:59:48.675006 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:59:48.676007 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m13:59:48.676007 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m13:59:48.677347 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:48.677347 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m13:59:48.677347 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.681061 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m13:59:48.682049 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m13:59:48.682049 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.721289 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m13:59:48.722398 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m13:59:48.722398 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.786623 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.104 seconds
[0m13:59:48.786623 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.109 seconds
[0m13:59:48.788639 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m13:59:48.788639 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m13:59:48.789973 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m13:59:48.789973 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m13:59:48.791018 [info ] [Thread-4 (]: 12 of 19 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.18s]
[0m13:59:48.792086 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m13:59:48.791018 [info ] [Thread-3 (]: 11 of 19 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.18s]
[0m13:59:48.792086 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:59:48.793093 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m13:59:48.794107 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:59:48.793093 [info ] [Thread-4 (]: 15 of 19 START test unique_stg_customers_customer_id ........................... [RUN]
[0m13:59:48.794107 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.071 seconds
[0m13:59:48.795106 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m13:59:48.794107 [info ] [Thread-3 (]: 16 of 19 START test unique_stg_items_ordered_item_id ........................... [RUN]
[0m13:59:48.796107 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m13:59:48.797446 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:59:48.797446 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83)
[0m13:59:48.804864 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:59:48.804864 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m13:59:48.805864 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:59:48.809373 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:59:48.809373 [info ] [Thread-1 (]: 13 of 19 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.16s]
[0m13:59:48.810689 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m13:59:48.812009 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:59:48.813120 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:59:48.813120 [info ] [Thread-1 (]: 17 of 19 START test unique_stg_orders_order_id ................................. [RUN]
[0m13:59:48.816569 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:59:48.817570 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:59:48.818569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m13:59:48.822013 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:59:48.822013 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:59:48.826233 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:48.827406 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:59:48.828417 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m13:59:48.828417 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:59:48.829562 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:59:48.829562 [debug] [Thread-2 (]: SQL status: BEGIN in 0.153 seconds
[0m13:59:48.830577 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: BEGIN
[0m13:59:48.830577 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:59:48.830577 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m13:59:48.831577 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:48.833595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:48.834600 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m13:59:48.836601 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:48.837902 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m13:59:48.837902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:59:48.880427 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m13:59:48.880427 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m13:59:48.880427 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:48.882523 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m13:59:48.882523 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m13:59:48.883587 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:48.891450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m13:59:48.891450 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m13:59:48.892450 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:48.950327 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.066 seconds
[0m13:59:48.951518 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: ROLLBACK
[0m13:59:48.952818 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: Close
[0m13:59:48.953863 [error] [Thread-3 (]: 16 of 19 FAIL 21 unique_stg_items_ordered_item_id .............................. [[31mFAIL 21[0m in 0.16s]
[0m13:59:48.954867 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m13:59:48.954867 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:59:48.956010 [info ] [Thread-3 (]: 18 of 19 START test unique_stg_products_product_id ............................. [RUN]
[0m13:59:48.956010 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m13:59:48.957010 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.121 seconds
[0m13:59:48.957010 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:59:48.959010 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m13:59:48.963011 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:59:48.963011 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m13:59:48.964011 [info ] [Thread-2 (]: 14 of 19 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.30s]
[0m13:59:48.964011 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m13:59:48.965382 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:59:48.965382 [info ] [Thread-2 (]: 19 of 19 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m13:59:48.966387 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m13:59:48.966387 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:59:48.970690 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:59:48.982076 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:59:48.985349 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:59:48.985349 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:59:48.988529 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:59:48.989533 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:59:48.989533 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m13:59:48.990843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:59:48.994950 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.103 seconds
[0m13:59:48.996951 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m13:59:48.997951 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m13:59:48.997951 [info ] [Thread-1 (]: 17 of 19 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.18s]
[0m13:59:48.998951 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m13:59:49.003415 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:59:49.003415 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m13:59:49.004415 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:59:49.048859 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m13:59:49.048859 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m13:59:49.049860 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:49.050860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.169 seconds
[0m13:59:49.051860 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m13:59:49.052860 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m13:59:49.052860 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:59:49.053860 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m13:59:49.055179 [error] [Thread-4 (]: 15 of 19 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.26s]
[0m13:59:49.055179 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m13:59:49.056183 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m13:59:49.057191 [info ] [Thread-2 (]: 19 of 19 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.09s]
[0m13:59:49.057191 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m13:59:49.136624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.147 seconds
[0m13:59:49.137972 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m13:59:49.137972 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:59:49.151416 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m13:59:49.153431 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m13:59:49.153431 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m13:59:49.154736 [info ] [Thread-3 (]: 18 of 19 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.20s]
[0m13:59:49.154736 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m13:59:49.156182 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.156182 [debug] [MainThread]: On master: BEGIN
[0m13:59:49.157352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:59:49.306592 [debug] [MainThread]: SQL status: BEGIN in 0.150 seconds
[0m13:59:49.307603 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.307603 [debug] [MainThread]: Using postgres connection "master"
[0m13:59:49.307603 [debug] [MainThread]: On master: COMMIT
[0m13:59:49.308606 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:59:49.308606 [debug] [MainThread]: On master: Close
[0m13:59:49.308606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:59:49.309652 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m13:59:49.309652 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m13:59:49.309652 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m13:59:49.309652 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m13:59:49.310651 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m13:59:49.310651 [info ] [MainThread]: 
[0m13:59:49.310651 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 1.44 seconds (1.44s).
[0m13:59:49.313931 [debug] [MainThread]: Command end result
[0m13:59:49.336136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m13:59:49.339583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m13:59:49.345922 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m13:59:49.346924 [info ] [MainThread]: 
[0m13:59:49.346924 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m13:59:49.346924 [info ] [MainThread]: 
[0m13:59:49.348315 [error] [MainThread]: [31mFailure in test unique_stg_items_ordered_item_id (models\staging\_staging_test.yml)[0m
[0m13:59:49.348315 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m13:59:49.348315 [info ] [MainThread]: 
[0m13:59:49.349323 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_items_ordered_item_id.sql
[0m13:59:49.349323 [info ] [MainThread]: 
[0m13:59:49.349323 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m13:59:49.350326 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m13:59:49.350326 [info ] [MainThread]: 
[0m13:59:49.350326 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m13:59:49.351333 [info ] [MainThread]: 
[0m13:59:49.351333 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=2 SKIP=0 TOTAL=19
[0m13:59:49.352345 [debug] [MainThread]: Command `dbt test` failed at 13:59:49.352345 after 3.63 seconds
[0m13:59:49.353348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C4160B3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C43BE4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C441338C0>]}
[0m13:59:49.353348 [debug] [MainThread]: Flushing usage events
[0m13:59:50.902064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:01:58.289106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD74A000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD86A780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD313BF0>]}


============================== 14:01:58.294418 | fffa9217-5184-46c9-9dee-6696395b95a6 ==============================
[0m14:01:58.294418 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:01:58.295552 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'log_format': 'default', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:01:58.532291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BDB688C0>]}
[0m14:01:58.587747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD12ACF0>]}
[0m14:01:58.590253 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:01:59.020049 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:01:59.110874 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:01:59.111380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF26FA70>]}
[0m14:02:00.191287 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'stg_order_payments' in the 'models' section of file 'models\staging\_staging_test.yml'
[0m14:02:00.350083 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.not_null_stg_order_payments_order_id.de5ce0ffc7' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m14:02:00.351042 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_project.relationships_stg_order_payments_order_id__order_id__ref_stg_orders_.6022349660' (models\staging\_staging_test.yml) depends on a node named 'stg_order_payments' in package '' which was not found
[0m14:02:00.429938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF3F6210>]}
[0m14:02:00.506248 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:02:00.533701 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:02:00.566673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF6CEB10>]}
[0m14:02:00.567800 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m14:02:00.567800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF3F5430>]}
[0m14:02:00.570808 [info ] [MainThread]: 
[0m14:02:00.571412 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:02:00.571412 [info ] [MainThread]: 
[0m14:02:00.572522 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:00.576546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:02:00.799372 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:02:00.799372 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:02:00.800382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:01.575961 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.776 seconds
[0m14:02:01.576961 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:02:01.579464 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:02:01.585006 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:02:01.585006 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:02:01.585006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:01.627994 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m14:02:01.629499 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:02:01.630017 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:02:01.651269 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.021 seconds
[0m14:02:01.652719 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:02:01.652719 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:02:01.659996 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:01.659996 [debug] [MainThread]: On master: BEGIN
[0m14:02:01.659996 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:01.708335 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m14:02:01.709335 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:01.709837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:02:01.726334 [debug] [MainThread]: SQL status: SELECT 9 in 0.016 seconds
[0m14:02:01.729334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF7104A0>]}
[0m14:02:01.729837 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:01.730340 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:01.730340 [debug] [MainThread]: On master: BEGIN
[0m14:02:01.731537 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:02:01.731537 [debug] [MainThread]: On master: COMMIT
[0m14:02:01.732565 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:01.732565 [debug] [MainThread]: On master: COMMIT
[0m14:02:01.732565 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:02:01.733574 [debug] [MainThread]: On master: Close
[0m14:02:01.742903 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:02:01.742903 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:02:01.743904 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:02:01.743904 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:02:01.744982 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m14:02:01.744982 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:02:01.745996 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:02:01.747014 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:02:01.745996 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:02:01.747014 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:02:01.748398 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:02:01.748398 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:02:01.748398 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:02:01.749398 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:02:01.749398 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:02:01.756992 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:02:01.756992 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:02:01.760273 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:02:01.763814 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:02:01.766893 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:02:01.767901 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:02:01.804301 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:02:01.805468 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:02:01.806475 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:02:01.806475 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:02:01.813248 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:02:01.819374 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:02:01.826186 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:02:01.826186 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:01.827248 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:02:01.828251 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:02:01.830260 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:01.833859 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:02:01.834860 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:02:01.835860 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:01.836862 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:02:01.836862 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:01.837860 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:02:01.837860 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:02:01.839364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:02:01.897850 [debug] [Thread-1 (]: SQL status: BEGIN in 0.070 seconds
[0m14:02:01.899356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:01.899356 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:02:01.903923 [debug] [Thread-2 (]: SQL status: BEGIN in 0.070 seconds
[0m14:02:01.903923 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:01.904956 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:02:01.906170 [debug] [Thread-3 (]: SQL status: BEGIN in 0.068 seconds
[0m14:02:01.907175 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:01.907175 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:02:01.917196 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:02:01.917196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:02:01.918205 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:02:01.925326 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:01.925326 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m14:02:01.930059 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:01.933416 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:01.933416 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:02:01.934868 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:01.934868 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:02:01.935877 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:02:01.935877 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:02:01.937256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:01.938260 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:02:01.938260 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:02:01.942536 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:01.942536 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:02:01.945676 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:01.949199 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:01.949199 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:02:01.952220 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:01.953223 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:02:01.953223 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:02:01.954233 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:02:01.954233 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:01.955737 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:01.955737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:01.955737 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:02:01.972311 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:02:01.974311 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:02:01.975312 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:02:01.979521 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:01.980023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:01.980023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:01.980023 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:01.981513 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:02:01.981513 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:02:01.982611 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:02:01.982611 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:02:01.983668 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:01.985082 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:02:01.985082 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:02:01.985082 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:02:01.986281 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:02:01.986281 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:01.992345 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:02:01.994346 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:02:01.998347 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:02:01.998347 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:02:02.003365 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:02:02.004365 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:02:02.004365 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:02:02.005365 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:02:02.005365 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:02:02.005365 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:02:02.006366 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:02:02.009366 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:02:02.010551 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:02:02.010551 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:02:02.011571 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:02:02.011571 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:02:02.012574 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:02:02.012574 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:02:02.014598 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:02:02.017676 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:02:02.020182 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:02:02.021935 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:02:02.027704 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BFFBF3E0>]}
[0m14:02:02.027704 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BFFB5640>]}
[0m14:02:02.027704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BAFB2BA0>]}
[0m14:02:02.029208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD05E9F0>]}
[0m14:02:02.030211 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:02:02.030211 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.28s]
[0m14:02:02.032362 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:02:02.031353 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.28s]
[0m14:02:02.033366 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:02:02.032362 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.28s]
[0m14:02:02.033366 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m14:02:02.034385 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:02:02.034385 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m14:02:02.035389 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:02:02.036392 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m14:02:02.035389 [info ] [Thread-2 (]: 5 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m14:02:02.036392 [info ] [Thread-3 (]: 6 of 7 START sql view model public.stg_products ................................ [RUN]
[0m14:02:02.037657 [info ] [Thread-1 (]: 7 of 7 START sql view model public.stg_sellers ................................. [RUN]
[0m14:02:02.037657 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m14:02:02.037657 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m14:02:02.039160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_sellers)
[0m14:02:02.039160 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m14:02:02.039160 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m14:02:02.040163 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:02:02.042595 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:02:02.044868 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:02:02.048198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:02:02.050287 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m14:02:02.054341 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:02:02.054341 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m14:02:02.055855 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m14:02:02.059254 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:02:02.062461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:02:02.062461 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.063604 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:02:02.063604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:02:02.067742 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.069246 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m14:02:02.069246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.069246 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:02:02.070248 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:02:02.070752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:02:02.118164 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m14:02:02.119164 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.119667 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m14:02:02.120171 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:02:02.120171 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.121183 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:02:02.126723 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:02:02.130229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.130229 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:02:02.130732 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:02:02.133834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.133834 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:02:02.134844 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:02.134844 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:02.136850 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.141354 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.141354 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:02:02.141354 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:02:02.142760 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:02:02.142760 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:02.144828 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m14:02:02.146034 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:02:02.146034 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.146034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.147037 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m14:02:02.147037 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:02:02.148247 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:02:02.150405 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:02:02.151419 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:02:02.151419 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:02:02.153620 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:02:02.153620 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:02:02.154664 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:02:02.154664 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:02:02.155667 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:02:02.156703 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:02:02.157707 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m14:02:02.159210 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m14:02:02.159210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BFB17BF0>]}
[0m14:02:02.159210 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BFBA21B0>]}
[0m14:02:02.160211 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:02:02.161365 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m14:02:02.161365 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:02:02.162671 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m14:02:02.207786 [debug] [Thread-2 (]: SQL status: BEGIN in 0.144 seconds
[0m14:02:02.209290 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.209290 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:02:02.216309 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:02:02.219812 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.220315 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:02:02.221324 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:02.223325 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.224326 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:02:02.225326 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:02:02.226326 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:02:02.226326 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.227326 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:02:02.228327 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:02:02.230332 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:02:02.230332 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:02:02.231295 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:02:02.233348 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:02:02.234348 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m14:02:02.235349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fffa9217-5184-46c9-9dee-6696395b95a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BF2E15B0>]}
[0m14:02:02.235349 [info ] [Thread-2 (]: 5 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m14:02:02.236349 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m14:02:02.237349 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:02.237349 [debug] [MainThread]: On master: BEGIN
[0m14:02:02.238491 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:02.280667 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:02:02.280667 [debug] [MainThread]: On master: COMMIT
[0m14:02:02.281668 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:02.281668 [debug] [MainThread]: On master: COMMIT
[0m14:02:02.281668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:02:02.281668 [debug] [MainThread]: On master: Close
[0m14:02:02.282669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:02.282669 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:02:02.282669 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:02:02.283669 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:02:02.283669 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m14:02:02.283669 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:02:02.283669 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m14:02:02.284669 [info ] [MainThread]: 
[0m14:02:02.284669 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:02:02.286670 [debug] [MainThread]: Command end result
[0m14:02:02.310179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:02:02.313777 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:02:02.319281 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:02:02.320283 [info ] [MainThread]: 
[0m14:02:02.320786 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:02.320786 [info ] [MainThread]: 
[0m14:02:02.321950 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:02:02.323060 [debug] [MainThread]: Command `dbt run` succeeded at 14:02:02.323060 after 4.15 seconds
[0m14:02:02.324062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD2DB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD2D99A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E0BD64E870>]}
[0m14:02:02.324062 [debug] [MainThread]: Flushing usage events
[0m14:02:04.114955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:02:04.559327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C8925280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C81CDF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C81CCB30>]}


============================== 14:02:04.565021 | 58addcd4-22de-4b8c-b006-e9ca90688902 ==============================
[0m14:02:04.565021 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:02:04.566029 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt ', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:02:04.728216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58addcd4-22de-4b8c-b006-e9ca90688902', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C8CC6A50>]}
[0m14:02:04.762078 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:02:04.764708 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:02:04.767137 [debug] [MainThread]: Command `cli deps` succeeded at 14:02:04.765748 after 0.34 seconds
[0m14:02:04.767137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C8925280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4CA159A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C8E02DB0>]}
[0m14:02:04.768448 [debug] [MainThread]: Flushing usage events
[0m14:02:06.175736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:25.429842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DAFCDE80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB4D0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB2EA5A0>]}


============================== 14:06:25.433381 | e8eced09-16b3-4183-9798-a5f2d64daaaa ==============================
[0m14:06:25.433381 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:06:25.434384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:06:25.631795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB58CB60>]}
[0m14:06:25.684565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DAFEE240>]}
[0m14:06:25.686615 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:06:26.081062 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:06:26.269345 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:26.270519 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:26.307088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB64BF80>]}
[0m14:06:26.379437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:06:26.402221 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:06:26.434612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DD3719A0>]}
[0m14:06:26.435646 [info ] [MainThread]: Found 7 models, 21 data tests, 9 sources, 447 macros
[0m14:06:26.435646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DD347920>]}
[0m14:06:26.437705 [info ] [MainThread]: 
[0m14:06:26.439210 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:26.439210 [info ] [MainThread]: 
[0m14:06:26.440726 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:26.444154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:06:26.623268 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:06:26.623268 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:06:26.624270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:26.809011 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.185 seconds
[0m14:06:26.810022 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:06:26.811975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:06:26.816975 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:06:26.816975 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:06:26.817975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:26.857930 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m14:06:26.857930 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:06:26.859077 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:26.872240 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.013 seconds
[0m14:06:26.873617 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:06:26.874639 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:06:26.880651 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:26.880651 [debug] [MainThread]: On master: BEGIN
[0m14:06:26.881652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:26.926987 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m14:06:26.926987 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:26.928156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:06:26.946328 [debug] [MainThread]: SQL status: SELECT 9 in 0.018 seconds
[0m14:06:26.949469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DCF34920>]}
[0m14:06:26.949971 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:26.949971 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:26.950946 [debug] [MainThread]: On master: BEGIN
[0m14:06:26.950946 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:06:26.950946 [debug] [MainThread]: On master: COMMIT
[0m14:06:26.951974 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:26.951974 [debug] [MainThread]: On master: COMMIT
[0m14:06:26.951974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:26.951974 [debug] [MainThread]: On master: Close
[0m14:06:26.957065 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:06:26.958070 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:06:26.958070 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:06:26.958070 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:06:26.959071 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m14:06:26.959071 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:06:26.960140 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:06:26.960140 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:06:26.960140 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:06:26.961382 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:06:26.961382 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:06:26.962398 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:06:26.962398 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:06:26.962398 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:06:26.962398 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:06:26.969106 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:06:26.970112 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:06:26.972650 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:06:26.974653 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:06:26.977152 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:06:26.979161 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:06:27.007976 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:06:27.009480 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:06:27.010025 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:06:27.010025 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:06:27.013063 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:06:27.017434 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:06:27.020416 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:06:27.021288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.021288 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:06:27.022497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:27.022497 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.023630 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.023630 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.024647 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:06:27.024647 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:06:27.024647 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:06:27.025766 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:27.025766 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:06:27.025766 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:27.070058 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m14:06:27.070058 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.071288 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:06:27.076362 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m14:06:27.076362 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.077812 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:06:27.080323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m14:06:27.080323 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m14:06:27.080323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.081258 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.081258 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:06:27.082411 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:06:27.082411 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:06:27.087672 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.087672 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:06:27.089176 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:06:27.092356 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.092356 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:06:27.093365 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.094369 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.096513 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.096513 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:06:27.097517 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:06:27.099522 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.100024 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:06:27.102070 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.105090 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.105090 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:06:27.105090 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:06:27.106106 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:06:27.106106 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.120334 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:06:27.120334 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:06:27.120334 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:06:27.121435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m14:06:27.121435 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.122440 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:06:27.124873 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.127379 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.127379 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:06:27.128462 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.128462 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:06:27.128462 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:06:27.129465 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:06:27.129973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.129973 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.130869 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.130869 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:06:27.131978 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:06:27.133070 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:06:27.139632 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:06:27.141158 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:06:27.142157 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.142157 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.146301 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:06:27.147328 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:06:27.147328 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:06:27.147328 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:06:27.148454 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:06:27.148454 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:06:27.149957 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.150871 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.152378 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:06:27.152378 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:06:27.153380 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:06:27.154434 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:06:27.155437 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:06:27.157495 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:06:27.158500 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:06:27.159500 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:06:27.160003 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:06:27.161326 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:06:27.162341 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DAF9E420>]}
[0m14:06:27.163345 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDA2E6C0>]}
[0m14:06:27.163345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:06:27.163345 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:06:27.164409 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:06:27.165411 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:06:27.164409 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:06:27.167516 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:06:27.167516 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:06:27.168532 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:06:27.168532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDA2F5C0>]}
[0m14:06:27.169035 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m14:06:27.169035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDA2FDD0>]}
[0m14:06:27.170042 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m14:06:27.170042 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:06:27.171003 [info ] [Thread-3 (]: 5 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m14:06:27.171003 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:06:27.172143 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:06:27.172143 [info ] [Thread-2 (]: 6 of 7 START sql view model public.stg_products ................................ [RUN]
[0m14:06:27.173147 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m14:06:27.173147 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:06:27.173147 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m14:06:27.174532 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m14:06:27.174532 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m14:06:27.175535 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m14:06:27.174532 [info ] [Thread-1 (]: 7 of 7 START sql view model public.stg_sellers ................................. [RUN]
[0m14:06:27.177554 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:06:27.180060 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:06:27.181156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_sellers)
[0m14:06:27.181156 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:06:27.183557 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:06:27.184560 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m14:06:27.184560 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m14:06:27.187630 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:06:27.191039 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:06:27.191039 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m14:06:27.194110 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:06:27.194110 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.195564 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.195564 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m14:06:27.196659 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:06:27.196659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:27.196659 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.197676 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:27.197676 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:06:27.197676 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:27.240089 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m14:06:27.240089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.241138 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:06:27.242141 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:06:27.242141 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.242141 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:06:27.245868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m14:06:27.245868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.246871 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:06:27.247912 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:06:27.250417 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.250919 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:06:27.251392 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:06:27.254403 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.255408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:06:27.255408 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:06:27.259037 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.259037 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:06:27.259037 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:06:27.261547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.261547 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:06:27.261547 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:06:27.262804 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:06:27.264963 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.266982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.266982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:06:27.267984 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:06:27.267984 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:06:27.269487 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:06:27.269995 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.269995 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:06:27.269995 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:27.270887 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:06:27.270887 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:06:27.273299 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:06:27.273299 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.273299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.273299 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.274691 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:06:27.274691 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:06:27.276696 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:06:27.276696 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:06:27.277727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.277727 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:27.277727 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:06:27.280232 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:06:27.281650 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:06:27.282732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:06:27.282732 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:06:27.283735 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:06:27.283735 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:06:27.283735 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:06:27.284775 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m14:06:27.285795 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:06:27.286798 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m14:06:27.286798 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDDD3AA0>]}
[0m14:06:27.287801 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:06:27.287801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDDD2D20>]}
[0m14:06:27.287801 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:27.290314 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m14:06:27.290816 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m14:06:27.290816 [info ] [Thread-1 (]: 7 of 7 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:27.292304 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8eced09-16b3-4183-9798-a5f2d64daaaa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DD99FF20>]}
[0m14:06:27.292304 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m14:06:27.293339 [info ] [Thread-2 (]: 6 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:06:27.293339 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m14:06:27.295351 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:27.295351 [debug] [MainThread]: On master: BEGIN
[0m14:06:27.295351 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:27.332323 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m14:06:27.333327 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.333327 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:27.333327 [debug] [MainThread]: On master: COMMIT
[0m14:06:27.334397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:27.334397 [debug] [MainThread]: On master: Close
[0m14:06:27.334397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:27.335397 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:06:27.335397 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:06:27.335397 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:06:27.335397 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:06:27.335397 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m14:06:27.336396 [debug] [MainThread]: Connection 'model.dbt_project.stg_order_payment' was properly closed.
[0m14:06:27.336396 [info ] [MainThread]: 
[0m14:06:27.337397 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m14:06:27.338651 [debug] [MainThread]: Command end result
[0m14:06:27.410871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:06:27.413873 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:06:27.419185 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:06:27.419185 [info ] [MainThread]: 
[0m14:06:27.420281 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:27.420281 [info ] [MainThread]: 
[0m14:06:27.421215 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:06:27.421215 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:27.421215 after 2.09 seconds
[0m14:06:27.422676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DB4F4EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDE05490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2DDE051F0>]}
[0m14:06:27.422676 [debug] [MainThread]: Flushing usage events
[0m14:06:29.174717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:36.900261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259295B3680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025928DC46E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592687C410>]}


============================== 14:06:36.903655 | 2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2 ==============================
[0m14:06:36.903655 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:06:36.904663 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt test', 'printer_width': '80', 'write_json': 'True'}
[0m14:06:37.089478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592970CEF0>]}
[0m14:06:37.143105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259297BBAA0>]}
[0m14:06:37.145105 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:06:37.550638 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:06:37.754127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:37.755149 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:37.794615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592ABCAFC0>]}
[0m14:06:37.909321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:06:37.961837 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:06:38.024491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592B2DEC90>]}
[0m14:06:38.025493 [info ] [MainThread]: Found 7 models, 21 data tests, 9 sources, 447 macros
[0m14:06:38.025493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592B2B3CE0>]}
[0m14:06:38.031554 [info ] [MainThread]: 
[0m14:06:38.032022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:38.033022 [info ] [MainThread]: 
[0m14:06:38.033022 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:38.039324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:06:38.209987 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:06:38.211009 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:06:38.211009 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:38.273053 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m14:06:38.273053 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:06:38.273053 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:38.280115 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m14:06:38.281850 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:06:38.281850 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:06:38.289159 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.289159 [debug] [MainThread]: On master: BEGIN
[0m14:06:38.290177 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:38.327446 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:06:38.328521 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.328521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:06:38.336436 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m14:06:38.339463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2baf9e18-ee3b-4daf-98eb-c18b84e0d1b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592B2DEBA0>]}
[0m14:06:38.339968 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:38.339968 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.339968 [debug] [MainThread]: On master: BEGIN
[0m14:06:38.340986 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:06:38.340986 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.340986 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.342120 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.342120 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:38.342624 [debug] [MainThread]: On master: Close
[0m14:06:38.346675 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:06:38.346675 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:06:38.347679 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:06:38.347679 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:06:38.347679 [info ] [Thread-1 (]: 1 of 21 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:06:38.347679 [info ] [Thread-2 (]: 2 of 21 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m14:06:38.349184 [info ] [Thread-3 (]: 3 of 21 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m14:06:38.350194 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:06:38.349184 [info ] [Thread-4 (]: 4 of 21 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m14:06:38.350194 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m14:06:38.351080 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505'
[0m14:06:38.351080 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:06:38.351080 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m14:06:38.351080 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:06:38.352332 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:06:38.367098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:06:38.367098 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:06:38.371885 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:06:38.375248 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:06:38.378268 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:06:38.379267 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:06:38.397132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:06:38.398150 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:06:38.399151 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:06:38.399654 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:06:38.402264 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:06:38.405589 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:06:38.407597 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:06:38.407597 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:06:38.409106 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:06:38.409106 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:38.411104 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:06:38.411104 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:06:38.412265 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m14:06:38.412265 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m14:06:38.412265 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:06:38.413268 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:38.413268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:38.414272 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m14:06:38.414272 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:06:38.459193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m14:06:38.459193 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:06:38.460351 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.461374 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m14:06:38.461374 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:06:38.461374 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.465401 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m14:06:38.466565 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:06:38.466565 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.470092 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m14:06:38.470986 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:06:38.471490 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.618412 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.158 seconds
[0m14:06:38.619412 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.157 seconds
[0m14:06:38.622625 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:06:38.623817 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m14:06:38.624818 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:06:38.624818 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m14:06:38.625891 [info ] [Thread-1 (]: 1 of 21 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.28s]
[0m14:06:38.626957 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:06:38.625891 [info ] [Thread-2 (]: 2 of 21 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.28s]
[0m14:06:38.627964 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:06:38.627964 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:06:38.629469 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:06:38.627964 [info ] [Thread-1 (]: 5 of 21 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m14:06:38.629983 [info ] [Thread-2 (]: 6 of 21 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m14:06:38.629983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m14:06:38.629983 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m14:06:38.631235 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:06:38.631235 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:06:38.635611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:06:38.639527 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:06:38.641531 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:06:38.643553 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:06:38.644557 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:06:38.648023 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:06:38.648023 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:06:38.649527 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m14:06:38.649527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:38.650044 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:06:38.651066 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m14:06:38.651831 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:38.655763 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.189 seconds
[0m14:06:38.655763 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.185 seconds
[0m14:06:38.658265 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m14:06:38.659266 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m14:06:38.659769 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m14:06:38.660273 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m14:06:38.660273 [info ] [Thread-3 (]: 3 of 21 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.31s]
[0m14:06:38.662302 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:06:38.661291 [info ] [Thread-4 (]: 4 of 21 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.31s]
[0m14:06:38.662302 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:06:38.663706 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:06:38.664706 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:06:38.663706 [info ] [Thread-3 (]: 7 of 21 START test not_null_stg_order_payment_order_id ......................... [RUN]
[0m14:06:38.665706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m14:06:38.665706 [info ] [Thread-4 (]: 8 of 21 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m14:06:38.666707 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:06:38.666707 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:06:38.671261 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:06:38.672416 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:06:38.675871 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:06:38.676873 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:06:38.679542 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:06:38.680063 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:06:38.684328 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:06:38.685477 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:06:38.685477 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m14:06:38.685477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:38.686800 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:06:38.686800 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m14:06:38.686800 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:38.702806 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m14:06:38.703807 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:06:38.703807 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.730869 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m14:06:38.730869 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:06:38.731610 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.733871 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:06:38.734872 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m14:06:38.735890 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m14:06:38.736891 [info ] [Thread-3 (]: 7 of 21 PASS not_null_stg_order_payment_order_id ............................... [[32mPASS[0m in 0.07s]
[0m14:06:38.737905 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:06:38.737905 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:06:38.737905 [info ] [Thread-3 (]: 9 of 21 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:06:38.739412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:06:38.739412 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:06:38.744052 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:06:38.745057 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:06:38.748521 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:06:38.750023 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:06:38.750023 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:06:38.751040 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:38.755932 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.052 seconds
[0m14:06:38.758456 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m14:06:38.758456 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m14:06:38.759457 [info ] [Thread-2 (]: 6 of 21 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.13s]
[0m14:06:38.759960 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:06:38.761052 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:06:38.761052 [info ] [Thread-2 (]: 10 of 21 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:06:38.762052 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:06:38.762052 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:06:38.766533 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:06:38.767536 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:06:38.770042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:06:38.772108 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:06:38.773112 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:06:38.773112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:38.795628 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m14:06:38.796628 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:06:38.796628 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.809581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.160 seconds
[0m14:06:38.810094 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:06:38.810094 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.817559 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m14:06:38.819066 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:06:38.819066 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.842283 [debug] [Thread-4 (]: SQL status: BEGIN in 0.155 seconds
[0m14:06:38.843455 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:06:38.843455 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.845943 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m14:06:38.848016 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:06:38.848016 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:06:38.849520 [info ] [Thread-2 (]: 10 of 21 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m14:06:38.850031 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:06:38.851045 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:06:38.851045 [info ] [Thread-2 (]: 11 of 21 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m14:06:38.852237 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m14:06:38.852237 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:06:38.857576 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:06:38.859080 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:06:38.863254 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:06:38.864258 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:06:38.865260 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.054 seconds
[0m14:06:38.865260 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m14:06:38.867453 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m14:06:38.867453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:38.868460 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m14:06:38.869460 [info ] [Thread-1 (]: 5 of 21 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.24s]
[0m14:06:38.869964 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:06:38.869964 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:06:38.871022 [info ] [Thread-1 (]: 12 of 21 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:06:38.871022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m14:06:38.872025 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:06:38.885134 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:06:38.887519 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:06:38.892262 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:06:38.894273 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:06:38.894273 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m14:06:38.895340 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:38.899158 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.055 seconds
[0m14:06:38.900162 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.103 seconds
[0m14:06:38.902669 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m14:06:38.904762 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:06:38.904762 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m14:06:38.904762 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:06:38.906210 [info ] [Thread-4 (]: 8 of 21 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.24s]
[0m14:06:38.908372 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:06:38.907363 [info ] [Thread-3 (]: 9 of 21 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.17s]
[0m14:06:38.908372 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:06:38.909371 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:06:38.910386 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:06:38.910386 [info ] [Thread-4 (]: 13 of 21 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m14:06:38.911401 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m14:06:38.911401 [info ] [Thread-3 (]: 14 of 21 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m14:06:38.912785 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:06:38.912785 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m14:06:38.921901 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:06:38.922931 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:06:38.929264 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:06:38.929264 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m14:06:38.930664 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:06:38.931780 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.931780 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:06:38.935783 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:06:38.936783 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:06:38.936783 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:06:38.940310 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:06:38.941991 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m14:06:38.942991 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:06:38.943992 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m14:06:38.943992 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m14:06:38.944992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:38.946002 [info ] [Thread-2 (]: 11 of 21 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.09s]
[0m14:06:38.947002 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:06:38.947002 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:06:38.948463 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:06:38.949468 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m14:06:38.949981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:38.949468 [info ] [Thread-2 (]: 15 of 21 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:06:38.951354 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m14:06:38.951354 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:06:38.957808 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:06:38.957808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.063 seconds
[0m14:06:38.959312 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:06:38.959312 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.960819 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:06:38.964822 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:06:38.965822 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:06:38.966822 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m14:06:38.967823 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:39.006802 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m14:06:39.007831 [debug] [Thread-4 (]: SQL status: BEGIN in 0.063 seconds
[0m14:06:39.007831 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:06:39.007831 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:06:39.009336 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:06:39.009336 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:06:39.029174 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m14:06:39.030177 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:06:39.030681 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:06:39.034684 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:06:39.037684 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m14:06:39.037684 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m14:06:39.039189 [info ] [Thread-2 (]: 15 of 21 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.09s]
[0m14:06:39.045698 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:06:39.046698 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:06:39.046698 [info ] [Thread-2 (]: 16 of 21 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:06:39.047698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:06:39.049203 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:06:39.057713 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:06:39.059217 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:06:39.063746 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:06:39.067747 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:06:39.067747 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m14:06:39.069252 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:39.086777 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.126 seconds
[0m14:06:39.087778 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m14:06:39.089281 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m14:06:39.090788 [info ] [Thread-1 (]: 12 of 21 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.22s]
[0m14:06:39.091790 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:06:39.092791 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:06:39.093791 [info ] [Thread-1 (]: 17 of 21 START test unique_stg_customers_customer_id ........................... [RUN]
[0m14:06:39.094791 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m14:06:39.095791 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:06:39.105805 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:06:39.107806 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:06:39.112834 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:06:39.112834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.103 seconds
[0m14:06:39.114309 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m14:06:39.115322 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m14:06:39.115322 [info ] [Thread-3 (]: 14 of 21 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.20s]
[0m14:06:39.116736 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:06:39.117736 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:06:39.117736 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:06:39.119241 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m14:06:39.120252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:39.120759 [info ] [Thread-3 (]: 18 of 21 START test unique_stg_items_ordered_item_id ........................... [RUN]
[0m14:06:39.120759 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83)
[0m14:06:39.122034 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m14:06:39.127202 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m14:06:39.129203 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m14:06:39.134238 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m14:06:39.135238 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m14:06:39.135238 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:06:39.135238 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:06:39.136673 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m14:06:39.137674 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: BEGIN
[0m14:06:39.137674 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:39.151156 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.142 seconds
[0m14:06:39.154159 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m14:06:39.154159 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m14:06:39.155173 [info ] [Thread-4 (]: 13 of 21 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.24s]
[0m14:06:39.156173 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:06:39.157173 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:06:39.158174 [info ] [Thread-4 (]: 19 of 21 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:06:39.159678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:06:39.160182 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:06:39.165495 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:06:39.167525 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:06:39.172513 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:06:39.173942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m14:06:39.173942 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:06:39.174943 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:39.174943 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:06:39.175952 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:06:39.175952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:39.189504 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m14:06:39.190020 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"
[0m14:06:39.190020 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    item_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is not null
group by item_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:39.225884 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m14:06:39.225884 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:06:39.226893 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:39.258325 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.068 seconds
[0m14:06:39.259324 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.122 seconds
[0m14:06:39.260329 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: ROLLBACK
[0m14:06:39.261857 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m14:06:39.261857 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83: Close
[0m14:06:39.262871 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m14:06:39.262871 [error] [Thread-3 (]: 18 of 21 FAIL 21 unique_stg_items_ordered_item_id .............................. [[31mFAIL 21[0m in 0.14s]
[0m14:06:39.264962 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83
[0m14:06:39.263875 [info ] [Thread-2 (]: 16 of 21 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.22s]
[0m14:06:39.264962 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:06:39.265973 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:06:39.266990 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:06:39.265973 [info ] [Thread-3 (]: 20 of 21 START test unique_stg_products_product_id ............................. [RUN]
[0m14:06:39.267990 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_items_ordered_item_id.91fa783c83, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m14:06:39.266990 [info ] [Thread-2 (]: 21 of 21 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m14:06:39.267990 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:06:39.267990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m14:06:39.341472 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.114 seconds
[0m14:06:39.344513 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:06:39.344513 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:06:39.346677 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:06:39.350189 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:06:39.350189 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:06:39.351904 [info ] [Thread-4 (]: 19 of 21 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m14:06:39.351904 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:06:39.353164 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:06:39.356319 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:06:39.356319 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:06:39.360249 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:06:39.361401 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:06:39.362458 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:06:39.362458 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:39.363651 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:06:39.363651 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m14:06:39.364651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:39.364651 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.190 seconds
[0m14:06:39.367654 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:06:39.367654 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m14:06:39.369158 [error] [Thread-1 (]: 17 of 21 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.27s]
[0m14:06:39.370159 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:06:39.405991 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m14:06:39.405991 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:06:39.405991 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:39.420075 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:06:39.422104 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:06:39.422104 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:06:39.423109 [info ] [Thread-3 (]: 20 of 21 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.16s]
[0m14:06:39.423109 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:06:39.515504 [debug] [Thread-2 (]: SQL status: BEGIN in 0.151 seconds
[0m14:06:39.516508 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:06:39.516508 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:39.519517 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:06:39.520869 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m14:06:39.521373 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m14:06:39.522470 [info ] [Thread-2 (]: 21 of 21 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.25s]
[0m14:06:39.522470 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:06:39.523578 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:39.523578 [debug] [MainThread]: On master: BEGIN
[0m14:06:39.524782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:39.566793 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:06:39.566793 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.567804 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:39.567804 [debug] [MainThread]: On master: COMMIT
[0m14:06:39.567804 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:39.567804 [debug] [MainThread]: On master: Close
[0m14:06:39.569309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:39.569309 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:06:39.569309 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m14:06:39.570316 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m14:06:39.570316 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m14:06:39.570316 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:06:39.570316 [info ] [MainThread]: 
[0m14:06:39.571530 [info ] [MainThread]: Finished running 21 data tests in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m14:06:39.574539 [debug] [MainThread]: Command end result
[0m14:06:39.601771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:06:39.604945 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:06:39.612603 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:06:39.612603 [info ] [MainThread]: 
[0m14:06:39.613862 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m14:06:39.613862 [info ] [MainThread]: 
[0m14:06:39.614868 [error] [MainThread]: [31mFailure in test unique_stg_items_ordered_item_id (models\staging\_staging_test.yml)[0m
[0m14:06:39.614868 [error] [MainThread]:   Got 21 results, configured to fail if != 0
[0m14:06:39.614868 [info ] [MainThread]: 
[0m14:06:39.615945 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_items_ordered_item_id.sql
[0m14:06:39.615945 [info ] [MainThread]: 
[0m14:06:39.615945 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m14:06:39.616998 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m14:06:39.617998 [info ] [MainThread]: 
[0m14:06:39.617998 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m14:06:39.617998 [info ] [MainThread]: 
[0m14:06:39.617998 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=2 SKIP=0 TOTAL=21
[0m14:06:39.620023 [debug] [MainThread]: Command `dbt test` failed at 14:06:39.620023 after 2.82 seconds
[0m14:06:39.620023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025928EC66C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259293EB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259293E8F80>]}
[0m14:06:39.620023 [debug] [MainThread]: Flushing usage events
[0m14:06:41.081346 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:42.990167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93B62BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BAE2BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BAE1A90>]}


============================== 14:10:42.995535 | e6b7b988-9460-4ac6-924f-073b186190cc ==============================
[0m14:10:42.995535 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:10:42.995535 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:10:43.134824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6b7b988-9460-4ac6-924f-073b186190cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BF14C50>]}
[0m14:10:43.171350 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:10:43.173128 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:10:43.175131 [debug] [MainThread]: Command `cli deps` succeeded at 14:10:43.175131 after 0.30 seconds
[0m14:10:43.176130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BCAFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93D2F82C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F93BF62B40>]}
[0m14:10:43.177132 [debug] [MainThread]: Flushing usage events
[0m14:10:44.876223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:16:07.654877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0B0D5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0DB72B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0DB73D40>]}


============================== 14:16:07.658918 | 9cf86286-2bfe-4a15-9cbc-b9c82b2147f4 ==============================
[0m14:16:07.658918 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:16:07.658918 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'log_format': 'default', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt test', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:16:07.857173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0E0532F0>]}
[0m14:16:07.911310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0B3DF440>]}
[0m14:16:07.912360 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:16:08.398746 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:16:08.620552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:16:08.620552 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:16:08.657302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0F497890>]}
[0m14:16:08.733855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:16:08.765383 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:16:08.809052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0FB7AF00>]}
[0m14:16:08.810167 [info ] [MainThread]: Found 7 models, 20 data tests, 9 sources, 447 macros
[0m14:16:08.811170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0F5F01A0>]}
[0m14:16:08.813553 [info ] [MainThread]: 
[0m14:16:08.814554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:16:08.814554 [info ] [MainThread]: 
[0m14:16:08.815630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:16:08.819152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:16:09.044702 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:16:09.045716 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:16:09.045716 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:16:09.130469 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m14:16:09.130469 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:16:09.131472 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:16:09.166118 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.034 seconds
[0m14:16:09.167513 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:16:09.168898 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:16:09.175451 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:09.175451 [debug] [MainThread]: On master: BEGIN
[0m14:16:09.176454 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:09.212535 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m14:16:09.212535 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:09.212535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:16:09.222228 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m14:16:09.225944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9cf86286-2bfe-4a15-9cbc-b9c82b2147f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0E11FD10>]}
[0m14:16:09.225944 [debug] [MainThread]: On master: ROLLBACK
[0m14:16:09.225944 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:09.226947 [debug] [MainThread]: On master: BEGIN
[0m14:16:09.226947 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:16:09.226947 [debug] [MainThread]: On master: COMMIT
[0m14:16:09.227952 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:09.227952 [debug] [MainThread]: On master: COMMIT
[0m14:16:09.227952 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:09.227952 [debug] [MainThread]: On master: Close
[0m14:16:09.233461 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:16:09.234463 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:16:09.234463 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:16:09.234463 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:16:09.235498 [info ] [Thread-1 (]: 1 of 20 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:16:09.235498 [info ] [Thread-2 (]: 2 of 20 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m14:16:09.235498 [info ] [Thread-3 (]: 3 of 20 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m14:16:09.236570 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:16:09.236570 [info ] [Thread-4 (]: 4 of 20 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m14:16:09.237589 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m14:16:09.237589 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505'
[0m14:16:09.238592 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:16:09.238592 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m14:16:09.238592 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:16:09.238592 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:16:09.253622 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:16:09.253622 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:16:09.256748 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:16:09.259754 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:16:09.263316 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:16:09.264326 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:16:09.280501 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:16:09.280501 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:16:09.281737 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:16:09.281737 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:16:09.284569 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:16:09.287204 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:16:09.288463 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:16:09.289465 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:16:09.290475 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:16:09.290475 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:16:09.291496 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:16:09.292541 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m14:16:09.292541 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:16:09.292541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:16:09.293541 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m14:16:09.293541 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:16:09.294044 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:16:09.294547 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m14:16:09.294547 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:16:09.335341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m14:16:09.336457 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:16:09.336457 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.338466 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:16:09.338466 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:16:09.338466 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.341957 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m14:16:09.341957 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:16:09.341957 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.343461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m14:16:09.344468 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:16:09.344468 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.474736 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.138 seconds
[0m14:16:09.475755 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.131 seconds
[0m14:16:09.478927 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:16:09.479931 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m14:16:09.480937 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m14:16:09.480937 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:16:09.481942 [info ] [Thread-2 (]: 2 of 20 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.24s]
[0m14:16:09.483446 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:16:09.481942 [info ] [Thread-1 (]: 1 of 20 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.25s]
[0m14:16:09.483446 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:16:09.484448 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:16:09.485381 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:16:09.484448 [info ] [Thread-2 (]: 5 of 20 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m14:16:09.485884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m14:16:09.485884 [info ] [Thread-1 (]: 6 of 20 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m14:16:09.487016 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:16:09.487016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m14:16:09.491370 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:16:09.492557 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:16:09.496691 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:16:09.498691 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:16:09.498691 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.156 seconds
[0m14:16:09.502315 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:16:09.502315 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.163 seconds
[0m14:16:09.502315 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:16:09.504439 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m14:16:09.505443 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m14:16:09.507532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:16:09.508542 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:16:09.508542 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m14:16:09.509547 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m14:16:09.509547 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m14:16:09.510550 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:16:09.510550 [info ] [Thread-3 (]: 3 of 20 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.27s]
[0m14:16:09.511550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:09.511550 [info ] [Thread-4 (]: 4 of 20 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.27s]
[0m14:16:09.512550 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m14:16:09.513550 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:16:09.513550 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:16:09.514674 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:09.514674 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:16:09.514674 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:16:09.515705 [info ] [Thread-3 (]: 7 of 20 START test not_null_stg_order_payment_order_id ......................... [RUN]
[0m14:16:09.516708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m14:16:09.515705 [info ] [Thread-4 (]: 8 of 20 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m14:16:09.516708 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:16:09.517708 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:16:09.521819 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:16:09.523112 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:16:09.527674 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:16:09.529758 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:16:09.531758 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:16:09.533081 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:16:09.535729 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:16:09.536792 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:16:09.536792 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m14:16:09.537796 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.537796 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:16:09.538797 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m14:16:09.538797 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:09.564620 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m14:16:09.564620 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m14:16:09.565528 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:16:09.565528 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:16:09.565528 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.566755 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.583647 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:16:09.584649 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:16:09.585152 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.587154 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:09.590155 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m14:16:09.590155 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m14:16:09.591446 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m14:16:09.592446 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:16:09.593447 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.592446 [info ] [Thread-3 (]: 7 of 20 PASS not_null_stg_order_payment_order_id ............................... [[32mPASS[0m in 0.08s]
[0m14:16:09.594454 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:16:09.595471 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:16:09.595471 [info ] [Thread-3 (]: 9 of 20 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:16:09.597473 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:16:09.598473 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:16:09.604361 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:16:09.605915 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:16:09.609195 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:16:09.612270 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:16:09.612270 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:16:09.613774 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.627961 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.061 seconds
[0m14:16:09.630281 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m14:16:09.631285 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m14:16:09.631285 [info ] [Thread-1 (]: 6 of 20 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.14s]
[0m14:16:09.632307 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:16:09.632307 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:16:09.632307 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m14:16:09.634320 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m14:16:09.632307 [info ] [Thread-1 (]: 10 of 20 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:16:09.635283 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:16:09.635283 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m14:16:09.636331 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:16:09.639332 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:16:09.640555 [info ] [Thread-2 (]: 5 of 20 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.15s]
[0m14:16:09.641712 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:16:09.641712 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:16:09.641712 [info ] [Thread-2 (]: 11 of 20 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m14:16:09.642726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m14:16:09.642726 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:16:09.643730 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:16:09.646984 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:16:09.649997 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:16:09.652014 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:16:09.652014 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:16:09.655375 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:16:09.655375 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:16:09.656024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:09.657025 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:16:09.658025 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m14:16:09.658025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:09.662026 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m14:16:09.662026 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:16:09.662026 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.684573 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m14:16:09.684573 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.091 seconds
[0m14:16:09.685781 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:16:09.687046 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m14:16:09.688052 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:16:09.688052 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m14:16:09.689296 [info ] [Thread-3 (]: 9 of 20 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.09s]
[0m14:16:09.690561 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:16:09.689296 [info ] [Thread-4 (]: 8 of 20 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.17s]
[0m14:16:09.690561 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:16:09.691713 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:16:09.691713 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:16:09.691713 [info ] [Thread-3 (]: 12 of 20 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:16:09.692912 [info ] [Thread-4 (]: 13 of 20 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m14:16:09.693416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m14:16:09.693416 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m14:16:09.694418 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:16:09.694418 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:16:09.701656 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:16:09.706552 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:16:09.707556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m14:16:09.707556 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m14:16:09.708560 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:16:09.708560 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:16:09.709565 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.709565 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.709565 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:16:09.712620 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:16:09.712620 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:16:09.714627 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:16:09.715654 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:16:09.717243 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m14:16:09.717243 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m14:16:09.718248 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:16:09.719358 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m14:16:09.718248 [info ] [Thread-2 (]: 11 of 20 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m14:16:09.719358 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:16:09.719358 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.720490 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:16:09.720490 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m14:16:09.721495 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:16:09.721495 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:09.722504 [info ] [Thread-2 (]: 14 of 20 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m14:16:09.723506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m14:16:09.723506 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:16:09.731764 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:16:09.731764 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m14:16:09.734279 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:16:09.735294 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:16:09.735847 [info ] [Thread-1 (]: 10 of 20 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.10s]
[0m14:16:09.736857 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:16:09.737858 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:16:09.742148 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:16:09.742148 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:16:09.742148 [info ] [Thread-1 (]: 15 of 20 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:16:09.743652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m14:16:09.743652 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:16:09.749036 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:16:09.750131 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:16:09.750131 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m14:16:09.751134 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:09.752262 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:16:09.756360 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:16:09.757360 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:16:09.758361 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m14:16:09.758361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:09.775549 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m14:16:09.775549 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:16:09.776409 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.776409 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m14:16:09.776409 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:16:09.777712 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.800344 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m14:16:09.801344 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:16:09.801344 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.807948 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m14:16:09.808948 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:16:09.808948 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.813452 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:16:09.815959 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m14:16:09.816959 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m14:16:09.817960 [info ] [Thread-1 (]: 15 of 20 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.07s]
[0m14:16:09.818960 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:16:09.819960 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:16:09.819960 [info ] [Thread-1 (]: 16 of 20 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:16:09.820960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:16:09.821961 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:16:09.829973 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:16:09.831974 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:16:09.838000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:16:09.839999 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:16:09.840999 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m14:16:09.842000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:16:09.896096 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.118 seconds
[0m14:16:09.898140 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m14:16:09.899143 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m14:16:09.900143 [info ] [Thread-4 (]: 13 of 20 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.21s]
[0m14:16:09.901293 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:16:09.901293 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:16:09.902606 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.101 seconds
[0m14:16:09.902606 [info ] [Thread-4 (]: 17 of 20 START test unique_stg_customers_customer_id ........................... [RUN]
[0m14:16:09.904710 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m14:16:09.905747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_customers_customer_id.c7614daada)
[0m14:16:09.905747 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:16:09.906410 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m14:16:09.911699 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:16:09.912699 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.136 seconds
[0m14:16:09.914705 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m14:16:09.912699 [info ] [Thread-2 (]: 14 of 20 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.19s]
[0m14:16:09.915728 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:16:09.915728 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m14:16:09.916732 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:16:09.916732 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:16:09.919732 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:16:09.920733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.079 seconds
[0m14:16:09.920733 [info ] [Thread-3 (]: 12 of 20 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.23s]
[0m14:16:09.921733 [info ] [Thread-2 (]: 18 of 20 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:16:09.921733 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:16:09.922733 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:16:09.922733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:16:09.923733 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:16:09.924235 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:16:09.924738 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:16:09.924738 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:16:09.925754 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: BEGIN
[0m14:16:09.925754 [info ] [Thread-3 (]: 19 of 20 START test unique_stg_products_product_id ............................. [RUN]
[0m14:16:09.930505 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:16:09.931505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:16:09.932506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m14:16:09.933507 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:16:09.939531 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:16:09.940547 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:16:09.943764 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:16:09.944769 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:16:09.950784 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:16:09.952785 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:16:09.952785 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:16:09.953785 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:16:09.955303 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:16:09.956095 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:16:09.956095 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:09.990908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m14:16:09.991907 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_customers_customer_id.c7614daada"
[0m14:16:09.991907 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_customers_customer_id.c7614daada"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:16:10.001918 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m14:16:10.003420 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:16:10.003420 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:16:10.008558 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m14:16:10.009564 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:16:10.009564 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:16:10.033616 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m14:16:10.034622 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:16:10.035562 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:16:10.035562 [info ] [Thread-3 (]: 19 of 20 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.10s]
[0m14:16:10.036632 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:16:10.037632 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:16:10.037632 [info ] [Thread-3 (]: 20 of 20 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m14:16:10.038633 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_products_product_id.7d950a1467, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m14:16:10.038633 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:16:10.106685 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:16:10.106685 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.182 seconds
[0m14:16:10.107688 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.103 seconds
[0m14:16:10.108699 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m14:16:10.109823 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:16:10.110828 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m14:16:10.110828 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:16:10.111833 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:16:10.114342 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:16:10.111833 [info ] [Thread-1 (]: 16 of 20 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.29s]
[0m14:16:10.115375 [info ] [Thread-2 (]: 18 of 20 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.19s]
[0m14:16:10.116572 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:16:10.116572 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:16:10.117582 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:16:10.117582 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m14:16:10.118589 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:16:10.153658 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.160 seconds
[0m14:16:10.155869 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: ROLLBACK
[0m14:16:10.155869 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_customers_customer_id.c7614daada: Close
[0m14:16:10.157000 [error] [Thread-4 (]: 17 of 20 FAIL 99441 unique_stg_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.25s]
[0m14:16:10.157000 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_customers_customer_id.c7614daada
[0m14:16:10.257472 [debug] [Thread-3 (]: SQL status: BEGIN in 0.139 seconds
[0m14:16:10.257472 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:16:10.258582 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:16:10.260975 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:16:10.262079 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m14:16:10.263082 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m14:16:10.263595 [info ] [Thread-3 (]: 20 of 20 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.23s]
[0m14:16:10.263595 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:16:10.265100 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:10.265100 [debug] [MainThread]: On master: BEGIN
[0m14:16:10.266101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:16:10.303395 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m14:16:10.304397 [debug] [MainThread]: On master: COMMIT
[0m14:16:10.304397 [debug] [MainThread]: Using postgres connection "master"
[0m14:16:10.304397 [debug] [MainThread]: On master: COMMIT
[0m14:16:10.304397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:16:10.305541 [debug] [MainThread]: On master: Close
[0m14:16:10.305541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:16:10.305541 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:16:10.305541 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m14:16:10.306543 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:16:10.306543 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m14:16:10.306543 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m14:16:10.306543 [info ] [MainThread]: 
[0m14:16:10.307543 [info ] [MainThread]: Finished running 20 data tests in 0 hours 0 minutes and 1.49 seconds (1.49s).
[0m14:16:10.310775 [debug] [MainThread]: Command end result
[0m14:16:10.333803 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:16:10.336320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:16:10.342825 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:16:10.343827 [info ] [MainThread]: 
[0m14:16:10.343827 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:16:10.344338 [info ] [MainThread]: 
[0m14:16:10.344338 [error] [MainThread]: [31mFailure in test unique_stg_customers_customer_id (models\staging\_staging_test.yml)[0m
[0m14:16:10.345375 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m14:16:10.345375 [info ] [MainThread]: 
[0m14:16:10.345375 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_staging_test.yml\unique_stg_customers_customer_id.sql
[0m14:16:10.346379 [info ] [MainThread]: 
[0m14:16:10.346379 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=1 SKIP=0 TOTAL=20
[0m14:16:10.347404 [debug] [MainThread]: Command `dbt test` failed at 14:16:10.347404 after 2.79 seconds
[0m14:16:10.348404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0D9E27B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0DD7B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0F68BFB0>]}
[0m14:16:10.348404 [debug] [MainThread]: Flushing usage events
[0m14:16:11.890388 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:22.751931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DADD89E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DADD89B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DADD94C0>]}


============================== 14:18:22.757368 | 409a7441-e9c3-426b-a0d0-f5420da86a62 ==============================
[0m14:18:22.757368 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:18:22.758519 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'printer_width': '80', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:18:22.983762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DAEF6060>]}
[0m14:18:23.041439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DAAE6DE0>]}
[0m14:18:23.043465 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:18:23.505581 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:18:23.701391 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:18:23.702393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:18:23.739708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DB0BB440>]}
[0m14:18:23.817815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:18:23.838354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:18:23.880237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DCA7CE60>]}
[0m14:18:23.881241 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m14:18:23.881241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DCA0FAA0>]}
[0m14:18:23.884750 [info ] [MainThread]: 
[0m14:18:23.885775 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:23.886307 [info ] [MainThread]: 
[0m14:18:23.886307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:18:23.890461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:18:24.040636 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:18:24.041636 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:18:24.041636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:24.085652 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m14:18:24.086666 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:18:24.086666 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:18:24.097041 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.009 seconds
[0m14:18:24.098044 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:18:24.098044 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:18:24.105057 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.105057 [debug] [MainThread]: On master: BEGIN
[0m14:18:24.105057 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:24.243728 [debug] [MainThread]: SQL status: BEGIN in 0.139 seconds
[0m14:18:24.244850 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.244850 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:18:24.253520 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m14:18:24.255575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409a7441-e9c3-426b-a0d0-f5420da86a62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169D827F7D0>]}
[0m14:18:24.256582 [debug] [MainThread]: On master: ROLLBACK
[0m14:18:24.256582 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.256582 [debug] [MainThread]: On master: BEGIN
[0m14:18:24.257585 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:18:24.257585 [debug] [MainThread]: On master: COMMIT
[0m14:18:24.257585 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:24.257585 [debug] [MainThread]: On master: COMMIT
[0m14:18:24.258686 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:18:24.258686 [debug] [MainThread]: On master: Close
[0m14:18:24.262725 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:18:24.262725 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:18:24.262725 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:18:24.263725 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:18:24.263725 [info ] [Thread-1 (]: 1 of 19 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:18:24.263725 [info ] [Thread-2 (]: 2 of 19 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m14:18:24.264812 [info ] [Thread-3 (]: 3 of 19 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m14:18:24.265811 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:18:24.264812 [info ] [Thread-4 (]: 4 of 19 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m14:18:24.265811 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m14:18:24.265811 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505'
[0m14:18:24.266880 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:18:24.266880 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m14:18:24.266880 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:18:24.267934 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:18:24.280949 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:18:24.280949 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:18:24.285504 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:18:24.288514 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:18:24.291958 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:18:24.293462 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:18:24.308859 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:18:24.308859 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:18:24.309866 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:18:24.309866 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:18:24.312273 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:18:24.314297 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:18:24.316668 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:18:24.317671 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:18:24.317671 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:18:24.317671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:24.318924 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:18:24.319996 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m14:18:24.319996 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:18:24.319996 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:18:24.319996 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:18:24.319996 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m14:18:24.321501 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m14:18:24.321501 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:18:24.321501 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:18:24.362629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:18:24.362629 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:18:24.363629 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.366664 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:18:24.366664 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:18:24.367668 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.368671 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m14:18:24.368671 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:18:24.369940 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.426846 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.059 seconds
[0m14:18:24.428006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m14:18:24.430485 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m14:18:24.431812 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:18:24.433112 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:18:24.433614 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m14:18:24.433614 [info ] [Thread-1 (]: 1 of 19 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.17s]
[0m14:18:24.435578 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:18:24.434615 [info ] [Thread-2 (]: 2 of 19 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.17s]
[0m14:18:24.435578 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:18:24.436581 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.066 seconds
[0m14:18:24.436581 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:18:24.438599 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m14:18:24.436581 [info ] [Thread-1 (]: 5 of 19 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m14:18:24.438599 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:18:24.439778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m14:18:24.439778 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m14:18:24.439778 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:18:24.439778 [info ] [Thread-2 (]: 6 of 19 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m14:18:24.444454 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:18:24.445650 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m14:18:24.445650 [info ] [Thread-4 (]: 4 of 19 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.18s]
[0m14:18:24.446653 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:18:24.446653 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:18:24.450895 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:18:24.451901 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:18:24.451901 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:18:24.451901 [info ] [Thread-4 (]: 7 of 19 START test not_null_stg_order_payment_order_id ......................... [RUN]
[0m14:18:24.455921 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:18:24.456921 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m14:18:24.456921 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:18:24.456921 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:18:24.462235 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:18:24.465246 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:18:24.466248 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:18:24.467249 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m14:18:24.467249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:24.468249 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:18:24.469249 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:18:24.472435 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:18:24.473939 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m14:18:24.474442 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:24.476024 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:18:24.476024 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m14:18:24.476024 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:24.498671 [debug] [Thread-3 (]: SQL status: BEGIN in 0.177 seconds
[0m14:18:24.500089 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:18:24.500089 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.524319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m14:18:24.525332 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:18:24.525921 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.530082 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m14:18:24.531442 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:18:24.531442 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.588466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.063 seconds
[0m14:18:24.590471 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m14:18:24.590471 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m14:18:24.591767 [info ] [Thread-1 (]: 5 of 19 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.15s]
[0m14:18:24.591767 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:18:24.591767 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:18:24.593206 [info ] [Thread-1 (]: 8 of 19 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m14:18:24.593710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:18:24.593710 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:18:24.598272 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:18:24.598272 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.066 seconds
[0m14:18:24.599429 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m14:18:24.600428 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m14:18:24.601639 [info ] [Thread-2 (]: 6 of 19 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.15s]
[0m14:18:24.601639 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:18:24.602671 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:18:24.606927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:18:24.606927 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:18:24.607970 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:18:24.608978 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:18:24.608978 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:18:24.613591 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:18:24.613591 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:18:24.615097 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m14:18:24.615097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:24.616366 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:18:24.618964 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:18:24.619964 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:18:24.619964 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:18:24.621474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:24.645253 [debug] [Thread-4 (]: SQL status: BEGIN in 0.169 seconds
[0m14:18:24.646279 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:18:24.646279 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.648419 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:18:24.649419 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m14:18:24.649419 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m14:18:24.650420 [info ] [Thread-4 (]: 7 of 19 PASS not_null_stg_order_payment_order_id ............................... [[32mPASS[0m in 0.19s]
[0m14:18:24.651420 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:18:24.651420 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:18:24.652447 [info ] [Thread-4 (]: 10 of 19 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:18:24.652447 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:18:24.652447 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:18:24.657602 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:18:24.658602 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.157 seconds
[0m14:18:24.659674 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m14:18:24.660674 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m14:18:24.660674 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:18:24.660674 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:18:24.661812 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:18:24.661812 [info ] [Thread-3 (]: 3 of 19 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.40s]
[0m14:18:24.663043 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.666654 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:18:24.666654 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:18:24.667658 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:18:24.667658 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:18:24.668661 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:18:24.668661 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.668661 [info ] [Thread-3 (]: 11 of 19 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m14:18:24.669666 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m14:18:24.670803 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:18:24.670803 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:18:24.671802 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:18:24.675218 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:18:24.676301 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:24.677448 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:18:24.680604 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:18:24.681606 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:18:24.681606 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m14:18:24.682898 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:24.711118 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m14:18:24.711118 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.042 seconds
[0m14:18:24.712527 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m14:18:24.713527 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:18:24.714647 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m14:18:24.714647 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:18:24.715653 [info ] [Thread-1 (]: 8 of 19 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.12s]
[0m14:18:24.716657 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.11s]
[0m14:18:24.717794 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:18:24.717794 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:18:24.717794 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:18:24.718799 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:18:24.718799 [info ] [Thread-1 (]: 12 of 19 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:18:24.720004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m14:18:24.720004 [info ] [Thread-2 (]: 13 of 19 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m14:18:24.720004 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:18:24.720004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m14:18:24.727623 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:18:24.728624 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m14:18:24.728624 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:18:24.728624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m14:18:24.729666 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:18:24.734550 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:18:24.734550 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:18:24.735439 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.735439 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:18:24.735439 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.738582 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:18:24.738582 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:18:24.741062 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:18:24.741062 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:18:24.742374 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m14:18:24.743876 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:18:24.744386 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m14:18:24.744386 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m14:18:24.744386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:18:24.745419 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:18:24.745419 [info ] [Thread-3 (]: 11 of 19 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m14:18:24.746413 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m14:18:24.747413 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.011 seconds
[0m14:18:24.748414 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:18:24.748414 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:24.750414 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:18:24.750414 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:18:24.751520 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:18:24.751520 [info ] [Thread-3 (]: 14 of 19 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m14:18:24.751520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m14:18:24.753525 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:18:24.752525 [info ] [Thread-4 (]: 10 of 19 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.10s]
[0m14:18:24.764358 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:18:24.764358 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:18:24.765426 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:18:24.765426 [info ] [Thread-4 (]: 15 of 19 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:18:24.766539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m14:18:24.766539 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:18:24.767558 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:18:24.771955 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:18:24.775398 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:18:24.775965 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:18:24.776985 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:18:24.776985 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m14:18:24.780074 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:18:24.780074 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:24.781079 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:18:24.782083 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m14:18:24.782083 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:24.797475 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m14:18:24.797475 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:18:24.798502 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.828637 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m14:18:24.828637 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:18:24.829638 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.831638 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m14:18:24.831638 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:18:24.832638 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.835662 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:18:24.838060 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m14:18:24.838060 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m14:18:24.839062 [info ] [Thread-4 (]: 15 of 19 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.07s]
[0m14:18:24.841063 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:18:24.841063 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:18:24.842063 [info ] [Thread-4 (]: 16 of 19 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:18:24.842063 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:18:24.843568 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:18:24.852082 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:18:24.855093 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:18:24.859096 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:18:24.862096 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:18:24.862096 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m14:18:24.862096 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:18:24.903538 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.105 seconds
[0m14:18:24.905527 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m14:18:24.906047 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m14:18:24.907051 [info ] [Thread-2 (]: 13 of 19 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.19s]
[0m14:18:24.908051 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:18:24.908051 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:18:24.909056 [info ] [Thread-2 (]: 17 of 19 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:18:24.909056 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:18:24.910072 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:18:24.919435 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:18:24.919435 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.090 seconds
[0m14:18:24.920446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.175 seconds
[0m14:18:24.921950 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m14:18:24.921950 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:18:24.921950 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.923468 [debug] [Thread-4 (]: SQL status: BEGIN in 0.060 seconds
[0m14:18:24.923468 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m14:18:24.923468 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:18:24.924483 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:18:24.926561 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:18:24.928024 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:18:24.928024 [info ] [Thread-3 (]: 14 of 19 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.18s]
[0m14:18:24.929247 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:18:24.929247 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:18:24.930246 [info ] [Thread-3 (]: 18 of 19 START test unique_stg_products_product_id ............................. [RUN]
[0m14:18:24.930246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m14:18:24.931247 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:18:24.932247 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:18:24.932247 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:18:24.940263 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:18:24.941264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:18:24.942264 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:18:24.947861 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:18:24.949861 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:18:24.950862 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:18:24.951862 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:24.995954 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m14:18:24.995954 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:18:24.996955 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:18:24.997955 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:18:24.997955 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:18:24.998955 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:18:25.020978 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.021 seconds
[0m14:18:25.022480 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:18:25.023482 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:18:25.023482 [info ] [Thread-3 (]: 18 of 19 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m14:18:25.024986 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:18:25.024986 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:18:25.026112 [info ] [Thread-3 (]: 19 of 19 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m14:18:25.026112 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_products_product_id.7d950a1467, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m14:18:25.027165 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:18:25.031430 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:18:25.033461 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:18:25.039776 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:18:25.040781 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:18:25.041787 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m14:18:25.041787 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:18:25.052570 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.123 seconds
[0m14:18:25.054574 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m14:18:25.055532 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m14:18:25.056079 [info ] [Thread-4 (]: 16 of 19 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.21s]
[0m14:18:25.057439 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:18:25.078799 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.154 seconds
[0m14:18:25.080799 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m14:18:25.081800 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m14:18:25.081800 [info ] [Thread-1 (]: 12 of 19 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.36s]
[0m14:18:25.082800 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:18:25.090950 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m14:18:25.092059 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:18:25.092059 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:18:25.097963 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:18:25.099987 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m14:18:25.099987 [debug] [Thread-3 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m14:18:25.101404 [info ] [Thread-3 (]: 19 of 19 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.08s]
[0m14:18:25.102437 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:18:25.112436 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.115 seconds
[0m14:18:25.113437 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:18:25.114697 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:18:25.115702 [info ] [Thread-2 (]: 17 of 19 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.21s]
[0m14:18:25.115702 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:18:25.117711 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:25.117711 [debug] [MainThread]: On master: BEGIN
[0m14:18:25.117711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:18:25.157525 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:18:25.158664 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.158664 [debug] [MainThread]: Using postgres connection "master"
[0m14:18:25.159667 [debug] [MainThread]: On master: COMMIT
[0m14:18:25.159667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:18:25.159667 [debug] [MainThread]: On master: Close
[0m14:18:25.160681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:25.160681 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:18:25.160681 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b' was properly closed.
[0m14:18:25.160681 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:18:25.161680 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m14:18:25.161680 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m14:18:25.161680 [info ] [MainThread]: 
[0m14:18:25.162686 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m14:18:25.165624 [debug] [MainThread]: Command end result
[0m14:18:25.253731 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:18:25.257237 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:18:25.265446 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:18:25.266735 [info ] [MainThread]: 
[0m14:18:25.266735 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:25.267737 [info ] [MainThread]: 
[0m14:18:25.267737 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m14:18:25.269736 [debug] [MainThread]: Command `dbt test` succeeded at 14:18:25.268743 after 2.65 seconds
[0m14:18:25.269736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DA1CC770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DA1CE7B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000169DACA48F0>]}
[0m14:18:25.269736 [debug] [MainThread]: Flushing usage events
[0m14:18:26.707448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:00.440798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB276AFFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB29C8CEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299C23F0>]}


============================== 14:20:00.445313 | c4156546-e742-4313-9712-1abe6e4b566a ==============================
[0m14:20:00.445313 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:20:00.445313 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:20:00.579620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4156546-e742-4313-9712-1abe6e4b566a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2A4B7980>]}
[0m14:20:00.613376 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:20:00.615532 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:20:00.616591 [debug] [MainThread]: Command `cli deps` succeeded at 14:20:00.616591 after 0.28 seconds
[0m14:20:00.617989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299C3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB299C23F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB2A6A1850>]}
[0m14:20:00.617989 [debug] [MainThread]: Flushing usage events
[0m14:20:02.383744 [debug] [MainThread]: An error was encountered while trying to flush usage events
dbt-fusion 2.0.0-preview.48
   Loading ~/.dbt/profiles.yml
error: dbt0102: Deprecated test arguments: ["field", "to"] at top-level detected. Please migrate to the new format under the '[33marguments[0m' field: https://docs.getdbt.com/reference/deprecations#missingargumentspropertyingenerictestdeprecation.
  --> models\staging\_staging_test.yml:51:22
error: dbt0102: Deprecated test arguments: ["field", "to"] at top-level detected. Please migrate to the new format under the '[33marguments[0m' field: https://docs.getdbt.com/reference/deprecations#missingargumentspropertyingenerictestdeprecation.
  --> models\staging\_staging_test.yml:57:22
error: dbt0102: Deprecated test arguments: ["field", "to"] at top-level detected. Please migrate to the new format under the '[33marguments[0m' field: https://docs.getdbt.com/reference/deprecations#missingargumentspropertyingenerictestdeprecation.
  --> models\staging\_staging_test.yml:63:22
error: dbt0102: Deprecated test arguments: ["field", "to"] at top-level detected. Please migrate to the new format under the '[33marguments[0m' field: https://docs.getdbt.com/reference/deprecations#missingargumentspropertyingenerictestdeprecation.
  --> models\staging\_staging_test.yml:33:22
error: dbt0102: Deprecated test arguments: ["field", "to"] at top-level detected. Please migrate to the new format under the '[33marguments[0m' field: https://docs.getdbt.com/reference/deprecations#missingargumentspropertyingenerictestdeprecation.
  --> models\staging\_staging_test.yml:24:22
suggestion: Run 'dbt deps' to see the latest fusion compatible packages. For compatibility errors, try the autofix script: https://github.com/dbt-labs/dbt-autofix

==================== Execution Summary =====================
Finished 'ls' with 5 errors for target 'dev' [1.5s]
[0m14:24:28.277243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912ABBA1B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912ABB8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912ABB8200>]}


============================== 14:24:28.281257 | 66d37336-af7d-4d7e-8702-09a742348e26 ==============================
[0m14:24:28.281257 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:24:28.282259 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt ls', 'no_print': 'None', 'printer_width': '80', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:24:28.473245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66d37336-af7d-4d7e-8702-09a742348e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912A8D4B60>]}
[0m14:24:28.525210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66d37336-af7d-4d7e-8702-09a742348e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019124C53E90>]}
[0m14:24:28.527222 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:24:28.918091 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:24:29.140441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:29.140441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:29.177449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '66d37336-af7d-4d7e-8702-09a742348e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912C490B30>]}
[0m14:24:29.250970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:24:29.274474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:24:29.302771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '66d37336-af7d-4d7e-8702-09a742348e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912C493BF0>]}
[0m14:24:29.304142 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m14:24:29.304142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '66d37336-af7d-4d7e-8702-09a742348e26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912B0FB890>]}
[0m14:24:29.306214 [info ] [MainThread]: dbt_project.staging.stg_customers
[0m14:24:29.306214 [info ] [MainThread]: dbt_project.staging.stg_items_ordered
[0m14:24:29.306214 [info ] [MainThread]: dbt_project.staging.stg_name_translation
[0m14:24:29.306214 [info ] [MainThread]: dbt_project.staging.stg_order_payment
[0m14:24:29.307545 [info ] [MainThread]: dbt_project.staging.stg_orders
[0m14:24:29.307545 [info ] [MainThread]: dbt_project.staging.stg_products
[0m14:24:29.307545 [info ] [MainThread]: dbt_project.staging.stg_sellers
[0m14:24:29.308547 [info ] [MainThread]: source:dbt_project.raw.olist_customers_dataset
[0m14:24:29.308547 [info ] [MainThread]: source:dbt_project.raw.olist_geolocation_dataset
[0m14:24:29.308547 [info ] [MainThread]: source:dbt_project.raw.olist_order_items_dataset
[0m14:24:29.308547 [info ] [MainThread]: source:dbt_project.raw.olist_order_payments_dataset
[0m14:24:29.309553 [info ] [MainThread]: source:dbt_project.raw.olist_order_reviews_dataset
[0m14:24:29.309553 [info ] [MainThread]: source:dbt_project.raw.olist_orders_dataset
[0m14:24:29.310654 [info ] [MainThread]: source:dbt_project.raw.olist_products_dataset
[0m14:24:29.310654 [info ] [MainThread]: source:dbt_project.raw.olist_sellers_dataset
[0m14:24:29.310654 [info ] [MainThread]: source:dbt_project.raw.product_category_name_translation
[0m14:24:29.310654 [info ] [MainThread]: dbt_project.staging.not_null_stg_customers_customer_id
[0m14:24:29.311673 [info ] [MainThread]: dbt_project.staging.not_null_stg_customers_customer_unique_id
[0m14:24:29.311673 [info ] [MainThread]: dbt_project.staging.not_null_stg_items_ordered_item_id
[0m14:24:29.311673 [info ] [MainThread]: dbt_project.staging.not_null_stg_items_ordered_order_id
[0m14:24:29.311673 [info ] [MainThread]: dbt_project.staging.not_null_stg_items_ordered_product_id
[0m14:24:29.312683 [info ] [MainThread]: dbt_project.staging.not_null_stg_items_ordered_seller_id
[0m14:24:29.312683 [info ] [MainThread]: dbt_project.staging.not_null_stg_order_payment_order_id
[0m14:24:29.312683 [info ] [MainThread]: dbt_project.staging.not_null_stg_orders_customer_id
[0m14:24:29.313690 [info ] [MainThread]: dbt_project.staging.not_null_stg_orders_order_id
[0m14:24:29.313690 [info ] [MainThread]: dbt_project.staging.not_null_stg_products_product_id
[0m14:24:29.313690 [info ] [MainThread]: dbt_project.staging.not_null_stg_sellers_seller_id
[0m14:24:29.313690 [info ] [MainThread]: dbt_project.staging.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_
[0m14:24:29.314693 [info ] [MainThread]: dbt_project.staging.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_
[0m14:24:29.314693 [info ] [MainThread]: dbt_project.staging.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_
[0m14:24:29.315697 [info ] [MainThread]: dbt_project.staging.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_
[0m14:24:29.315697 [info ] [MainThread]: dbt_project.staging.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
[0m14:24:29.315697 [info ] [MainThread]: dbt_project.staging.unique_stg_orders_order_id
[0m14:24:29.315697 [info ] [MainThread]: dbt_project.staging.unique_stg_products_product_id
[0m14:24:29.316700 [info ] [MainThread]: dbt_project.staging.unique_stg_sellers_seller_id
[0m14:24:29.317702 [debug] [MainThread]: Command `dbt ls` succeeded at 14:24:29.317702 after 1.14 seconds
[0m14:24:29.317702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019127FB0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912A780800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001912A944A10>]}
[0m14:24:29.317702 [debug] [MainThread]: Flushing usage events
[0m14:24:30.882079 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:44.255400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B645DEDFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B645FD5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B645E950D0>]}


============================== 14:25:44.259414 | e056ca7b-4de4-49a3-9093-f62466c6910b ==============================
[0m14:25:44.259414 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:25:44.260420 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'no_print': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m14:25:44.452332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B646498770>]}
[0m14:25:44.506410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B645DEDFD0>]}
[0m14:25:44.507423 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:25:44.925232 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:25:45.127626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:25:45.127626 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:25:45.165029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B647DBAC30>]}
[0m14:25:45.241558 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:25:45.260635 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:25:45.297047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B648173A10>]}
[0m14:25:45.297047 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m14:25:45.298183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B647DBBE90>]}
[0m14:25:45.300250 [info ] [MainThread]: 
[0m14:25:45.300250 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:45.301439 [info ] [MainThread]: 
[0m14:25:45.301439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:45.304822 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:25:45.748785 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:25:45.749789 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:25:45.749789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:45.953337 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.204 seconds
[0m14:25:45.955352 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:25:45.956608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:25:45.961724 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:25:45.962724 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:25:45.962724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:46.003416 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m14:25:46.003416 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:25:46.003416 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:25:46.020306 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.016 seconds
[0m14:25:46.022308 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:25:46.022308 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:25:46.028975 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.028975 [debug] [MainThread]: On master: BEGIN
[0m14:25:46.029975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:46.073068 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m14:25:46.073068 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.073068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:25:46.087677 [debug] [MainThread]: SQL status: SELECT 9 in 0.014 seconds
[0m14:25:46.090964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6480293A0>]}
[0m14:25:46.090964 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:46.092051 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.092051 [debug] [MainThread]: On master: BEGIN
[0m14:25:46.092051 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:25:46.093056 [debug] [MainThread]: On master: COMMIT
[0m14:25:46.093056 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.093056 [debug] [MainThread]: On master: COMMIT
[0m14:25:46.093056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:46.094060 [debug] [MainThread]: On master: Close
[0m14:25:46.099290 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:25:46.100480 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:25:46.100480 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:25:46.100480 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:25:46.101500 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_customers ............................... [RUN]
[0m14:25:46.101500 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:25:46.102507 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:25:46.102507 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:25:46.102507 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:25:46.103766 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:25:46.103766 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:25:46.104862 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:25:46.104862 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:25:46.104862 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:25:46.104862 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:25:46.105867 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:25:46.111980 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:25:46.114986 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:25:46.117382 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:25:46.119392 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:25:46.122402 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:25:46.154335 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:25:46.155828 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:25:46.158932 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:25:46.159932 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:25:46.159932 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:25:46.163948 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:25:46.167433 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:25:46.167433 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.168436 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.168436 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:25:46.169565 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:25:46.169565 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:46.170757 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.170757 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:46.170757 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.171787 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:25:46.171787 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:25:46.172791 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:25:46.172791 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:46.215161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:25:46.216161 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.216161 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:25:46.221611 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m14:25:46.222612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.222612 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:25:46.224940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m14:25:46.224940 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.224940 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:25:46.227127 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m14:25:46.228131 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.228131 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:25:46.235122 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:25:46.236125 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:25:46.236125 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m14:25:46.236125 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:25:46.242283 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.245412 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.247414 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.250466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.250466 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:25:46.251776 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:25:46.251776 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:25:46.251776 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:25:46.253784 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.253784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:25:46.255054 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:25:46.255054 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:25:46.257214 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.259216 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.262510 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.263839 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.265257 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:25:46.265257 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:25:46.265257 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:25:46.266277 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:25:46.267443 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:25:46.267443 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.267443 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.268443 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.282279 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:25:46.283282 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:25:46.284282 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:25:46.286297 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:25:46.286297 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.286297 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.286297 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.287559 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.287559 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:25:46.287559 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:25:46.288562 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:25:46.288562 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:25:46.290602 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:46.290602 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:46.291611 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:46.291611 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:25:46.297927 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:25:46.300116 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:25:46.302218 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:25:46.304423 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:25:46.309426 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:25:46.309426 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:25:46.310489 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:25:46.311555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:25:46.311555 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:25:46.311555 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:25:46.312568 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:25:46.312568 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:25:46.317676 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:25:46.317676 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:25:46.318676 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:25:46.318676 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:25:46.320754 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:25:46.321759 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:25:46.322772 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:25:46.323778 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:25:46.327277 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B643BFB9B0>]}
[0m14:25:46.328280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6487DAC30>]}
[0m14:25:46.328280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B648808D70>]}
[0m14:25:46.328280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B645DEE510>]}
[0m14:25:46.329280 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:25:46.329280 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:25:46.330643 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:25:46.330643 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:25:46.330643 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:25:46.332147 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:25:46.333150 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:25:46.333150 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m14:25:46.333150 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:25:46.334150 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m14:25:46.334150 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_sellers
[0m14:25:46.335159 [info ] [Thread-3 (]: 5 of 7 START sql view model public.stg_orders .................................. [RUN]
[0m14:25:46.335159 [info ] [Thread-4 (]: 6 of 7 START sql view model public.stg_products ................................ [RUN]
[0m14:25:46.336430 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m14:25:46.335159 [info ] [Thread-2 (]: 7 of 7 START sql view model public.stg_sellers ................................. [RUN]
[0m14:25:46.336430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m14:25:46.336430 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m14:25:46.336430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m14:25:46.337787 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m14:25:46.339919 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:25:46.340920 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:25:46.343144 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:25:46.346155 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:25:46.347445 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m14:25:46.350574 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:25:46.350574 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_sellers
[0m14:25:46.351582 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m14:25:46.354744 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:25:46.358115 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:25:46.359233 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.359233 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:25:46.359233 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:25:46.360364 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.361496 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:25:46.361496 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:25:46.361496 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.362516 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m14:25:46.362516 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:25:46.402036 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m14:25:46.402036 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.403040 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:25:46.405047 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m14:25:46.405047 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.405047 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:25:46.408493 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:25:46.411557 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.413558 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m14:25:46.413558 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:25:46.413558 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:25:46.414633 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.417143 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.417143 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:25:46.417143 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:25:46.417143 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.420525 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.420525 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:25:46.421662 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:25:46.423920 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.423920 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:25:46.423920 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:25:46.427092 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.427092 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:25:46.428092 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:25:46.428092 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:25:46.429092 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:25:46.430165 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:25:46.431167 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:46.431167 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.431167 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.433681 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.433681 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:25:46.434685 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:25:46.434685 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:25:46.435690 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:25:46.436842 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:25:46.436842 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:46.437848 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:25:46.437848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.439866 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:25:46.441869 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:25:46.441869 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:25:46.441869 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:25:46.443368 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:25:46.443368 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:25:46.444399 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:25:46.444399 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:25:46.446407 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:25:46.446407 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:25:46.447409 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:25:46.447409 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:25:46.448625 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m14:25:46.449809 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: Close
[0m14:25:46.449809 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:25:46.450883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6486F6BA0>]}
[0m14:25:46.450883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6486F75C0>]}
[0m14:25:46.452175 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:25:46.452175 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:25:46.454182 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m14:25:46.455274 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m14:25:46.453179 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:25:46.455274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e056ca7b-4de4-49a3-9093-f62466c6910b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6486F74D0>]}
[0m14:25:46.456650 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_sellers
[0m14:25:46.456650 [info ] [Thread-4 (]: 6 of 7 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:25:46.456650 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m14:25:46.459034 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.459034 [debug] [MainThread]: On master: BEGIN
[0m14:25:46.459034 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:46.502352 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m14:25:46.503356 [debug] [MainThread]: On master: COMMIT
[0m14:25:46.503356 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:46.504367 [debug] [MainThread]: On master: COMMIT
[0m14:25:46.504367 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:25:46.504367 [debug] [MainThread]: On master: Close
[0m14:25:46.504367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:46.504367 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:25:46.505844 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:25:46.505844 [debug] [MainThread]: Connection 'model.dbt_project.stg_customers' was properly closed.
[0m14:25:46.505844 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:25:46.505844 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m14:25:46.506848 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:25:46.506848 [info ] [MainThread]: 
[0m14:25:46.506848 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:25:46.508240 [debug] [MainThread]: Command end result
[0m14:25:46.586257 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:25:46.588726 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:25:46.595806 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:25:46.595806 [info ] [MainThread]: 
[0m14:25:46.595806 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:46.596809 [info ] [MainThread]: 
[0m14:25:46.596809 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m14:25:46.598142 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:46.598142 after 2.45 seconds
[0m14:25:46.598142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6460A3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B6480293A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B646569760>]}
[0m14:25:46.598142 [debug] [MainThread]: Flushing usage events
[0m14:25:48.318565 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:26:13.043788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A328A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333817C620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013339EDC530>]}


============================== 14:26:13.047827 | 862c4949-a2b7-450b-8bd5-3dbc3d71eda7 ==============================
[0m14:26:13.047827 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:26:13.048832 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'no_print': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test', 'printer_width': '80', 'target_path': 'None'}
[0m14:26:13.231488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A50F650>]}
[0m14:26:13.283059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A469730>]}
[0m14:26:13.285073 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:26:13.679347 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:26:13.871852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:26:13.871852 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:26:13.909283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A60B9B0>]}
[0m14:26:13.980205 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:26:13.998201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:26:14.038700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333BFAE3C0>]}
[0m14:26:14.039873 [info ] [MainThread]: Found 7 models, 19 data tests, 9 sources, 447 macros
[0m14:26:14.039873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A664350>]}
[0m14:26:14.042888 [info ] [MainThread]: 
[0m14:26:14.043894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:26:14.043894 [info ] [MainThread]: 
[0m14:26:14.044912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:26:14.048222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:26:14.200917 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:26:14.201934 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:26:14.201934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:26:14.345512 [debug] [ThreadPool]: SQL status: BEGIN in 0.144 seconds
[0m14:26:14.346515 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:26:14.346515 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:26:14.352605 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.006 seconds
[0m14:26:14.354610 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:26:14.354610 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:26:14.360643 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:14.361646 [debug] [MainThread]: On master: BEGIN
[0m14:26:14.361646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:26:14.398298 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m14:26:14.399321 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:14.399321 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:26:14.406346 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m14:26:14.409491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '862c4949-a2b7-450b-8bd5-3dbc3d71eda7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333A50C6E0>]}
[0m14:26:14.409491 [debug] [MainThread]: On master: ROLLBACK
[0m14:26:14.410515 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:14.410515 [debug] [MainThread]: On master: BEGIN
[0m14:26:14.410515 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:26:14.411518 [debug] [MainThread]: On master: COMMIT
[0m14:26:14.411518 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:14.411518 [debug] [MainThread]: On master: COMMIT
[0m14:26:14.412535 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:26:14.412535 [debug] [MainThread]: On master: Close
[0m14:26:14.416582 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:26:14.417085 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:26:14.417085 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:26:14.417085 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:26:14.418090 [info ] [Thread-1 (]: 1 of 19 START test not_null_stg_customers_customer_id .......................... [RUN]
[0m14:26:14.418090 [info ] [Thread-2 (]: 2 of 19 START test not_null_stg_customers_customer_unique_id ................... [RUN]
[0m14:26:14.418090 [info ] [Thread-3 (]: 3 of 19 START test not_null_stg_items_ordered_item_id .......................... [RUN]
[0m14:26:14.419096 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m14:26:14.419096 [info ] [Thread-4 (]: 4 of 19 START test not_null_stg_items_ordered_order_id ......................... [RUN]
[0m14:26:14.420102 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba'
[0m14:26:14.420102 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505'
[0m14:26:14.421115 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:26:14.421115 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947'
[0m14:26:14.421115 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:26:14.422118 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:26:14.436233 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:26:14.436233 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:26:14.439246 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:26:14.443374 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:26:14.446380 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:26:14.448437 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:26:14.464812 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:26:14.464812 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:26:14.465857 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:26:14.465857 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:26:14.467885 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:26:14.469896 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:26:14.472048 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:26:14.473051 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:26:14.473051 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m14:26:14.473051 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:26:14.475061 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:26:14.475061 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m14:26:14.476081 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:26:14.476081 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:26:14.476081 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:26:14.477097 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m14:26:14.477097 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m14:26:14.478100 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:26:14.478100 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:26:14.520541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m14:26:14.521553 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m14:26:14.521553 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.523564 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m14:26:14.524572 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m14:26:14.524572 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.525582 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:14.526585 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m14:26:14.526585 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.531611 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m14:26:14.531611 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m14:26:14.532640 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.698516 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.176 seconds
[0m14:26:14.698516 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.172 seconds
[0m14:26:14.702728 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m14:26:14.702728 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.170 seconds
[0m14:26:14.703753 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.178 seconds
[0m14:26:14.704757 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m14:26:14.706017 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m14:26:14.706017 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m14:26:14.707021 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m14:26:14.708025 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m14:26:14.708025 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m14:26:14.709225 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m14:26:14.708025 [info ] [Thread-1 (]: 1 of 19 PASS not_null_stg_customers_customer_id ................................ [[32mPASS[0m in 0.29s]
[0m14:26:14.709225 [info ] [Thread-2 (]: 2 of 19 PASS not_null_stg_customers_customer_unique_id ......................... [[32mPASS[0m in 0.29s]
[0m14:26:14.711271 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m14:26:14.710243 [info ] [Thread-3 (]: 3 of 19 PASS not_null_stg_items_ordered_item_id ................................ [[32mPASS[0m in 0.29s]
[0m14:26:14.711271 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m14:26:14.710243 [info ] [Thread-4 (]: 4 of 19 PASS not_null_stg_items_ordered_order_id ............................... [[32mPASS[0m in 0.29s]
[0m14:26:14.712320 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:26:14.712320 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m14:26:14.713536 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:26:14.713536 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m14:26:14.714536 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:26:14.714536 [info ] [Thread-1 (]: 5 of 19 START test not_null_stg_items_ordered_product_id ....................... [RUN]
[0m14:26:14.715536 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:26:14.715536 [info ] [Thread-2 (]: 6 of 19 START test not_null_stg_items_ordered_seller_id ........................ [RUN]
[0m14:26:14.715536 [info ] [Thread-3 (]: 7 of 19 START test not_null_stg_order_payment_order_id ......................... [RUN]
[0m14:26:14.716604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m14:26:14.716604 [info ] [Thread-4 (]: 8 of 19 START test not_null_stg_orders_customer_id ............................. [RUN]
[0m14:26:14.717603 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m14:26:14.717603 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m14:26:14.717603 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:26:14.717603 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m14:26:14.718943 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:26:14.718943 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:26:14.722077 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:26:14.723080 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:26:14.726099 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:26:14.729128 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:26:14.732534 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:26:14.733633 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:26:14.736822 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:26:14.736822 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:26:14.738996 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:26:14.740001 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:26:14.740001 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:26:14.742046 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:26:14.745059 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:26:14.746059 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:26:14.746059 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:26:14.747230 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m14:26:14.747230 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m14:26:14.748239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:14.748239 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:26:14.749245 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:14.749245 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:26:14.749245 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m14:26:14.750316 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m14:26:14.750316 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:14.750316 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:14.797163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:14.798162 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m14:26:14.798162 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.801460 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m14:26:14.802475 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m14:26:14.802475 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.846735 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.048 seconds
[0m14:26:14.847787 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m14:26:14.848790 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m14:26:14.849796 [info ] [Thread-2 (]: 6 of 19 PASS not_null_stg_items_ordered_seller_id .............................. [[32mPASS[0m in 0.13s]
[0m14:26:14.849796 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m14:26:14.849796 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:26:14.851011 [info ] [Thread-2 (]: 9 of 19 START test not_null_stg_orders_order_id ................................ [RUN]
[0m14:26:14.851011 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m14:26:14.851011 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:26:14.856309 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:26:14.857483 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:26:14.860731 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:26:14.862918 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:26:14.862918 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m14:26:14.863959 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:14.890613 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.088 seconds
[0m14:26:14.892651 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m14:26:14.892651 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m14:26:14.893651 [info ] [Thread-4 (]: 8 of 19 PASS not_null_stg_orders_customer_id ................................... [[32mPASS[0m in 0.18s]
[0m14:26:14.893651 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m14:26:14.894651 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:26:14.894651 [info ] [Thread-4 (]: 10 of 19 START test not_null_stg_products_product_id ........................... [RUN]
[0m14:26:14.895651 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m14:26:14.895651 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:26:14.899698 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:26:14.900703 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:26:14.903775 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:26:14.904773 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:26:14.905774 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m14:26:14.905774 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:14.911161 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m14:26:14.911161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.163 seconds
[0m14:26:14.912206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.161 seconds
[0m14:26:14.912206 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m14:26:14.912206 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m14:26:14.913209 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m14:26:14.913209 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.914297 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.914297 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.916560 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:26:14.919064 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m14:26:14.919064 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m14:26:14.920064 [info ] [Thread-3 (]: 7 of 19 PASS not_null_stg_order_payment_order_id ............................... [[32mPASS[0m in 0.20s]
[0m14:26:14.921065 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m14:26:14.922461 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:26:14.922461 [info ] [Thread-3 (]: 11 of 19 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m14:26:14.923591 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m14:26:14.923591 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:26:14.929595 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:26:14.931596 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:26:14.931596 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:26:14.935597 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:26:14.938598 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m14:26:14.939598 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m14:26:14.940598 [info ] [Thread-2 (]: 9 of 19 PASS not_null_stg_orders_order_id ...................................... [[32mPASS[0m in 0.09s]
[0m14:26:14.941941 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m14:26:14.941941 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:26:14.943030 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:26:14.943030 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m14:26:14.944436 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:14.943030 [info ] [Thread-2 (]: 12 of 19 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:26:14.944436 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m14:26:14.945461 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:26:14.955070 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:26:14.957585 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m14:26:14.958701 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m14:26:14.958701 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:26:14.959757 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:14.962011 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:26:14.963206 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:26:14.964293 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m14:26:14.964293 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:14.972211 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.057 seconds
[0m14:26:14.973288 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m14:26:14.974297 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m14:26:14.975351 [info ] [Thread-1 (]: 5 of 19 PASS not_null_stg_items_ordered_product_id ............................. [[32mPASS[0m in 0.26s]
[0m14:26:14.975351 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m14:26:14.976647 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:26:14.976647 [info ] [Thread-1 (]: 13 of 19 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m14:26:14.976647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m14:26:14.978030 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:26:14.984034 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:26:14.985034 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:26:14.988035 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:26:14.989035 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.027 seconds
[0m14:26:14.990120 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m14:26:14.991120 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m14:26:14.991120 [info ] [Thread-4 (]: 10 of 19 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.10s]
[0m14:26:14.992178 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:26:14.993327 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m14:26:14.993327 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m14:26:14.993327 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:26:14.994331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:14.994331 [info ] [Thread-4 (]: 14 of 19 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m14:26:14.995332 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m14:26:14.995332 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:26:15.003567 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:26:15.005851 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:26:15.009853 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:26:15.011863 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:26:15.011863 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:15.013050 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m14:26:15.013050 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m14:26:15.014151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:15.014151 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.041526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:15.042525 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m14:26:15.042525 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.058010 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m14:26:15.059013 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m14:26:15.060013 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.100769 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m14:26:15.101891 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m14:26:15.101891 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.105144 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:26:15.107145 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m14:26:15.107145 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m14:26:15.108145 [info ] [Thread-3 (]: 11 of 19 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.19s]
[0m14:26:15.109425 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m14:26:15.110426 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:26:15.110426 [info ] [Thread-3 (]: 15 of 19 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m14:26:15.111873 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m14:26:15.111873 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:26:15.117955 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:26:15.121214 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:26:15.125215 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:26:15.127216 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:26:15.128215 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m14:26:15.128215 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:26:15.131633 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.117 seconds
[0m14:26:15.133659 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m14:26:15.134659 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m14:26:15.134659 [info ] [Thread-2 (]: 12 of 19 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.19s]
[0m14:26:15.135660 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m14:26:15.136694 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:26:15.137698 [info ] [Thread-2 (]: 16 of 19 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m14:26:15.137698 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m14:26:15.138698 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:26:15.146450 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:26:15.146450 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.104 seconds
[0m14:26:15.147894 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.087 seconds
[0m14:26:15.148916 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m14:26:15.149920 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m14:26:15.150924 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:26:15.150924 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m14:26:15.152077 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m14:26:15.154086 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:26:15.155090 [info ] [Thread-1 (]: 13 of 19 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.18s]
[0m14:26:15.157318 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m14:26:15.156303 [info ] [Thread-4 (]: 14 of 19 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.16s]
[0m14:26:15.157318 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:26:15.158682 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m14:26:15.158682 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:26:15.159780 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:26:15.159780 [info ] [Thread-1 (]: 17 of 19 START test unique_stg_orders_order_id ................................. [RUN]
[0m14:26:15.160784 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m14:26:15.161842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m14:26:15.160784 [info ] [Thread-4 (]: 18 of 19 START test unique_stg_products_product_id ............................. [RUN]
[0m14:26:15.161842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:26:15.161842 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:26:15.163345 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m14:26:15.169369 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:26:15.170386 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:26:15.174462 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:26:15.175916 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:26:15.178296 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:26:15.179347 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:26:15.181808 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:26:15.182813 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:26:15.182813 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m14:26:15.182813 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:15.184149 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:26:15.184149 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m14:26:15.184149 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:15.210246 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:15.210246 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m14:26:15.210246 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.229442 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:26:15.230442 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m14:26:15.230442 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:26:15.232443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m14:26:15.232443 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m14:26:15.233443 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:26:15.256678 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m14:26:15.257678 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m14:26:15.258884 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m14:26:15.258884 [info ] [Thread-4 (]: 18 of 19 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.10s]
[0m14:26:15.259890 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m14:26:15.259890 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:26:15.260890 [info ] [Thread-4 (]: 19 of 19 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m14:26:15.260890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_products_product_id.7d950a1467, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m14:26:15.261890 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:26:15.266274 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:26:15.268275 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:26:15.271283 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:26:15.273277 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:26:15.273277 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m14:26:15.274277 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:26:15.283612 [debug] [Thread-3 (]: SQL status: BEGIN in 0.155 seconds
[0m14:26:15.284613 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m14:26:15.285612 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m14:26:15.288797 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:26:15.292798 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m14:26:15.293798 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m14:26:15.294798 [info ] [Thread-3 (]: 15 of 19 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.18s]
[0m14:26:15.294798 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m14:26:15.316767 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.106 seconds
[0m14:26:15.318270 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m14:26:15.319271 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m14:26:15.319271 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m14:26:15.319271 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m14:26:15.320404 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:26:15.320404 [info ] [Thread-2 (]: 16 of 19 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.18s]
[0m14:26:15.321484 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m14:26:15.324493 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:26:15.325493 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m14:26:15.325493 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m14:26:15.326494 [info ] [Thread-4 (]: 19 of 19 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.07s]
[0m14:26:15.327627 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m14:26:15.330785 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.100 seconds
[0m14:26:15.333113 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m14:26:15.333113 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m14:26:15.334124 [info ] [Thread-1 (]: 17 of 19 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m14:26:15.334124 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m14:26:15.336125 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.336125 [debug] [MainThread]: On master: BEGIN
[0m14:26:15.336125 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:26:15.379226 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m14:26:15.380233 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.380233 [debug] [MainThread]: Using postgres connection "master"
[0m14:26:15.381235 [debug] [MainThread]: On master: COMMIT
[0m14:26:15.381235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:26:15.381235 [debug] [MainThread]: On master: Close
[0m14:26:15.382240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:15.382240 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:26:15.383241 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m14:26:15.383241 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m14:26:15.383241 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8' was properly closed.
[0m14:26:15.383241 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m14:26:15.384241 [info ] [MainThread]: 
[0m14:26:15.384241 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 1.34 seconds (1.34s).
[0m14:26:15.388042 [debug] [MainThread]: Command end result
[0m14:26:15.477282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:26:15.480291 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:26:15.487551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:26:15.487551 [info ] [MainThread]: 
[0m14:26:15.487551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:26:15.488924 [info ] [MainThread]: 
[0m14:26:15.488924 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 TOTAL=19
[0m14:26:15.489933 [debug] [MainThread]: Command `dbt test` succeeded at 14:26:15.489933 after 2.54 seconds
[0m14:26:15.490939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333C1CCE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333C1CFA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001333C1CFA70>]}
[0m14:26:15.490939 [debug] [MainThread]: Flushing usage events
[0m14:26:16.859534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:50:44.566045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028223DAC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028226751E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028226752A80>]}


============================== 10:50:44.573650 | 6e9fbaf7-6a6d-4485-b35f-41eae0d0afa3 ==============================
[0m10:50:44.573650 [info ] [MainThread]: Running with dbt=1.9.10
[0m10:50:44.573650 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt ', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m10:50:44.735151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e9fbaf7-6a6d-4485-b35f-41eae0d0afa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282267521E0>]}
[0m10:50:44.780623 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:50:44.783624 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:50:44.785624 [debug] [MainThread]: Command `cli deps` succeeded at 10:50:44.785624 after 0.37 seconds
[0m10:50:44.785624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028223DAC0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282269807A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028226038E90>]}
[0m10:50:44.786625 [debug] [MainThread]: Flushing usage events
[0m10:50:46.520444 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m05:43:06.721873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CD8D1340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CD7C4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CAB00C50>]}


============================== 05:43:06.729057 | 68d7a6ea-4b2d-4738-8654-535fe9943429 ==============================
[0m05:43:06.729057 [info ] [MainThread]: Running with dbt=1.9.10
[0m05:43:06.729057 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m05:43:06.861006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d7a6ea-4b2d-4738-8654-535fe9943429', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CD8D27B0>]}
[0m05:43:06.905329 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:43:06.910394 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:43:06.912902 [debug] [MainThread]: Command `cli deps` succeeded at 05:43:06.912902 after 0.31 seconds
[0m05:43:06.914117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CD07D280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CDB387A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000145CD761FD0>]}
[0m05:43:06.915133 [debug] [MainThread]: Flushing usage events
[0m05:43:08.734533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:19:19.608380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C73BB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C98E8320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C98EA240>]}


============================== 06:19:19.613897 | af1db7b0-4943-4839-8fa9-cfeb77524214 ==============================
[0m06:19:19.613897 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:19:19.614997 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m06:19:19.870225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CA1B8650>]}
[0m06:19:19.925074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C9678D70>]}
[0m06:19:19.927078 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:19:20.389800 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:19:20.580129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:19:20.580129 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:19:20.617466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB6B7080>]}
[0m06:19:20.689233 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:19:20.736105 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:19:20.778777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CBA6BC80>]}
[0m06:19:20.779804 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:19:20.779804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CB618C20>]}
[0m06:19:20.782850 [info ] [MainThread]: 
[0m06:19:20.782850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:19:20.784011 [info ] [MainThread]: 
[0m06:19:20.784011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:19:20.787017 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:19:22.300882 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:19:22.301882 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:19:22.301882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:22.368789 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m06:19:22.369805 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:19:22.371794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:19:22.375999 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:19:22.376999 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:19:22.376999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:19:22.410543 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:19:22.410543 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:19:22.410543 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:19:22.419009 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m06:19:22.420012 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:19:22.421014 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:19:22.426855 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:22.426855 [debug] [MainThread]: On master: BEGIN
[0m06:19:22.426855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:19:22.562900 [debug] [MainThread]: SQL status: BEGIN in 0.135 seconds
[0m06:19:22.562900 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:22.563506 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:19:22.569681 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:19:22.572601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC002FF0>]}
[0m06:19:22.572601 [debug] [MainThread]: On master: ROLLBACK
[0m06:19:22.573618 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:22.573618 [debug] [MainThread]: On master: BEGIN
[0m06:19:22.573618 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:19:22.574622 [debug] [MainThread]: On master: COMMIT
[0m06:19:22.574622 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:22.574622 [debug] [MainThread]: On master: COMMIT
[0m06:19:22.574622 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:22.575626 [debug] [MainThread]: On master: Close
[0m06:19:22.581018 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:19:22.581018 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:19:22.582017 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:19:22.582017 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:19:22.582520 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:19:22.583235 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:19:22.583540 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:19:22.584541 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:19:22.583540 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:19:22.584541 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:19:22.584541 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:19:22.585544 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:19:22.585544 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:19:22.586588 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:19:22.586588 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:19:22.592620 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:19:22.592620 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:19:22.594624 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:19:22.596624 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:19:22.599625 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:19:22.600625 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:19:22.628913 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:19:22.629923 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:19:22.629923 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:19:22.630935 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:19:22.635072 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:19:22.638075 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:19:22.641154 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:19:22.641154 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.642153 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:19:22.642657 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:19:22.643668 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.643668 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:19:22.644670 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.644670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:19:22.644670 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.644670 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:19:22.645674 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:19:22.645674 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:19:22.645674 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:19:22.688141 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m06:19:22.689387 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.689387 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:19:22.696165 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m06:19:22.696165 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m06:19:22.697219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.697219 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.697219 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:19:22.698222 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:19:22.707662 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:19:22.707662 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m06:19:22.707662 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:19:22.713864 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.715893 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.718899 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.718899 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:19:22.720221 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:19:22.720221 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:19:22.722727 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:22.722727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:22.722727 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:22.724956 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.727352 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.729355 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.730355 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:19:22.730355 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:19:22.730355 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:19:22.731859 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:22.731859 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:22.731859 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:22.745631 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:19:22.746635 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:19:22.748640 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:19:22.748640 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.748640 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.748640 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.749874 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:19:22.749874 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:19:22.749874 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:19:22.751878 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:19:22.756068 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:19:22.757074 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m06:19:22.757074 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m06:19:22.761645 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:19:22.765242 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:19:22.766732 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:19:22.767735 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:19:22.767735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:19:22.768738 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:19:22.768738 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:19:22.769816 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:19:22.774911 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m06:19:22.774911 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m06:19:22.774911 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m06:19:22.777177 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:19:22.778411 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:19:22.779411 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:19:22.782915 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C96B2990>]}
[0m06:19:22.783420 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC0F1310>]}
[0m06:19:22.783420 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC0B7500>]}
[0m06:19:22.784547 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:19:22.785955 [debug] [Thread-1 (]: SQL status: BEGIN in 0.143 seconds
[0m06:19:22.784547 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:19:22.786972 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:19:22.785955 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:19:22.786972 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.786972 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:19:22.787987 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m06:19:22.787987 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:19:22.787987 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:19:22.789046 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:19:22.790167 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m06:19:22.789046 [info ] [Thread-3 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:19:22.790167 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:19:22.790167 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m06:19:22.790167 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:19:22.791670 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:19:22.791670 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m06:19:22.792673 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m06:19:22.792673 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:19:22.795442 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:19:22.795442 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:19:22.795442 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:19:22.797444 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:19:22.800444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.802946 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:19:22.803448 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:19:22.803448 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m06:19:22.807448 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:19:22.807448 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:19:22.810449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.810449 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:19:22.810449 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:19:22.814461 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:19:22.814461 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m06:19:22.815461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.818616 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:19:22.818616 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:19:22.819636 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:19:22.820806 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:19:22.821805 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.821805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:19:22.822892 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.822892 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:19:22.822892 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:19:22.824202 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.824202 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:19:22.824202 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:19:22.825376 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:19:22.825376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:19:22.827386 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:19:22.828409 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:19:22.828409 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:19:22.830513 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:19:22.832016 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:19:22.832526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC0CB830>]}
[0m06:19:22.833536 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m06:19:22.833536 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:19:22.871738 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m06:19:22.872739 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m06:19:22.872739 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.872739 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.872739 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m06:19:22.874046 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:19:22.874046 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:19:22.875058 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.875058 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:19:22.879204 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:19:22.884109 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.884109 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:19:22.885113 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:19:22.885113 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:19:22.888121 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.890124 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.890124 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:19:22.891536 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:19:22.891536 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:22.893568 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.894573 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:19:22.894573 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:19:22.894573 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:19:22.896587 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.899683 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.899683 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:19:22.899683 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:22.900687 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:19:22.901686 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:19:22.901686 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:19:22.901686 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.901686 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:19:22.903803 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:19:22.904179 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:19:22.905181 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:19:22.905181 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.905181 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.906232 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:19:22.906232 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:19:22.906232 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:19:22.908374 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:19:22.908374 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:19:22.909379 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:19:22.909379 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:19:22.910548 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:19:22.912051 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:19:22.913581 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:19:22.913581 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:19:22.914594 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:19:22.914594 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:19:22.915858 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:19:22.915858 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:19:22.916916 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m06:19:22.916916 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:19:22.917919 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:19:22.918924 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:19:22.918924 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC12F7D0>]}
[0m06:19:22.919927 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m06:19:22.921296 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC00B6B0>]}
[0m06:19:22.919927 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m06:19:22.922800 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC00B1D0>]}
[0m06:19:22.921798 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m06:19:22.923303 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m06:19:22.924044 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:19:22.924044 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m06:19:22.925089 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m06:19:22.925089 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m06:19:22.926575 [info ] [Thread-1 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:19:22.926575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m06:19:22.926575 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m06:19:22.929922 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:19:22.931922 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m06:19:22.950891 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:19:22.951891 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:19:22.953051 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:19:22.953051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:19:22.994825 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m06:19:22.994825 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:19:22.995826 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(order_purchase_timestamp)) as first_order_date,
        max(date(order_purchase_timestamp)) as most_recent_order_date,
        -- Calculate days between first and last order
        date_part('day', max(date(order_purchase_timestamp)) - min(date(order_purchase_timestamp))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_Methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_types_used,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then date_part('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                and date_part('day', current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when date_part('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:19:22.998226 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "order_purchase_timestamp" does not exist
LINE 31:         min(date(order_purchase_timestamp)) as first_order_d...
                          ^

[0m06:19:22.998226 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:19:22.999229 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m06:19:23.116365 [debug] [Thread-1 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column "order_purchase_timestamp" does not exist
  LINE 31:         min(date(order_purchase_timestamp)) as first_order_d...
                            ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:19:23.117367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'af1db7b0-4943-4839-8fa9-cfeb77524214', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186CC09C800>]}
[0m06:19:23.117367 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.19s]
[0m06:19:23.118369 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m06:19:23.118369 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column "order_purchase_timestamp" does not exist
  LINE 31:         min(date(order_purchase_timestamp)) as first_order_d...
                            ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:19:23.120488 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:23.120488 [debug] [MainThread]: On master: BEGIN
[0m06:19:23.120488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:19:23.159103 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m06:19:23.159103 [debug] [MainThread]: On master: COMMIT
[0m06:19:23.160214 [debug] [MainThread]: Using postgres connection "master"
[0m06:19:23.160214 [debug] [MainThread]: On master: COMMIT
[0m06:19:23.160214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:19:23.160214 [debug] [MainThread]: On master: Close
[0m06:19:23.161717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:19:23.161717 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:19:23.161717 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:19:23.161717 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:19:23.161717 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:19:23.162722 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:19:23.162722 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:19:23.163224 [info ] [MainThread]: 
[0m06:19:23.163929 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 2.38 seconds (2.38s).
[0m06:19:23.165454 [debug] [MainThread]: Command end result
[0m06:19:23.239212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:19:23.242751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:19:23.248519 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:19:23.248519 [info ] [MainThread]: 
[0m06:19:23.249532 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:19:23.249532 [info ] [MainThread]: 
[0m06:19:23.250751 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column "order_purchase_timestamp" does not exist
  LINE 31:         min(date(order_purchase_timestamp)) as first_order_d...
                            ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:19:23.250751 [info ] [MainThread]: 
[0m06:19:23.250751 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:19:23.251754 [debug] [MainThread]: Command `dbt run` failed at 06:19:23.251754 after 3.79 seconds
[0m06:19:23.252757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C9BB5BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C9963770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000186C788DFD0>]}
[0m06:19:23.252757 [debug] [MainThread]: Flushing usage events
[0m06:19:25.259540 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:21:30.346274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012493B77FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012493A9BDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012493A9B470>]}


============================== 06:21:30.350299 | df754181-cd6b-4f7d-a1c4-d709e863b9ee ==============================
[0m06:21:30.350299 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:21:30.351802 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m06:21:30.531146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012491474530>]}
[0m06:21:30.585656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012494169520>]}
[0m06:21:30.587663 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:21:30.973934 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:21:31.162515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:21:31.163282 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:21:31.199385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012495596690>]}
[0m06:21:31.269489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:21:31.286942 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:21:31.315907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124955DBC50>]}
[0m06:21:31.315907 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:21:31.316926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012495958770>]}
[0m06:21:31.318413 [info ] [MainThread]: 
[0m06:21:31.319417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:21:31.319417 [info ] [MainThread]: 
[0m06:21:31.320634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:21:31.323655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:21:31.467383 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:21:31.468391 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:21:31.468391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:31.511873 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m06:21:31.514165 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:21:31.515168 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:21:31.520704 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:21:31.520704 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:21:31.520704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:21:31.556115 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m06:21:31.557119 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:21:31.557119 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:21:31.561839 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:21:31.564030 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:21:31.564030 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:21:31.570561 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:31.570561 [debug] [MainThread]: On master: BEGIN
[0m06:21:31.570561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:21:31.604893 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:21:31.605914 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:31.605914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:21:31.611920 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m06:21:31.615023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012495993C20>]}
[0m06:21:31.615023 [debug] [MainThread]: On master: ROLLBACK
[0m06:21:31.615023 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:31.615023 [debug] [MainThread]: On master: BEGIN
[0m06:21:31.616505 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:21:31.616505 [debug] [MainThread]: On master: COMMIT
[0m06:21:31.616505 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:31.616505 [debug] [MainThread]: On master: COMMIT
[0m06:21:31.617643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:21:31.617643 [debug] [MainThread]: On master: Close
[0m06:21:31.621153 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:21:31.622152 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:21:31.622655 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:21:31.622655 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:21:31.622655 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:21:31.622655 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:21:31.623890 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:21:31.624938 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:21:31.623890 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:21:31.624938 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:21:31.624938 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:21:31.626340 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:21:31.626340 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:21:31.626340 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:21:31.626340 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:21:31.632592 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:21:31.633347 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:21:31.634857 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:21:31.636966 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:21:31.638974 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:21:31.639994 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:21:31.671836 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:21:31.672837 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:21:31.673498 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:21:31.673498 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:21:31.676747 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:21:31.680242 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:21:31.683835 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:21:31.683835 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.684848 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:21:31.684848 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:21:31.685963 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.685963 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:21:31.685963 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.687044 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:21:31.687044 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:21:31.687044 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.688046 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:21:31.688046 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:21:31.689046 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:21:31.731953 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m06:21:31.731953 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.733463 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:21:31.736130 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m06:21:31.736130 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.737133 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:21:31.739362 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m06:21:31.739362 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.740367 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:21:31.740367 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m06:21:31.746377 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.746377 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:21:31.746377 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:21:31.747675 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:21:31.749681 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.752690 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.753423 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:21:31.753423 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:21:31.753423 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:21:31.756519 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.756519 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:21:31.756519 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:21:31.756519 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:21:31.758845 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.761861 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.762366 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:21:31.762366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.762870 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:21:31.769393 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:21:31.776098 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:21:31.778103 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:21:31.778103 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:21:31.778103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.779106 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.780109 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:21:31.780109 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:21:31.780109 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:21:31.780109 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.781555 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:21:31.782565 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:21:31.782565 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m06:21:31.782565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:21:31.788582 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:21:31.789833 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:21:31.792853 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:21:31.796875 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:21:31.797877 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:21:31.797877 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:21:31.798905 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:21:31.798905 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:21:31.798905 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:21:31.800909 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:21:31.801909 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:21:31.801909 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:21:31.803639 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:21:31.805091 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:21:31.806095 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:21:31.808110 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001249363E990>]}
[0m06:21:31.809146 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496074F20>]}
[0m06:21:31.809146 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496076450>]}
[0m06:21:31.809146 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:21:31.810471 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:21:31.811974 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:21:31.810471 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:21:31.811974 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:21:31.811974 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m06:21:31.813482 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:21:31.813482 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m06:21:31.814487 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m06:21:31.813482 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:21:31.814487 [info ] [Thread-3 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:21:31.815491 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:21:31.815491 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m06:21:31.815491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m06:21:31.816561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m06:21:31.816561 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m06:21:31.816561 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m06:21:31.817564 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:21:31.819647 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:21:31.822661 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:21:31.824670 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:21:31.826747 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m06:21:31.829265 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:21:31.830338 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m06:21:31.830338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.145 seconds
[0m06:21:31.830338 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m06:21:31.833997 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:21:31.833997 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.837462 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:21:31.837462 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.838469 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:21:31.838469 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:21:31.839471 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:21:31.839471 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.840485 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m06:21:31.840485 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.840485 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:21:31.840485 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:21:31.841992 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:21:31.844198 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:21:31.847460 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.848576 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:21:31.849579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:21:31.853337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.853337 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:21:31.854535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:21:31.857634 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:21:31.857634 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.857634 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:21:31.859895 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:21:31.862416 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:21:31.862919 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:21:31.863848 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:21:31.864981 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:21:31.866484 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:21:31.866484 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496012300>]}
[0m06:21:31.867486 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m06:21:31.867486 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:21:31.888363 [debug] [Thread-3 (]: SQL status: BEGIN in 0.048 seconds
[0m06:21:31.889367 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.889367 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:21:31.891876 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m06:21:31.891876 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.892887 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:21:31.895196 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:21:31.898201 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.899201 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:21:31.899201 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:21:31.903604 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.903604 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:21:31.904620 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.904620 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.907623 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.909859 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.909859 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:21:31.909859 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:21:31.910936 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.910936 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:21:31.911936 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:21:31.914002 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:21:31.914002 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.914002 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.914002 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:21:31.915225 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:21:31.916137 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:21:31.917258 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:21:31.918260 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:21:31.918260 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:21:31.920263 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:21:31.920263 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:21:31.921767 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:21:31.921767 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:21:31.922769 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:21:31.923398 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:21:31.923398 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m06:21:31.925838 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m06:21:31.925838 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012495F20A10>]}
[0m06:21:31.925838 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012495F3AE40>]}
[0m06:21:31.926840 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m06:21:31.927990 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m06:21:31.926840 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m06:21:31.929010 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m06:21:31.979913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.141 seconds
[0m06:21:31.981230 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.981732 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:21:31.985974 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:21:31.988978 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.988978 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:21:31.989978 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.992654 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.992654 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:21:31.993334 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:21:31.994409 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:21:31.994409 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.995409 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:21:31.996099 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:21:31.998122 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:21:31.998122 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:21:31.998122 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:21:32.000054 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:21:32.001126 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m06:21:32.001126 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496011C40>]}
[0m06:21:32.002129 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m06:21:32.002636 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m06:21:32.003643 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m06:21:32.003643 [info ] [Thread-1 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:21:32.003643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m06:21:32.004814 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m06:21:32.007885 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:21:32.009278 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m06:21:32.027087 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:21:32.028089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:21:32.029091 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:21:32.029091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:21:32.064870 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m06:21:32.064870 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:21:32.066373 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order
        date_part('day', max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_Methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_types_used,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then date_part('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                and date_part('day', current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when date_part('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:21:32.075913 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 34:         date_part('day', max(date(purchased_date)) - min(dat...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:21:32.075913 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:21:32.077170 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m06:21:32.082689 [debug] [Thread-1 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max(date(purchased_date)) - min(dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:21:32.082689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df754181-cd6b-4f7d-a1c4-d709e863b9ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000124964A9A60>]}
[0m06:21:32.082689 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.08s]
[0m06:21:32.083772 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m06:21:32.084776 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max(date(purchased_date)) - min(dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:21:32.085779 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.085779 [debug] [MainThread]: On master: BEGIN
[0m06:21:32.086781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:21:32.124060 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m06:21:32.124060 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.125112 [debug] [MainThread]: Using postgres connection "master"
[0m06:21:32.125112 [debug] [MainThread]: On master: COMMIT
[0m06:21:32.125112 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:21:32.126115 [debug] [MainThread]: On master: Close
[0m06:21:32.126115 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:21:32.126115 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:21:32.127117 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:21:32.127117 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:21:32.127117 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:21:32.127117 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:21:32.127117 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:21:32.128117 [info ] [MainThread]: 
[0m06:21:32.128117 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m06:21:32.130118 [debug] [MainThread]: Command end result
[0m06:21:32.206291 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:21:32.208290 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:21:32.213796 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:21:32.213796 [info ] [MainThread]: 
[0m06:21:32.214797 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:21:32.214797 [info ] [MainThread]: 
[0m06:21:32.214797 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max(date(purchased_date)) - min(dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:21:32.216286 [info ] [MainThread]: 
[0m06:21:32.216286 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:21:32.217289 [debug] [MainThread]: Command `dbt run` failed at 06:21:32.217289 after 2.01 seconds
[0m06:21:32.217289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012493B77FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496094830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012496096240>]}
[0m06:21:32.218294 [debug] [MainThread]: Flushing usage events
[0m06:21:34.157873 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:22:43.014768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BD987D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BD98890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BD98D70>]}


============================== 06:22:43.019717 | 88ea2c19-ccec-41ef-afc4-579099b199b5 ==============================
[0m06:22:43.019717 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:22:43.020737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m06:22:43.200251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BEB25D0>]}
[0m06:22:43.251935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BC34C50>]}
[0m06:22:43.252937 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:22:43.631138 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:22:43.818664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:22:43.818664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:22:43.855686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2D2E5EB0>]}
[0m06:22:43.927188 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:22:43.944561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:22:43.973555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2D6DBAD0>]}
[0m06:22:43.973555 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:22:43.974606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2D6BBB30>]}
[0m06:22:43.976627 [info ] [MainThread]: 
[0m06:22:43.976627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:22:43.978114 [info ] [MainThread]: 
[0m06:22:43.979185 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:43.983198 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:22:44.137134 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:22:44.138135 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:22:44.138135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:44.204572 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m06:22:44.205711 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:22:44.206716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:22:44.212261 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:22:44.212763 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:22:44.212763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:44.246884 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:22:44.246884 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:22:44.246884 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:22:44.253103 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:22:44.254120 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:22:44.254120 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:22:44.260222 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.260222 [debug] [MainThread]: On master: BEGIN
[0m06:22:44.260222 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:44.296015 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:22:44.296015 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.297020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:22:44.302554 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:22:44.305630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2923F740>]}
[0m06:22:44.305630 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:44.305630 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.306635 [debug] [MainThread]: On master: BEGIN
[0m06:22:44.306635 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:22:44.306635 [debug] [MainThread]: On master: COMMIT
[0m06:22:44.307640 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.307640 [debug] [MainThread]: On master: COMMIT
[0m06:22:44.307640 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:44.307640 [debug] [MainThread]: On master: Close
[0m06:22:44.312158 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:22:44.312158 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:22:44.312673 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:22:44.312673 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:22:44.313398 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:22:44.313398 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:22:44.314571 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:22:44.314571 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:22:44.314571 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:22:44.315592 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:22:44.315592 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:22:44.316598 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:22:44.316598 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:22:44.316598 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:22:44.317601 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:22:44.322820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:22:44.323834 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:22:44.325843 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:22:44.327852 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:22:44.329855 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:22:44.330992 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:22:44.358916 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:22:44.359941 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:22:44.359941 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:22:44.360946 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:22:44.363972 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:22:44.367477 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:22:44.369953 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:22:44.370963 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.371959 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:22:44.371959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:22:44.371959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.373210 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:22:44.373909 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.374416 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.374416 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:22:44.374416 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:22:44.374416 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:22:44.375421 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:22:44.375421 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:22:44.415915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:22:44.416922 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.416922 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:22:44.418108 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m06:22:44.418108 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.419112 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:22:44.422132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:22:44.427095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.428098 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:22:44.428098 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:22:44.428098 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m06:22:44.429270 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m06:22:44.431778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.431778 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.431778 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.432788 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.432788 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:22:44.433293 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:22:44.433293 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:22:44.435313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.436317 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:22:44.436317 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.438327 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.439341 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:22:44.439341 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:22:44.453215 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:22:44.453215 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m06:22:44.453215 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m06:22:44.454221 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.454221 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:22:44.456228 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.459239 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.459239 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:22:44.460598 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:22:44.460598 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:22:44.460598 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:22:44.462101 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.462611 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:22:44.463396 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.463396 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.465943 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.467951 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.468953 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:22:44.468953 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:22:44.469957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:22:44.469957 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.470961 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:22:44.472464 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:22:44.472966 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.472966 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.472966 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:22:44.473979 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:22:44.513436 [debug] [Thread-1 (]: SQL status: COMMIT in 0.052 seconds
[0m06:22:44.520490 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:22:44.524150 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:22:44.525153 [debug] [Thread-3 (]: SQL status: COMMIT in 0.051 seconds
[0m06:22:44.525153 [debug] [Thread-2 (]: SQL status: COMMIT in 0.062 seconds
[0m06:22:44.525153 [debug] [Thread-4 (]: SQL status: COMMIT in 0.051 seconds
[0m06:22:44.526157 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:22:44.528167 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:22:44.529172 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:22:44.531680 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:22:44.531680 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:22:44.532682 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:22:44.533754 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:22:44.533754 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:22:44.533754 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:22:44.534759 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:22:44.579446 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.048 seconds
[0m06:22:44.581876 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:22:44.584143 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2D23C050>]}
[0m06:22:44.585206 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.27s]
[0m06:22:44.585206 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:22:44.586210 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:22:44.586210 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:22:44.586210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:22:44.587210 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:22:44.589535 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:22:44.590541 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:22:44.594334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:22:44.595337 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.595337 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:22:44.595337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:44.615772 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.081 seconds
[0m06:22:44.616846 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.082 seconds
[0m06:22:44.616846 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.082 seconds
[0m06:22:44.617850 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:22:44.618855 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:22:44.619859 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:22:44.620863 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DDDCAD0>]}
[0m06:22:44.621862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DC50A40>]}
[0m06:22:44.622868 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DCFF3E0>]}
[0m06:22:44.622365 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.31s]
[0m06:22:44.622868 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.30s]
[0m06:22:44.624979 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:22:44.623974 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.31s]
[0m06:22:44.624979 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:22:44.624979 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:22:44.626476 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:22:44.626476 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m06:22:44.626476 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:22:44.627481 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:22:44.627481 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:22:44.628486 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:22:44.628486 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m06:22:44.630505 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:22:44.630505 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:22:44.634456 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:22:44.635461 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m06:22:44.635461 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.636520 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:22:44.636520 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:22:44.640575 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:22:44.640575 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m06:22:44.643682 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:22:44.644703 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.644703 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:22:44.644703 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.645878 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:22:44.645878 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:22:44.645878 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:22:44.647025 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:22:44.650467 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.650467 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:22:44.651970 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.656814 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.657813 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:22:44.658972 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.660086 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:22:44.660086 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.661374 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:22:44.687772 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m06:22:44.687772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.027 seconds
[0m06:22:44.688777 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.690800 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:22:44.690800 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:22:44.690800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m06:22:44.692304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:22:44.692304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.692807 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:22:44.693497 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:22:44.702033 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m06:22:44.703506 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:22:44.703506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DBE0260>]}
[0m06:22:44.704509 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m06:22:44.704509 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:22:44.705509 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m06:22:44.705509 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m06:22:44.708882 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.708882 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m06:22:44.709885 [info ] [Thread-3 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:22:44.709885 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:22:44.712893 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.713559 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.dim_customers)
[0m06:22:44.713559 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:22:44.713559 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m06:22:44.714572 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.716578 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:22:44.717580 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:22:44.719590 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.722271 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.722773 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:22:44.722773 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:22:44.723934 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m06:22:44.723934 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.723934 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:22:44.743030 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:22:44.744045 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:22:44.745382 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:22:44.746387 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.746387 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.746387 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:22:44.747393 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:22:44.747393 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:22:44.748396 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:22:44.748396 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:22:44.780860 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m06:22:44.780860 [debug] [Thread-2 (]: SQL status: COMMIT in 0.033 seconds
[0m06:22:44.783333 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:22:44.785504 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:22:44.785504 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:22:44.786567 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m06:22:44.786567 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:22:44.786567 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:22:44.787571 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:22:44.787571 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:22:44.787571 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order
        ('day', max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_Methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_types_used,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then ('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                and ('day', current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when ('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:22:44.806575 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.018 seconds
[0m06:22:44.808027 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m06:22:44.808027 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DC50DD0>]}
[0m06:22:44.809030 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m06:22:44.810036 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m06:22:44.818328 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.030 seconds
[0m06:22:44.819783 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:22:44.819783 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DC50620>]}
[0m06:22:44.820847 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:22:44.820847 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:22:44.871730 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column cp.payment_types_used does not exist
LINE 73:         cp.payment_types_used,
                 ^

[0m06:22:44.872732 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:22:44.873236 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m06:22:44.878253 [debug] [Thread-3 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column cp.payment_types_used does not exist
  LINE 73:         cp.payment_types_used,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:22:44.879254 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88ea2c19-ccec-41ef-afc4-579099b199b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2BEB3350>]}
[0m06:22:44.879254 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.17s]
[0m06:22:44.880542 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m06:22:44.880542 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column cp.payment_types_used does not exist
  LINE 73:         cp.payment_types_used,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:22:44.882554 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.883309 [debug] [MainThread]: On master: BEGIN
[0m06:22:44.883309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:44.918335 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:22:44.918335 [debug] [MainThread]: On master: COMMIT
[0m06:22:44.919339 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:44.919339 [debug] [MainThread]: On master: COMMIT
[0m06:22:44.919339 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:22:44.919339 [debug] [MainThread]: On master: Close
[0m06:22:44.920344 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:44.920344 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:22:44.920344 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:22:44.920344 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:22:44.920344 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:22:44.921849 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:22:44.921849 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:22:44.921849 [info ] [MainThread]: 
[0m06:22:44.922859 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m06:22:44.923873 [debug] [MainThread]: Command end result
[0m06:22:45.054380 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:22:45.057616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:22:45.062899 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:22:45.062899 [info ] [MainThread]: 
[0m06:22:45.063939 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:22:45.063939 [info ] [MainThread]: 
[0m06:22:45.065039 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  column cp.payment_types_used does not exist
  LINE 73:         cp.payment_types_used,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:22:45.065039 [info ] [MainThread]: 
[0m06:22:45.065039 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:22:45.067216 [debug] [MainThread]: Command `dbt run` failed at 06:22:45.066210 after 2.16 seconds
[0m06:22:45.067216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DBD3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DBDB650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FA2DBDA5D0>]}
[0m06:22:45.067216 [debug] [MainThread]: Flushing usage events
[0m06:22:46.971611 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:24:17.710222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E3BADBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E36F3B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E134FBC0>]}


============================== 06:24:17.714975 | 771938e2-779e-465b-85f1-d4dde17ae382 ==============================
[0m06:24:17.714975 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:24:17.715996 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'write_json': 'True', 'log_format': 'default', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m06:24:17.896378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E35053A0>]}
[0m06:24:17.948634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E37142F0>]}
[0m06:24:17.949636 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:24:18.332538 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:24:18.519549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:24:18.519549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:24:18.556575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E5AEBBF0>]}
[0m06:24:18.627034 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:24:18.643831 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:24:18.671966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E42A7BC0>]}
[0m06:24:18.672472 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:24:18.672977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E5B0B320>]}
[0m06:24:18.675252 [info ] [MainThread]: 
[0m06:24:18.675252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:24:18.675252 [info ] [MainThread]: 
[0m06:24:18.676254 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:24:18.679827 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:24:18.825928 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:24:18.826930 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:24:18.826930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:18.867679 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m06:24:18.868681 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:24:18.870685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:24:18.875719 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:24:18.875719 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:24:18.875719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:24:18.909791 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:24:18.910793 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:24:18.910793 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:24:18.915812 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:24:18.917816 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:24:18.917816 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:24:18.923993 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:18.924995 [debug] [MainThread]: On master: BEGIN
[0m06:24:18.924995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:24:18.960047 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:24:18.960047 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:18.960047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:24:18.966852 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:24:18.968857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E5B46B70>]}
[0m06:24:18.968857 [debug] [MainThread]: On master: ROLLBACK
[0m06:24:18.969859 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:18.969859 [debug] [MainThread]: On master: BEGIN
[0m06:24:18.969859 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:24:18.970861 [debug] [MainThread]: On master: COMMIT
[0m06:24:18.970861 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:18.970861 [debug] [MainThread]: On master: COMMIT
[0m06:24:18.970861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:18.971861 [debug] [MainThread]: On master: Close
[0m06:24:18.974879 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:24:18.975881 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:24:18.975881 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:24:18.975881 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:24:18.976883 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:24:18.976883 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:24:18.977885 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:24:18.977885 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:24:18.977885 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:24:18.979388 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:24:18.979388 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:24:18.979388 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:24:18.980407 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:24:18.980407 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:24:18.980407 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:24:18.986424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:24:18.987426 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:24:18.989475 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:24:18.990481 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:24:18.993491 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:24:18.994179 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:24:19.022632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:24:19.022632 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:24:19.023640 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:24:19.023640 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:24:19.026674 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:24:19.030683 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:24:19.033379 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:24:19.033882 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.033882 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:24:19.034884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:24:19.034884 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.035888 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:24:19.035888 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.035888 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:24:19.037107 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:24:19.037107 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.037107 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:24:19.038116 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:24:19.038116 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:24:19.078465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:24:19.079466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.079969 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:24:19.081972 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m06:24:19.082476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.082980 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:24:19.085006 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m06:24:19.085006 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:24:19.085006 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.091021 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.091021 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:24:19.092021 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m06:24:19.092524 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:24:19.092524 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:24:19.094769 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.095772 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.095772 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:24:19.095772 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:24:19.096774 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.098871 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.098871 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:24:19.099885 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:24:19.099885 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:24:19.102391 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.102894 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:24:19.104907 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.104907 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:24:19.105909 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:24:19.107913 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.107913 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:24:19.121735 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:24:19.121735 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:24:19.122739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:19.122739 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.122739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.123958 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:24:19.124960 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.124960 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:24:19.126964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.126964 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.130015 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.130015 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:24:19.131017 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:24:19.131017 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:24:19.131017 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:24:19.137717 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:24:19.137717 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m06:24:19.137717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m06:24:19.138719 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m06:24:19.142729 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:24:19.143737 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:24:19.145841 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:24:19.146843 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:24:19.146843 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:24:19.147846 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.147846 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:24:19.148848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.148848 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:24:19.148848 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:24:19.149850 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:24:19.150852 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:24:19.152355 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:24:19.152858 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m06:24:19.152858 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:24:19.152858 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:24:19.153867 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:24:19.155871 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:24:19.156873 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:24:19.157875 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:24:19.158877 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:24:19.160928 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:24:19.160928 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:24:19.161928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E374EDB0>]}
[0m06:24:19.161928 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E61EF440>]}
[0m06:24:19.163217 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:24:19.163217 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:24:19.163949 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:24:19.164960 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:24:19.163949 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:24:19.165967 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:24:19.166969 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:24:19.167972 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:24:19.167972 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E60F13A0>]}
[0m06:24:19.167972 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:24:19.168974 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E60C0950>]}
[0m06:24:19.168974 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:24:19.169977 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:24:19.169977 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:24:19.170979 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:24:19.171979 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:24:19.170979 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:24:19.172483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:24:19.172985 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:24:19.172985 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:24:19.172985 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:24:19.173995 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:24:19.173995 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:24:19.173995 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:24:19.177256 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:24:19.179762 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:24:19.179762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:24:19.180777 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:24:19.182783 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:24:19.183468 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:24:19.183468 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:24:19.186600 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:24:19.189624 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:24:19.190691 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:24:19.193773 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:24:19.193773 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.194780 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:24:19.194780 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.194780 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:24:19.195790 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:24:19.195790 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.196792 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:24:19.196792 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:24:19.196792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:24:19.240619 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:24:19.240619 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.240619 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:24:19.242122 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m06:24:19.242633 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.242633 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:24:19.246904 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:24:19.246904 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:24:19.249920 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.253938 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.253938 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:24:19.253938 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:24:19.254940 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:19.254940 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.257322 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.260452 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.260452 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:24:19.260452 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:24:19.260452 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:19.261955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.262956 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:24:19.264089 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:24:19.264089 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.264089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.265109 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:24:19.265109 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:24:19.266112 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:24:19.268381 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:24:19.268381 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:24:19.268381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:24:19.270387 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:24:19.270387 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:24:19.270387 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:24:19.271890 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:24:19.272893 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:24:19.273964 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:24:19.273964 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:24:19.275408 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:24:19.275408 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E65AD6D0>]}
[0m06:24:19.276429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E60C6690>]}
[0m06:24:19.276429 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m06:24:19.277904 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:24:19.276429 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:24:19.278931 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:24:19.278931 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:24:19.279931 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:24:19.279931 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:24:19.280436 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:24:19.283794 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:24:19.285300 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:24:19.302679 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:24:19.303685 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:24:19.303685 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:24:19.304923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:24:19.345907 [debug] [Thread-2 (]: SQL status: BEGIN in 0.150 seconds
[0m06:24:19.345907 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m06:24:19.345907 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.346910 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:24:19.346910 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:24:19.346910 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order
        ('day', max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then ('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                and ('day', current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when ('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:24:19.350928 [debug] [Thread-4 (]: Postgres adapter: Postgres error: operator does not exist: record <= integer
LINE 100: ...and ('day', current_date - co.most_recent_order_date) <= 180
                                                                   ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m06:24:19.350928 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:24:19.351928 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:24:19.352935 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:24:19.356225 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.356225 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:24:19.357475 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:24:19.359484 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.359484 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:24:19.360488 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:24:19.361992 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:24:19.361992 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.361992 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:24:19.363000 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:24:19.365298 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:24:19.366303 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:24:19.366303 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:24:19.368309 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:24:19.369311 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:24:19.369311 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E6594590>]}
[0m06:24:19.370577 [debug] [Thread-4 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record <= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) <= 180
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:24:19.370577 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:24:19.372080 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771938e2-779e-465b-85f1-d4dde17ae382', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E5DD9670>]}
[0m06:24:19.372590 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:24:19.373370 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.09s]
[0m06:24:19.373370 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:24:19.374614 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record <= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) <= 180
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:24:19.375716 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:19.375716 [debug] [MainThread]: On master: BEGIN
[0m06:24:19.376780 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:24:19.415556 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m06:24:19.415556 [debug] [MainThread]: On master: COMMIT
[0m06:24:19.416575 [debug] [MainThread]: Using postgres connection "master"
[0m06:24:19.416575 [debug] [MainThread]: On master: COMMIT
[0m06:24:19.416575 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:24:19.417578 [debug] [MainThread]: On master: Close
[0m06:24:19.417578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:24:19.417578 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:24:19.418581 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:24:19.418581 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:24:19.418581 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:24:19.418581 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:24:19.419580 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:24:19.419580 [info ] [MainThread]: 
[0m06:24:19.419580 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m06:24:19.420581 [debug] [MainThread]: Command end result
[0m06:24:19.499328 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:24:19.501960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:24:19.508398 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:24:19.508398 [info ] [MainThread]: 
[0m06:24:19.508398 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:24:19.509510 [info ] [MainThread]: 
[0m06:24:19.509510 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record <= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) <= 180
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:24:19.510515 [info ] [MainThread]: 
[0m06:24:19.510515 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:24:19.512019 [debug] [MainThread]: Command `dbt run` failed at 06:24:19.512019 after 1.94 seconds
[0m06:24:19.512527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E3D154C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E40BD1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E1559E80>]}
[0m06:24:19.512527 [debug] [MainThread]: Flushing usage events
[0m06:24:21.449231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:26:28.907318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113D2A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113D28FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113D29250>]}


============================== 06:26:28.910339 | 2b1d6636-36cb-4887-8217-663452a95206 ==============================
[0m06:26:28.910339 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:26:28.911842 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'target_path': 'None', 'log_format': 'default', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:26:29.091785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131147D1DF0>]}
[0m06:26:29.143502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113C80C50>]}
[0m06:26:29.145180 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:26:29.523263 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:26:29.707664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:26:29.708666 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:26:29.743287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013115CFAC30>]}
[0m06:26:29.814632 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:26:29.832056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:26:29.861104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131147AFA40>]}
[0m06:26:29.861104 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:26:29.862104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013115F2C230>]}
[0m06:26:29.863625 [info ] [MainThread]: 
[0m06:26:29.864628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:26:29.864628 [info ] [MainThread]: 
[0m06:26:29.865631 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:26:29.869657 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:26:30.009916 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:26:30.009916 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:26:30.009916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:30.056799 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m06:26:30.057801 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:26:30.059806 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:26:30.064540 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:26:30.065553 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:26:30.065553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:30.100445 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m06:26:30.101948 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:26:30.101948 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:26:30.106655 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:26:30.108705 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:26:30.108705 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:26:30.115209 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.115209 [debug] [MainThread]: On master: BEGIN
[0m06:26:30.115209 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:26:30.152022 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m06:26:30.152525 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.152525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:26:30.158652 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:26:30.161657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013116080DA0>]}
[0m06:26:30.161657 [debug] [MainThread]: On master: ROLLBACK
[0m06:26:30.162160 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.162160 [debug] [MainThread]: On master: BEGIN
[0m06:26:30.162663 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:26:30.162663 [debug] [MainThread]: On master: COMMIT
[0m06:26:30.163455 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.163455 [debug] [MainThread]: On master: COMMIT
[0m06:26:30.163455 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:26:30.164470 [debug] [MainThread]: On master: Close
[0m06:26:30.167482 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:26:30.168485 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:26:30.168485 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:26:30.168485 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:26:30.169487 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:26:30.169487 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:26:30.170486 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:26:30.170486 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:26:30.170486 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:26:30.171989 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:26:30.171989 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:26:30.171989 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:26:30.172989 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:26:30.172989 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:26:30.172989 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:26:30.179093 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:26:30.180095 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:26:30.182098 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:26:30.183610 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:26:30.185784 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:26:30.186787 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:26:30.215590 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:26:30.218656 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:26:30.222668 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:26:30.222668 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:26:30.223678 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:26:30.227877 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:26:30.227877 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.230896 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:26:30.231896 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.231896 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:26:30.231896 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:26:30.233177 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.233177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:26:30.234004 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:26:30.234004 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:26:30.234004 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.235065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:26:30.235065 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:26:30.236069 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:26:30.276556 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:26:30.277813 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.277813 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:26:30.278823 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m06:26:30.278823 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.279826 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:26:30.283196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:26:30.288377 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.289380 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:26:30.289380 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:26:30.291897 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.292899 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m06:26:30.292899 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:26:30.293403 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:30.293403 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.296065 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.296065 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:26:30.296065 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:26:30.297065 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:26:30.298571 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.299576 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:26:30.299576 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:30.307621 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:26:30.313362 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:26:30.314375 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m06:26:30.316380 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.317382 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.318384 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:26:30.318384 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:26:30.319389 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:26:30.319389 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.319389 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:26:30.320403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:30.320403 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:26:30.320403 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:26:30.322911 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.328125 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:26:30.330130 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:26:30.331132 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:26:30.335371 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:30.335371 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:30.336373 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:26:30.336373 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:30.336373 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:26:30.339545 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:26:30.339545 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:26:30.340547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.342561 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:26:30.342561 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:30.342561 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:26:30.343570 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:26:30.346579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113C82000>]}
[0m06:26:30.346579 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131167A7BF0>]}
[0m06:26:30.346579 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:30.347584 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:26:30.350694 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:26:30.347584 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:26:30.350694 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:26:30.351694 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:30.351694 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:26:30.351694 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:26:30.353105 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:26:30.353105 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:26:30.354117 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:26:30.354117 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:26:30.355208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:26:30.355208 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:26:30.355208 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:26:30.356213 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:26:30.356213 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:26:30.357216 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:26:30.360225 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:26:30.362735 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:26:30.363524 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131166E6DB0>]}
[0m06:26:30.363524 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:26:30.364547 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:26:30.364547 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:26:30.365584 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:26:30.370065 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:26:30.370065 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:26:30.371658 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:26:30.377171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:26:30.378171 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:26:30.376170 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:26:30.383196 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:26:30.383609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.384197 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:26:30.385198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:30.386198 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:26:30.393209 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:26:30.394211 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.394211 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:26:30.396217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:26:30.396217 [debug] [Thread-4 (]: SQL status: BEGIN in 0.161 seconds
[0m06:26:30.395212 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.397715 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.398717 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:26:30.398717 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:26:30.399717 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:26:30.406743 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:26:30.412266 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.412769 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:26:30.414784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:30.418785 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.419786 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:26:30.420786 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:30.422794 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:26:30.423662 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.424810 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:26:30.426810 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:30.431811 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:26:30.432872 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:30.434302 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:26:30.436306 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:30.437401 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:26:30.438405 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013116722B40>]}
[0m06:26:30.439408 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.27s]
[0m06:26:30.439408 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:26:30.455395 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m06:26:30.456398 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.456398 [debug] [Thread-2 (]: SQL status: BEGIN in 0.060 seconds
[0m06:26:30.456398 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m06:26:30.457401 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:26:30.457401 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.457401 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.458405 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:26:30.458405 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:26:30.461913 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:26:30.466988 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.467991 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:26:30.467991 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:26:30.467991 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:26:30.471015 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.473530 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.473530 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:26:30.474533 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:26:30.474533 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:30.476538 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.477541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:26:30.477541 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:26:30.477541 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:26:30.480548 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.482561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.482561 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:26:30.483358 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:30.483358 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:26:30.484372 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:26:30.485385 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:30.485385 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.485385 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:30.486388 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:26:30.487390 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:26:30.488393 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:26:30.488393 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.488393 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.489395 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:26:30.489395 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:26:30.489395 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:26:30.491901 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:26:30.491901 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:30.491901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:30.492906 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:30.494412 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:26:30.496416 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:26:30.496416 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:26:30.497417 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:30.497417 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:30.497417 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:26:30.498689 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:26:30.498689 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:26:30.499699 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:26:30.499699 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:30.500702 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:30.501702 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:26:30.502205 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001311670D8E0>]}
[0m06:26:30.502707 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:26:30.503717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001311663FB90>]}
[0m06:26:30.503717 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m06:26:30.504719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001311663F6B0>]}
[0m06:26:30.504719 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m06:26:30.504719 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:26:30.506098 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:26:30.506098 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.15s]
[0m06:26:30.507101 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:26:30.508103 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:26:30.508103 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:26:30.509106 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:26:30.509106 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:26:30.512616 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:26:30.513362 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:26:30.531878 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:26:30.533615 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:26:30.533615 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:26:30.533615 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:26:30.571110 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m06:26:30.572110 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:26:30.572613 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order
        ('day', max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then ('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                and ('day', current_date - co.most_recent_order_date) >= 100
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when ('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:26:30.574331 [debug] [Thread-4 (]: Postgres adapter: Postgres error: operator does not exist: record >= integer
LINE 100: ...and ('day', current_date - co.most_recent_order_date) >= 100
                                                                   ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m06:26:30.575435 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:26:30.575435 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:26:30.580451 [debug] [Thread-4 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record >= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) >= 100
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:26:30.581954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b1d6636-36cb-4887-8217-663452a95206', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001311663E180>]}
[0m06:26:30.581954 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.07s]
[0m06:26:30.582960 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:26:30.582960 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record >= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) >= 100
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:26:30.585079 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.585079 [debug] [MainThread]: On master: BEGIN
[0m06:26:30.585079 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:26:30.619449 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:26:30.619449 [debug] [MainThread]: On master: COMMIT
[0m06:26:30.620464 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:30.620464 [debug] [MainThread]: On master: COMMIT
[0m06:26:30.620464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:26:30.620464 [debug] [MainThread]: On master: Close
[0m06:26:30.621966 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:26:30.621966 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:26:30.621966 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:26:30.621966 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:26:30.622968 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:26:30.622968 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:26:30.622968 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:26:30.622968 [info ] [MainThread]: 
[0m06:26:30.622968 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m06:26:30.625400 [debug] [MainThread]: Command end result
[0m06:26:30.699354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:26:30.701919 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:26:30.707631 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:26:30.707631 [info ] [MainThread]: 
[0m06:26:30.708633 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:26:30.708633 [info ] [MainThread]: 
[0m06:26:30.709647 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record >= integer
  LINE 100: ...and ('day', current_date - co.most_recent_order_date) >= 100
                                                                     ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:26:30.709647 [info ] [MainThread]: 
[0m06:26:30.709647 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:26:30.710656 [debug] [MainThread]: Command `dbt run` failed at 06:26:30.710656 after 1.95 seconds
[0m06:26:30.710656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013113F1B8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131144B88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000131144B9C40>]}
[0m06:26:30.712160 [debug] [MainThread]: Flushing usage events
[0m06:26:32.654345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:26:51.882641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001D4F7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001D43BF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001D4396A0>]}


============================== 06:26:51.886601 | 914f8bed-b2c6-4e4d-b741-90bebbadcfc2 ==============================
[0m06:26:51.886601 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:26:51.887778 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'use_colors': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:26:52.073549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020020391FA0>]}
[0m06:26:52.125476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FD22CF0>]}
[0m06:26:52.126477 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:26:52.515607 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:26:52.704785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:26:52.704785 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:26:52.742820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200217D7170>]}
[0m06:26:52.814831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:26:52.832982 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:26:52.861837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020021B93800>]}
[0m06:26:52.861837 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:26:52.862843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020021713830>]}
[0m06:26:52.864996 [info ] [MainThread]: 
[0m06:26:52.864996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:26:52.866182 [info ] [MainThread]: 
[0m06:26:52.866182 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:26:52.870311 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:26:53.015616 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:26:53.016616 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:26:53.016616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:53.062821 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m06:26:53.064851 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:26:53.065873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:26:53.070877 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:26:53.071877 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:26:53.071877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:26:53.107027 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m06:26:53.108030 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:26:53.108030 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:26:53.112698 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:26:53.115322 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:26:53.115322 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:26:53.121682 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.121682 [debug] [MainThread]: On master: BEGIN
[0m06:26:53.123074 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:26:53.173727 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m06:26:53.174731 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.174731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:26:53.183440 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m06:26:53.185220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200204586B0>]}
[0m06:26:53.186222 [debug] [MainThread]: On master: ROLLBACK
[0m06:26:53.186222 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.187463 [debug] [MainThread]: On master: BEGIN
[0m06:26:53.187463 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:26:53.187463 [debug] [MainThread]: On master: COMMIT
[0m06:26:53.187463 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.188864 [debug] [MainThread]: On master: COMMIT
[0m06:26:53.188864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:26:53.188864 [debug] [MainThread]: On master: Close
[0m06:26:53.194289 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:26:53.194289 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:26:53.195451 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:26:53.195451 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:26:53.196451 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:26:53.196451 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:26:53.196451 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:26:53.198921 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:26:53.197890 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:26:53.198921 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:26:53.199925 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:26:53.199925 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:26:53.199925 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:26:53.200927 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:26:53.200927 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:26:53.209176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:26:53.209176 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:26:53.212680 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:26:53.215694 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:26:53.218717 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:26:53.219723 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:26:53.250429 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:26:53.251934 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:26:53.251934 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:26:53.252936 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:26:53.256432 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:26:53.260437 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:26:53.263444 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:26:53.263444 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.264551 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:26:53.264551 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:26:53.265650 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.265650 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:26:53.266653 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.266653 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.266653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:26:53.267976 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:26:53.267976 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:26:53.267976 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:26:53.267976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:26:53.313485 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m06:26:53.314778 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.314778 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:26:53.319117 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m06:26:53.319117 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.319117 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:26:53.320229 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:26:53.325834 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.325834 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:26:53.326838 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:26:53.326838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m06:26:53.329863 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.329863 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.329863 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.330928 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:26:53.330928 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:26:53.332938 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.333589 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:26:53.333589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.335802 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.335802 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:26:53.335802 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:26:53.345855 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m06:26:53.349981 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:26:53.352991 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.352991 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:26:53.353600 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.353600 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:26:53.354883 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:26:53.354883 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:26:53.356076 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.356076 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.356076 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:26:53.358325 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.359327 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:26:53.359327 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:26:53.365026 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:26:53.365026 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m06:26:53.369268 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:26:53.369268 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:26:53.370270 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:26:53.371773 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:26:53.372775 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:26:53.373278 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:26:53.374001 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.374001 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:26:53.374001 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:26:53.375237 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:26:53.377265 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:26:53.377265 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:53.377265 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:53.380353 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:26:53.383948 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:26:53.383948 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:26:53.384951 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:26:53.385992 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001F8428D0>]}
[0m06:26:53.385992 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002227C230>]}
[0m06:26:53.386992 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:26:53.385992 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:26:53.388486 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:26:53.386992 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:26:53.389487 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:26:53.389487 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:26:53.390522 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020022275FA0>]}
[0m06:26:53.390522 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_orders
[0m06:26:53.390522 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:26:53.392025 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:26:53.392025 [info ] [Thread-4 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:26:53.392535 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:26:53.392535 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:26:53.393714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_orders)
[0m06:26:53.393714 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:26:53.394812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:26:53.394812 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_orders
[0m06:26:53.394812 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:26:53.395812 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:26:53.398071 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:26:53.398071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:26:53.401085 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:26:53.401085 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:26:53.403439 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:26:53.404450 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_orders
[0m06:26:53.407686 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:26:53.408768 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:26:53.412780 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:26:53.412780 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:26:53.412780 [debug] [Thread-1 (]: SQL status: BEGIN in 0.148 seconds
[0m06:26:53.416128 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:26:53.416128 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.416128 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.417388 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:26:53.418394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.418394 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:26:53.418394 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.419396 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:26:53.419396 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:26:53.419396 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:26:53.420520 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:26:53.420520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:26:53.424444 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:26:53.429905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.429905 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:26:53.431291 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:53.436304 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.437304 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:26:53.438305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:53.440305 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:26:53.441809 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.441809 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:26:53.444318 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:26:53.448319 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:26:53.449318 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:26:53.450319 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:26:53.452827 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:53.455333 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:26:53.455333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200220A33E0>]}
[0m06:26:53.456539 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.26s]
[0m06:26:53.457542 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:26:53.476628 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m06:26:53.476628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m06:26:53.477634 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.477634 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.477634 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:26:53.478640 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:26:53.483548 [debug] [Thread-3 (]: SQL status: BEGIN in 0.062 seconds
[0m06:26:53.484053 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:26:53.484053 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:26:53.484053 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.487059 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.491142 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.492142 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:26:53.492646 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:26:53.492646 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:26:53.493672 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.493672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:53.495885 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.497896 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.498898 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:26:53.498898 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:26:53.498898 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:26:53.502073 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.502577 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:26:53.502577 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.503365 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:53.504481 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:26:53.504481 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:26:53.505527 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:26:53.506529 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.507834 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.508836 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.508836 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:26:53.508836 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:26:53.509849 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:26:53.509849 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:26:53.510985 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:26:53.511985 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:53.511985 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:26:53.511985 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.514226 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:26:53.515290 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:26:53.516295 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:26:53.516295 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:26:53.517299 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:26:53.517299 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:26:53.518318 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:26:53.518318 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:26:53.520358 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:26:53.520358 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:53.520358 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:26:53.520358 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:26:53.521862 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:26:53.523562 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: Close
[0m06:26:53.523562 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:26:53.523562 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002212FAA0>]}
[0m06:26:53.523562 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002002212FCB0>]}
[0m06:26:53.525034 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m06:26:53.526054 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:26:53.525034 [info ] [Thread-4 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.13s]
[0m06:26:53.526054 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:26:53.527057 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:26:53.528191 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_orders
[0m06:26:53.528191 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020022263CB0>]}
[0m06:26:53.529535 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m06:26:53.529535 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.13s]
[0m06:26:53.530667 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:26:53.530667 [info ] [Thread-1 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:26:53.530667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m06:26:53.532170 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m06:26:53.534691 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:26:53.535693 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m06:26:53.554620 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:26:53.555620 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:26:53.556981 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:26:53.556981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:26:53.594058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m06:26:53.595061 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:26:53.595061 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order
        ('day', max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when cp.lifetime_value >= 1000 then 'High Value'
            when cp.lifetime_value >= 500 then 'Medium Value'
            when cp.lifetime_value > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order)
        case 
            when co.most_recent_order_date is not null 
            then ('day', current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment
        case
            when co.lifetime_orders >= 3 and cp.lifetime_value >= 500 
                --and ('day', current_date - co.most_recent_order_date) >= 100
            then 'Champion'
            when co.lifetime_orders >= 2 and cp.lifetime_value >= 300
            then 'Loyal'
            when co.lifetime_orders = 1 and cp.lifetime_value >= 200
            then 'Potential'
            when ('day', current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:26:53.597066 [debug] [Thread-1 (]: Postgres adapter: Postgres error: operator does not exist: record > integer
LINE 106: ...when ('day', current_date - co.most_recent_order_date) > 365
                                                                    ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m06:26:53.598473 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:26:53.598473 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m06:26:53.604084 [debug] [Thread-1 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record > integer
  LINE 106: ...when ('day', current_date - co.most_recent_order_date) > 365
                                                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:26:53.604084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '914f8bed-b2c6-4e4d-b741-90bebbadcfc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020022161C70>]}
[0m06:26:53.605086 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.07s]
[0m06:26:53.605086 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m06:26:53.606590 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record > integer
  LINE 106: ...when ('day', current_date - co.most_recent_order_date) > 365
                                                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:26:53.607606 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.608658 [debug] [MainThread]: On master: BEGIN
[0m06:26:53.608658 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:26:53.644984 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m06:26:53.644984 [debug] [MainThread]: On master: COMMIT
[0m06:26:53.644984 [debug] [MainThread]: Using postgres connection "master"
[0m06:26:53.646198 [debug] [MainThread]: On master: COMMIT
[0m06:26:53.646198 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:26:53.646198 [debug] [MainThread]: On master: Close
[0m06:26:53.647203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:26:53.647203 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:26:53.647203 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:26:53.647203 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:26:53.648204 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:26:53.648204 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:26:53.648204 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:26:53.648204 [info ] [MainThread]: 
[0m06:26:53.649204 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m06:26:53.650204 [debug] [MainThread]: Command end result
[0m06:26:53.724159 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:26:53.727356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:26:53.733482 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:26:53.733482 [info ] [MainThread]: 
[0m06:26:53.733482 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:26:53.734656 [info ] [MainThread]: 
[0m06:26:53.734656 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  operator does not exist: record > integer
  LINE 106: ...when ('day', current_date - co.most_recent_order_date) > 365
                                                                      ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:26:53.734656 [info ] [MainThread]: 
[0m06:26:53.735671 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:26:53.736671 [debug] [MainThread]: Command `dbt run` failed at 06:26:53.736671 after 1.95 seconds
[0m06:26:53.737672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002001FF516A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020021B48080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200221331D0>]}
[0m06:26:53.737672 [debug] [MainThread]: Flushing usage events
[0m06:26:55.563545 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:07.618327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C1F8A10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E9393E3BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C1F8E60>]}


============================== 06:34:07.621964 | 4fd06761-9824-48c0-bb75-a4f1bd7e6a94 ==============================
[0m06:34:07.621964 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:34:07.622973 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:34:07.802784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C3D96A0>]}
[0m06:34:07.854626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E939F89F10>]}
[0m06:34:07.856626 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:34:08.236698 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:34:08.420680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:08.421681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:08.458440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93D756690>]}
[0m06:34:08.529027 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:34:08.546244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:34:08.575670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93D941280>]}
[0m06:34:08.576673 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:34:08.577700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93DABC770>]}
[0m06:34:08.579727 [info ] [MainThread]: 
[0m06:34:08.580829 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:08.580829 [info ] [MainThread]: 
[0m06:34:08.582333 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:08.585864 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:34:08.746338 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:34:08.746338 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:34:08.746338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:08.790282 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m06:34:08.790282 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:34:08.793293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:34:08.798238 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:34:08.798238 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:34:08.798238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:08.833217 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:34:08.833217 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:34:08.833217 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:34:08.839241 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:34:08.840254 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:34:08.840254 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:34:08.846995 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:08.846995 [debug] [MainThread]: On master: BEGIN
[0m06:34:08.846995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:08.880623 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:34:08.880623 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:08.882126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:34:08.887664 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m06:34:08.890704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93DF84260>]}
[0m06:34:08.890704 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:08.890704 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:08.891703 [debug] [MainThread]: On master: BEGIN
[0m06:34:08.891703 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:08.892207 [debug] [MainThread]: On master: COMMIT
[0m06:34:08.892207 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:08.892709 [debug] [MainThread]: On master: COMMIT
[0m06:34:08.892709 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:08.893371 [debug] [MainThread]: On master: Close
[0m06:34:08.896388 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:34:08.897390 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:34:08.897390 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:34:08.898393 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:34:08.897390 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:34:08.898393 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:34:08.899395 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:34:08.899395 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:34:08.900409 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:34:08.900409 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:34:08.900409 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:34:08.900409 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:34:08.900409 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:34:08.901912 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:34:08.901912 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:34:08.901912 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:34:08.908442 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:34:08.910447 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:34:08.911949 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:34:08.914098 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:34:08.916112 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:34:08.935133 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:34:08.944687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:34:08.946692 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:34:08.948195 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:34:08.948195 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:34:08.953250 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:34:08.955255 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:34:08.956257 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:08.956257 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:08.957260 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:34:08.957260 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:34:08.957260 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:34:08.958263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:34:08.958263 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:08.959265 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:08.959265 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:34:08.959265 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:34:08.960287 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:34:08.960287 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:09.002515 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:34:09.003323 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:09.003323 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:34:09.003323 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m06:34:09.004398 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:09.004398 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:34:09.007821 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m06:34:09.008825 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:09.008825 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:34:09.009830 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:34:09.015858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:09.015858 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m06:34:09.016861 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m06:34:09.016861 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:34:09.019881 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:09.019881 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m06:34:09.022387 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:09.022890 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:34:09.022890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.023663 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:09.023663 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:34:09.025679 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:09.026682 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:09.026682 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:34:09.026682 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:34:09.027684 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.029761 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:09.031764 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:09.031764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:09.031764 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:34:09.033184 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:34:09.043376 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m06:34:09.046465 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:34:09.048970 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:09.049982 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:34:09.049982 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:34:09.049982 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:09.050984 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:34:09.051985 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:34:09.052991 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:34:09.052991 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:34:09.054000 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:09.054000 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.054000 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:09.055003 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:34:09.057008 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:09.057008 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:34:09.058010 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:34:09.058010 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:34:09.064583 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:34:09.064583 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m06:34:09.069615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:09.069615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:34:09.069615 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m06:34:09.072120 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:34:09.072630 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:34:09.073358 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:34:09.075428 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:34:09.075428 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:09.076431 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:09.076431 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:09.077433 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:34:09.077433 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:34:09.077433 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:34:09.078436 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:34:09.080452 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:34:09.080452 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:34:09.080452 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:34:09.082962 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:34:09.084126 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:34:09.085130 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:34:09.086132 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:09.087135 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:34:09.087135 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:34:09.088137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93B7BE870>]}
[0m06:34:09.088137 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E1C5520>]}
[0m06:34:09.088137 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E1C5490>]}
[0m06:34:09.089140 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:34:09.090143 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:09.090143 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:34:09.091903 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:34:09.091400 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:34:09.093733 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:34:09.093733 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:34:09.094759 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:34:09.094759 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:34:09.094759 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:34:09.095762 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E1C4470>]}
[0m06:34:09.096764 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m06:34:09.095762 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:34:09.096764 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:34:09.096764 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:34:09.098233 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:34:09.098233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:34:09.099236 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:34:09.099236 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:34:09.100245 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m06:34:09.100245 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:34:09.100245 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:34:09.100245 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:34:09.103257 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:34:09.105263 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:34:09.107337 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:34:09.109345 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:34:09.109345 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:34:09.112868 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:34:09.113687 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m06:34:09.115703 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:34:09.119718 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:34:09.120720 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.120720 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:34:09.120720 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:34:09.121722 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.122229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.122734 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:34:09.122734 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:34:09.123750 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:34:09.123750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:09.164859 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m06:34:09.165861 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.165861 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:34:09.166863 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m06:34:09.167865 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.167865 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:34:09.170945 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:34:09.173722 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.173722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:34:09.173722 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:34:09.177742 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.177742 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:34:09.178745 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.180749 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.180749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:09.181749 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:34:09.183764 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.183764 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:34:09.183764 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.185855 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:34:09.185855 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:09.186858 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.187860 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:34:09.187860 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:34:09.187860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.188863 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:34:09.189931 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:09.190953 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:34:09.191953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:34:09.192458 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:09.194174 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:34:09.194174 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:34:09.195178 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:09.195178 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:34:09.196181 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:09.196181 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:09.197635 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m06:34:09.198638 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:34:09.198638 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E09CC80>]}
[0m06:34:09.199830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E5DD310>]}
[0m06:34:09.199830 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m06:34:09.200834 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m06:34:09.200834 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:34:09.201834 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:34:09.202977 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m06:34:09.202977 [info ] [Thread-3 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:34:09.202977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.dim_customers)
[0m06:34:09.203993 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m06:34:09.207266 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:34:09.208269 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m06:34:09.226013 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:34:09.228019 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:09.228019 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:34:09.228019 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:34:09.260376 [debug] [Thread-2 (]: SQL status: BEGIN in 0.140 seconds
[0m06:34:09.261880 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.261880 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:34:09.266202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m06:34:09.267531 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:09.267531 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:34:09.267531 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        (max(date(purchased_date)) - min(date(purchased_date)))::int as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date - co.most_recent_order_date)::int
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final;
  );
  
[0m06:34:09.270678 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.270678 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:34:09.271678 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 125: select * from final;
                             ^

[0m06:34:09.271678 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:09.271678 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:34:09.274130 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.275132 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:34:09.275132 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m06:34:09.276142 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:09.277145 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:34:09.278145 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.278145 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:34:09.279375 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:09.281852 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:34:09.281852 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:09.281852 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:34:09.283854 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:09.284941 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:34:09.284941 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E17E990>]}
[0m06:34:09.285944 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:34:09.285944 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:34:09.288432 [debug] [Thread-3 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  syntax error at or near ";"
  LINE 125: select * from final;
                               ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:34:09.289432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd06761-9824-48c0-bb75-a4f1bd7e6a94', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E192540>]}
[0m06:34:09.289432 [error] [Thread-3 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.09s]
[0m06:34:09.290432 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m06:34:09.290432 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  syntax error at or near ";"
  LINE 125: select * from final;
                               ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:34:09.291937 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:09.292947 [debug] [MainThread]: On master: BEGIN
[0m06:34:09.293450 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:09.328580 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:34:09.328580 [debug] [MainThread]: On master: COMMIT
[0m06:34:09.328580 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:09.329583 [debug] [MainThread]: On master: COMMIT
[0m06:34:09.329583 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:09.329583 [debug] [MainThread]: On master: Close
[0m06:34:09.330587 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:09.330587 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:34:09.330587 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:34:09.330587 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:34:09.330587 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:34:09.332090 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:34:09.332090 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:34:09.332602 [info ] [MainThread]: 
[0m06:34:09.332602 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m06:34:09.333889 [debug] [MainThread]: Command end result
[0m06:34:09.406643 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:34:09.409121 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:34:09.414928 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:34:09.414928 [info ] [MainThread]: 
[0m06:34:09.414928 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:34:09.414928 [info ] [MainThread]: 
[0m06:34:09.416370 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  syntax error at or near ";"
  LINE 125: select * from final;
                               ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:34:09.416370 [info ] [MainThread]: 
[0m06:34:09.416370 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:34:09.417690 [debug] [MainThread]: Command `dbt run` failed at 06:34:09.417690 after 1.95 seconds
[0m06:34:09.418690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93C12D250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E5DBC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E93E5D8620>]}
[0m06:34:09.418690 [debug] [MainThread]: Flushing usage events
[0m06:34:11.338138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:34:44.372193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D82E699A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DFFF1FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D82A955B0>]}


============================== 06:34:44.375448 | 7bbe3cea-4101-497f-a4f8-f894f0c059c3 ==============================
[0m06:34:44.375448 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:34:44.376451 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m06:34:44.555547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D8366E660>]}
[0m06:34:44.607512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D833F49E0>]}
[0m06:34:44.608514 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:34:44.979663 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:34:45.170275 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:34:45.170275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:34:45.205792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D84ABB110>]}
[0m06:34:45.275752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:34:45.294074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:34:45.321984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D84E6BC80>]}
[0m06:34:45.322487 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:34:45.322989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D836283B0>]}
[0m06:34:45.325106 [info ] [MainThread]: 
[0m06:34:45.325106 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:34:45.326326 [info ] [MainThread]: 
[0m06:34:45.326326 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:34:45.329331 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:34:45.473859 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:34:45.474864 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:34:45.474864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:45.626826 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.152 seconds
[0m06:34:45.627830 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:34:45.629835 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:34:45.634995 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:34:45.634995 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:34:45.634995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:34:45.771778 [debug] [ThreadPool]: SQL status: BEGIN in 0.136 seconds
[0m06:34:45.772282 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:34:45.772784 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:34:45.777803 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.005 seconds
[0m06:34:45.778805 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:34:45.778805 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:34:45.784657 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:45.785659 [debug] [MainThread]: On master: BEGIN
[0m06:34:45.785659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:34:45.818602 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m06:34:45.819604 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:45.819604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:34:45.825287 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:34:45.828535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D84E19040>]}
[0m06:34:45.828535 [debug] [MainThread]: On master: ROLLBACK
[0m06:34:45.828535 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:45.829537 [debug] [MainThread]: On master: BEGIN
[0m06:34:45.829537 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:34:45.829537 [debug] [MainThread]: On master: COMMIT
[0m06:34:45.829537 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:45.830548 [debug] [MainThread]: On master: COMMIT
[0m06:34:45.830548 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:45.830548 [debug] [MainThread]: On master: Close
[0m06:34:45.834575 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:34:45.834575 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:34:45.834575 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:34:45.835577 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:34:45.835577 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:34:45.835577 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:34:45.836580 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:34:45.837583 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:34:45.836580 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:34:45.837583 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:34:45.838585 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:34:45.838585 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:34:45.838585 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:34:45.839588 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:34:45.839588 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:34:45.845350 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:34:45.845350 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:34:45.847355 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:34:45.849359 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:34:45.851872 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:34:45.852879 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:34:45.886064 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:34:45.887067 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:34:45.890193 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:34:45.890193 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:34:45.891697 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:34:45.895013 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:34:45.896016 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.899023 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:34:45.899023 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:34:45.899023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:45.900025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:34:45.900025 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:34:45.901027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:45.901027 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:45.902027 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:34:45.902027 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:34:45.902530 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:34:45.902530 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:34:45.903542 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:34:45.942824 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m06:34:45.942824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.942824 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:34:45.944974 [debug] [Thread-2 (]: SQL status: BEGIN in 0.043 seconds
[0m06:34:45.944974 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:45.945977 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:34:45.947982 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:34:45.953237 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.954249 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:34:45.954249 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:34:45.954249 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m06:34:45.957256 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:45.957256 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:45.958259 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:45.958259 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:34:45.958259 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:34:45.960263 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.960263 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:34:45.961766 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:45.963896 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:45.963896 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:45.963896 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:34:45.977173 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:34:45.978175 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m06:34:45.978175 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.980190 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:45.981693 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:34:45.981693 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:34:45.981693 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:34:45.983749 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:34:45.983749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:45.983749 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:34:45.984752 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:45.986756 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:45.986756 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:34:45.987759 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m06:34:45.987759 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:34:45.992771 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:34:45.994405 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:34:45.998456 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:34:45.999459 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:34:45.999459 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:34:46.000461 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:34:46.000461 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:34:46.001964 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:34:46.001964 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:46.001964 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:34:46.002968 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:46.005130 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:46.005130 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:34:46.007135 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:34:46.009139 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:34:46.010152 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:34:46.010152 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:34:46.012665 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:34:46.013973 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D82B0AF60>]}
[0m06:34:46.013973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D85563AA0>]}
[0m06:34:46.013973 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:46.014984 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:34:46.015988 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:34:46.014984 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:34:46.016990 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:34:46.016990 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:34:46.017993 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D8552E5D0>]}
[0m06:34:46.017993 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m06:34:46.018997 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m06:34:46.018997 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:34:46.020001 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:34:46.021004 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:34:46.020001 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:34:46.021004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m06:34:46.021004 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m06:34:46.022004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_products)
[0m06:34:46.022506 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m06:34:46.022506 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m06:34:46.022506 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:34:46.025258 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:34:46.027264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:34:46.027264 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m06:34:46.028266 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:34:46.030374 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:34:46.030374 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m06:34:46.030374 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m06:34:46.034060 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:34:46.037075 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:34:46.038078 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m06:34:46.040106 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:34:46.041611 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.041611 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.042621 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:34:46.043316 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m06:34:46.043316 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.043316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:34:46.044447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:34:46.044447 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:34:46.045455 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:34:46.059396 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m06:34:46.060426 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:46.060426 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:34:46.067213 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:34:46.070268 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:46.070268 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:34:46.071771 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.073974 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:46.073974 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:34:46.075067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.076070 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:34:46.077075 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:46.077075 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:34:46.078079 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:46.080086 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:34:46.080086 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:34:46.081092 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:34:46.082092 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:46.083351 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:34:46.083351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D854A0830>]}
[0m06:34:46.084372 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.25s]
[0m06:34:46.085390 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:34:46.085390 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m06:34:46.086427 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.086427 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:34:46.092738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:34:46.096759 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.096759 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m06:34:46.097761 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:34:46.097761 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.097761 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m06:34:46.098764 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:34:46.098764 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.098764 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.101781 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.102285 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:34:46.102285 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:34:46.102787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.104621 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m06:34:46.104621 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:34:46.104621 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.108052 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.108052 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:34:46.109055 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m06:34:46.109055 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:34:46.112061 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.112564 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:34:46.112564 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.112564 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:46.113579 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.115595 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.117601 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:34:46.119605 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.120607 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:34:46.120607 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:34:46.121608 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:34:46.122111 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:34:46.122111 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:34:46.123281 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:34:46.123281 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:34:46.124299 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:34:46.124299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.125301 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:34:46.126304 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m06:34:46.127306 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:34:46.127306 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.127306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D855543B0>]}
[0m06:34:46.128308 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:34:46.128308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:34:46.129312 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m06:34:46.130331 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:34:46.131834 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m06:34:46.131834 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m06:34:46.132840 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:34:46.134346 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:34:46.134346 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:34:46.135349 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:34:46.135349 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:34:46.136352 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:46.137413 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:34:46.138416 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m06:34:46.139507 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m06:34:46.140509 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D8552E6C0>]}
[0m06:34:46.140509 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D85407AA0>]}
[0m06:34:46.140509 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m06:34:46.142563 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m06:34:46.142012 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m06:34:46.143327 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m06:34:46.143327 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m06:34:46.143327 [info ] [Thread-3 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:34:46.144355 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.dim_customers)
[0m06:34:46.144355 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m06:34:46.147718 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:34:46.149724 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m06:34:46.167676 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:34:46.169748 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:46.169748 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:34:46.170775 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:34:46.315775 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m06:34:46.316777 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:46.316777 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        (max(date(purchased_date)) - min(date(purchased_date)))::int as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date - co.most_recent_order_date)::int
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:34:48.266792 [debug] [Thread-3 (]: SQL status: SELECT 198882 in 1.950 seconds
[0m06:34:48.274128 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:48.274128 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m06:34:48.275144 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:34:48.276148 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m06:34:48.277152 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:48.277152 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m06:34:48.290499 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m06:34:48.353773 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m06:34:48.355779 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:34:48.356782 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m06:34:48.358013 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m06:34:48.359015 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m06:34:48.359015 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bbe3cea-4101-497f-a4f8-f894f0c059c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D8597C1D0>]}
[0m06:34:48.360017 [info ] [Thread-3 (]: 8 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 2.21s]
[0m06:34:48.360017 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m06:34:48.362018 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.362018 [debug] [MainThread]: On master: BEGIN
[0m06:34:48.362522 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:34:48.400166 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m06:34:48.400166 [debug] [MainThread]: On master: COMMIT
[0m06:34:48.401283 [debug] [MainThread]: Using postgres connection "master"
[0m06:34:48.401283 [debug] [MainThread]: On master: COMMIT
[0m06:34:48.401785 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:34:48.401785 [debug] [MainThread]: On master: Close
[0m06:34:48.401785 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:34:48.402791 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:34:48.402791 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:34:48.403294 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:34:48.403294 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:34:48.403638 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:34:48.403638 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:34:48.404295 [info ] [MainThread]: 
[0m06:34:48.404295 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m06:34:48.405296 [debug] [MainThread]: Command end result
[0m06:34:48.428475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:34:48.430487 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:34:48.436258 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:34:48.437258 [info ] [MainThread]: 
[0m06:34:48.437258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:34:48.437258 [info ] [MainThread]: 
[0m06:34:48.438470 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:34:48.439473 [debug] [MainThread]: Command `dbt run` succeeded at 06:34:48.439473 after 4.16 seconds
[0m06:34:48.439473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D82E289E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D836994C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D830501A0>]}
[0m06:34:48.440487 [debug] [MainThread]: Flushing usage events
[0m06:34:50.329859 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:42:45.250887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E91F4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E9268E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E926A420>]}


============================== 06:42:45.256706 | 8c385ac3-c5b2-4872-9283-c46d611402c9 ==============================
[0m06:42:45.256706 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:42:45.256706 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'invocation_command': 'dbt run', 'no_print': 'None', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m06:42:45.477902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E9778980>]}
[0m06:42:45.534527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E9062CF0>]}
[0m06:42:45.536947 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:42:45.936960 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:42:46.127611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:42:46.127611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:42:46.164279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EAB13560>]}
[0m06:42:46.234657 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:42:46.256947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:42:46.295055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EAE9D550>]}
[0m06:42:46.296056 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:42:46.296056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E98144D0>]}
[0m06:42:46.297507 [info ] [MainThread]: 
[0m06:42:46.298912 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:42:46.298912 [info ] [MainThread]: 
[0m06:42:46.300052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:42:46.303568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:42:46.495618 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:42:46.495618 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:42:46.496618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:46.563515 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m06:42:46.565551 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:42:46.567022 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:42:46.572130 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:42:46.572633 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:42:46.572633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:42:46.606987 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:42:46.606987 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:42:46.606987 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:42:46.614162 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m06:42:46.615185 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:42:46.616240 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:42:46.621753 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:46.622757 [debug] [MainThread]: On master: BEGIN
[0m06:42:46.622757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:42:46.656444 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:42:46.657447 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:46.657447 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:42:46.665210 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m06:42:46.668220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E9868CB0>]}
[0m06:42:46.668220 [debug] [MainThread]: On master: ROLLBACK
[0m06:42:46.668220 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:46.669224 [debug] [MainThread]: On master: BEGIN
[0m06:42:46.669224 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:42:46.669224 [debug] [MainThread]: On master: COMMIT
[0m06:42:46.670240 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:46.670240 [debug] [MainThread]: On master: COMMIT
[0m06:42:46.670240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:46.670240 [debug] [MainThread]: On master: Close
[0m06:42:46.674788 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:42:46.675790 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:42:46.675790 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:42:46.675790 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:42:46.676793 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:42:46.676793 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:42:46.676793 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:42:46.677794 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:42:46.677794 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:42:46.678833 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:42:46.678833 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:42:46.678833 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:42:46.679983 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:42:46.679983 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:42:46.679983 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:42:46.687713 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:42:46.687713 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:42:46.690725 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:42:46.692956 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:42:46.695052 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:42:46.696061 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:42:46.727594 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:42:46.728597 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:42:46.732120 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:42:46.732632 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:42:46.732632 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:42:46.737655 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:42:46.737655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.740669 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:42:46.740669 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:42:46.741669 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.741669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:42:46.742678 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:42:46.743398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:42:46.743398 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.743398 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:42:46.744696 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.744696 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:42:46.744696 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:42:46.745713 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:42:46.786266 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m06:42:46.786266 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.786266 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:42:46.788369 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m06:42:46.789372 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.789372 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:42:46.795392 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m06:42:46.795392 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.796500 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:42:46.796500 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:42:46.796500 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:42:46.803314 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.805342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.806345 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:42:46.806345 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:42:46.808349 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:46.808349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:42:46.810354 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.810354 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:42:46.813365 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.813365 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:42:46.816372 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.816372 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:42:46.817374 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:42:46.817374 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:46.831651 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:42:46.831651 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m06:42:46.831651 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m06:42:46.832655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.833348 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:42:46.836427 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.836427 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:42:46.837429 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.837429 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:42:46.837429 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:42:46.838431 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:46.839434 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:42:46.839434 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m06:42:46.840437 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m06:42:46.840437 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.846131 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:42:46.848136 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:42:46.848136 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:42:46.853340 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:42:46.854353 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:42:46.854353 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:42:46.855356 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:42:46.855356 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:46.857360 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:42:46.857360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:42:46.858363 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:42:46.860369 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m06:42:46.860369 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:42:46.860369 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m06:42:46.863382 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:42:46.864386 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:42:46.865400 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:42:46.868505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E8B7EDB0>]}
[0m06:42:46.868505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB5539B0>]}
[0m06:42:46.869507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EAC70230>]}
[0m06:42:46.869507 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:42:46.870515 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:42:46.872019 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:42:46.870515 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:42:46.872532 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:42:46.872532 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:42:46.873223 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:42:46.873223 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m06:42:46.874236 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_sellers
[0m06:42:46.874236 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:42:46.875239 [info ] [Thread-3 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:42:46.875239 [info ] [Thread-2 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:42:46.876242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:42:46.876242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m06:42:46.876242 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m06:42:46.877245 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:42:46.877245 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m06:42:46.877245 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:42:46.880264 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:42:46.882768 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:42:46.885034 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:42:46.889059 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m06:42:46.890123 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:42:46.894382 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:42:46.894382 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_sellers
[0m06:42:46.897422 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:42:46.900587 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:42:46.900587 [debug] [Thread-4 (]: SQL status: BEGIN in 0.156 seconds
[0m06:42:46.900587 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.902092 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:42:46.902613 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:46.903625 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.903625 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.903625 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:42:46.904820 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m06:42:46.904820 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:42:46.904820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:42:46.905824 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:42:46.905824 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:42:46.907833 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:42:46.910908 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.911908 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:42:46.911908 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:46.916004 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.917017 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:42:46.917017 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:46.919372 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:42:46.919372 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.920850 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:42:46.921872 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:46.924285 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:42:46.925314 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:42:46.925314 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:42:46.927323 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:42:46.928326 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:42:46.929395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB551D00>]}
[0m06:42:46.929395 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m06:42:46.930397 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:42:46.946825 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m06:42:46.947828 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.947828 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:42:46.953546 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:42:46.957580 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.958583 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:42:46.958583 [debug] [Thread-2 (]: SQL status: BEGIN in 0.053 seconds
[0m06:42:46.958583 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:46.959587 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.961751 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.962255 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:42:46.962758 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:42:46.962758 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:46.964773 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:42:46.964773 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.964773 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:42:46.965776 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:46.967783 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:42:46.968786 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:42:46.968786 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:42:46.971803 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.971803 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:42:46.971803 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:42:46.973171 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:46.974971 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.976022 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:42:46.976022 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:42:46.977025 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m06:42:46.978027 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB46F9E0>]}
[0m06:42:46.978027 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:42:46.980033 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:42:46.979031 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m06:42:46.980033 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.981100 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m06:42:46.981100 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:42:46.982604 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:46.984629 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:42:46.984629 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:42:46.985632 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:42:46.986634 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:42:46.987637 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: Close
[0m06:42:46.988649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB46E9C0>]}
[0m06:42:46.988649 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m06:42:46.989651 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_sellers
[0m06:42:47.047276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m06:42:47.047276 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:47.047276 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:42:47.051785 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:42:47.055896 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:47.055896 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:42:47.056898 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:47.059915 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:47.059915 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:42:47.060919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:42:47.061918 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:42:47.062421 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:47.062421 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:42:47.063632 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:42:47.065652 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:42:47.066655 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:42:47.066655 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:42:47.067977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:42:47.069051 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:42:47.070054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB51C650>]}
[0m06:42:47.070054 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m06:42:47.071056 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:42:47.071056 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:42:47.072559 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:42:47.072559 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:42:47.072559 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:42:47.075588 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:42:47.077593 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:42:47.094780 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:42:47.095783 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:42:47.096785 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:42:47.096785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:42:47.131925 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m06:42:47.131925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:42:47.131925 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part(max(date(purchased_date)) - min(date(purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part(current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:42:47.138464 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function date_part(integer) does not exist
LINE 34:         date_part(max(date(purchased_date)) - min(date(purch...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:42:47.138464 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:42:47.139464 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:42:47.147370 [debug] [Thread-4 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max(date(purchased_date)) - min(date(purch...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:42:47.148372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c385ac3-c5b2-4872-9283-c46d611402c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EB52A5A0>]}
[0m06:42:47.148372 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.08s]
[0m06:42:47.149373 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:42:47.150423 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max(date(purchased_date)) - min(date(purch...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:42:47.151928 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:47.151928 [debug] [MainThread]: On master: BEGIN
[0m06:42:47.151928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:42:47.186853 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:42:47.187857 [debug] [MainThread]: On master: COMMIT
[0m06:42:47.187857 [debug] [MainThread]: Using postgres connection "master"
[0m06:42:47.187857 [debug] [MainThread]: On master: COMMIT
[0m06:42:47.188860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:42:47.188860 [debug] [MainThread]: On master: Close
[0m06:42:47.188860 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:42:47.189865 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:42:47.189865 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:42:47.189865 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:42:47.189865 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:42:47.190871 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:42:47.190871 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:42:47.190871 [info ] [MainThread]: 
[0m06:42:47.191870 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m06:42:47.193088 [debug] [MainThread]: Command end result
[0m06:42:47.265666 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:42:47.268673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:42:47.273688 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:42:47.274689 [info ] [MainThread]: 
[0m06:42:47.274689 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:42:47.274689 [info ] [MainThread]: 
[0m06:42:47.276004 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max(date(purchased_date)) - min(date(purch...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:42:47.276004 [info ] [MainThread]: 
[0m06:42:47.276004 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:42:47.277006 [debug] [MainThread]: Command `dbt run` failed at 06:42:47.277006 after 2.21 seconds
[0m06:42:47.278008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E9333E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6EAD04500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6E8B40E60>]}
[0m06:42:47.278008 [debug] [MainThread]: Flushing usage events
[0m06:42:49.223924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:45:00.883422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFB0E7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFD3D39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFD3D3AD0>]}


============================== 06:45:00.888610 | 59f18352-657b-497d-9067-1b4ddcbfe3ec ==============================
[0m06:45:00.888610 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:45:00.889808 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:45:01.104608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFDF81FD0>]}
[0m06:45:01.157018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFB740D10>]}
[0m06:45:01.159028 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:45:01.570000 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:45:01.763745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:45:01.764224 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:45:01.800475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFF38B3E0>]}
[0m06:45:01.876403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:45:01.898007 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:45:01.934629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFF7B3AD0>]}
[0m06:45:01.934629 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:45:01.935644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFF38B230>]}
[0m06:45:01.937682 [info ] [MainThread]: 
[0m06:45:01.937682 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:45:01.938684 [info ] [MainThread]: 
[0m06:45:01.938684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:45:01.943153 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:45:02.115404 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:45:02.116406 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:45:02.116406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:02.183872 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m06:45:02.184876 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:45:02.186954 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:45:02.191964 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:45:02.191964 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:45:02.192467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:45:02.333933 [debug] [ThreadPool]: SQL status: BEGIN in 0.142 seconds
[0m06:45:02.333933 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:45:02.333933 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:45:02.341990 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.008 seconds
[0m06:45:02.344076 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:45:02.344076 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:45:02.349922 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.350934 [debug] [MainThread]: On master: BEGIN
[0m06:45:02.350934 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:45:02.383298 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m06:45:02.383298 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.384350 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:45:02.392225 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m06:45:02.394741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFB30F740>]}
[0m06:45:02.394741 [debug] [MainThread]: On master: ROLLBACK
[0m06:45:02.394741 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.395744 [debug] [MainThread]: On master: BEGIN
[0m06:45:02.395744 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:45:02.395744 [debug] [MainThread]: On master: COMMIT
[0m06:45:02.395744 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.396746 [debug] [MainThread]: On master: COMMIT
[0m06:45:02.396746 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:45:02.396746 [debug] [MainThread]: On master: Close
[0m06:45:02.400757 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:45:02.401757 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:45:02.402260 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:45:02.402260 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:45:02.402763 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:45:02.403428 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:45:02.403932 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:45:02.404947 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:45:02.403932 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:45:02.404947 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:45:02.404947 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:45:02.405950 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:45:02.405950 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:45:02.405950 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:45:02.406952 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:45:02.412971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:45:02.412971 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:45:02.414983 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:45:02.416985 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:45:02.419252 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:45:02.420270 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:45:02.449787 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:45:02.449787 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:45:02.453639 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:45:02.453639 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:45:02.453639 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:45:02.458072 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:45:02.458072 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.460278 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:45:02.461783 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:45:02.461783 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.461783 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:45:02.463290 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:45:02.463689 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.463689 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:45:02.464292 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.464292 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:45:02.465291 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:45:02.465291 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:45:02.465291 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:45:02.504904 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m06:45:02.504904 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.505952 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:45:02.507961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m06:45:02.508961 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.508961 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:45:02.513705 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m06:45:02.514967 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.514967 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:45:02.514967 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m06:45:02.515969 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.515969 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:45:02.518063 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m06:45:02.519288 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m06:45:02.524898 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.524898 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:45:02.524898 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:45:02.527901 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.527901 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:45:02.531086 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.533316 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.533819 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:45:02.533819 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:45:02.534823 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:45:02.535750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.535750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.535750 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.536766 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:45:02.538773 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.540784 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.542956 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.544968 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.545968 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:45:02.545968 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:45:02.545968 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:45:02.547021 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:45:02.548028 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.548028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.548028 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.548028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.561856 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:45:02.563162 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:45:02.564437 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:45:02.565441 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:45:02.565441 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.566446 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.566446 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.566446 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.566446 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:45:02.567725 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:45:02.567725 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:45:02.567725 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:45:02.569405 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:45:02.575049 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:45:02.576051 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m06:45:02.576051 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m06:45:02.576051 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m06:45:02.580363 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:45:02.581866 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:45:02.584375 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:45:02.586395 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:45:02.586395 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:45:02.587402 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:45:02.587402 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:45:02.587402 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:45:02.588859 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:45:02.588859 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:45:02.588859 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:45:02.590867 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:45:02.590867 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:45:02.592873 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:45:02.593526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m06:45:02.594030 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m06:45:02.595035 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:45:02.596039 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:45:02.597315 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:45:02.599489 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFEA8650>]}
[0m06:45:02.600507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFE625A0>]}
[0m06:45:02.600507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFD7FB00>]}
[0m06:45:02.600507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFD42E990>]}
[0m06:45:02.600507 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:45:02.602010 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:45:02.602555 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:45:02.602555 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:45:02.602555 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:45:02.603935 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:45:02.603935 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:45:02.604953 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m06:45:02.604953 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:45:02.605957 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m06:45:02.605957 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m06:45:02.605957 [info ] [Thread-3 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:45:02.606960 [info ] [Thread-4 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:45:02.607964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m06:45:02.606960 [info ] [Thread-1 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:45:02.607964 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m06:45:02.607964 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m06:45:02.608966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_sellers)
[0m06:45:02.608966 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m06:45:02.611117 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:45:02.612117 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:45:02.613624 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:45:02.616625 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:45:02.617625 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m06:45:02.620626 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:45:02.620626 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m06:45:02.620626 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m06:45:02.624675 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:45:02.627676 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:45:02.628676 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.628676 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:45:02.629677 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:45:02.629677 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.630678 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m06:45:02.630678 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.630678 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:45:02.630678 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:45:02.631678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:45:02.674456 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m06:45:02.674456 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.674456 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:45:02.676470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:45:02.677520 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.677520 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:45:02.679913 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:45:02.682540 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.684806 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m06:45:02.684806 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:45:02.687188 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.687188 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:45:02.688570 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.688570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.690587 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.692599 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.693606 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:45:02.693606 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:45:02.694675 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.694675 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:45:02.695678 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:45:02.696680 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:45:02.696680 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.696680 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.698074 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:45:02.698074 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:45:02.699266 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:45:02.701772 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:45:02.701772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:45:02.702774 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:45:02.703902 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:45:02.704913 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:45:02.704913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:45:02.705917 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:45:02.706922 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:45:02.707925 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m06:45:02.707925 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:45:02.708931 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m06:45:02.708931 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFF03560>]}
[0m06:45:02.710319 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFD043B0>]}
[0m06:45:02.710319 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m06:45:02.711823 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m06:45:02.710319 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m06:45:02.712824 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m06:45:02.768517 [debug] [Thread-3 (]: SQL status: BEGIN in 0.140 seconds
[0m06:45:02.769659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.769659 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:45:02.776031 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:45:02.779036 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.779036 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:45:02.779036 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.781777 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.781777 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:45:02.782779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:45:02.784488 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:45:02.784488 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.784488 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:45:02.786154 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:45:02.788176 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:45:02.788176 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:45:02.788176 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:45:02.790228 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:45:02.792741 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m06:45:02.793841 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFED7560>]}
[0m06:45:02.794891 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.19s]
[0m06:45:02.794891 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m06:45:02.795891 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_customers
[0m06:45:02.795891 [info ] [Thread-2 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:45:02.797145 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.dim_customers)
[0m06:45:02.797145 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_customers
[0m06:45:02.800147 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:45:02.801147 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_customers
[0m06:45:02.819777 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:45:02.821778 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:45:02.822281 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:45:02.822784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:45:02.857456 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m06:45:02.858773 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:45:02.858773 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part(max((purchased_date)) - min((purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part(current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:45:02.865162 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function date_part(integer) does not exist
LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:45:02.865162 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:45:02.866164 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: Close
[0m06:45:02.878504 [debug] [Thread-2 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:45:02.879507 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59f18352-657b-497d-9067-1b4ddcbfe3ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFE636B0>]}
[0m06:45:02.879507 [error] [Thread-2 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.08s]
[0m06:45:02.880510 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_customers
[0m06:45:02.880510 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:45:02.882533 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.882533 [debug] [MainThread]: On master: BEGIN
[0m06:45:02.883743 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:45:02.918374 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:45:02.919378 [debug] [MainThread]: On master: COMMIT
[0m06:45:02.919378 [debug] [MainThread]: Using postgres connection "master"
[0m06:45:02.919378 [debug] [MainThread]: On master: COMMIT
[0m06:45:02.920380 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:45:02.920380 [debug] [MainThread]: On master: Close
[0m06:45:02.920380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:45:02.920380 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:45:02.920380 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:45:02.921883 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:45:02.921883 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:45:02.921883 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:45:02.921883 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:45:02.922884 [info ] [MainThread]: 
[0m06:45:02.923387 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m06:45:02.925389 [debug] [MainThread]: Command end result
[0m06:45:03.000296 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:45:03.003988 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:45:03.010113 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:45:03.010113 [info ] [MainThread]: 
[0m06:45:03.010113 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:45:03.011221 [info ] [MainThread]: 
[0m06:45:03.011723 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:45:03.011723 [info ] [MainThread]: 
[0m06:45:03.011723 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:45:03.012725 [debug] [MainThread]: Command `dbt run` failed at 06:45:03.012725 after 2.28 seconds
[0m06:45:03.013821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFD8D3170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFF0E720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027BFFF0C140>]}
[0m06:45:03.013821 [debug] [MainThread]: Flushing usage events
[0m06:45:04.989323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:47:48.700437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3912FF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3912F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3912D130>]}


============================== 06:47:48.705454 | 303e173b-518a-4d1f-be8d-ff66cc00d88d ==============================
[0m06:47:48.705454 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:47:48.706456 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m06:47:48.886877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C39DCFFE0>]}
[0m06:47:48.938954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3914A270>]}
[0m06:47:48.939955 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:47:49.320851 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:47:49.507105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:47:49.507105 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:47:49.544003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3B0C7800>]}
[0m06:47:49.613852 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:47:49.632526 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:47:49.660880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3B6EC7D0>]}
[0m06:47:49.662385 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:47:49.662890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3B27E210>]}
[0m06:47:49.664919 [info ] [MainThread]: 
[0m06:47:49.664919 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:47:49.665921 [info ] [MainThread]: 
[0m06:47:49.665921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:47:49.669948 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:47:49.815605 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:47:49.815605 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:47:49.816608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:49.859029 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.042 seconds
[0m06:47:49.860031 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:47:49.862033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:47:49.866562 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:47:49.866562 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:47:49.867564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:49.900298 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:47:49.901800 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:47:49.901800 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:47:49.907355 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m06:47:49.908357 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:47:49.908357 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:47:49.915096 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:49.915096 [debug] [MainThread]: On master: BEGIN
[0m06:47:49.916098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:47:49.950654 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:47:49.951655 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:49.951655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:47:49.957901 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:47:49.960908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3B0C7D10>]}
[0m06:47:49.960908 [debug] [MainThread]: On master: ROLLBACK
[0m06:47:49.960908 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:49.961908 [debug] [MainThread]: On master: BEGIN
[0m06:47:49.961908 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:47:49.962411 [debug] [MainThread]: On master: COMMIT
[0m06:47:49.962411 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:49.962914 [debug] [MainThread]: On master: COMMIT
[0m06:47:49.962914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:47:49.962914 [debug] [MainThread]: On master: Close
[0m06:47:49.966939 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:47:49.966939 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:47:49.968173 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:47:49.968173 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:47:49.968173 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:47:49.969175 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:47:49.969175 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:47:49.970190 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:47:49.970190 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:47:49.970190 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:47:49.971693 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:47:49.971693 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:47:49.971693 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:47:49.972698 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:47:49.972698 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:47:49.978964 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:47:49.978964 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:47:49.980969 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:47:49.982975 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:47:49.985004 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:47:49.986007 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:47:50.015008 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:47:50.015008 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:47:50.019025 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:47:50.019025 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:47:50.020033 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:47:50.023837 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:47:50.023837 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.026853 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:47:50.027855 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:47:50.027855 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.028859 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:47:50.028859 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:47:50.028859 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.030320 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:47:50.030320 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.030320 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:47:50.030320 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:47:50.031823 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:47:50.031823 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:47:50.072935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:47:50.074052 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.074052 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:47:50.075069 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m06:47:50.075069 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.076217 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:47:50.078235 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m06:47:50.078235 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.079320 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:47:50.079320 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:47:50.084564 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.085566 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m06:47:50.085566 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m06:47:50.086569 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:47:50.088588 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.089593 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.089593 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:47:50.089593 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:47:50.090615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:50.090615 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:47:50.093632 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.093632 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:47:50.095637 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.095637 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:47:50.099165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.099165 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:47:50.099165 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:47:50.099165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:47:50.101926 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.102929 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:47:50.102929 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:47:50.103574 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:47:50.103574 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:47:50.116788 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:47:50.119815 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.120818 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:47:50.120818 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.121819 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:47:50.121819 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:50.121819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.121819 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:47:50.124451 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:47:50.124451 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:47:50.124451 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:47:50.125454 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.127461 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.128463 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:47:50.128463 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:47:50.129468 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:47:50.129468 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:47:50.136118 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:47:50.139134 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:47:50.139134 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:47:50.139134 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:47:50.144569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:47:50.144569 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:47:50.146576 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:47:50.148581 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:47:50.148581 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:47:50.148581 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:47:50.149583 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.149583 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:47:50.150599 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:47:50.150599 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:47:50.152103 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:47:50.152614 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:47:50.152614 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:47:50.152614 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:47:50.154631 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:47:50.156674 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:47:50.157676 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:47:50.158679 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:47:50.159681 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:47:50.161683 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:47:50.162191 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BAD00E0>]}
[0m06:47:50.162697 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BAB6BA0>]}
[0m06:47:50.162697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C390FE330>]}
[0m06:47:50.163468 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:47:50.163468 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:47:50.164639 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:47:50.166798 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:47:50.164639 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:47:50.166798 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:47:50.167802 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:47:50.167802 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:47:50.168804 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3B97BDD0>]}
[0m06:47:50.168804 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m06:47:50.168804 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m06:47:50.169805 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m06:47:50.170805 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:47:50.170805 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:47:50.171805 [info ] [Thread-3 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:47:50.172810 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:47:50.172308 [info ] [Thread-1 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:47:50.172810 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m06:47:50.172810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m06:47:50.174131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_sellers)
[0m06:47:50.174131 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m06:47:50.175134 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m06:47:50.175134 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:47:50.177145 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:47:50.179150 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:47:50.182599 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:47:50.183610 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m06:47:50.186994 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:47:50.186994 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m06:47:50.190008 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:47:50.190008 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m06:47:50.193248 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:47:50.194260 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.194260 [debug] [Thread-3 (]: On model.dbt_project.stg_products: BEGIN
[0m06:47:50.195276 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:47:50.195276 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.196279 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.196279 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:47:50.196279 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:47:50.197279 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:47:50.197279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:47:50.236971 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m06:47:50.237976 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.237976 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:47:50.241992 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m06:47:50.241992 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.241992 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:47:50.243454 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:47:50.246549 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.246549 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:47:50.246549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m06:47:50.248861 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:47:50.248861 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:47:50.248861 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.250866 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.254127 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.254127 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:47:50.255130 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:47:50.255130 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:47:50.256133 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:47:50.256133 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:50.257145 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:47:50.259163 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.260166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:47:50.260166 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.260166 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:47:50.262675 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.262675 [debug] [Thread-3 (]: On model.dbt_project.stg_products: COMMIT
[0m06:47:50.263819 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:47:50.263819 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:47:50.264861 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:47:50.265865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:47:50.265865 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:47:50.265865 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.267869 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.269885 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:47:50.270887 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:47:50.270887 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:47:50.271887 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:47:50.271887 [debug] [Thread-3 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:47:50.271887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:47:50.271887 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:47:50.273936 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:47:50.273936 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:47:50.275958 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:47:50.275958 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.276997 [debug] [Thread-3 (]: On model.dbt_project.stg_products: Close
[0m06:47:50.278000 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:47:50.278000 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:47:50.278000 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:47:50.279002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BF0F200>]}
[0m06:47:50.280002 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:47:50.279002 [info ] [Thread-3 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m06:47:50.282002 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:47:50.282505 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m06:47:50.282505 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m06:47:50.283531 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:47:50.284534 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m06:47:50.285548 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:47:50.285548 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BA0EF00>]}
[0m06:47:50.286551 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m06:47:50.286551 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m06:47:50.287550 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:47:50.288560 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m06:47:50.288560 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:47:50.289640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BF247D0>]}
[0m06:47:50.289640 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:47:50.290641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:47:50.290641 [info ] [Thread-1 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m06:47:50.290641 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:47:50.291641 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m06:47:50.294925 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:47:50.295999 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:47:50.314464 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:47:50.315482 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:47:50.315482 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:47:50.316487 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:47:50.350582 [debug] [Thread-4 (]: SQL status: BEGIN in 0.035 seconds
[0m06:47:50.352087 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:47:50.352605 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part(max((purchased_date)) - min((purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part(current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part(current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:47:50.354627 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function date_part(integer) does not exist
LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:47:50.354627 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:47:50.355629 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:47:50.360697 [debug] [Thread-4 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:47:50.361697 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e173b-518a-4d1f-be8d-ff66cc00d88d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BAA0BC0>]}
[0m06:47:50.362200 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.07s]
[0m06:47:50.362705 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:47:50.363433 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:47:50.364938 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:50.364938 [debug] [MainThread]: On master: BEGIN
[0m06:47:50.364938 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:47:50.401757 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m06:47:50.401757 [debug] [MainThread]: On master: COMMIT
[0m06:47:50.401757 [debug] [MainThread]: Using postgres connection "master"
[0m06:47:50.403044 [debug] [MainThread]: On master: COMMIT
[0m06:47:50.403044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:47:50.403716 [debug] [MainThread]: On master: Close
[0m06:47:50.403716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:50.403716 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:47:50.404879 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:47:50.404879 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:47:50.404879 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:47:50.404879 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:47:50.404879 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:47:50.405881 [info ] [MainThread]: 
[0m06:47:50.405881 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m06:47:50.407887 [debug] [MainThread]: Command end result
[0m06:47:50.479411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:47:50.482543 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:47:50.488442 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:47:50.488442 [info ] [MainThread]: 
[0m06:47:50.489445 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:47:50.489445 [info ] [MainThread]: 
[0m06:47:50.490451 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(integer) does not exist
  LINE 34:         date_part(max((purchased_date)) - min((purchased_dat...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:47:50.490451 [info ] [MainThread]: 
[0m06:47:50.490451 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:47:50.491956 [debug] [MainThread]: Command `dbt run` failed at 06:47:50.491956 after 1.93 seconds
[0m06:47:50.491956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C392325A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C396C84A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026C3BB19220>]}
[0m06:47:50.492968 [debug] [MainThread]: Flushing usage events
[0m06:47:52.414922 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:50:29.640731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C316099C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C315951220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C315953920>]}


============================== 06:50:29.644903 | 15b1e643-662e-4955-847c-94c7fc97e486 ==============================
[0m06:50:29.644903 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:50:29.645906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'no_print': 'None', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m06:50:29.826811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C316502690>]}
[0m06:50:29.878929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C316382B70>]}
[0m06:50:29.880934 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:50:30.282500 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:50:30.475614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:50:30.475614 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:50:30.512538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3166478F0>]}
[0m06:50:30.584711 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:50:30.602563 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:50:30.630954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31800CE60>]}
[0m06:50:30.632457 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:50:30.632976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3167264B0>]}
[0m06:50:30.635272 [info ] [MainThread]: 
[0m06:50:30.635272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:50:30.636275 [info ] [MainThread]: 
[0m06:50:30.637277 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:50:30.640285 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:50:30.786250 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:50:30.786250 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:50:30.786250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:30.830767 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m06:50:30.831767 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:50:30.833516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:50:30.838029 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:50:30.839031 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:50:30.839031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:50:30.971700 [debug] [ThreadPool]: SQL status: BEGIN in 0.132 seconds
[0m06:50:30.971700 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:50:30.971700 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:50:30.977435 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m06:50:30.978437 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:50:30.978437 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:50:30.985607 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:30.985607 [debug] [MainThread]: On master: BEGIN
[0m06:50:30.985607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:50:31.019598 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:50:31.019598 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:31.020600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:50:31.027652 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m06:50:31.030659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C317DA0080>]}
[0m06:50:31.030659 [debug] [MainThread]: On master: ROLLBACK
[0m06:50:31.031659 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:31.032162 [debug] [MainThread]: On master: BEGIN
[0m06:50:31.032162 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:50:31.032665 [debug] [MainThread]: On master: COMMIT
[0m06:50:31.032665 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:31.032665 [debug] [MainThread]: On master: COMMIT
[0m06:50:31.032665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:50:31.033675 [debug] [MainThread]: On master: Close
[0m06:50:31.037692 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:50:31.037692 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:50:31.037692 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:50:31.037692 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:50:31.038695 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:50:31.038695 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:50:31.039709 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:50:31.039709 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:50:31.040779 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:50:31.040779 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:50:31.041778 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:50:31.041778 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:50:31.042282 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:50:31.042785 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:50:31.042785 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:50:31.043510 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:50:31.049537 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:50:31.052042 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:50:31.053560 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:50:31.055575 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:50:31.056912 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:50:31.057916 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:50:31.091796 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:50:31.092299 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:50:31.093815 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:50:31.094824 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:50:31.098835 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:50:31.101851 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:50:31.102983 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.103639 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:50:31.103639 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.103639 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:50:31.104726 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:50:31.104726 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.104726 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.105730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:50:31.105730 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:50:31.105730 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:50:31.106733 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:50:31.106733 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:50:31.145573 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m06:50:31.146576 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.146576 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:50:31.150819 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:50:31.150819 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.151818 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:50:31.152323 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:50:31.157553 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.157553 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:50:31.158557 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m06:50:31.158557 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m06:50:31.159560 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.159560 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.159560 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:50:31.160576 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:50:31.160576 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:50:31.163649 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.163649 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:50:31.163649 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:50:31.166665 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.166665 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:50:31.167667 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.178496 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m06:50:31.178496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m06:50:31.180544 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:50:31.180544 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m06:50:31.183566 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.186573 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.186573 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.188577 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.189579 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:50:31.189579 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:50:31.189579 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:50:31.190589 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:50:31.190589 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.191589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:50:31.192092 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:50:31.194250 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.194250 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:50:31.195581 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:50:31.197590 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.198593 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:50:31.203614 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:50:31.204627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.204627 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:50:31.208637 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:50:31.209639 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:50:31.209639 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:50:31.209639 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:50:31.210727 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.211727 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:50:31.212732 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:50:31.212732 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:50:31.213466 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:50:31.213466 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.213466 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.215481 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:50:31.217485 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:50:31.217485 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:50:31.218487 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:50:31.218487 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:50:31.220504 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:50:31.220504 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:50:31.220504 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:50:31.222520 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:50:31.224537 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:50:31.225547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:50:31.225547 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:50:31.226646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:50:31.227648 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:50:31.228651 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3159AE840>]}
[0m06:50:31.228651 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:50:31.228651 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:50:31.229653 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3184135C0>]}
[0m06:50:31.229653 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:50:31.230656 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:50:31.230656 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:50:31.231656 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:50:31.232160 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:50:31.232662 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m06:50:31.233520 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:50:31.234542 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:50:31.235557 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:50:31.236559 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m06:50:31.235557 [info ] [Thread-3 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:50:31.236559 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318312EA0>]}
[0m06:50:31.237562 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318412BD0>]}
[0m06:50:31.237562 [info ] [Thread-1 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:50:31.237562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m06:50:31.239044 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:50:31.239044 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:50:31.240047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_products)
[0m06:50:31.240047 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m06:50:31.240047 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:50:31.241050 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:50:31.241050 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m06:50:31.244576 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:50:31.244576 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_sellers
[0m06:50:31.246581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:50:31.247584 [info ] [Thread-2 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:50:31.248587 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m06:50:31.248587 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:50:31.250675 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:50:31.251678 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m06:50:31.251678 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m06:50:31.255511 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:50:31.257734 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:50:31.258739 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_sellers
[0m06:50:31.261746 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:50:31.261746 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.263111 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:50:31.263111 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.264156 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:50:31.264156 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m06:50:31.265172 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.265172 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:50:31.265172 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:50:31.266178 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:50:31.305686 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m06:50:31.305686 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.305686 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:50:31.309710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m06:50:31.310713 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.310713 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:50:31.310713 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:50:31.315738 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.315738 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:50:31.315738 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:50:31.316741 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m06:50:31.319174 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.321809 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.321809 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:50:31.322885 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:50:31.322885 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:50:31.325693 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.325693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:50:31.326695 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:50:31.328699 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.328699 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:50:31.329701 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.330704 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:50:31.330704 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:50:31.331704 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:50:31.332207 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.332710 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m06:50:31.335847 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.335847 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:50:31.335847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.336850 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:50:31.336850 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m06:50:31.337853 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:50:31.337853 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.339868 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:50:31.339868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m06:50:31.342374 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.342877 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:50:31.344607 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:50:31.344607 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:50:31.344607 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:50:31.345609 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:50:31.345609 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:50:31.346612 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:50:31.347616 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:50:31.347616 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:50:31.347616 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:50:31.348621 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.349623 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m06:50:31.350687 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m06:50:31.350687 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:50:31.351687 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318326B10>]}
[0m06:50:31.352190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318327650>]}
[0m06:50:31.352693 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:50:31.352693 [info ] [Thread-3 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m06:50:31.355729 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:50:31.352693 [info ] [Thread-1 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m06:50:31.355729 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m06:50:31.357182 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:50:31.357182 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m06:50:31.358185 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:50:31.358185 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:50:31.358185 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:50:31.359205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:50:31.359205 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:50:31.360208 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:50:31.363457 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:50:31.364470 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: Close
[0m06:50:31.364470 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C318310DA0>]}
[0m06:50:31.365535 [info ] [Thread-2 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m06:50:31.365535 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_sellers
[0m06:50:31.366540 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:50:31.384246 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:50:31.385257 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:50:31.386260 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:50:31.386260 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:50:31.423284 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m06:50:31.423284 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:50:31.424299 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(date(purchased_date)) as first_order_date,
        max(date(purchased_date)) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part('day', max((purchased_date)) - min((purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part('day',current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:50:31.426304 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:50:31.426304 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:50:31.426304 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:50:31.431877 [debug] [Thread-4 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:50:31.432883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b1e643-662e-4955-847c-94c7fc97e486', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3188050A0>]}
[0m06:50:31.433386 [error] [Thread-4 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.07s]
[0m06:50:31.433386 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:50:31.434388 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:50:31.436392 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:31.436392 [debug] [MainThread]: On master: BEGIN
[0m06:50:31.436392 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:50:31.471319 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:50:31.471835 [debug] [MainThread]: On master: COMMIT
[0m06:50:31.471835 [debug] [MainThread]: Using postgres connection "master"
[0m06:50:31.471835 [debug] [MainThread]: On master: COMMIT
[0m06:50:31.472837 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:50:31.472837 [debug] [MainThread]: On master: Close
[0m06:50:31.473530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:50:31.473530 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:50:31.473530 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:50:31.474543 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:50:31.474543 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:50:31.474543 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:50:31.474543 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:50:31.474543 [info ] [MainThread]: 
[0m06:50:31.475612 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.84 seconds (0.84s).
[0m06:50:31.477626 [debug] [MainThread]: Command end result
[0m06:50:31.554416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:50:31.557423 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:50:31.562948 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:50:31.562948 [info ] [MainThread]: 
[0m06:50:31.564138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:50:31.564138 [info ] [MainThread]: 
[0m06:50:31.564138 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:50:31.565164 [info ] [MainThread]: 
[0m06:50:31.565164 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:50:31.566167 [debug] [MainThread]: Command `dbt run` failed at 06:50:31.566167 after 2.07 seconds
[0m06:50:31.566167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31844EA20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31844C140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31844EE40>]}
[0m06:50:31.567170 [debug] [MainThread]: Flushing usage events
[0m06:50:33.500383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:51:46.250603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C57B5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C8C19AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C8C1A270>]}


============================== 06:51:46.255682 | 0631a375-9e68-426c-a5e7-974397f7807f ==============================
[0m06:51:46.255682 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:51:46.255682 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:51:46.436908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C9074DA0>]}
[0m06:51:46.488532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C8DB2B70>]}
[0m06:51:46.490542 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:51:46.870069 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:51:47.059786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:51:47.059786 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:51:47.096001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CA3F7C80>]}
[0m06:51:47.167599 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:51:47.184589 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:51:47.213267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CA779310>]}
[0m06:51:47.214269 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:51:47.214269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CA630770>]}
[0m06:51:47.216302 [info ] [MainThread]: 
[0m06:51:47.217315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:51:47.217315 [info ] [MainThread]: 
[0m06:51:47.217315 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:51:47.221834 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:51:47.365871 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:51:47.365871 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:51:47.365871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:47.518715 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.152 seconds
[0m06:51:47.519717 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:51:47.521720 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:51:47.526542 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:51:47.526542 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:51:47.526542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:51:47.560649 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m06:51:47.560649 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:51:47.561649 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:51:47.566419 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m06:51:47.567421 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:51:47.568423 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:51:47.573953 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:47.574964 [debug] [MainThread]: On master: BEGIN
[0m06:51:47.574964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:51:47.609309 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m06:51:47.609309 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:47.609309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:51:47.617047 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m06:51:47.620059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C7E72360>]}
[0m06:51:47.620059 [debug] [MainThread]: On master: ROLLBACK
[0m06:51:47.620059 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:47.621061 [debug] [MainThread]: On master: BEGIN
[0m06:51:47.621061 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:51:47.621061 [debug] [MainThread]: On master: COMMIT
[0m06:51:47.621061 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:47.622061 [debug] [MainThread]: On master: COMMIT
[0m06:51:47.622061 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:47.622564 [debug] [MainThread]: On master: Close
[0m06:51:47.625700 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:51:47.626703 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:51:47.626703 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:51:47.626703 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:51:47.627946 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:51:47.627946 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:51:47.627946 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:51:47.628949 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:51:47.628949 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:51:47.629972 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:51:47.629972 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:51:47.629972 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:51:47.630975 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:51:47.630975 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:51:47.631975 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:51:47.637709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:51:47.637709 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:51:47.639713 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:51:47.642906 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:51:47.645021 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:51:47.646024 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:51:47.675707 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:51:47.675707 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:51:47.675707 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:51:47.679720 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:51:47.679720 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:51:47.683750 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:51:47.684752 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.687788 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:51:47.687788 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:51:47.688790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:51:47.689815 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.689815 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:51:47.689815 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:51:47.690863 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.690863 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.691862 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:51:47.691862 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:51:47.691862 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:51:47.691862 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:51:47.732808 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m06:51:47.733582 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.733582 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:51:47.737620 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:51:47.743645 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.744652 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:51:47.744652 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m06:51:47.744652 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m06:51:47.745654 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.745654 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.745654 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.746657 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:51:47.748829 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.748829 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:51:47.749842 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:51:47.750844 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.763642 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:51:47.764948 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m06:51:47.764948 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m06:51:47.764948 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.767966 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.770973 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.770973 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:51:47.771973 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:51:47.771973 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:51:47.772980 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.772980 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:47.775510 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.775510 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m06:51:47.777521 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.778523 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:51:47.783595 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:51:47.783595 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:51:47.788613 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:51:47.788613 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m06:51:47.788613 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:51:47.789615 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.790618 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:51:47.792121 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:51:47.792121 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.792624 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.792624 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.794646 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:51:47.794646 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:51:47.795650 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:51:47.796723 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:51:47.799737 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:51:47.799737 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:51:47.800741 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:51:47.803449 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:51:47.804464 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:51:47.804464 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:51:47.805466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C61EB830>]}
[0m06:51:47.805466 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:51:47.806468 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:51:47.806468 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.807477 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:51:47.807477 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.808480 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:51:47.809483 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m06:51:47.810497 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:51:47.810497 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAE934D0>]}
[0m06:51:47.810497 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:51:47.812562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAE854F0>]}
[0m06:51:47.812000 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:51:47.812562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m06:51:47.813580 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:51:47.813580 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:51:47.814709 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m06:51:47.814709 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m06:51:47.815727 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:51:47.817826 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:51:47.818901 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:51:47.818901 [info ] [Thread-4 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:51:47.819904 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:51:47.819904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m06:51:47.820908 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:51:47.820908 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m06:51:47.821907 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:51:47.822410 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m06:51:47.824786 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:51:47.826792 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:51:47.829863 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:51:47.831873 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:51:47.832376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.834993 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:51:47.835996 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m06:51:47.835996 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:51:47.839012 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:51:47.839012 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:51:47.840026 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.840026 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:51:47.840026 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:51:47.841397 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:47.841900 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m06:51:47.841900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:51:47.842909 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m06:51:47.842909 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.843816 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:51:47.850039 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:51:47.854288 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.855316 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:51:47.856424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:47.859696 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.859696 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:51:47.860873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.862377 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:51:47.862880 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.862880 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:51:47.863589 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:51:47.866615 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:51:47.866615 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:51:47.866615 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:51:47.868620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.869648 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:51:47.870652 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAE26480>]}
[0m06:51:47.870652 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.24s]
[0m06:51:47.871652 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:51:47.883672 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m06:51:47.883672 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.883672 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:51:47.885708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m06:51:47.885708 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.885708 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:51:47.889719 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:51:47.893893 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.893893 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:51:47.894896 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:51:47.896901 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.897910 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:51:47.897910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:47.900954 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.900954 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m06:51:47.901955 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:51:47.903637 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.904651 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:51:47.904651 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:47.905654 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:51:47.906725 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:51:47.906725 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.907728 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:51:47.907728 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:51:47.908730 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.908730 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:51:47.909733 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:51:47.911736 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:51:47.911736 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m06:51:47.911736 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:51:47.913878 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:51:47.914892 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:51:47.914892 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:51:47.915895 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:51:47.916897 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.916897 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:47.917900 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m06:51:47.918903 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:51:47.919906 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAD30B90>]}
[0m06:51:47.919906 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CADD9820>]}
[0m06:51:47.920908 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m06:51:47.921908 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m06:51:47.920908 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m06:51:47.921908 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:51:47.921908 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m06:51:47.923384 [info ] [Thread-1 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:51:47.924140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m06:51:47.924140 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m06:51:47.927168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:51:47.928170 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m06:51:47.946993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:51:47.947996 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:51:47.947996 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:51:47.948998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:51:47.988004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m06:51:47.988004 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:51:47.989007 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part('day', max((purchased_date)) - min((purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part('day',current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:51:47.991023 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:51:47.991023 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:51:47.991023 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m06:51:47.996225 [debug] [Thread-4 (]: SQL status: BEGIN in 0.154 seconds
[0m06:51:47.996225 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:47.997229 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:51:47.998231 [debug] [Thread-1 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:51:47.998231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAD46180>]}
[0m06:51:47.999233 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.07s]
[0m06:51:47.999233 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m06:51:48.000492 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:51:48.003008 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:51:48.006042 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:48.006042 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:51:48.007045 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:48.009050 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:48.009050 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:51:48.010052 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:51:48.011054 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:51:48.011054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:48.012055 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:51:48.013289 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:51:48.015309 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:51:48.015309 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:51:48.015309 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:51:48.017366 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:51:48.018368 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m06:51:48.018368 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0631a375-9e68-426c-a5e7-974397f7807f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAD478C0>]}
[0m06:51:48.019370 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m06:51:48.019370 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m06:51:48.020386 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:48.020386 [debug] [MainThread]: On master: BEGIN
[0m06:51:48.021889 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:51:48.165374 [debug] [MainThread]: SQL status: BEGIN in 0.143 seconds
[0m06:51:48.165374 [debug] [MainThread]: On master: COMMIT
[0m06:51:48.165374 [debug] [MainThread]: Using postgres connection "master"
[0m06:51:48.166377 [debug] [MainThread]: On master: COMMIT
[0m06:51:48.166377 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:51:48.166377 [debug] [MainThread]: On master: Close
[0m06:51:48.166377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:51:48.166377 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:51:48.167712 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:51:48.167712 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:51:48.167712 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:51:48.167712 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:51:48.168712 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:51:48.168712 [info ] [MainThread]: 
[0m06:51:48.168712 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.95 seconds (0.95s).
[0m06:51:48.170832 [debug] [MainThread]: Command end result
[0m06:51:48.239949 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:51:48.244175 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:51:48.249184 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:51:48.249184 [info ] [MainThread]: 
[0m06:51:48.250185 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:51:48.250185 [info ] [MainThread]: 
[0m06:51:48.250185 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:51:48.251689 [info ] [MainThread]: 
[0m06:51:48.251689 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:51:48.253193 [debug] [MainThread]: Command `dbt run` failed at 06:51:48.253193 after 2.11 seconds
[0m06:51:48.253193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C81DC410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185C837FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000185CAE6B350>]}
[0m06:51:48.254373 [debug] [MainThread]: Flushing usage events
[0m06:51:50.203791 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:53:46.864543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24CC224B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F2288C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F50C7A0>]}


============================== 06:53:46.868578 | cd6f3e27-8a17-489c-aaa4-511fcac3035a ==============================
[0m06:53:46.868578 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:53:46.869584 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'no_print': 'None', 'printer_width': '80', 'invocation_command': 'dbt run', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m06:53:47.049628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24FA28920>]}
[0m06:53:47.102062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24FA71EE0>]}
[0m06:53:47.103584 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:53:47.490103 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:53:47.680144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:53:47.681647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:53:47.717265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B250E1AED0>]}
[0m06:53:47.788660 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:53:47.807834 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:53:47.836194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B251273A40>]}
[0m06:53:47.837504 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:53:47.837504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B250EB64B0>]}
[0m06:53:47.839620 [info ] [MainThread]: 
[0m06:53:47.840633 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:53:47.840633 [info ] [MainThread]: 
[0m06:53:47.841634 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:53:47.845394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:53:47.989725 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:53:47.990732 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:53:47.990732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:48.037888 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m06:53:48.038890 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:53:48.040893 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:53:48.045041 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:53:48.046045 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:53:48.046045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:53:48.081720 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m06:53:48.081720 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:53:48.082723 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:53:48.087407 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m06:53:48.089811 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:53:48.089811 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:53:48.096124 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.097130 [debug] [MainThread]: On master: BEGIN
[0m06:53:48.097130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:53:48.132521 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m06:53:48.133559 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.133559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:53:48.140173 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:53:48.142678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B250DE9790>]}
[0m06:53:48.143378 [debug] [MainThread]: On master: ROLLBACK
[0m06:53:48.143378 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.143378 [debug] [MainThread]: On master: BEGIN
[0m06:53:48.144437 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:53:48.144437 [debug] [MainThread]: On master: COMMIT
[0m06:53:48.144437 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.145483 [debug] [MainThread]: On master: COMMIT
[0m06:53:48.145483 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:53:48.145483 [debug] [MainThread]: On master: Close
[0m06:53:48.149291 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:53:48.150303 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:53:48.150303 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:53:48.150303 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:53:48.150303 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:53:48.151805 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:53:48.151805 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:53:48.152807 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:53:48.152807 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:53:48.152807 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:53:48.153896 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:53:48.153896 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:53:48.153896 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:53:48.155018 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:53:48.155018 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:53:48.161630 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:53:48.161630 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:53:48.163525 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:53:48.166793 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:53:48.168835 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:53:48.169850 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:53:48.191633 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:53:48.199748 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:53:48.202758 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:53:48.203485 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:53:48.203485 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:53:48.208511 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:53:48.210527 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:53:48.212031 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.212546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.212546 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:53:48.212546 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:53:48.212546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:53:48.213946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.213946 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:53:48.213946 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.215128 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:53:48.215128 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:53:48.215128 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:53:48.215128 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:53:48.260454 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m06:53:48.261959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.261959 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:53:48.267119 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:53:48.268124 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m06:53:48.274049 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.274049 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.274049 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m06:53:48.274049 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:53:48.275535 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:53:48.275535 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.275535 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:53:48.276541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.278797 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.278797 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:53:48.279806 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.293544 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:53:48.293544 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m06:53:48.293544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m06:53:48.294546 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.296552 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.298967 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.299967 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:53:48.299967 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:53:48.299967 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:53:48.301719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.301719 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:53:48.302720 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.305215 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.307494 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.312521 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:53:48.313186 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:53:48.313186 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:53:48.318728 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:53:48.318728 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:53:48.319746 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.319746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:53:48.320751 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:53:48.321750 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.322841 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:53:48.323860 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.325863 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:53:48.325863 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.325863 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:53:48.325863 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:53:48.328106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B250EB4050>]}
[0m06:53:48.328106 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.329559 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:53:48.332675 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:53:48.329559 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m06:53:48.335688 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:53:48.336688 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:53:48.337798 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:53:48.337798 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:53:48.337798 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:53:48.339164 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m06:53:48.339164 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:53:48.339164 [info ] [Thread-2 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:53:48.340169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m06:53:48.340169 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m06:53:48.340169 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.341673 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.343798 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:53:48.344805 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:53:48.346921 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:53:48.346921 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B251D37290>]}
[0m06:53:48.347924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2519402F0>]}
[0m06:53:48.348929 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:53:48.348929 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m06:53:48.350281 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:53:48.348929 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:53:48.354293 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:53:48.355341 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m06:53:48.355341 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:53:48.356345 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:53:48.356345 [info ] [Thread-4 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:53:48.357480 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:53:48.357480 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m06:53:48.357480 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:53:48.358484 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.358484 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m06:53:48.359487 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:53:48.359487 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:53:48.361989 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:53:48.364492 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:53:48.365492 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m06:53:48.365492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:53:48.366492 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.366492 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:53:48.367493 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:53:48.367493 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m06:53:48.371792 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:53:48.374059 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:53:48.375072 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:53:48.379746 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.380810 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:53:48.381808 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.382312 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.382828 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:53:48.382828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:53:48.383896 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m06:53:48.383896 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:53:48.386913 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.387917 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:53:48.387917 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:53:48.388922 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:53:48.389939 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:53:48.390942 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.390942 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:53:48.392952 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.394965 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:53:48.395964 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:53:48.395964 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:53:48.399025 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:53:48.400316 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:53:48.400316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24FB184D0>]}
[0m06:53:48.400316 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m06:53:48.401819 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:53:48.412531 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m06:53:48.413376 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.413376 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:53:48.421007 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m06:53:48.423819 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.425005 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:53:48.425005 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.429215 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.429215 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:53:48.430218 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.431721 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:53:48.431721 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.431721 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:53:48.432724 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m06:53:48.432724 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.433229 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:53:48.433229 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.435239 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:53:48.436244 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:53:48.436244 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:53:48.437247 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.438349 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m06:53:48.439354 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:53:48.441874 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.441874 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2518F2480>]}
[0m06:53:48.442884 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:53:48.443387 [info ] [Thread-2 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m06:53:48.444164 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m06:53:48.444164 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:53:48.446642 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.447651 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m06:53:48.447651 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:53:48.447651 [info ] [Thread-1 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:53:48.448657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m06:53:48.448657 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:53:48.449660 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m06:53:48.450898 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:53:48.453913 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:53:48.453913 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.455031 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m06:53:48.455031 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m06:53:48.456192 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.473870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:53:48.475882 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:53:48.476887 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:53:48.476887 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:53:48.477893 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:53:48.478897 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:53:48.478897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:53:48.478897 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.480898 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m06:53:48.480898 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B25181E930>]}
[0m06:53:48.481898 [info ] [Thread-4 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m06:53:48.481898 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m06:53:48.522044 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m06:53:48.522547 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:53:48.523227 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
        date_part('day', max((purchased_date)) - min((purchased_date))) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then date_part('day',current_date - co.most_recent_order_date)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and date_part('day',current_date - co.most_recent_order_date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:53:48.524397 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function date_part(unknown, integer) does not exist
LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m06:53:48.525835 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: ROLLBACK
[0m06:53:48.525835 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m06:53:48.529471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.146 seconds
[0m06:53:48.529471 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.530552 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:53:48.532563 [debug] [Thread-1 (]: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:53:48.533650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B25193C860>]}
[0m06:53:48.533650 [error] [Thread-1 (]: 8 of 8 ERROR creating sql table model public.dim_customers ..................... [[31mERROR[0m in 0.08s]
[0m06:53:48.534706 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m06:53:48.534706 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m06:53:48.535803 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_customers' to be skipped because of status 'error'.  Reason: Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql.
[0m06:53:48.537828 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.539837 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:53:48.539837 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.542847 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.542847 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:53:48.543549 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:53:48.544680 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:53:48.544680 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.545774 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:53:48.546983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m06:53:48.548987 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:53:48.548987 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:53:48.549990 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:53:48.550993 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:53:48.552497 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:53:48.552999 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd6f3e27-8a17-489c-aaa4-511fcac3035a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B25181F920>]}
[0m06:53:48.552999 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.20s]
[0m06:53:48.554009 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:53:48.555011 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.555011 [debug] [MainThread]: On master: BEGIN
[0m06:53:48.555011 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:53:48.589429 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m06:53:48.590697 [debug] [MainThread]: On master: COMMIT
[0m06:53:48.590697 [debug] [MainThread]: Using postgres connection "master"
[0m06:53:48.590697 [debug] [MainThread]: On master: COMMIT
[0m06:53:48.591697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:53:48.591697 [debug] [MainThread]: On master: Close
[0m06:53:48.591697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:53:48.592888 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:53:48.592888 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:53:48.592888 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:53:48.593668 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:53:48.593668 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:53:48.593668 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:53:48.594174 [info ] [MainThread]: 
[0m06:53:48.594174 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m06:53:48.596183 [debug] [MainThread]: Command end result
[0m06:53:48.672031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:53:48.674722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:53:48.679739 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:53:48.680739 [info ] [MainThread]: 
[0m06:53:48.680739 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m06:53:48.681739 [info ] [MainThread]: 
[0m06:53:48.682243 [error] [MainThread]:   Database Error in model dim_customers (models\staging\Marts\dim_customers.sql)
  function date_part(unknown, integer) does not exist
  LINE 34:         date_part('day', max((purchased_date)) - min((purcha...
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\dbt_project\models\staging\Marts\dim_customers.sql
[0m06:53:48.682746 [info ] [MainThread]: 
[0m06:53:48.682746 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 TOTAL=8
[0m06:53:48.683945 [debug] [MainThread]: Command `dbt run` failed at 06:53:48.683945 after 1.96 seconds
[0m06:53:48.684965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F424C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24F50C7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B24D1E3170>]}
[0m06:53:48.684965 [debug] [MainThread]: Flushing usage events
[0m06:53:50.565955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:58:02.742529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB780C170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7AF8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7AF9490>]}


============================== 06:58:02.746633 | 9d81ad2d-df94-43d3-859a-5504f318dbd7 ==============================
[0m06:58:02.746633 [info ] [MainThread]: Running with dbt=1.9.10
[0m06:58:02.747636 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m06:58:02.929481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB5244650>]}
[0m06:58:02.981801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB802FF50>]}
[0m06:58:02.983215 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m06:58:03.368675 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m06:58:03.557432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:58:03.558438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:58:03.594769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB812B3E0>]}
[0m06:58:03.664042 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:58:03.682123 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:58:03.710683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB802F7D0>]}
[0m06:58:03.710683 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m06:58:03.711684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB81880E0>]}
[0m06:58:03.714283 [info ] [MainThread]: 
[0m06:58:03.714283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:58:03.714283 [info ] [MainThread]: 
[0m06:58:03.715288 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:58:03.719300 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m06:58:03.866134 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m06:58:03.866134 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m06:58:03.867141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:03.913934 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m06:58:03.914954 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m06:58:03.916962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m06:58:03.921994 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:58:03.921994 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m06:58:03.922498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:58:04.055639 [debug] [ThreadPool]: SQL status: BEGIN in 0.134 seconds
[0m06:58:04.056871 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m06:58:04.056871 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m06:58:04.063326 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m06:58:04.064526 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m06:58:04.064526 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m06:58:04.070623 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:04.070623 [debug] [MainThread]: On master: BEGIN
[0m06:58:04.072126 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:58:04.104551 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m06:58:04.105555 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:04.105555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m06:58:04.112181 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m06:58:04.114694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9A5D070>]}
[0m06:58:04.114694 [debug] [MainThread]: On master: ROLLBACK
[0m06:58:04.114694 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:04.114694 [debug] [MainThread]: On master: BEGIN
[0m06:58:04.116159 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m06:58:04.116159 [debug] [MainThread]: On master: COMMIT
[0m06:58:04.116159 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:04.116159 [debug] [MainThread]: On master: COMMIT
[0m06:58:04.117279 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:58:04.117279 [debug] [MainThread]: On master: Close
[0m06:58:04.121089 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m06:58:04.121089 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m06:58:04.121089 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m06:58:04.122089 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m06:58:04.122592 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m06:58:04.122592 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m06:58:04.123292 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m06:58:04.124358 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m06:58:04.123292 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m06:58:04.124358 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m06:58:04.124358 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m06:58:04.124358 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m06:58:04.125696 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m06:58:04.125696 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m06:58:04.125696 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m06:58:04.132009 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m06:58:04.132511 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m06:58:04.134524 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m06:58:04.136530 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m06:58:04.138535 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m06:58:04.139537 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m06:58:04.168017 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m06:58:04.168017 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m06:58:04.169021 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m06:58:04.172049 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m06:58:04.172552 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m06:58:04.176756 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m06:58:04.179771 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m06:58:04.179771 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.181118 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m06:58:04.181118 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m06:58:04.182124 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.182636 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m06:58:04.182636 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.183563 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:58:04.183563 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m06:58:04.183563 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.183563 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:58:04.184889 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m06:58:04.184889 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:58:04.224249 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m06:58:04.225250 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.225250 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m06:58:04.228152 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m06:58:04.228152 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.229152 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        date(shipping_limit_date) as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m06:58:04.230152 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:58:04.236395 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.237398 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m06:58:04.237398 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m06:58:04.237398 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m06:58:04.240854 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.240854 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m06:58:04.240854 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.241854 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m06:58:04.241854 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.241854 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.242943 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m06:58:04.242943 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m06:58:04.243670 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.245682 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.248353 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.248353 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m06:58:04.248353 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m06:58:04.249357 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.249357 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.262904 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:58:04.262904 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m06:58:04.263909 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m06:58:04.264924 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:58:04.264924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.267360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.269755 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.270757 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.270757 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m06:58:04.270757 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m06:58:04.271757 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m06:58:04.271757 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m06:58:04.272866 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.272866 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:58:04.273594 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.275659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.275659 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m06:58:04.281132 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m06:58:04.284658 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.284658 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m06:58:04.286661 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m06:58:04.290749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m06:58:04.291750 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m06:58:04.291750 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m06:58:04.291750 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.293051 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m06:58:04.293051 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m06:58:04.293805 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.293805 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:58:04.296095 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:58:04.296095 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.297101 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:58:04.297101 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:58:04.297101 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.298140 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m06:58:04.299448 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m06:58:04.300451 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m06:58:04.300451 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m06:58:04.302956 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m06:58:04.305507 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m06:58:04.305507 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m06:58:04.306507 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m06:58:04.307840 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m06:58:04.308844 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m06:58:04.308844 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m06:58:04.309914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9EAAE70>]}
[0m06:58:04.309914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB740E510>]}
[0m06:58:04.309914 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m06:58:04.309914 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:58:04.311127 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:58:04.311127 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m06:58:04.312128 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m06:58:04.313429 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m06:58:04.313429 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:58:04.314442 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m06:58:04.314442 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m06:58:04.317444 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m06:58:04.318444 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9E63EF0>]}
[0m06:58:04.319445 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m06:58:04.319445 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m06:58:04.320445 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9D690D0>]}
[0m06:58:04.320445 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:58:04.321949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m06:58:04.321949 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m06:58:04.323455 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m06:58:04.324457 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m06:58:04.323455 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m06:58:04.325457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m06:58:04.325457 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m06:58:04.327961 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m06:58:04.328962 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m06:58:04.328962 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m06:58:04.329962 [info ] [Thread-3 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m06:58:04.333853 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m06:58:04.333853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m06:58:04.334994 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m06:58:04.334994 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m06:58:04.338995 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m06:58:04.342999 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m06:58:04.342999 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m06:58:04.348010 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m06:58:04.349011 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.349011 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m06:58:04.349011 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m06:58:04.353818 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m06:58:04.353818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:58:04.356476 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.356476 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m06:58:04.357476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m06:58:04.358476 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.359478 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m06:58:04.359478 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m06:58:04.400792 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m06:58:04.400792 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.401792 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        date(order_purchase_timestamp) as Purchased_date,
        date(order_approved_at) as Confirmation_date,
        date(order_delivered_carrier_date) as order_shipped_date,
        date(order_delivered_customer_date) as order_delivered_date,
        date(order_estimated_delivery_date) as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m06:58:04.404811 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m06:58:04.404811 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.405811 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m06:58:04.406856 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m06:58:04.410485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.411988 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m06:58:04.411988 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m06:58:04.411988 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m06:58:04.414689 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.414689 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.415692 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m06:58:04.415692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.415692 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m06:58:04.417953 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.417953 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:58:04.418956 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m06:58:04.420958 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.421959 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m06:58:04.421959 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.421959 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m06:58:04.423233 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:58:04.423233 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m06:58:04.426516 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.426516 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.428020 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:58:04.428020 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m06:58:04.428020 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m06:58:04.429023 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.429023 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m06:58:04.429023 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:04.429023 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m06:58:04.431905 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.431905 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m06:58:04.434410 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m06:58:04.434410 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m06:58:04.435824 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m06:58:04.436824 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m06:58:04.437897 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m06:58:04.437897 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:04.437897 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m06:58:04.437897 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m06:58:04.439946 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:58:04.439946 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.439946 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m06:58:04.441327 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m06:58:04.441327 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m06:58:04.441830 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:58:04.443630 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m06:58:04.443630 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m06:58:04.444962 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m06:58:04.446144 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m06:58:04.447147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9E61C10>]}
[0m06:58:04.447147 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB9D694F0>]}
[0m06:58:04.447147 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m06:58:04.448220 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m06:58:04.449224 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m06:58:04.448220 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m06:58:04.450303 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m06:58:04.450303 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m06:58:04.450303 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m06:58:04.452818 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m06:58:04.450303 [info ] [Thread-4 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m06:58:04.452818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m06:58:04.452818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA259640>]}
[0m06:58:04.452818 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m06:58:04.457959 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m06:58:04.454231 [info ] [Thread-3 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m06:58:04.457959 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m06:58:04.458961 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m06:58:04.477117 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m06:58:04.478120 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:04.479122 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m06:58:04.479122 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m06:58:04.515357 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m06:58:04.516551 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:04.516551 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m06:58:07.025348 [debug] [Thread-4 (]: SQL status: SELECT 198882 in 2.508 seconds
[0m06:58:07.032374 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:07.032877 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m06:58:07.032877 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m06:58:07.098960 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:07.099974 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m06:58:07.100977 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m06:58:07.101977 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: COMMIT
[0m06:58:07.103073 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:07.103073 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: COMMIT
[0m06:58:07.112710 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m06:58:07.115746 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m06:58:07.118757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m06:58:07.118757 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m06:58:07.134080 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m06:58:07.136085 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m06:58:07.136085 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d81ad2d-df94-43d3-859a-5504f318dbd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EBA2BE840>]}
[0m06:58:07.137171 [info ] [Thread-4 (]: 8 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 2.68s]
[0m06:58:07.137171 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m06:58:07.138174 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:07.139213 [debug] [MainThread]: On master: BEGIN
[0m06:58:07.139213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:58:07.282631 [debug] [MainThread]: SQL status: BEGIN in 0.144 seconds
[0m06:58:07.283895 [debug] [MainThread]: On master: COMMIT
[0m06:58:07.283895 [debug] [MainThread]: Using postgres connection "master"
[0m06:58:07.283895 [debug] [MainThread]: On master: COMMIT
[0m06:58:07.284898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m06:58:07.284898 [debug] [MainThread]: On master: Close
[0m06:58:07.284898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:58:07.285900 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m06:58:07.285900 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m06:58:07.285900 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m06:58:07.285900 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m06:58:07.286900 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m06:58:07.286900 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m06:58:07.286900 [info ] [MainThread]: 
[0m06:58:07.287900 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m06:58:07.288900 [debug] [MainThread]: Command end result
[0m06:58:07.311808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m06:58:07.315313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m06:58:07.320314 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m06:58:07.320314 [info ] [MainThread]: 
[0m06:58:07.320314 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:58:07.321819 [info ] [MainThread]: 
[0m06:58:07.321819 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m06:58:07.323324 [debug] [MainThread]: Command `dbt run` succeeded at 06:58:07.323324 after 4.73 seconds
[0m06:58:07.323324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7A82840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7A81010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020EB7A83CE0>]}
[0m06:58:07.324051 [debug] [MainThread]: Flushing usage events
[0m06:58:09.197192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:08:37.107542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1765E540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF172F88C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF14BEBF80>]}


============================== 07:08:37.112048 | 7acc23eb-389d-49e4-8ae5-2a21f14fd291 ==============================
[0m07:08:37.112048 [info ] [MainThread]: Running with dbt=1.9.10
[0m07:08:37.112557 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m07:08:37.293280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF17CDFFE0>]}
[0m07:08:37.343892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF177F9430>]}
[0m07:08:37.345896 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m07:08:37.724126 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m07:08:37.910238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:08:37.910238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:08:37.946985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF170423C0>]}
[0m07:08:38.016887 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m07:08:38.034625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m07:08:38.064059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1939BA10>]}
[0m07:08:38.064059 [info ] [MainThread]: Found 8 models, 19 data tests, 9 sources, 447 macros
[0m07:08:38.064059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1937BB60>]}
[0m07:08:38.066551 [info ] [MainThread]: 
[0m07:08:38.067907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:08:38.067907 [info ] [MainThread]: 
[0m07:08:38.067907 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:08:38.071930 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m07:08:38.215826 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m07:08:38.216827 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m07:08:38.216827 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:38.259732 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m07:08:38.260845 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m07:08:38.263240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m07:08:38.268264 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m07:08:38.269264 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m07:08:38.269264 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:08:38.302658 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m07:08:38.303829 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m07:08:38.303829 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m07:08:38.309344 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m07:08:38.310347 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m07:08:38.311850 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m07:08:38.318428 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:38.318428 [debug] [MainThread]: On master: BEGIN
[0m07:08:38.318428 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:08:38.353705 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m07:08:38.353705 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:38.354752 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m07:08:38.360834 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m07:08:38.363848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19922A20>]}
[0m07:08:38.363848 [debug] [MainThread]: On master: ROLLBACK
[0m07:08:38.363848 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:38.363848 [debug] [MainThread]: On master: BEGIN
[0m07:08:38.364849 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m07:08:38.364849 [debug] [MainThread]: On master: COMMIT
[0m07:08:38.364849 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:38.364849 [debug] [MainThread]: On master: COMMIT
[0m07:08:38.366075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:08:38.366075 [debug] [MainThread]: On master: Close
[0m07:08:38.369839 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m07:08:38.369839 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m07:08:38.370842 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m07:08:38.370842 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m07:08:38.370842 [info ] [Thread-1 (]: 1 of 8 START sql view model public.stg_customers ............................... [RUN]
[0m07:08:38.371841 [info ] [Thread-2 (]: 2 of 8 START sql view model public.stg_items_ordered ........................... [RUN]
[0m07:08:38.371841 [info ] [Thread-3 (]: 3 of 8 START sql view model public.stg_name_translation ........................ [RUN]
[0m07:08:38.373125 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m07:08:38.371841 [info ] [Thread-4 (]: 4 of 8 START sql view model public.stg_order_payment ........................... [RUN]
[0m07:08:38.373125 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m07:08:38.374138 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m07:08:38.374138 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m07:08:38.374138 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m07:08:38.374138 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m07:08:38.375492 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m07:08:38.380540 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m07:08:38.380540 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m07:08:38.383793 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m07:08:38.385798 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m07:08:38.387802 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m07:08:38.388804 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m07:08:38.418270 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m07:08:38.418270 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m07:08:38.422194 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m07:08:38.422703 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m07:08:38.422703 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m07:08:38.426781 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m07:08:38.429795 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m07:08:38.429795 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.430799 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.430799 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m07:08:38.431801 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m07:08:38.431801 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.431801 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m07:08:38.431801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m07:08:38.432971 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.432971 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m07:08:38.432971 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m07:08:38.434153 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m07:08:38.434153 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m07:08:38.477103 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m07:08:38.477103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.478106 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m07:08:38.478106 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m07:08:38.478106 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.479109 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m07:08:38.483315 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:08:38.484470 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:08:38.490577 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.493598 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.493598 [debug] [Thread-4 (]: SQL status: BEGIN in 0.059 seconds
[0m07:08:38.493598 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m07:08:38.494599 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m07:08:38.494599 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.494599 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m07:08:38.495892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.495892 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.497970 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.499973 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.499973 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:08:38.499973 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m07:08:38.501366 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m07:08:38.504005 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.504005 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m07:08:38.504005 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:38.505009 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.516523 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m07:08:38.517856 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m07:08:38.519861 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m07:08:38.521866 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.521866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.522867 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.522867 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m07:08:38.522867 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m07:08:38.522867 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m07:08:38.524327 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:38.525342 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m07:08:38.526345 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m07:08:38.526345 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m07:08:38.526345 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.530566 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m07:08:38.533301 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m07:08:38.533804 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m07:08:38.538820 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m07:08:38.539833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m07:08:38.539833 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m07:08:38.539833 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m07:08:38.539833 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m07:08:38.542763 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m07:08:38.543276 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:08:38.543276 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:08:38.543276 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m07:08:38.545286 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m07:08:38.547295 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m07:08:38.547295 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m07:08:38.549795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF16FF29C0>]}
[0m07:08:38.549795 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19A12E70>]}
[0m07:08:38.550800 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:08:38.550800 [info ] [Thread-1 (]: 1 of 8 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m07:08:38.553047 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m07:08:38.551800 [info ] [Thread-2 (]: 2 of 8 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m07:08:38.553722 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m07:08:38.554069 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m07:08:38.554069 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19A51A90>]}
[0m07:08:38.555070 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m07:08:38.555070 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m07:08:38.556072 [info ] [Thread-4 (]: 4 of 8 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.18s]
[0m07:08:38.556072 [info ] [Thread-1 (]: 5 of 8 START sql view model public.stg_orders .................................. [RUN]
[0m07:08:38.557284 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m07:08:38.556072 [info ] [Thread-2 (]: 6 of 8 START sql view model public.stg_products ................................ [RUN]
[0m07:08:38.557284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m07:08:38.558289 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m07:08:38.558289 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m07:08:38.558289 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m07:08:38.559293 [info ] [Thread-4 (]: 7 of 8 START sql view model public.stg_sellers ................................. [RUN]
[0m07:08:38.559293 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m07:08:38.561799 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m07:08:38.561799 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m07:08:38.565305 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m07:08:38.565305 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m07:08:38.569515 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m07:08:38.569515 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m07:08:38.574565 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m07:08:38.574565 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m07:08:38.577908 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m07:08:38.577908 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m07:08:38.582053 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m07:08:38.582556 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.582556 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m07:08:38.582556 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m07:08:38.583925 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.583925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.583925 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m07:08:38.584956 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m07:08:38.584956 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:08:38.584956 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m07:08:38.596630 [debug] [Thread-3 (]: SQL status: BEGIN in 0.163 seconds
[0m07:08:38.597736 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.597736 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m07:08:38.602928 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:08:38.607152 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.608151 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m07:08:38.608151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.610513 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.612017 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m07:08:38.612526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:38.613319 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m07:08:38.614596 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.614596 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m07:08:38.615740 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m07:08:38.617743 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m07:08:38.617743 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m07:08:38.617743 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m07:08:38.619944 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:08:38.621002 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m07:08:38.621002 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19A12C90>]}
[0m07:08:38.622505 [info ] [Thread-3 (]: 3 of 8 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.25s]
[0m07:08:38.622505 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m07:08:38.626776 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m07:08:38.626776 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.627779 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m07:08:38.629811 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m07:08:38.630810 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.630810 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m07:08:38.631810 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m07:08:38.631810 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.631810 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m07:08:38.633300 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m07:08:38.638212 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.638212 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m07:08:38.638212 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m07:08:38.639216 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m07:08:38.641724 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.644239 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.645265 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m07:08:38.645265 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m07:08:38.645265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.648274 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.648274 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m07:08:38.648274 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m07:08:38.649277 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m07:08:38.650280 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.653294 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.653943 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m07:08:38.653943 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:38.653943 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m07:08:38.655954 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m07:08:38.655954 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:38.655954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.656958 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:38.658087 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m07:08:38.658087 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m07:08:38.659091 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m07:08:38.659091 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.659091 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.660467 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m07:08:38.660467 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m07:08:38.660467 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m07:08:38.662972 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m07:08:38.662972 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m07:08:38.662972 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m07:08:38.664073 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m07:08:38.666156 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m07:08:38.667160 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m07:08:38.668163 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m07:08:38.668163 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m07:08:38.669166 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m07:08:38.669166 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m07:08:38.670170 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m07:08:38.670170 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m07:08:38.671174 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m07:08:38.672175 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:08:38.672678 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m07:08:38.673697 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m07:08:38.673697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1992F7A0>]}
[0m07:08:38.674713 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m07:08:38.675717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1992EED0>]}
[0m07:08:38.675717 [info ] [Thread-1 (]: 5 of 8 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m07:08:38.677081 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19A00350>]}
[0m07:08:38.677081 [info ] [Thread-2 (]: 6 of 8 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m07:08:38.678084 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m07:08:38.678084 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m07:08:38.678084 [info ] [Thread-4 (]: 7 of 8 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m07:08:38.679406 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_customers
[0m07:08:38.679406 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m07:08:38.680410 [info ] [Thread-2 (]: 8 of 8 START sql table model public.dim_customers .............................. [RUN]
[0m07:08:38.680410 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.dim_customers)
[0m07:08:38.680410 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_customers
[0m07:08:38.684180 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m07:08:38.685185 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_customers
[0m07:08:38.704216 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m07:08:38.705219 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:38.705219 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: BEGIN
[0m07:08:38.706221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m07:08:38.740572 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m07:08:38.740572 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:38.742076 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m07:08:41.648945 [debug] [Thread-2 (]: SQL status: SELECT 198882 in 2.907 seconds
[0m07:08:41.656963 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:41.656963 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m07:08:41.656963 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m07:08:41.715460 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:41.716461 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m07:08:41.717676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m07:08:41.718679 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m07:08:41.718679 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:41.718679 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m07:08:41.719680 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m07:08:41.721914 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m07:08:41.723935 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m07:08:41.724937 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m07:08:41.734340 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.010 seconds
[0m07:08:41.736367 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: Close
[0m07:08:41.736367 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7acc23eb-389d-49e4-8ae5-2a21f14fd291', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF19E8A300>]}
[0m07:08:41.737370 [info ] [Thread-2 (]: 8 of 8 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 3.06s]
[0m07:08:41.737370 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_customers
[0m07:08:41.738649 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:41.739653 [debug] [MainThread]: On master: BEGIN
[0m07:08:41.739653 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:08:41.784648 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m07:08:41.784648 [debug] [MainThread]: On master: COMMIT
[0m07:08:41.784648 [debug] [MainThread]: Using postgres connection "master"
[0m07:08:41.785651 [debug] [MainThread]: On master: COMMIT
[0m07:08:41.785651 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m07:08:41.786653 [debug] [MainThread]: On master: Close
[0m07:08:41.786653 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:08:41.787653 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m07:08:41.787653 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m07:08:41.787653 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m07:08:41.787653 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m07:08:41.788654 [debug] [MainThread]: Connection 'model.dbt_project.stg_name_translation' was properly closed.
[0m07:08:41.788654 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m07:08:41.788654 [info ] [MainThread]: 
[0m07:08:41.788654 [info ] [MainThread]: Finished running 1 table model, 7 view models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m07:08:41.791127 [debug] [MainThread]: Command end result
[0m07:08:41.816554 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m07:08:41.820055 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m07:08:41.826924 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m07:08:41.826924 [info ] [MainThread]: 
[0m07:08:41.827925 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:08:41.827925 [info ] [MainThread]: 
[0m07:08:41.827925 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m07:08:41.829925 [debug] [MainThread]: Command `dbt run` succeeded at 07:08:41.828924 after 4.87 seconds
[0m07:08:41.829925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF11944E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF1524BE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AF174A4EF0>]}
[0m07:08:41.829925 [debug] [MainThread]: Flushing usage events
[0m07:08:43.744133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:28.209214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7EFD39E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7F909C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7F719610>]}


============================== 14:39:28.216243 | 6538a560-efa9-4f89-b532-096f67c84f52 ==============================
[0m14:39:28.216243 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:39:28.216243 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m14:39:28.630172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7FB82090>]}
[0m14:39:28.682446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7FC0BCB0>]}
[0m14:39:28.684525 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:39:29.212610 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:39:29.409260 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:29.409260 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:29.445589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01250380>]}
[0m14:39:29.517113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:39:29.543954 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:39:29.595629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE0172D310>]}
[0m14:39:29.597142 [info ] [MainThread]: Found 9 models, 19 data tests, 9 sources, 447 macros
[0m14:39:29.597142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE010764B0>]}
[0m14:39:29.599047 [info ] [MainThread]: 
[0m14:39:29.600050 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:29.600050 [info ] [MainThread]: 
[0m14:39:29.601053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:29.605077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:39:31.142251 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:39:31.142251 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:39:31.142756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:31.248238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.105 seconds
[0m14:39:31.249304 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:39:31.251412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:39:31.256422 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:39:31.256422 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:39:31.256925 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:31.292993 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:39:31.292993 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:39:31.292993 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:39:31.311449 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.017 seconds
[0m14:39:31.312452 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:39:31.312452 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:39:31.319548 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:31.319548 [debug] [MainThread]: On master: BEGIN
[0m14:39:31.319548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:31.359808 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:39:31.359808 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:31.360856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:39:31.375637 [debug] [MainThread]: SQL status: SELECT 9 in 0.015 seconds
[0m14:39:31.378162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE014B83E0>]}
[0m14:39:31.378162 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:31.379165 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:31.379165 [debug] [MainThread]: On master: BEGIN
[0m14:39:31.379165 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:39:31.379165 [debug] [MainThread]: On master: COMMIT
[0m14:39:31.380234 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:31.380234 [debug] [MainThread]: On master: COMMIT
[0m14:39:31.380234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:31.380234 [debug] [MainThread]: On master: Close
[0m14:39:31.385240 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:39:31.386743 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:39:31.387251 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:39:31.387251 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:39:31.388026 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m14:39:31.388026 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:39:31.388026 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:39:31.389253 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:39:31.389253 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:39:31.389253 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:39:31.390257 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:39:31.390257 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:39:31.390257 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:39:31.391404 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:39:31.391404 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:39:31.397773 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:39:31.398818 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:39:31.400818 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:39:31.402819 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:39:31.404819 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:39:31.406321 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:39:31.435058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:39:31.435058 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:39:31.435058 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:39:31.435058 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:39:31.439084 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:39:31.443587 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:39:31.446356 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:39:31.446356 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.447357 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:39:31.447357 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:31.448117 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.448117 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.449500 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:39:31.449500 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:39:31.449500 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.450522 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:39:31.450522 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:39:31.450522 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:39:31.451527 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:39:31.493058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:39:31.494066 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m14:39:31.494066 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.494066 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.495068 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:39:31.495068 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:39:31.497896 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m14:39:31.499005 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.499005 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:39:31.504588 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m14:39:31.504588 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.505592 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:39:31.524971 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.029 seconds
[0m14:39:31.524971 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m14:39:31.524971 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.027 seconds
[0m14:39:31.526474 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.031 seconds
[0m14:39:31.531641 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.534648 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.537154 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.539576 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.539576 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:39:31.540578 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:39:31.540578 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:39:31.540578 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:39:31.542927 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:39:31.542927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:39:31.542927 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:39:31.543941 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:39:31.544946 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.548533 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.550544 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.552569 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.552569 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:39:31.553572 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:39:31.553572 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:39:31.553572 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:39:31.554608 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:31.554608 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.555806 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.556309 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.569525 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:39:31.570527 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:39:31.571632 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:39:31.572639 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:39:31.573646 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.573646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.573646 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.574654 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.574654 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:39:31.574654 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:39:31.574654 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:39:31.575659 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:39:31.578433 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.578433 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.578433 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.579435 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.585439 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:39:31.587810 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:39:31.589833 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:39:31.591835 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:39:31.596370 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:39:31.597371 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:39:31.598054 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:39:31.598054 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:39:31.598054 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:39:31.599066 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:39:31.599066 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:39:31.599066 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:39:31.603775 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:39:31.604805 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:39:31.606309 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.006 seconds
[0m14:39:31.606309 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:39:31.606309 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:39:31.607318 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:39:31.609356 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:39:31.610359 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:39:31.612397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7CE3B800>]}
[0m14:39:31.612397 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01A5FD40>]}
[0m14:39:31.613438 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01A5C380>]}
[0m14:39:31.613438 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7F02E990>]}
[0m14:39:31.613438 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:39:31.614443 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:39:31.614443 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:39:31.616473 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:39:31.615473 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:39:31.616977 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:39:31.617480 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:39:31.617480 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m14:39:31.617480 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:39:31.618824 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m14:39:31.618824 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m14:39:31.618824 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m14:39:31.619828 [info ] [Thread-4 (]: 6 of 9 START sql view model public.stg_products ................................ [RUN]
[0m14:39:31.620831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m14:39:31.619828 [info ] [Thread-3 (]: 7 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m14:39:31.620831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m14:39:31.620831 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m14:39:31.621834 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m14:39:31.621834 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m14:39:31.623840 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:39:31.624843 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:39:31.626346 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:39:31.628562 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:39:31.629565 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m14:39:31.632578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:39:31.632578 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m14:39:31.633674 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m14:39:31.636302 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:39:31.639434 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:39:31.640436 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.640436 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:39:31.640436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:31.641941 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.641941 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m14:39:31.642977 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:39:31.642977 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.643998 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:39:31.643998 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:39:31.686346 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:39:31.687420 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.688211 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:39:31.688714 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m14:39:31.688714 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.688714 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:39:31.690721 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m14:39:31.690721 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.691724 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:39:31.695040 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:39:31.695040 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:39:31.698067 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.700072 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:39:31.702090 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.702090 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:39:31.705099 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.705099 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:39:31.705099 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:39:31.706602 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.707112 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.707112 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.709022 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.711027 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.714034 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.714034 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:39:31.714034 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:39:31.715036 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:39:31.715036 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:31.715036 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.715036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:31.717045 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:39:31.718055 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:39:31.719057 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:39:31.720060 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.720060 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.720060 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.721062 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:39:31.721062 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:39:31.721062 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:39:31.724159 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:39:31.724159 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.724159 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:39:31.726260 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:39:31.728525 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:39:31.730531 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:39:31.730531 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:39:31.731543 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:39:31.731543 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:39:31.732547 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:39:31.732547 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:39:31.732547 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:39:31.734418 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:39:31.734418 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:39:31.734418 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:39:31.735434 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m14:39:31.736936 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m14:39:31.737438 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m14:39:31.738457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01B687A0>]}
[0m14:39:31.738457 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01A5FC80>]}
[0m14:39:31.739511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01A5F590>]}
[0m14:39:31.739511 [info ] [Thread-3 (]: 7 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:39:31.740515 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:39:31.742020 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m14:39:31.740515 [info ] [Thread-4 (]: 6 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:39:31.742020 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m14:39:31.743035 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m14:39:31.743035 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_customers
[0m14:39:31.744255 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_products
[0m14:39:31.744255 [info ] [Thread-2 (]: 8 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m14:39:31.744255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.dim_customers)
[0m14:39:31.744255 [info ] [Thread-1 (]: 9 of 9 START sql table model public.dim_products ............................... [RUN]
[0m14:39:31.745499 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_customers
[0m14:39:31.745499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m14:39:31.749319 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:39:31.749319 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_products
[0m14:39:31.752322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:39:31.753605 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_customers
[0m14:39:31.773042 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:39:31.774045 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_products
[0m14:39:31.826998 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:39:31.827500 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:31.827500 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:39:31.828797 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:39:31.828797 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:39:31.829799 [debug] [Thread-1 (]: On model.dbt_project.dim_products: BEGIN
[0m14:39:31.829799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:31.870555 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m14:39:31.870555 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:31.871557 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:39:31.872567 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m14:39:31.872567 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:39:31.872567 [debug] [Thread-1 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(price) as total_revenue,
        avg(price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_freight,
        pm.avg_freight,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:39:31.878028 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "price" does not exist
LINE 31:         sum(price) as total_revenue,
                     ^

[0m14:39:31.878028 [debug] [Thread-1 (]: On model.dbt_project.dim_products: ROLLBACK
[0m14:39:31.879209 [debug] [Thread-1 (]: On model.dbt_project.dim_products: Close
[0m14:39:31.999051 [debug] [Thread-1 (]: Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column "price" does not exist
  LINE 31:         sum(price) as total_revenue,
                       ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql
[0m14:39:32.000054 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01FDBA40>]}
[0m14:39:32.000054 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model public.dim_products ...................... [[31mERROR[0m in 0.25s]
[0m14:39:32.001057 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_products
[0m14:39:32.002074 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column "price" does not exist
  LINE 31:         sum(price) as total_revenue,
                       ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql.
[0m14:39:34.739353 [debug] [Thread-2 (]: SQL status: SELECT 198882 in 2.867 seconds
[0m14:39:34.744856 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:34.744856 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:39:34.746372 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:39:34.748878 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:34.748878 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:39:34.748878 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:34.750251 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:39:34.751252 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:34.751252 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:39:34.779973 [debug] [Thread-2 (]: SQL status: COMMIT in 0.028 seconds
[0m14:39:34.782263 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:39:34.785271 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:39:34.785271 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:39:34.798629 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.013 seconds
[0m14:39:34.799631 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: Close
[0m14:39:34.800633 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6538a560-efa9-4f89-b532-096f67c84f52', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE01FDB680>]}
[0m14:39:34.801634 [info ] [Thread-2 (]: 8 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 3.06s]
[0m14:39:34.801634 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_customers
[0m14:39:34.802867 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.802867 [debug] [MainThread]: On master: BEGIN
[0m14:39:34.804028 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:34.849612 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m14:39:34.849612 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.850939 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:34.850939 [debug] [MainThread]: On master: COMMIT
[0m14:39:34.850939 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:34.850939 [debug] [MainThread]: On master: Close
[0m14:39:34.852266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:34.852266 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:39:34.852266 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:39:34.852266 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:39:34.853339 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:39:34.853339 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:39:34.853339 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:39:34.854339 [info ] [MainThread]: 
[0m14:39:34.854339 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m14:39:34.856841 [debug] [MainThread]: Command end result
[0m14:39:34.880119 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:39:34.883585 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:39:34.888629 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:39:34.889675 [info ] [MainThread]: 
[0m14:39:34.889675 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:39:34.890714 [info ] [MainThread]: 
[0m14:39:34.890714 [error] [MainThread]:   Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column "price" does not exist
  LINE 31:         sum(price) as total_revenue,
                       ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql
[0m14:39:34.890714 [info ] [MainThread]: 
[0m14:39:34.890714 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:39:34.892124 [debug] [MainThread]: Command `dbt run` failed at 14:39:34.892124 after 6.81 seconds
[0m14:39:34.893127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE799B4E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7F868A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE7EF7F800>]}
[0m14:39:34.893127 [debug] [MainThread]: Flushing usage events
[0m14:39:36.864111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:27.018286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637497230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637495EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663505BF80>]}


============================== 14:40:27.023738 | fefa5b72-9fad-4911-ab0d-0f4896d2fc56 ==============================
[0m14:40:27.023738 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:40:27.024741 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'use_colors': 'True', 'write_json': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m14:40:27.210477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637942480>]}
[0m14:40:27.262114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636E3A0C0>]}
[0m14:40:27.263616 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:40:27.667915 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:40:27.858072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:27.858072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:27.894703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026637495EB0>]}
[0m14:40:27.966486 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:40:27.983057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:40:28.017139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663947D0D0>]}
[0m14:40:28.017139 [info ] [MainThread]: Found 9 models, 19 data tests, 9 sources, 447 macros
[0m14:40:28.017139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266391B3980>]}
[0m14:40:28.020589 [info ] [MainThread]: 
[0m14:40:28.020589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:28.020589 [info ] [MainThread]: 
[0m14:40:28.021870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:28.024878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:40:28.174185 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:40:28.174185 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:40:28.175185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.228091 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m14:40:28.229105 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:40:28.231398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:40:28.236402 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:40:28.236402 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:40:28.236905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:28.271761 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:40:28.273141 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:40:28.273141 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:40:28.279254 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.006 seconds
[0m14:40:28.281453 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:40:28.281453 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:40:28.287462 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.288214 [debug] [MainThread]: On master: BEGIN
[0m14:40:28.288716 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:28.323181 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:40:28.324184 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.324184 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:40:28.332151 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m14:40:28.334422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026638E07D10>]}
[0m14:40:28.335425 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:28.335425 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.335425 [debug] [MainThread]: On master: BEGIN
[0m14:40:28.336425 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:40:28.336425 [debug] [MainThread]: On master: COMMIT
[0m14:40:28.336425 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:28.336425 [debug] [MainThread]: On master: COMMIT
[0m14:40:28.336425 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:40:28.337681 [debug] [MainThread]: On master: Close
[0m14:40:28.340697 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:40:28.341697 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:40:28.341697 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:40:28.341697 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:40:28.341697 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m14:40:28.342966 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:40:28.342966 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:40:28.344005 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:40:28.344005 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:40:28.344005 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:40:28.345009 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:40:28.345009 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:40:28.345009 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:40:28.345009 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:40:28.346511 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:40:28.352745 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:40:28.352745 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:40:28.354755 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:40:28.357261 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:40:28.359455 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:40:28.360459 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:40:28.389916 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:40:28.389916 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:40:28.391418 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:40:28.394499 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:40:28.394499 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:40:28.399023 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:40:28.399023 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.402236 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:40:28.402236 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:40:28.403240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.403240 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:28.404243 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:40:28.404243 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.405243 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.405243 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:40:28.405243 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:40:28.406243 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:40:28.406243 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:40:28.406243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:28.449323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:40:28.450327 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.450327 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:40:28.451330 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m14:40:28.452620 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.452620 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:40:28.454874 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m14:40:28.454874 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.454874 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:40:28.456377 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:40:28.461161 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.462175 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:40:28.462175 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:40:28.462175 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:40:28.465181 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.465181 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m14:40:28.468283 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.468283 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:40:28.469286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.469286 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.469286 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:40:28.471384 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.472387 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:40:28.472387 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:40:28.472387 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:40:28.473389 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.475400 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.477412 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.478134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:40:28.478134 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:40:28.478134 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:40:28.485566 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:40:28.492619 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:40:28.495627 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.495627 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:40:28.495627 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:40:28.496627 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.496627 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:40:28.497887 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:40:28.499392 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:40:28.499392 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:40:28.499392 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.500395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.500395 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.500395 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:40:28.502625 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.503627 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:40:28.503627 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:40:28.504630 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:40:28.509555 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:40:28.510557 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:40:28.514561 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:40:28.514561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:40:28.514561 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m14:40:28.517182 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:40:28.517182 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:40:28.518020 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:40:28.520142 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:40:28.521149 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:40:28.521149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.522168 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:40:28.522168 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:40:28.523171 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:40:28.523171 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:40:28.523171 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:40:28.525178 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:40:28.525178 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:40:28.526178 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:40:28.528276 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:40:28.529279 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:40:28.530656 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:40:28.530656 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:40:28.531658 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:40:28.532667 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:40:28.532667 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026634C2B9B0>]}
[0m14:40:28.533877 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266397C4500>]}
[0m14:40:28.533877 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026636DEE0C0>]}
[0m14:40:28.534882 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:40:28.534882 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:40:28.534882 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:40:28.536385 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:40:28.536385 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:40:28.538162 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:40:28.539175 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:40:28.539175 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m14:40:28.540179 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:40:28.540179 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m14:40:28.540179 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266397C4C80>]}
[0m14:40:28.541183 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_sellers
[0m14:40:28.541183 [info ] [Thread-1 (]: 5 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m14:40:28.542187 [info ] [Thread-4 (]: 6 of 9 START sql view model public.stg_products ................................ [RUN]
[0m14:40:28.542187 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:40:28.543190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m14:40:28.543190 [info ] [Thread-2 (]: 7 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m14:40:28.543190 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_products)
[0m14:40:28.544194 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:40:28.544194 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m14:40:28.545198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m14:40:28.545198 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m14:40:28.547205 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:40:28.548219 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:40:28.550321 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:40:28.553348 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:40:28.554381 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m14:40:28.557391 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:40:28.558142 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m14:40:28.560402 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:40:28.561761 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_sellers
[0m14:40:28.564071 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:40:28.565229 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.565229 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:40:28.566229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:28.566229 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.567264 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m14:40:28.567264 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.567264 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:40:28.567264 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:40:28.568474 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:40:28.608576 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m14:40:28.609651 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.609651 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:40:28.610948 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m14:40:28.610948 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.612092 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:40:28.614288 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:40:28.615391 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.615391 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:40:28.615391 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:40:28.618604 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.619606 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:40:28.620610 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:40:28.622621 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.623627 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:40:28.623627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.625635 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.626636 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:40:28.626636 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:40:28.627139 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:40:28.629173 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.632176 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.632176 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:40:28.632176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.632176 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:40:28.634406 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:40:28.634406 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:40:28.634406 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.635409 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:28.636410 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:40:28.636410 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:40:28.638905 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.638905 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.638905 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:40:28.638905 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:40:28.640265 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:40:28.642313 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:40:28.642313 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:40:28.642313 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:40:28.642313 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:40:28.644844 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:40:28.646348 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:40:28.646348 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:40:28.646348 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.647350 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:40:28.648074 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:40:28.648074 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:40:28.648074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:40:28.649206 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m14:40:28.650206 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:40:28.650206 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:40:28.652318 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:40:28.652318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266398B9BB0>]}
[0m14:40:28.653693 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m14:40:28.653693 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:40:28.654822 [info ] [Thread-1 (]: 5 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:40:28.654822 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:40:28.654822 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266398A0500>]}
[0m14:40:28.656329 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m14:40:28.656329 [info ] [Thread-4 (]: 6 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:40:28.657334 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m14:40:28.657334 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m14:40:28.658577 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:40:28.658577 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_products
[0m14:40:28.660717 [debug] [Thread-2 (]: On model.dbt_project.stg_sellers: Close
[0m14:40:28.658577 [info ] [Thread-3 (]: 8 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m14:40:28.660717 [info ] [Thread-1 (]: 9 of 9 START sql table model public.dim_products ............................... [RUN]
[0m14:40:28.661752 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.dim_customers)
[0m14:40:28.661752 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002663979FEC0>]}
[0m14:40:28.662754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m14:40:28.662754 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m14:40:28.662754 [info ] [Thread-2 (]: 7 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:40:28.664043 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_products
[0m14:40:28.667079 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:40:28.667079 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_sellers
[0m14:40:28.669860 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:40:28.671264 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m14:40:28.691903 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:40:28.691903 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_products
[0m14:40:28.744305 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:40:28.746279 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:28.746279 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:40:28.747287 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:40:28.747287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:40:28.747287 [debug] [Thread-1 (]: On model.dbt_project.dim_products: BEGIN
[0m14:40:28.748660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:28.789911 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m14:40:28.789911 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:28.790914 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:40:28.790914 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m14:40:28.791914 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:40:28.791914 [debug] [Thread-1 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_freight,
        pm.avg_freight,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:40:28.795427 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column pm.total_freight does not exist
LINE 53:         pm.total_freight,
                 ^

[0m14:40:28.796427 [debug] [Thread-1 (]: On model.dbt_project.dim_products: ROLLBACK
[0m14:40:28.796427 [debug] [Thread-1 (]: On model.dbt_project.dim_products: Close
[0m14:40:28.802736 [debug] [Thread-1 (]: Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column pm.total_freight does not exist
  LINE 53:         pm.total_freight,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql
[0m14:40:28.802736 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026639CC7AD0>]}
[0m14:40:28.803814 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model public.dim_products ...................... [[31mERROR[0m in 0.14s]
[0m14:40:28.803814 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_products
[0m14:40:28.805193 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column pm.total_freight does not exist
  LINE 53:         pm.total_freight,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql.
[0m14:40:31.328125 [debug] [Thread-3 (]: SQL status: SELECT 198882 in 2.536 seconds
[0m14:40:31.334127 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:31.334127 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:40:31.335128 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:31.337140 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:31.337961 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:40:31.337961 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:40:31.339149 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:40:31.340149 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:31.340149 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:40:31.351165 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m14:40:31.353165 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:40:31.356166 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:40:31.356670 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:40:31.367191 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m14:40:31.369201 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m14:40:31.369201 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fefa5b72-9fad-4911-ab0d-0f4896d2fc56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026639CC6120>]}
[0m14:40:31.370201 [info ] [Thread-3 (]: 8 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 2.71s]
[0m14:40:31.371202 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m14:40:31.372202 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:31.372202 [debug] [MainThread]: On master: BEGIN
[0m14:40:31.372202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:31.427139 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m14:40:31.428197 [debug] [MainThread]: On master: COMMIT
[0m14:40:31.428197 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:31.428197 [debug] [MainThread]: On master: COMMIT
[0m14:40:31.429200 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:40:31.429200 [debug] [MainThread]: On master: Close
[0m14:40:31.429200 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:31.430385 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:40:31.430385 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:40:31.431388 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:40:31.431388 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:40:31.431388 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:40:31.431388 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:40:31.431388 [info ] [MainThread]: 
[0m14:40:31.432812 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m14:40:31.435007 [debug] [MainThread]: Command end result
[0m14:40:31.467515 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:40:31.470936 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:40:31.478213 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:40:31.478213 [info ] [MainThread]: 
[0m14:40:31.478213 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:40:31.479296 [info ] [MainThread]: 
[0m14:40:31.479296 [error] [MainThread]:   Database Error in model dim_products (models\staging\Marts\dim_products.sql)
  column pm.total_freight does not exist
  LINE 53:         pm.total_freight,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_products.sql
[0m14:40:31.480297 [info ] [MainThread]: 
[0m14:40:31.480297 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:40:31.482296 [debug] [MainThread]: Command `dbt run` failed at 14:40:31.482296 after 4.57 seconds
[0m14:40:31.482296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026635084350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266350845F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000266391F3980>]}
[0m14:40:31.483297 [debug] [MainThread]: Flushing usage events
[0m14:40:33.379200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:03.816496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D844D7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D83EB77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D83EB77D0>]}


============================== 14:41:03.821612 | 8966ecd1-d5ed-45a7-9bfb-27289d91a6fa ==============================
[0m14:41:03.821612 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:41:03.822775 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m14:41:04.012155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D84A97FE0>]}
[0m14:41:04.064728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D844D7FB0>]}
[0m14:41:04.066231 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:41:04.474217 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:41:04.669664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:04.670728 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:04.706357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D84CCAC30>]}
[0m14:41:04.778446 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:41:04.796395 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:41:04.829134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D85F9BF20>]}
[0m14:41:04.830135 [info ] [MainThread]: Found 9 models, 19 data tests, 9 sources, 447 macros
[0m14:41:04.830135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D84B7BE90>]}
[0m14:41:04.832274 [info ] [MainThread]: 
[0m14:41:04.833515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:04.833515 [info ] [MainThread]: 
[0m14:41:04.834519 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:41:04.838033 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:41:04.991124 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:41:04.991124 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:41:04.991124 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:05.036306 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m14:41:05.037308 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:41:05.038612 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:41:05.043626 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:41:05.043626 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:41:05.044626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:05.079256 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:41:05.080259 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:41:05.080259 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:41:05.085283 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m14:41:05.087287 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:41:05.087287 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:41:05.093423 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.094499 [debug] [MainThread]: On master: BEGIN
[0m14:41:05.094499 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:41:05.130183 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:41:05.130183 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.130183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:41:05.137206 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m14:41:05.139723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D84C9C710>]}
[0m14:41:05.139723 [debug] [MainThread]: On master: ROLLBACK
[0m14:41:05.140723 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.140723 [debug] [MainThread]: On master: BEGIN
[0m14:41:05.140723 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:41:05.141950 [debug] [MainThread]: On master: COMMIT
[0m14:41:05.141950 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:05.141950 [debug] [MainThread]: On master: COMMIT
[0m14:41:05.141950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:05.141950 [debug] [MainThread]: On master: Close
[0m14:41:05.146501 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:41:05.146501 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:41:05.147503 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:41:05.148278 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:41:05.147503 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_customers ............................... [RUN]
[0m14:41:05.148278 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_items_ordered ........................... [RUN]
[0m14:41:05.148278 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_name_translation ........................ [RUN]
[0m14:41:05.149596 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_order_payment ........................... [RUN]
[0m14:41:05.149596 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:41:05.150599 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:41:05.150599 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:41:05.150599 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:41:05.151611 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:41:05.151611 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:41:05.151611 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:41:05.151611 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:41:05.158918 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:41:05.160184 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:41:05.162601 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:41:05.164611 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:41:05.167119 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:41:05.167119 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:41:05.199502 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:41:05.200504 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:41:05.201504 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:41:05.201504 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:41:05.206397 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:41:05.209669 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:41:05.209669 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.210672 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.210672 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:41:05.211672 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.211672 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:41:05.211672 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:05.212672 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.212672 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:41:05.212672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:05.213684 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:41:05.213684 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:05.213684 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:05.257277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m14:41:05.257277 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.258119 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:41:05.259540 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m14:41:05.259540 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.259540 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:41:05.262935 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:41:05.268948 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.268948 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:41:05.268948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m14:41:05.268948 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:41:05.272311 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.272311 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.272311 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:41:05.272311 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.273716 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:41:05.274833 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.276335 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:41:05.276335 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:41:05.278585 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.278585 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:41:05.279886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.292101 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:41:05.293103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m14:41:05.293103 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:41:05.293103 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.294478 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:41:05.297376 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.297376 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:41:05.298095 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.298095 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:41:05.298095 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:41:05.299298 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.299298 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:05.300719 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.304728 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:41:05.307735 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.309745 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:41:05.313749 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:41:05.314749 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:41:05.314749 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:41:05.314749 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:41:05.316253 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:41:05.316253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.317255 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:41:05.317995 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:05.317995 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:05.317995 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.320480 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:41:05.320480 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:41:05.321917 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:41:05.324153 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.328236 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:41:05.328236 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:41:05.329237 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D81E2BA70>]}
[0m14:41:05.329237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D83F9E960>]}
[0m14:41:05.329237 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:41:05.330249 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_items_ordered ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:41:05.330249 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_customers .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:41:05.331263 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:41:05.332324 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:41:05.332324 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:05.332324 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m14:41:05.333372 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m14:41:05.333372 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:41:05.334582 [info ] [Thread-2 (]: 5 of 9 START sql view model public.stg_orders .................................. [RUN]
[0m14:41:05.334582 [info ] [Thread-1 (]: 6 of 9 START sql view model public.stg_products ................................ [RUN]
[0m14:41:05.335585 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86A47950>]}
[0m14:41:05.335585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_orders)
[0m14:41:05.336585 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_products)
[0m14:41:05.337089 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m14:41:05.337089 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_name_translation ................... [[32mCREATE VIEW[0m in 0.18s]
[0m14:41:05.337597 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m14:41:05.339925 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:41:05.339925 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:41:05.343147 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:41:05.343147 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m14:41:05.343147 [info ] [Thread-3 (]: 7 of 9 START sql view model public.stg_sellers ................................. [RUN]
[0m14:41:05.344447 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m14:41:05.344447 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m14:41:05.345471 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:41:05.348879 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:41:05.348879 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m14:41:05.350881 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:41:05.353882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:41:05.355230 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.355230 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:41:05.356231 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:05.356735 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.356735 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m14:41:05.357238 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m14:41:05.360314 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:41:05.360314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:05.362451 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.362451 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:41:05.362451 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:41:05.376301 [debug] [Thread-4 (]: SQL status: BEGIN in 0.163 seconds
[0m14:41:05.377707 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.377707 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:41:05.383868 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:41:05.386371 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.387373 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:41:05.387876 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:05.390060 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.390060 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:41:05.391084 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.392184 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:41:05.393187 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.393187 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:41:05.394253 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.396258 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:41:05.396764 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:41:05.396764 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:41:05.398288 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:05.399292 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:41:05.399292 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m14:41:05.399292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.400297 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D868E8D40>]}
[0m14:41:05.400297 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:41:05.401300 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_order_payment ...................... [[32mCREATE VIEW[0m in 0.25s]
[0m14:41:05.402365 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:41:05.407997 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:41:05.407997 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m14:41:05.411305 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.411305 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.411305 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:41:05.412308 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:41:05.413312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.416428 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.416428 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:41:05.416428 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:41:05.419487 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.420490 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:41:05.420490 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:05.420490 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.421742 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:41:05.424940 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.424940 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.424940 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:41:05.424940 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:41:05.426443 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.427953 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:41:05.427953 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:41:05.427953 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.429771 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:41:05.430773 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:41:05.430773 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:41:05.430773 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:41:05.432033 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.434039 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:41:05.434039 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:41:05.434039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:41:05.435042 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m14:41:05.435042 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:41:05.436545 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D868FC560>]}
[0m14:41:05.437607 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:05.437607 [info ] [Thread-2 (]: 5 of 9 OK created sql view model public.stg_orders ............................. [[32mCREATE VIEW[0m in 0.10s]
[0m14:41:05.438623 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m14:41:05.439629 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m14:41:05.439629 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D868E8EC0>]}
[0m14:41:05.440632 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_customers
[0m14:41:05.440632 [info ] [Thread-3 (]: 7 of 9 OK created sql view model public.stg_sellers ............................ [[32mCREATE VIEW[0m in 0.10s]
[0m14:41:05.441632 [info ] [Thread-4 (]: 8 of 9 START sql table model public.dim_customers .............................. [RUN]
[0m14:41:05.441632 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m14:41:05.442632 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m14:41:05.442632 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_customers
[0m14:41:05.445104 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:41:05.447117 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_customers
[0m14:41:05.465358 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:41:05.466358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:05.466358 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:41:05.467569 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:05.507918 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m14:41:05.508967 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:05.508967 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:41:05.512466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.152 seconds
[0m14:41:05.512466 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.513544 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:41:05.518745 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:41:05.521857 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.521857 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:41:05.522857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.524858 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.524858 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:41:05.526361 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:05.527866 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m14:41:05.527866 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.528583 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m14:41:05.529600 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:41:05.532601 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:41:05.533601 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:41:05.533601 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:41:05.535638 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:41:05.536641 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m14:41:05.537150 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D868FFEC0>]}
[0m14:41:05.537661 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.stg_products ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:41:05.538706 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m14:41:05.539719 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_products
[0m14:41:05.539719 [info ] [Thread-2 (]: 9 of 9 START sql table model public.dim_products ............................... [RUN]
[0m14:41:05.539719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m14:41:05.540722 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_products
[0m14:41:05.543745 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:41:05.544750 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_products
[0m14:41:05.550775 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:41:05.551779 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:41:05.552784 [debug] [Thread-2 (]: On model.dbt_project.dim_products: BEGIN
[0m14:41:05.552784 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:41:05.592203 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m14:41:05.592203 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:41:05.592203 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:41:07.313290 [debug] [Thread-2 (]: SQL status: SELECT 32951 in 1.720 seconds
[0m14:41:07.371588 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:41:07.371588 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:41:07.372763 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:07.373763 [debug] [Thread-2 (]: On model.dbt_project.dim_products: COMMIT
[0m14:41:07.373763 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:41:07.374858 [debug] [Thread-2 (]: On model.dbt_project.dim_products: COMMIT
[0m14:41:07.387347 [debug] [Thread-2 (]: SQL status: COMMIT in 0.012 seconds
[0m14:41:07.389710 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m14:41:07.391713 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:41:07.391713 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m14:41:07.392713 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:41:07.393968 [debug] [Thread-2 (]: On model.dbt_project.dim_products: Close
[0m14:41:07.394968 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86E2DA90>]}
[0m14:41:07.394968 [info ] [Thread-2 (]: 9 of 9 OK created sql table model public.dim_products .......................... [[32mSELECT 32951[0m in 1.86s]
[0m14:41:07.394968 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_products
[0m14:41:08.856622 [debug] [Thread-4 (]: SQL status: SELECT 198882 in 3.347 seconds
[0m14:41:08.859460 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:08.859460 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:41:08.860465 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:41:08.863479 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:08.863479 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:41:08.864479 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:41:08.865590 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:41:08.865590 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:08.866594 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:41:09.079298 [debug] [Thread-4 (]: SQL status: COMMIT in 0.213 seconds
[0m14:41:09.081389 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:41:09.082417 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:41:09.082417 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:41:09.090618 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:41:09.091622 [debug] [Thread-4 (]: On model.dbt_project.dim_customers: Close
[0m14:41:09.091622 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8966ecd1-d5ed-45a7-9bfb-27289d91a6fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D84AAADB0>]}
[0m14:41:09.092624 [info ] [Thread-4 (]: 8 of 9 OK created sql table model public.dim_customers ......................... [[32mSELECT 198882[0m in 3.65s]
[0m14:41:09.092624 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_customers
[0m14:41:09.094625 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:09.094625 [debug] [MainThread]: On master: BEGIN
[0m14:41:09.094625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:41:09.134652 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:41:09.134652 [debug] [MainThread]: On master: COMMIT
[0m14:41:09.134652 [debug] [MainThread]: Using postgres connection "master"
[0m14:41:09.134652 [debug] [MainThread]: On master: COMMIT
[0m14:41:09.136154 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:41:09.136154 [debug] [MainThread]: On master: Close
[0m14:41:09.137156 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:09.137660 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:41:09.137660 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:41:09.138059 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:41:09.138059 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:41:09.138059 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:41:09.138662 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:41:09.138662 [info ] [MainThread]: 
[0m14:41:09.138662 [info ] [MainThread]: Finished running 2 table models, 7 view models in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m14:41:09.140883 [debug] [MainThread]: Command end result
[0m14:41:09.166495 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:41:09.170002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:41:09.176226 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:41:09.176226 [info ] [MainThread]: 
[0m14:41:09.176226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:09.177228 [info ] [MainThread]: 
[0m14:41:09.177228 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:41:09.178025 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:09.178025 after 5.46 seconds
[0m14:41:09.178025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D83CB25D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D826BDD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D849D92B0>]}
[0m14:41:09.179506 [debug] [MainThread]: Flushing usage events
[0m14:41:11.129108 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:08.316572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220D17DFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220D17DD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220D1AEF00>]}


============================== 14:44:08.321822 | 1be003a0-7f71-43fc-8eff-48d07bdde30d ==============================
[0m14:44:08.321822 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:44:08.322869 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m14:44:08.529562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220DD5BE60>]}
[0m14:44:08.584917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220DB11700>]}
[0m14:44:08.587422 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:44:09.011047 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:44:09.209118 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:44:09.210118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:44:09.246678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F14A8A0>]}
[0m14:44:09.317414 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:44:09.340056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:44:09.383499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F819400>]}
[0m14:44:09.384521 [info ] [MainThread]: Found 10 models, 19 data tests, 9 sources, 447 macros
[0m14:44:09.385527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F1664B0>]}
[0m14:44:09.388548 [info ] [MainThread]: 
[0m14:44:09.389553 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:09.389553 [info ] [MainThread]: 
[0m14:44:09.389553 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:09.394067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:44:09.572222 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:44:09.572222 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:44:09.573222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:09.717703 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.145 seconds
[0m14:44:09.719050 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:44:09.720053 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:44:09.726306 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:44:09.726306 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:44:09.726809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:09.760393 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:44:09.761627 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:44:09.761627 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:44:09.771456 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.009 seconds
[0m14:44:09.772458 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:44:09.773472 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:44:09.779693 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:09.779693 [debug] [MainThread]: On master: BEGIN
[0m14:44:09.780695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:09.927743 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m14:44:09.927743 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:09.927743 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:44:09.937080 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m14:44:09.939742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220F80ACF0>]}
[0m14:44:09.939742 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:09.939742 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:09.940745 [debug] [MainThread]: On master: BEGIN
[0m14:44:09.940745 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:44:09.940745 [debug] [MainThread]: On master: COMMIT
[0m14:44:09.940745 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:09.941749 [debug] [MainThread]: On master: COMMIT
[0m14:44:09.941749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:09.941749 [debug] [MainThread]: On master: Close
[0m14:44:09.946255 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:44:09.946255 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:44:09.946255 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:44:09.947257 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:44:09.947257 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m14:44:09.948287 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_items_ordered .......................... [RUN]
[0m14:44:09.948287 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_name_translation ....................... [RUN]
[0m14:44:09.949594 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:44:09.948287 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_order_payment .......................... [RUN]
[0m14:44:09.949594 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:44:09.949594 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:44:09.949594 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:44:09.951011 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:44:09.951011 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:44:09.951011 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:44:09.957146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:44:09.957891 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:44:09.959309 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:44:09.961309 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:44:09.963309 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:44:09.964310 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:44:09.993203 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:44:09.993203 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:44:09.997152 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:44:09.997152 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:44:09.998104 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:44:10.002298 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:44:10.002298 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.005302 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:44:10.005302 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.005302 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:44:10.006303 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:44:10.006303 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:10.007506 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.007506 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:44:10.007506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.008524 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:44:10.008524 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:44:10.009536 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:44:10.009536 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:44:10.053741 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m14:44:10.053741 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.053741 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:44:10.055097 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m14:44:10.055097 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.055097 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:44:10.057108 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m14:44:10.058271 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.058271 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:44:10.060533 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m14:44:10.060533 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.060533 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:44:10.061733 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:44:10.061733 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:44:10.067246 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.067749 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:44:10.067749 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:44:10.070524 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.070524 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:44:10.072561 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.076301 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.076301 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:44:10.076301 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:44:10.077311 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:44:10.077311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:10.079325 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.079325 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.079325 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.080592 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:44:10.080592 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:44:10.082600 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.084610 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.087117 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.088132 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:44:10.088132 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:10.088756 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:44:10.088756 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:44:10.102394 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:44:10.102394 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m14:44:10.103396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.103396 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:44:10.104622 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.104622 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.104622 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:44:10.105684 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.106186 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:44:10.107882 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:44:10.107882 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:44:10.108892 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.108892 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.108892 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:44:10.108892 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:10.109980 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:10.109980 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:44:10.115145 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:44:10.116648 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:44:10.118166 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:44:10.122544 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:44:10.122544 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m14:44:10.124880 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:44:10.124880 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:44:10.124880 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:44:10.127891 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:44:10.127891 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:44:10.128678 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:44:10.128678 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:44:10.129690 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:44:10.129690 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:44:10.129690 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:10.131708 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:44:10.132708 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:44:10.132708 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:44:10.132708 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:44:10.133885 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:44:10.136402 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:44:10.137907 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:44:10.137907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FC0E030>]}
[0m14:44:10.139278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FFEC9B0>]}
[0m14:44:10.139278 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FA9A120>]}
[0m14:44:10.139278 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FC97BF0>]}
[0m14:44:10.140304 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:44:10.140304 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:44:10.141425 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m14:44:10.142616 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:44:10.141425 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.19s]
[0m14:44:10.142616 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:44:10.143669 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:44:10.143669 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders
[0m14:44:10.144675 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:44:10.144675 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m14:44:10.144675 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m14:44:10.144675 [info ] [Thread-1 (]: 5 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m14:44:10.146178 [info ] [Thread-2 (]: 6 of 10 START sql view model public.stg_products ............................... [RUN]
[0m14:44:10.146178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m14:44:10.146178 [info ] [Thread-4 (]: 7 of 10 START sql view model public.stg_sellers ................................ [RUN]
[0m14:44:10.147180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m14:44:10.147984 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders
[0m14:44:10.147984 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m14:44:10.147984 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m14:44:10.149997 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:44:10.150996 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:44:10.153127 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:44:10.155322 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:44:10.156320 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders
[0m14:44:10.160610 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:44:10.160610 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m14:44:10.163621 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:44:10.163621 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m14:44:10.167410 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:44:10.167410 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.168328 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:44:10.168328 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:10.168328 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.169697 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.169697 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m14:44:10.170714 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:44:10.170714 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:10.170714 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:10.212545 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m14:44:10.212545 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.213548 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:44:10.214864 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m14:44:10.214864 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.214864 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:44:10.217370 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m14:44:10.217875 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.217875 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as seller_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:44:10.219741 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:44:10.222905 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.222905 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:44:10.223909 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:44:10.224914 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:44:10.226417 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.229667 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.229667 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:44:10.230670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:10.230670 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:44:10.232772 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.233773 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.233773 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:44:10.233773 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:10.236322 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.238598 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.238598 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:44:10.239600 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:44:10.239600 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:44:10.240991 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:44:10.240991 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.242108 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:10.242108 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:10.242108 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:44:10.243114 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:44:10.244118 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:44:10.245121 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.245121 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.245121 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:44:10.245121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:10.246623 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:44:10.248183 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:44:10.248183 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:44:10.249484 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:44:10.249484 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:10.250832 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:44:10.251846 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:44:10.253848 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:44:10.253848 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:44:10.255240 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:44:10.255240 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:44:10.255240 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:10.256240 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:44:10.256240 [debug] [Thread-1 (]: On model.dbt_project.stg_orders: Close
[0m14:44:10.257567 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:10.258205 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m14:44:10.259233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FBD19D0>]}
[0m14:44:10.259233 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:44:10.260479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FBD16D0>]}
[0m14:44:10.259233 [info ] [Thread-1 (]: 5 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:44:10.261481 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m14:44:10.262581 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders
[0m14:44:10.261481 [info ] [Thread-4 (]: 7 of 10 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:44:10.263581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FB11B50>]}
[0m14:44:10.263581 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m14:44:10.263581 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m14:44:10.264739 [info ] [Thread-2 (]: 6 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:44:10.264739 [info ] [Thread-3 (]: 8 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m14:44:10.264739 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_sellers
[0m14:44:10.266242 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m14:44:10.266242 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.dim_customers)
[0m14:44:10.267244 [info ] [Thread-1 (]: 9 of 10 START sql table model public.dim_sellers ............................... [RUN]
[0m14:44:10.267244 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_products
[0m14:44:10.267244 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m14:44:10.267244 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_sellers)
[0m14:44:10.271785 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:44:10.268702 [info ] [Thread-4 (]: 10 of 10 START sql table model public.dim_products ............................. [RUN]
[0m14:44:10.271785 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_sellers
[0m14:44:10.272798 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now model.dbt_project.dim_products)
[0m14:44:10.275012 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m14:44:10.275012 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_products
[0m14:44:10.276524 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m14:44:10.279445 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:44:10.348763 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:44:10.349764 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_sellers
[0m14:44:10.352786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m14:44:10.353862 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_products
[0m14:44:10.353862 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:10.357377 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:44:10.357377 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:44:10.358630 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:44:10.358630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:10.358630 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: BEGIN
[0m14:44:10.359886 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:10.359886 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:10.359886 [debug] [Thread-4 (]: On model.dbt_project.dim_products: BEGIN
[0m14:44:10.360915 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:44:10.406287 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m14:44:10.406287 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:44:10.406287 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.seller_zip_code_prefix as zip_code,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m14:44:10.407550 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m14:44:10.408273 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:10.408776 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:44:10.413531 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.seller_zip_code_prefix does not exist
LINE 39:         s.seller_zip_code_prefix as zip_code,
                 ^

[0m14:44:10.413531 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: ROLLBACK
[0m14:44:10.413531 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: Close
[0m14:44:10.425145 [debug] [Thread-1 (]: Database Error in model dim_sellers (models\staging\Marts\dim_sellers.sql)
  column s.seller_zip_code_prefix does not exist
  LINE 39:         s.seller_zip_code_prefix as zip_code,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_sellers.sql
[0m14:44:10.426648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220DCD22D0>]}
[0m14:44:10.427164 [error] [Thread-1 (]: 9 of 10 ERROR creating sql table model public.dim_sellers ...................... [[31mERROR[0m in 0.16s]
[0m14:44:10.427164 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_sellers
[0m14:44:10.427986 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.dim_sellers' to be skipped because of status 'error'.  Reason: Database Error in model dim_sellers (models\staging\Marts\dim_sellers.sql)
  column s.seller_zip_code_prefix does not exist
  LINE 39:         s.seller_zip_code_prefix as zip_code,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_sellers.sql.
[0m14:44:10.507321 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m14:44:10.508458 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:10.508458 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:44:11.907111 [debug] [Thread-4 (]: SQL status: SELECT 32951 in 1.498 seconds
[0m14:44:11.913120 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:11.913120 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m14:44:11.914121 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:11.916218 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:11.916720 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:44:11.917223 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:11.917947 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m14:44:11.917947 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:11.919232 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m14:44:11.922233 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:44:11.924234 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m14:44:11.927237 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:44:11.927237 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m14:44:11.933246 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:44:11.934246 [debug] [Thread-4 (]: On model.dbt_project.dim_products: Close
[0m14:44:11.935246 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220DC88D40>]}
[0m14:44:11.935246 [info ] [Thread-4 (]: 10 of 10 OK created sql table model public.dim_products ........................ [[32mSELECT 32951[0m in 1.66s]
[0m14:44:11.936247 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_products
[0m14:44:13.632317 [debug] [Thread-3 (]: SQL status: SELECT 198882 in 3.124 seconds
[0m14:44:13.635320 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:13.636320 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:44:13.636825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:13.639350 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:13.639350 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:44:13.640354 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:13.641370 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:44:13.641370 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:13.641370 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:44:13.654363 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m14:44:13.656365 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:44:13.657371 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:44:13.657371 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:44:13.664909 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:44:13.666413 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m14:44:13.666413 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1be003a0-7f71-43fc-8eff-48d07bdde30d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022210057D70>]}
[0m14:44:13.667415 [info ] [Thread-3 (]: 8 of 10 OK created sql table model public.dim_customers ........................ [[32mSELECT 198882[0m in 3.40s]
[0m14:44:13.668222 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m14:44:13.668920 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:13.668920 [debug] [MainThread]: On master: BEGIN
[0m14:44:13.668920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:13.712253 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:44:13.712253 [debug] [MainThread]: On master: COMMIT
[0m14:44:13.713256 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:13.713256 [debug] [MainThread]: On master: COMMIT
[0m14:44:13.713256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:13.714258 [debug] [MainThread]: On master: Close
[0m14:44:13.714258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:13.714258 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:44:13.715258 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:44:13.715258 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m14:44:13.715258 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:44:13.715258 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:44:13.716258 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:44:13.716761 [info ] [MainThread]: 
[0m14:44:13.716761 [info ] [MainThread]: Finished running 3 table models, 7 view models in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m14:44:13.719279 [debug] [MainThread]: Command end result
[0m14:44:13.747107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:44:13.751513 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:44:13.756318 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:44:13.757475 [info ] [MainThread]: 
[0m14:44:13.757475 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:13.758212 [info ] [MainThread]: 
[0m14:44:13.758212 [error] [MainThread]:   Database Error in model dim_sellers (models\staging\Marts\dim_sellers.sql)
  column s.seller_zip_code_prefix does not exist
  LINE 39:         s.seller_zip_code_prefix as zip_code,
                   ^
  compiled code at target\run\dbt_project\models\staging\Marts\dim_sellers.sql
[0m14:44:13.758212 [info ] [MainThread]: 
[0m14:44:13.759443 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m14:44:13.760443 [debug] [MainThread]: Command `dbt run` failed at 14:44:13.760443 after 5.60 seconds
[0m14:44:13.760443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220DAED4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FC54110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002220FC56FC0>]}
[0m14:44:13.761443 [debug] [MainThread]: Flushing usage events
[0m14:44:15.826985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:17.333451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C003A91C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7FF8A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C006F8CB0>]}


============================== 14:45:17.337787 | 0174c40d-1003-4550-ad50-2ae22bd37397 ==============================
[0m14:45:17.337787 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:45:17.338790 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:45:17.527063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0089A480>]}
[0m14:45:17.579333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7FCA82F0>]}
[0m14:45:17.581335 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:45:17.999649 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:45:18.195057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:18.195057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:18.231751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C01D18B60>]}
[0m14:45:18.303046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:45:18.320970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:45:18.359521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C02389820>]}
[0m14:45:18.359521 [info ] [MainThread]: Found 10 models, 19 data tests, 9 sources, 447 macros
[0m14:45:18.360524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C007C8770>]}
[0m14:45:18.363002 [info ] [MainThread]: 
[0m14:45:18.363002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:45:18.363002 [info ] [MainThread]: 
[0m14:45:18.364281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:18.368306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:45:18.519884 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:45:18.519884 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:45:18.520894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:18.574348 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m14:45:18.575368 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:45:18.577430 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:45:18.582467 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:45:18.582467 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:45:18.582467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:18.618643 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m14:45:18.619695 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:45:18.619695 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:45:18.624815 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.006 seconds
[0m14:45:18.627335 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:45:18.627841 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:45:18.633612 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:18.633612 [debug] [MainThread]: On master: BEGIN
[0m14:45:18.634615 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:18.668642 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:45:18.669876 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:18.669876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:45:18.676814 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m14:45:18.678596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C026B0C50>]}
[0m14:45:18.679598 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:18.679598 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:18.679598 [debug] [MainThread]: On master: BEGIN
[0m14:45:18.680614 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:45:18.680614 [debug] [MainThread]: On master: COMMIT
[0m14:45:18.680614 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:18.681628 [debug] [MainThread]: On master: COMMIT
[0m14:45:18.681628 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:18.681628 [debug] [MainThread]: On master: Close
[0m14:45:18.684635 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_customers
[0m14:45:18.686143 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:45:18.686143 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_name_translation
[0m14:45:18.686143 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_order_payment
[0m14:45:18.687145 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_customers .............................. [RUN]
[0m14:45:18.687145 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_items_ordered .......................... [RUN]
[0m14:45:18.688226 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_name_translation ....................... [RUN]
[0m14:45:18.688226 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_order_payment .......................... [RUN]
[0m14:45:18.689229 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:45:18.689229 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:45:18.689229 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:45:18.690236 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_order_payment'
[0m14:45:18.690236 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_customers
[0m14:45:18.690236 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:45:18.691259 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:45:18.691259 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:45:18.697277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:45:18.699137 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:45:18.701142 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:45:18.703151 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:45:18.704153 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_customers
[0m14:45:18.733367 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:45:18.733367 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:45:18.734370 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:45:18.737694 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:45:18.738385 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:45:18.741563 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:45:18.745027 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:45:18.745027 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.745027 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:45:18.746534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:18.747050 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.747050 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.747050 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:45:18.748076 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.748076 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:45:18.748076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:45:18.749244 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:45:18.749244 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:45:18.749244 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:45:18.792586 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m14:45:18.792586 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.792586 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:45:18.794589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:45:18.795610 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.795610 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:45:18.797799 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:45:18.803967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.803967 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:45:18.803967 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:45:18.807381 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.807381 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:45:18.807381 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.808403 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.810656 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.812659 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.812659 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:45:18.812659 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:45:18.814115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.814115 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:18.827262 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:45:18.828044 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:45:18.829200 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.829200 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.829200 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:45:18.830203 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:45:18.831566 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:18.836587 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:45:18.836587 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:45:18.841147 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:45:18.843150 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:45:18.843150 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:45:18.844196 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:45:18.844196 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:45:18.845568 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:18.845568 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:18.848269 [debug] [Thread-3 (]: On model.dbt_project.stg_name_translation: Close
[0m14:45:18.849272 [debug] [Thread-2 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:45:18.851671 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0275CA70>]}
[0m14:45:18.851671 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7FC5E5D0>]}
[0m14:45:18.851671 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.16s]
[0m14:45:18.852760 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:45:18.852760 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:45:18.853959 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_orders
[0m14:45:18.853959 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:45:18.855194 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_products
[0m14:45:18.855194 [info ] [Thread-3 (]: 5 of 10 START sql view model public.stg_orders ................................. [RUN]
[0m14:45:18.856198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m14:45:18.855194 [info ] [Thread-2 (]: 6 of 10 START sql view model public.stg_products ............................... [RUN]
[0m14:45:18.856198 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_orders
[0m14:45:18.857206 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m14:45:18.858713 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:45:18.859729 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_products
[0m14:45:18.861732 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:45:18.862906 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_orders
[0m14:45:18.867414 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:45:18.868173 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_products
[0m14:45:18.871633 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:45:18.871633 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.871633 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:45:18.873041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:18.873041 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.874135 [debug] [Thread-2 (]: On model.dbt_project.stg_products: BEGIN
[0m14:45:18.874135 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:18.904338 [debug] [Thread-1 (]: SQL status: BEGIN in 0.159 seconds
[0m14:45:18.905342 [debug] [Thread-4 (]: SQL status: BEGIN in 0.156 seconds
[0m14:45:18.905342 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.905342 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.906342 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:45:18.906342 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:45:18.910581 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:45:18.912010 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:45:18.914167 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.917185 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.917185 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m14:45:18.918277 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:45:18.918277 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:45:18.918277 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.919280 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m14:45:18.919280 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:45:18.919280 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.920347 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:18.920347 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.922646 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.924668 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.924668 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:45:18.924668 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:45:18.926172 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:45:18.926172 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:45:18.928032 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.929102 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:45:18.929102 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.929102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:18.931155 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:45:18.931155 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:45:18.931155 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:45:18.932215 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:45:18.933216 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.935343 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.937349 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.938366 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.938366 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:45:18.938366 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:45:18.939369 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:45:18.939369 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:45:18.940506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.940506 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:18.940506 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:18.941514 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:45:18.942516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:18.943741 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.946258 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:45:18.946258 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.949485 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:45:18.949485 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:45:18.949485 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:45:18.950980 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:45:18.950980 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:45:18.950980 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:45:18.951999 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:18.951999 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:45:18.953003 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:45:18.954003 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:18.954003 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:18.954003 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.955095 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:45:18.956598 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:45:18.957107 [debug] [Thread-4 (]: On model.dbt_project.stg_order_payment: Close
[0m14:45:18.958125 [debug] [Thread-2 (]: On model.dbt_project.stg_products: COMMIT
[0m14:45:18.958125 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:45:18.959128 [debug] [Thread-1 (]: On model.dbt_project.stg_customers: Close
[0m14:45:18.959128 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C02789610>]}
[0m14:45:18.960463 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:45:18.960463 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:18.961465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C02618CB0>]}
[0m14:45:18.961465 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:45:18.963810 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:45:18.964815 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:45:18.964815 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:45:18.964815 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:45:18.966319 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:45:18.967824 [debug] [Thread-3 (]: On model.dbt_project.stg_orders: Close
[0m14:45:18.967824 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m14:45:18.968565 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_customers
[0m14:45:18.968565 [debug] [Thread-2 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:45:18.968565 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C02789670>]}
[0m14:45:18.968565 [info ] [Thread-4 (]: 7 of 10 START sql view model public.stg_sellers ................................ [RUN]
[0m14:45:18.970951 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.stg_sellers)
[0m14:45:18.969934 [info ] [Thread-3 (]: 5 of 10 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:45:18.970951 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:45:18.970951 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:18.971956 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_orders
[0m14:45:18.973958 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:45:18.974989 [debug] [Thread-2 (]: On model.dbt_project.stg_products: Close
[0m14:45:18.974989 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m14:45:18.976493 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0261B440>]}
[0m14:45:18.976493 [info ] [Thread-1 (]: 8 of 10 START sql table model public.dim_customers ............................. [RUN]
[0m14:45:18.977494 [info ] [Thread-2 (]: 6 of 10 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:45:18.977494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.dim_customers)
[0m14:45:18.978625 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m14:45:18.978625 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_products
[0m14:45:18.979625 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m14:45:18.982893 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:45:18.985076 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:45:18.985076 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_products
[0m14:45:18.987088 [info ] [Thread-3 (]: 9 of 10 START sql table model public.dim_products .............................. [RUN]
[0m14:45:18.987088 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m14:45:18.987088 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_products
[0m14:45:18.991232 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:45:18.991232 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m14:45:18.991232 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.010505 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:45:19.010505 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:45:19.010505 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:45:19.011848 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_products
[0m14:45:19.015372 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:45:19.015876 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:19.016402 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:45:19.016402 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:19.016402 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:19.017922 [debug] [Thread-3 (]: On model.dbt_project.dim_products: BEGIN
[0m14:45:19.017922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:19.057318 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m14:45:19.058091 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:19.058091 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:45:19.060339 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m14:45:19.061423 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:19.061423 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:45:19.157680 [debug] [Thread-4 (]: SQL status: BEGIN in 0.147 seconds
[0m14:45:19.158689 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.158689 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as sellers_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:45:19.162692 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:45:19.166193 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.166193 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:45:19.167195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.169475 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.169475 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:45:19.169475 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:19.171476 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:45:19.171476 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.171476 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:45:19.172476 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:19.175477 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:45:19.176477 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:45:19.176979 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:45:19.177481 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:45:19.234017 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m14:45:19.235017 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7F99D3D0>]}
[0m14:45:19.235017 [info ] [Thread-4 (]: 7 of 10 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.27s]
[0m14:45:19.236521 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m14:45:19.237043 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_sellers
[0m14:45:19.237043 [info ] [Thread-2 (]: 10 of 10 START sql table model public.dim_sellers .............................. [RUN]
[0m14:45:19.238053 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.dim_sellers)
[0m14:45:19.238053 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_sellers
[0m14:45:19.241303 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m14:45:19.242306 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_sellers
[0m14:45:19.245311 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m14:45:19.246815 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:45:19.247318 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: BEGIN
[0m14:45:19.247318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:19.287163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.040 seconds
[0m14:45:19.287943 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:45:19.287943 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.sellers_zip_code ,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m14:45:20.392286 [debug] [Thread-3 (]: SQL status: SELECT 32951 in 1.330 seconds
[0m14:45:20.398095 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:20.399303 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m14:45:20.399303 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.401303 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:20.402388 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:45:20.402388 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:20.404396 [debug] [Thread-3 (]: On model.dbt_project.dim_products: COMMIT
[0m14:45:20.404396 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:20.404396 [debug] [Thread-3 (]: On model.dbt_project.dim_products: COMMIT
[0m14:45:20.407411 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:20.409556 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m14:45:20.411584 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:45:20.412587 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m14:45:20.418463 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:45:20.419468 [debug] [Thread-3 (]: On model.dbt_project.dim_products: Close
[0m14:45:20.420471 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C008D97F0>]}
[0m14:45:20.420471 [info ] [Thread-3 (]: 9 of 10 OK created sql table model public.dim_products ......................... [[32mSELECT 32951[0m in 1.43s]
[0m14:45:20.421471 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_products
[0m14:45:21.887134 [debug] [Thread-2 (]: SQL status: SELECT 3095 in 2.599 seconds
[0m14:45:21.890147 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:45:21.891149 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m14:45:21.891149 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:21.892162 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:45:21.893165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:45:21.893165 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:45:21.900041 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:45:21.902045 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_sellers__dbt_backup"
[0m14:45:21.902045 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:45:21.903048 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
drop table if exists "ecommerce_raw"."public"."dim_sellers__dbt_backup" cascade
[0m14:45:21.903048 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:45:21.904050 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: Close
[0m14:45:21.905052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C0276D340>]}
[0m14:45:21.905052 [info ] [Thread-2 (]: 10 of 10 OK created sql table model public.dim_sellers ......................... [[32mSELECT 3095[0m in 2.67s]
[0m14:45:21.906555 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_sellers
[0m14:45:22.797095 [debug] [Thread-1 (]: SQL status: SELECT 198882 in 3.739 seconds
[0m14:45:22.800110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:22.801113 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:45:22.802116 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:45:22.804122 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:22.804122 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:45:22.805124 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:22.806126 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:45:22.806126 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:22.806126 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:45:22.820368 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m14:45:22.822395 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:45:22.823396 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:45:22.823396 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:45:22.832610 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m14:45:22.833808 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m14:45:22.833808 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0174c40d-1003-4550-ad50-2ae22bd37397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C02B64DA0>]}
[0m14:45:22.834836 [info ] [Thread-1 (]: 8 of 10 OK created sql table model public.dim_customers ........................ [[32mSELECT 198882[0m in 3.86s]
[0m14:45:22.834836 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m14:45:22.836340 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:22.837343 [debug] [MainThread]: On master: BEGIN
[0m14:45:22.837343 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:22.880483 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m14:45:22.881501 [debug] [MainThread]: On master: COMMIT
[0m14:45:22.881501 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:22.881501 [debug] [MainThread]: On master: COMMIT
[0m14:45:22.881501 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:22.882514 [debug] [MainThread]: On master: Close
[0m14:45:22.882514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:22.882514 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:45:22.883520 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:45:22.883520 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:45:22.883520 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m14:45:22.883520 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:45:22.884515 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m14:45:22.884515 [info ] [MainThread]: 
[0m14:45:22.884515 [info ] [MainThread]: Finished running 3 table models, 7 view models in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m14:45:22.887183 [debug] [MainThread]: Command end result
[0m14:45:22.910530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:45:22.913922 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:45:22.920543 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:45:22.920543 [info ] [MainThread]: 
[0m14:45:22.920543 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:22.921711 [info ] [MainThread]: 
[0m14:45:22.921711 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 TOTAL=10
[0m14:45:22.922715 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:22.922715 after 5.70 seconds
[0m14:45:22.923718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C00407B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7FC20140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C7FC22630>]}
[0m14:45:22.923718 [debug] [MainThread]: Flushing usage events
[0m14:45:24.865259 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:41.468681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C10383890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C12D6A660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C12D681D0>]}


============================== 14:50:41.473598 | e8007594-4d59-4e34-91b1-1b891628d90b ==============================
[0m14:50:41.473598 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:50:41.474599 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'write_json': 'True'}
[0m14:50:41.682574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C131D55B0>]}
[0m14:50:41.734428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14564080>]}
[0m14:50:41.736743 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:50:42.145852 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:50:42.341314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:50:42.341314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:50:42.378190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14644D10>]}
[0m14:50:42.447651 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:50:42.470502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:50:42.513731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14CBD640>]}
[0m14:50:42.513731 [info ] [MainThread]: Found 11 models, 19 data tests, 9 sources, 447 macros
[0m14:50:42.514742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C148CD2E0>]}
[0m14:50:42.517312 [info ] [MainThread]: 
[0m14:50:42.518317 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:42.518317 [info ] [MainThread]: 
[0m14:50:42.518317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:50:42.522428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:50:42.701742 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:50:42.702742 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:50:42.702742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:42.750595 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m14:50:42.751598 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:50:42.753603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:50:42.759322 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:50:42.759322 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:50:42.759322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:42.794586 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m14:50:42.795091 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:50:42.795595 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:50:42.805559 [debug] [ThreadPool]: SQL status: SELECT 22 in 0.010 seconds
[0m14:50:42.806573 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:50:42.806573 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:50:42.813009 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.813009 [debug] [MainThread]: On master: BEGIN
[0m14:50:42.814512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:42.848042 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:50:42.849288 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.849288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:50:42.858282 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m14:50:42.860471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14604860>]}
[0m14:50:42.861484 [debug] [MainThread]: On master: ROLLBACK
[0m14:50:42.861484 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.861484 [debug] [MainThread]: On master: BEGIN
[0m14:50:42.862489 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:50:42.862489 [debug] [MainThread]: On master: COMMIT
[0m14:50:42.862489 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:42.862489 [debug] [MainThread]: On master: COMMIT
[0m14:50:42.863571 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:42.863571 [debug] [MainThread]: On master: Close
[0m14:50:42.867585 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_date
[0m14:50:42.867585 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m14:50:42.867585 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:50:42.867585 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m14:50:42.869085 [info ] [Thread-1 (]: 1 of 11 START sql table model public.dim_date .................................. [RUN]
[0m14:50:42.869085 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m14:50:42.870091 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_items_ordered .......................... [RUN]
[0m14:50:42.871093 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.dim_date'
[0m14:50:42.870091 [info ] [Thread-4 (]: 4 of 11 START sql view model public.stg_name_translation ....................... [RUN]
[0m14:50:42.871093 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:50:42.871093 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:50:42.872534 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_date
[0m14:50:42.872534 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:50:42.872534 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m14:50:42.873538 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:50:42.879611 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_date"
[0m14:50:42.879611 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:50:42.882622 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:50:42.884522 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:50:42.886753 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:50:42.887764 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_date
[0m14:50:42.920160 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_date"
[0m14:50:42.921162 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m14:50:42.921162 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:50:42.937574 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:50:42.937574 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:50:42.941331 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:50:42.944449 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:50:42.944449 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_date"
[0m14:50:42.945868 [debug] [Thread-1 (]: On model.dbt_project.dim_date: BEGIN
[0m14:50:42.945868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:50:42.946563 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:42.947645 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:42.947645 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:50:42.947645 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:42.948659 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:50:42.948659 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:42.949664 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:50:42.949664 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:42.949664 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:42.995384 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:50:42.996183 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m14:50:42.996183 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:42.996183 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:42.997224 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:50:42.997224 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:50:42.998486 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m14:50:42.998486 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:42.998486 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:50:43.003697 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:50:43.003697 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:50:43.004698 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:50:43.010241 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:43.012262 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:43.015276 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:43.016008 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:50:43.016008 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:50:43.016008 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:50:43.017022 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:43.017022 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.018027 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.020029 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:43.021351 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:43.024358 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:43.024862 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:50:43.025364 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:50:43.025364 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:50:43.025364 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:43.026634 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.026634 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.039340 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:50:43.041555 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:50:43.042558 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:50:43.042558 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:43.042558 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:43.043852 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:43.044355 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:50:43.044355 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:50:43.044355 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:50:43.046215 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.046215 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:50:43.046215 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.051394 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:50:43.054404 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:50:43.056430 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:50:43.060443 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:50:43.060443 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:50:43.060443 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:50:43.061869 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:50:43.061869 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:50:43.061869 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:50:43.064515 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:43.065517 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:50:43.066771 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:50:43.066771 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:50:43.067883 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m14:50:43.070207 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m14:50:43.071208 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C15075610>]}
[0m14:50:43.072208 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C15084C20>]}
[0m14:50:43.072208 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1267E3F0>]}
[0m14:50:43.073209 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:50:43.073209 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:50:43.074712 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:50:43.073209 [info ] [Thread-4 (]: 4 of 11 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.20s]
[0m14:50:43.075221 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m14:50:43.075221 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_order_payment
[0m14:50:43.075884 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:50:43.075884 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m14:50:43.077181 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m14:50:43.075884 [info ] [Thread-3 (]: 5 of 11 START sql view model public.stg_order_payment .......................... [RUN]
[0m14:50:43.077181 [info ] [Thread-2 (]: 6 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m14:50:43.078198 [info ] [Thread-4 (]: 7 of 11 START sql view model public.stg_products ............................... [RUN]
[0m14:50:43.078198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_order_payment)
[0m14:50:43.079201 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m14:50:43.079201 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m14:50:43.079201 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:50:43.080203 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m14:50:43.080203 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m14:50:43.083411 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:50:43.085527 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:50:43.087570 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:50:43.089659 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:50:43.091943 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:50:43.092944 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m14:50:43.092944 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m14:50:43.096265 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:50:43.099031 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:50:43.100039 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.100039 [debug] [Thread-1 (]: SQL status: BEGIN in 0.154 seconds
[0m14:50:43.101043 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:50:43.101043 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_date"
[0m14:50:43.102061 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:43.102061 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */

  
    

  create  table "ecommerce_raw"."public"."dim_date__dbt_tmp"
  
  
    as
  
  (
    

with date_spine as (
    -- Generate all dates from 2016 to 2020 (covers your data range)
    select
        date_day::date as date_day
    from 
        generate_series(
            '2016-01-01'::date,
            '2020-12-31'::date,
            '1 day'::interval
        ) as date_day
),

final as (
    select
        -- Date
        date_day,
        
        -- Year
        extract(year from date_day) as year,
        extract(quarter from date_day) as quarter,
        extract(month from date_day) as month,
        extract(week from date_day) as week_of_year,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week, -- 0=Sunday, 6=Saturday
        extract(doy from date_day) as day_of_year,
        
        -- Formatted dates
        to_char(date_day, 'YYYY-MM-DD') as date_formatted,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'YYYY-Q') as year_quarter,
        
        -- Names
        to_char(date_day, 'Day') as day_name,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Mon') as month_name_short,
        
        -- Flags
        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend,
        case when extract(dow from date_day) between 1 and 5 then true else false end as is_weekday,
        
        -- Relative dates
        case when date_day = current_date then true else false end as is_today,
        case when date_day = current_date - interval '1 day' then true else false end as is_yesterday,
        case when date_day >= date_trunc('month', current_date) then true else false end as is_current_month,
        case when date_day >= date_trunc('year', current_date) then true else false end as is_current_year,
        
        -- Holiday markers (add as needed for your region)
        case 
            when extract(month from date_day) = 12 and extract(day from date_day) = 25 then 'Christmas'
            when extract(month from date_day) = 1 and extract(day from date_day) = 1 then 'New Year'
            when extract(month from date_day) = 11 and extract(day from date_day) = 15 then 'Black Friday (approx)'
            else null
        end as holiday_name

    from date_spine
)

select * from final
  );
  
[0m14:50:43.103064 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.103064 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.103064 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:50:43.103064 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m14:50:43.104567 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:50:43.104567 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:50:43.141150 [debug] [Thread-1 (]: SQL status: SELECT 1827 in 0.037 seconds
[0m14:50:43.146277 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_date"
[0m14:50:43.147650 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */
alter table "ecommerce_raw"."public"."dim_date__dbt_tmp" rename to "dim_date"
[0m14:50:43.147650 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:50:43.147650 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.148700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.148700 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:50:43.149702 [debug] [Thread-1 (]: On model.dbt_project.dim_date: COMMIT
[0m14:50:43.149702 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_date"
[0m14:50:43.149702 [debug] [Thread-1 (]: On model.dbt_project.dim_date: COMMIT
[0m14:50:43.151109 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m14:50:43.151109 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.151109 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:50:43.151109 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.153278 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_date__dbt_backup"
[0m14:50:43.155290 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_date"
[0m14:50:43.156541 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:50:43.156541 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:50:43.156541 [debug] [Thread-1 (]: On model.dbt_project.dim_date: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_date"} */
drop table if exists "ecommerce_raw"."public"."dim_date__dbt_backup" cascade
[0m14:50:43.159547 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.162816 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.162816 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:50:43.162816 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:50:43.164320 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:50:43.165321 [debug] [Thread-1 (]: On model.dbt_project.dim_date: Close
[0m14:50:43.165824 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.167462 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.168465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C150A3740>]}
[0m14:50:43.168465 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:50:43.168465 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:50:43.169468 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.dim_date ............................. [[32mSELECT 1827[0m in 0.30s]
[0m14:50:43.172477 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.172477 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:50:43.172477 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_date
[0m14:50:43.173479 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:50:43.174982 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:50:43.174982 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m14:50:43.175486 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.175486 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.176521 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:50:43.176521 [info ] [Thread-1 (]: 8 of 11 START sql view model public.stg_sellers ................................ [RUN]
[0m14:50:43.177525 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:50:43.178527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_date, now model.dbt_project.stg_sellers)
[0m14:50:43.178527 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.178527 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:50:43.179587 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.179587 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m14:50:43.181590 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:50:43.183654 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:50:43.185156 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:50:43.185156 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.185934 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:50:43.187438 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:50:43.188450 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:50:43.188450 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m14:50:43.188450 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:50:43.189451 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:43.191813 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:50:43.192816 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: Close
[0m14:50:43.192816 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:50:43.195321 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m14:50:43.195321 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C154996D0>]}
[0m14:50:43.196433 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C150849B0>]}
[0m14:50:43.195321 [info ] [Thread-3 (]: 5 of 11 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:50:43.197664 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:50:43.196433 [info ] [Thread-4 (]: 7 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:50:43.198690 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.198690 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m14:50:43.199690 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:50:43.199690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:43.200783 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_products
[0m14:50:43.200783 [info ] [Thread-3 (]: 9 of 11 START sql table model public.dim_products .............................. [RUN]
[0m14:50:43.200783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_products)
[0m14:50:43.202213 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_products
[0m14:50:43.205228 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:50:43.205938 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_products
[0m14:50:43.210259 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:50:43.212476 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:43.212476 [debug] [Thread-3 (]: On model.dbt_project.dim_products: BEGIN
[0m14:50:43.212476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:50:43.244687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m14:50:43.245198 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.245944 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as sellers_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:50:43.250158 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:50:43.252763 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.253838 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:50:43.253838 [debug] [Thread-3 (]: SQL status: BEGIN in 0.041 seconds
[0m14:50:43.254342 [debug] [Thread-2 (]: SQL status: BEGIN in 0.150 seconds
[0m14:50:43.254342 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.254342 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:43.255343 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.257494 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.257494 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:50:43.258586 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:50:43.258586 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:50:43.259590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:43.260593 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:50:43.260593 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.261593 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:50:43.261593 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.265359 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:50:43.266194 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:50:43.266194 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:50:43.328019 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.328019 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:50:43.329031 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:50:43.329031 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:43.332344 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.332344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:50:43.332344 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:50:43.333712 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m14:50:43.334712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C15500410>]}
[0m14:50:43.335215 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:50:43.335215 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:50:43.336299 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:50:43.337299 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m14:50:43.337299 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.338503 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:50:43.338503 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_sellers
[0m14:50:43.339507 [info ] [Thread-4 (]: 10 of 11 START sql table model public.dim_sellers .............................. [RUN]
[0m14:50:43.339507 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.dim_sellers)
[0m14:50:43.339507 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:43.340511 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_sellers
[0m14:50:43.342594 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:50:43.345581 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m14:50:43.346083 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:50:43.346083 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:50:43.347083 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_sellers
[0m14:50:43.350084 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m14:50:43.351084 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:50:43.352084 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m14:50:43.353084 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1510ECF0>]}
[0m14:50:43.353084 [info ] [Thread-2 (]: 6 of 11 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.27s]
[0m14:50:43.353084 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:43.354586 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m14:50:43.354586 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: BEGIN
[0m14:50:43.356089 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:50:43.356422 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m14:50:43.356422 [info ] [Thread-1 (]: 11 of 11 START sql table model public.dim_customers ............................ [RUN]
[0m14:50:43.357090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now model.dbt_project.dim_customers)
[0m14:50:43.358091 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m14:50:43.362092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:50:43.363092 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m14:50:43.368103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:50:43.369501 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:43.370506 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:50:43.370506 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:43.399757 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m14:50:43.399757 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:43.399757 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.sellers_zip_code ,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m14:50:43.409271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m14:50:43.409271 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:43.410272 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:50:44.715983 [debug] [Thread-3 (]: SQL status: SELECT 32951 in 1.457 seconds
[0m14:50:44.719360 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:44.720360 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m14:50:44.720360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:44.722705 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:44.722705 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:50:44.724208 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:44.725209 [debug] [Thread-3 (]: On model.dbt_project.dim_products: COMMIT
[0m14:50:44.725712 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:44.725712 [debug] [Thread-3 (]: On model.dbt_project.dim_products: COMMIT
[0m14:50:44.739565 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m14:50:44.741568 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m14:50:44.742568 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:50:44.742568 [debug] [Thread-3 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m14:50:44.749941 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:50:44.750941 [debug] [Thread-3 (]: On model.dbt_project.dim_products: Close
[0m14:50:44.750941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C14FDD640>]}
[0m14:50:44.751942 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public.dim_products ......................... [[32mSELECT 32951[0m in 1.55s]
[0m14:50:44.752943 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_products
[0m14:50:44.896673 [debug] [Thread-4 (]: SQL status: SELECT 3095 in 1.496 seconds
[0m14:50:44.899684 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:44.901708 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers" rename to "dim_sellers__dbt_backup"
[0m14:50:44.902713 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:44.904222 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:44.905233 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m14:50:44.905233 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:44.907255 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:50:44.907255 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:44.907255 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:50:44.909263 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:50:44.911273 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_sellers__dbt_backup"
[0m14:50:44.911273 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:50:44.911273 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
drop table if exists "ecommerce_raw"."public"."dim_sellers__dbt_backup" cascade
[0m14:50:44.917395 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:50:44.918466 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: Close
[0m14:50:44.918466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C131A8920>]}
[0m14:50:44.919468 [info ] [Thread-4 (]: 10 of 11 OK created sql table model public.dim_sellers ......................... [[32mSELECT 3095[0m in 1.58s]
[0m14:50:44.919468 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_sellers
[0m14:50:46.382583 [debug] [Thread-1 (]: SQL status: SELECT 198882 in 2.973 seconds
[0m14:50:46.386341 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:46.386341 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:50:46.387344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:46.388847 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:46.389860 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:50:46.389860 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:50:46.391868 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:50:46.391868 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:46.391868 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:50:46.404623 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m14:50:46.406106 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:50:46.407107 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:50:46.407107 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:50:46.416174 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m14:50:46.417174 [debug] [Thread-1 (]: On model.dbt_project.dim_customers: Close
[0m14:50:46.417174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8007594-4d59-4e34-91b1-1b891628d90b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C150F6B70>]}
[0m14:50:46.418174 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public.dim_customers ....................... [[32mSELECT 198882[0m in 3.06s]
[0m14:50:46.419183 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m14:50:46.420187 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:46.420187 [debug] [MainThread]: On master: BEGIN
[0m14:50:46.420187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:46.455147 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m14:50:46.455147 [debug] [MainThread]: On master: COMMIT
[0m14:50:46.456545 [debug] [MainThread]: Using postgres connection "master"
[0m14:50:46.456545 [debug] [MainThread]: On master: COMMIT
[0m14:50:46.456545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:50:46.457548 [debug] [MainThread]: On master: Close
[0m14:50:46.457548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:46.457548 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:50:46.457548 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:50:46.458548 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:50:46.458548 [debug] [MainThread]: Connection 'model.dbt_project.stg_orders' was properly closed.
[0m14:50:46.458548 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:50:46.458548 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m14:50:46.459548 [info ] [MainThread]: 
[0m14:50:46.459548 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 3.94 seconds (3.94s).
[0m14:50:46.460909 [debug] [MainThread]: Command end result
[0m14:50:46.484561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:50:46.487412 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:50:46.493206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:50:46.493206 [info ] [MainThread]: 
[0m14:50:46.493206 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:50:46.494710 [info ] [MainThread]: 
[0m14:50:46.495220 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:50:46.496239 [debug] [MainThread]: Command `dbt run` succeeded at 14:50:46.496239 after 5.18 seconds
[0m14:50:46.496239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C12A1B170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C149DB7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C145BD160>]}
[0m14:50:46.497239 [debug] [MainThread]: Flushing usage events
[0m14:50:48.513434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:51:47.942948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE748A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE748A240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE4FF03B0>]}


============================== 14:51:47.947670 | 755a5a22-ff64-475b-a5a2-f881f25fd58d ==============================
[0m14:51:47.947670 [info ] [MainThread]: Running with dbt=1.9.10
[0m14:51:47.948673 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m14:51:48.142195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE7F11EB0>]}
[0m14:51:48.194885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE52A74D0>]}
[0m14:51:48.196396 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m14:51:48.614338 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m14:51:48.807821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:51:48.808822 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:51:48.846180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE7FDAC30>]}
[0m14:51:48.914493 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:51:48.933531 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:51:48.967967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE95A1550>]}
[0m14:51:48.968967 [info ] [MainThread]: Found 11 models, 19 data tests, 9 sources, 447 macros
[0m14:51:48.968967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE936BCE0>]}
[0m14:51:48.972072 [info ] [MainThread]: 
[0m14:51:48.972072 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:51:48.972072 [info ] [MainThread]: 
[0m14:51:48.973444 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:48.976577 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m14:51:49.141387 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m14:51:49.141387 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m14:51:49.141387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:49.194587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m14:51:49.196083 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m14:51:49.197532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m14:51:49.202683 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:51:49.202683 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m14:51:49.203684 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:49.239663 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m14:51:49.240931 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m14:51:49.240931 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:51:49.247862 [debug] [ThreadPool]: SQL status: SELECT 23 in 0.006 seconds
[0m14:51:49.248864 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m14:51:49.248864 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m14:51:49.256173 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.256676 [debug] [MainThread]: On master: BEGIN
[0m14:51:49.256676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:49.394754 [debug] [MainThread]: SQL status: BEGIN in 0.138 seconds
[0m14:51:49.395257 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.395257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m14:51:49.402328 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m14:51:49.404834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9CC8E90>]}
[0m14:51:49.404834 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:49.405336 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.405336 [debug] [MainThread]: On master: BEGIN
[0m14:51:49.406052 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:51:49.406052 [debug] [MainThread]: On master: COMMIT
[0m14:51:49.406052 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.406052 [debug] [MainThread]: On master: COMMIT
[0m14:51:49.406052 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:49.407556 [debug] [MainThread]: On master: Close
[0m14:51:49.410612 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_time
[0m14:51:49.411614 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m14:51:49.411614 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m14:51:49.412616 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m14:51:49.411614 [info ] [Thread-1 (]: 1 of 11 START sql table model public.dim_time .................................. [RUN]
[0m14:51:49.412616 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m14:51:49.413619 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_items_ordered .......................... [RUN]
[0m14:51:49.413619 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.dim_time'
[0m14:51:49.413619 [info ] [Thread-4 (]: 4 of 11 START sql view model public.stg_name_translation ....................... [RUN]
[0m14:51:49.415122 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m14:51:49.415122 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m14:51:49.415122 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_time
[0m14:51:49.416133 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m14:51:49.416133 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m14:51:49.416133 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m14:51:49.423162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_time"
[0m14:51:49.423162 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m14:51:49.425175 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m14:51:49.426891 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m14:51:49.428896 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m14:51:49.429898 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m14:51:49.445283 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_time
[0m14:51:49.460332 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m14:51:49.460332 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m14:51:49.477393 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m14:51:49.479502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_time"
[0m14:51:49.482509 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m14:51:49.485521 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m14:51:49.486165 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.486530 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m14:51:49.486530 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:51:49.487535 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m14:51:49.487535 [debug] [Thread-1 (]: On model.dbt_project.dim_time: BEGIN
[0m14:51:49.488544 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.488544 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.488544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:51:49.488544 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m14:51:49.489547 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m14:51:49.489547 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:51:49.490549 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:51:49.532481 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m14:51:49.533484 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.533484 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m14:51:49.534485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m14:51:49.534485 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m14:51:49.534485 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */

  
    

  create  table "ecommerce_raw"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

with date_spine as (
    -- Generate all dates from 2016 to 2020 (covers your data range)
    select
        date_day::date as date_day
    from 
        generate_series(
            '2016-01-01'::date,
            '2020-12-31'::date,
            '1 day'::interval
        ) as date_day
),

final as (
    select
        -- Date
        date_day,
        
        -- Year
        extract(year from date_day) as year,
        extract(quarter from date_day) as quarter,
        extract(month from date_day) as month,
        extract(week from date_day) as week_of_year,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week, -- 0=Sunday, 6=Saturday
        extract(doy from date_day) as day_of_year,
        
        -- Formatted dates
        to_char(date_day, 'YYYY-MM-DD') as date_formatted,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'YYYY-Q') as year_quarter,
        
        -- Names
        to_char(date_day, 'Day') as day_name,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Mon') as month_name_short,
        
        -- Flags
        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend,
        case when extract(dow from date_day) between 1 and 5 then true else false end as is_weekday,
        
        -- Relative dates
        case when date_day = current_date then true else false end as is_today,
        case when date_day = current_date - interval '1 day' then true else false end as is_yesterday,
        case when date_day >= date_trunc('month', current_date) then true else false end as is_current_month,
        case when date_day >= date_trunc('year', current_date) then true else false end as is_current_year,
        
        -- Holiday markers (add as needed for your region)
        case 
            when extract(month from date_day) = 12 and extract(day from date_day) = 25 then 'Christmas'
            when extract(month from date_day) = 1 and extract(day from date_day) = 1 then 'New Year'
            when extract(month from date_day) = 11 and extract(day from date_day) = 15 then 'Black Friday (approx)'
            else null
        end as holiday_name

    from date_spine
)

select * from final
  );
  
[0m14:51:49.537635 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m14:51:49.537635 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.537635 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m14:51:49.538709 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:51:49.545492 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.545492 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:51:49.546546 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m14:51:49.546546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m14:51:49.549555 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.549555 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.550558 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m14:51:49.550558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.550558 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m14:51:49.553579 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.553579 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:51:49.553579 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m14:51:49.556537 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.556537 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m14:51:49.556537 [debug] [Thread-1 (]: SQL status: SELECT 1827 in 0.022 seconds
[0m14:51:49.557663 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.562677 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m14:51:49.562677 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:51:49.562677 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:51:49.576977 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:51:49.577979 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
alter table "ecommerce_raw"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m14:51:49.578982 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:51:49.580988 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.581998 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.581998 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.583001 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m14:51:49.583001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.583001 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m14:51:49.583001 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m14:51:49.584504 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m14:51:49.585511 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.586015 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m14:51:49.588021 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.588021 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:49.589024 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:49.589024 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m14:51:49.589024 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m14:51:49.595547 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m14:51:49.597356 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m14:51:49.602415 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m14:51:49.602415 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:51:49.602415 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:51:49.603418 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m14:51:49.603418 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m14:51:49.604921 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:51:49.606433 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_time__dbt_backup"
[0m14:51:49.606433 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m14:51:49.607433 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.609941 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m14:51:49.609941 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:51:49.609941 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m14:51:49.610944 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
drop table if exists "ecommerce_raw"."public"."dim_time__dbt_backup" cascade
[0m14:51:49.612961 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m14:51:49.612961 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:51:49.614465 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m14:51:49.615472 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:51:49.616294 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:51:49.617316 [debug] [Thread-1 (]: On model.dbt_project.dim_time: Close
[0m14:51:49.619465 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m14:51:49.620468 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m14:51:49.620468 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m14:51:49.621474 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE51CB8C0>]}
[0m14:51:49.621474 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9D625D0>]}
[0m14:51:49.621474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE73BE870>]}
[0m14:51:49.622476 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:51:49.623479 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:51:49.622476 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:51:49.624478 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m14:51:49.623479 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.dim_time ............................. [[32mSELECT 1827[0m in 0.21s]
[0m14:51:49.625579 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m14:51:49.625579 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m14:51:49.626699 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_order_payment
[0m14:51:49.626699 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_time
[0m14:51:49.627701 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m14:51:49.627701 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9DD6C30>]}
[0m14:51:49.628706 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m14:51:49.628706 [info ] [Thread-3 (]: 5 of 11 START sql view model public.stg_order_payment .......................... [RUN]
[0m14:51:49.629711 [info ] [Thread-2 (]: 6 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m14:51:49.629711 [info ] [Thread-4 (]: 4 of 11 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.21s]
[0m14:51:49.630715 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_order_payment)
[0m14:51:49.629711 [info ] [Thread-1 (]: 7 of 11 START sql view model public.stg_products ............................... [RUN]
[0m14:51:49.630715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m14:51:49.631718 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m14:51:49.631718 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_order_payment
[0m14:51:49.631718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_time, now model.dbt_project.stg_products)
[0m14:51:49.632727 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m14:51:49.632727 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m14:51:49.635963 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m14:51:49.635963 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m14:51:49.637981 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m14:51:49.638984 [info ] [Thread-4 (]: 8 of 11 START sql view model public.stg_sellers ................................ [RUN]
[0m14:51:49.640991 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m14:51:49.642005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m14:51:49.642005 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m14:51:49.643007 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_order_payment
[0m14:51:49.644511 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m14:51:49.649032 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m14:51:49.649032 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m14:51:49.650035 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m14:51:49.653052 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m14:51:49.657097 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m14:51:49.658100 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m14:51:49.658100 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.662313 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m14:51:49.663320 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m14:51:49.664323 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.664828 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.664828 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:49.665330 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m14:51:49.665330 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m14:51:49.666351 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:49.666351 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.666351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:51:49.666351 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: BEGIN
[0m14:51:49.667624 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:49.718575 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m14:51:49.719584 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.719584 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m14:51:49.723647 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m14:51:49.725154 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.725154 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m14:51:49.725953 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:51:49.731255 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.732254 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m14:51:49.733255 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.737277 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.738314 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m14:51:49.738314 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m14:51:49.739746 [debug] [Thread-4 (]: SQL status: BEGIN in 0.072 seconds
[0m14:51:49.740760 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m14:51:49.740760 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.740760 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.742025 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.744530 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.745532 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m14:51:49.746327 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:51:49.747341 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as sellers_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m14:51:49.747341 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m14:51:49.747341 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.748344 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m14:51:49.749529 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.749529 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:49.752793 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.752793 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:51:49.755305 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m14:51:49.756508 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:51:49.756508 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m14:51:49.759510 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.759510 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m14:51:49.762822 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.762822 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m14:51:49.762822 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:49.762822 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m14:51:49.764325 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m14:51:49.765332 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:51:49.765836 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.766498 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.768517 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.768517 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:51:49.769520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:51:49.769520 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m14:51:49.769520 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m14:51:49.770523 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: Close
[0m14:51:49.773542 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.773542 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m14:51:49.774542 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9D4E120>]}
[0m14:51:49.775047 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:49.775550 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.775550 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:49.775550 [info ] [Thread-3 (]: 5 of 11 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:51:49.778655 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m14:51:49.780661 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:51:49.781663 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m14:51:49.781663 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_order_payment
[0m14:51:49.782666 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m14:51:49.782666 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.783669 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.783669 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m14:51:49.783669 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: COMMIT
[0m14:51:49.784669 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m14:51:49.785901 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:49.785901 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:49.790043 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m14:51:49.790043 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:51:49.852483 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m14:51:49.852483 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m14:51:49.854486 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m14:51:49.854989 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m14:51:49.855492 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m14:51:49.855492 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m14:51:49.855492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEA1F1400>]}
[0m14:51:49.856503 [info ] [Thread-2 (]: 6 of 11 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.22s]
[0m14:51:49.857507 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m14:51:49.858510 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:51:49.858510 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:51:49.859808 [debug] [Thread-4 (]: On model.dbt_project.stg_sellers: Close
[0m14:51:49.860807 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m14:51:49.861818 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m14:51:49.862826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEA213350>]}
[0m14:51:49.861818 [info ] [Thread-3 (]: 9 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m14:51:49.864329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEA213290>]}
[0m14:51:49.862826 [info ] [Thread-4 (]: 8 of 11 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:51:49.864329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m14:51:49.865336 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m14:51:49.865336 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m14:51:49.865336 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m14:51:49.866435 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m14:51:49.870615 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m14:51:49.870615 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_sellers
[0m14:51:49.871619 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_products
[0m14:51:49.871619 [info ] [Thread-2 (]: 10 of 11 START sql table model public.dim_sellers .............................. [RUN]
[0m14:51:49.872623 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_sellers)
[0m14:51:49.872623 [info ] [Thread-4 (]: 11 of 11 START sql table model public.dim_products ............................. [RUN]
[0m14:51:49.873627 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_sellers
[0m14:51:49.873627 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m14:51:49.874626 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now model.dbt_project.dim_products)
[0m14:51:49.876853 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m14:51:49.880959 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m14:51:49.880959 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_products
[0m14:51:49.884480 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m14:51:49.885486 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:49.885486 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_sellers
[0m14:51:49.885486 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m14:51:49.888620 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m14:51:49.889623 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_products
[0m14:51:49.889623 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:51:49.892638 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m14:51:49.893646 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:49.893646 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: BEGIN
[0m14:51:49.894647 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:51:49.895151 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:49.895151 [debug] [Thread-4 (]: On model.dbt_project.dim_products: BEGIN
[0m14:51:49.896046 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:51:49.936227 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m14:51:49.936227 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:49.936227 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m14:51:49.939253 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m14:51:49.939253 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:49.940255 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.sellers_zip_code ,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m14:51:49.942274 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m14:51:49.942274 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:49.943276 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m14:51:51.417666 [debug] [Thread-4 (]: SQL status: SELECT 32951 in 1.475 seconds
[0m14:51:51.421676 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:51.421676 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m14:51:51.422678 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:51.425889 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:51.425889 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m14:51:51.426922 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:51.427925 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m14:51:51.427925 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:51.427925 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m14:51:51.441606 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m14:51:51.443613 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m14:51:51.444612 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m14:51:51.445115 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m14:51:51.451898 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:51:51.452900 [debug] [Thread-4 (]: On model.dbt_project.dim_products: Close
[0m14:51:51.452900 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FEA1C3710>]}
[0m14:51:51.454403 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public.dim_products ........................ [[32mSELECT 32951[0m in 1.58s]
[0m14:51:51.455411 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_products
[0m14:51:51.518503 [debug] [Thread-2 (]: SQL status: SELECT 3095 in 1.578 seconds
[0m14:51:51.522514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:51.522514 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers" rename to "dim_sellers__dbt_backup"
[0m14:51:51.523516 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:51:51.525523 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:51.525523 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m14:51:51.526536 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:51.527539 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:51:51.528541 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:51.528541 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: COMMIT
[0m14:51:51.529543 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:51:51.532564 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_sellers__dbt_backup"
[0m14:51:51.532564 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m14:51:51.533564 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
drop table if exists "ecommerce_raw"."public"."dim_sellers__dbt_backup" cascade
[0m14:51:51.539494 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:51:51.540705 [debug] [Thread-2 (]: On model.dbt_project.dim_sellers: Close
[0m14:51:51.541707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9CBD8E0>]}
[0m14:51:51.541707 [info ] [Thread-2 (]: 10 of 11 OK created sql table model public.dim_sellers ......................... [[32mSELECT 3095[0m in 1.67s]
[0m14:51:51.542710 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_sellers
[0m14:51:52.844644 [debug] [Thread-3 (]: SQL status: SELECT 198882 in 2.907 seconds
[0m14:51:52.849266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:52.849266 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m14:51:52.850688 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:52.855519 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:52.856398 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m14:51:52.857629 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:51:52.861631 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:51:52.861631 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:52.862646 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m14:51:52.876081 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m14:51:52.880223 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m14:51:52.882461 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m14:51:52.882461 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m14:51:52.899232 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.015 seconds
[0m14:51:52.902391 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m14:51:52.903571 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '755a5a22-ff64-475b-a5a2-f881f25fd58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE9CD9220>]}
[0m14:51:52.904574 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 198882[0m in 3.04s]
[0m14:51:52.905577 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m14:51:52.907640 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.910237 [debug] [MainThread]: On master: BEGIN
[0m14:51:52.910237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:52.982685 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m14:51:52.984172 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.984676 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:52.985200 [debug] [MainThread]: On master: COMMIT
[0m14:51:52.985200 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:51:52.986246 [debug] [MainThread]: On master: Close
[0m14:51:52.987280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:52.987280 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m14:51:52.987280 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m14:51:52.987280 [debug] [MainThread]: Connection 'model.dbt_project.stg_products' was properly closed.
[0m14:51:52.988474 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m14:51:52.988474 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m14:51:52.989488 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m14:51:52.989488 [info ] [MainThread]: 
[0m14:51:52.989488 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m14:51:52.993041 [debug] [MainThread]: Command end result
[0m14:51:53.029069 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m14:51:53.034338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m14:51:53.040635 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m14:51:53.041704 [info ] [MainThread]: 
[0m14:51:53.041704 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:51:53.043008 [info ] [MainThread]: 
[0m14:51:53.043008 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m14:51:53.044513 [debug] [MainThread]: Command `dbt run` succeeded at 14:51:53.044513 after 5.21 seconds
[0m14:51:53.044513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE7363A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE73639B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017FE748A900>]}
[0m14:51:53.046021 [debug] [MainThread]: Flushing usage events
[0m14:51:55.157797 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:00:34.705349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2D9FCD40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2DC703B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2E148560>]}


============================== 15:00:34.711481 | d103be73-51a2-4cce-ac82-6d685770a853 ==============================
[0m15:00:34.711481 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:00:34.712910 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'no_print': 'None', 'invocation_command': 'dbt test', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:00:34.925209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2F8D8710>]}
[0m15:00:34.977244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2E196DE0>]}
[0m15:00:34.979782 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:00:35.393556 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:00:35.595284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:35.596491 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:35.633292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2F9BA720>]}
[0m15:00:35.705538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:00:35.728612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:00:35.789216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C30121A00>]}
[0m15:00:35.789216 [info ] [MainThread]: Found 11 models, 42 data tests, 9 sources, 447 macros
[0m15:00:35.789216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2FDC80B0>]}
[0m15:00:35.794397 [info ] [MainThread]: 
[0m15:00:35.795398 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:35.795398 [info ] [MainThread]: 
[0m15:00:35.795398 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:00:35.799630 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m15:00:35.980384 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:00:35.980384 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m15:00:35.981384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:36.047232 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m15:00:36.048234 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:00:36.048234 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:00:36.057447 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.009 seconds
[0m15:00:36.059452 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m15:00:36.059452 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m15:00:36.066490 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:36.066490 [debug] [MainThread]: On master: BEGIN
[0m15:00:36.066490 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:36.102656 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:00:36.103660 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:36.103660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:00:36.111285 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m15:00:36.113638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd103be73-51a2-4cce-ac82-6d685770a853', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2FDB2990>]}
[0m15:00:36.113638 [debug] [MainThread]: On master: ROLLBACK
[0m15:00:36.114638 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:36.115141 [debug] [MainThread]: On master: BEGIN
[0m15:00:36.115141 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:00:36.115141 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.116155 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:36.116155 [debug] [MainThread]: On master: COMMIT
[0m15:00:36.116155 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:36.117206 [debug] [MainThread]: On master: Close
[0m15:00:36.122627 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:00:36.123631 [debug] [Thread-2 (]: Began running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:00:36.123631 [debug] [Thread-3 (]: Began running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:00:36.123631 [debug] [Thread-4 (]: Began running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:00:36.123631 [info ] [Thread-1 (]: 1 of 42 START test accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention  [RUN]
[0m15:00:36.124630 [info ] [Thread-2 (]: 2 of 42 START test accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold  [RUN]
[0m15:00:36.125132 [info ] [Thread-3 (]: 3 of 42 START test accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive  [RUN]
[0m15:00:36.126278 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf'
[0m15:00:36.125132 [info ] [Thread-4 (]: 4 of 42 START test accepted_values_dim_time_is_weekend__True__False ............ [RUN]
[0m15:00:36.126278 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68'
[0m15:00:36.126278 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a'
[0m15:00:36.127279 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:00:36.127279 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68'
[0m15:00:36.127279 [debug] [Thread-2 (]: Began compiling node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:00:36.128433 [debug] [Thread-3 (]: Began compiling node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:00:36.142508 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:00:36.143514 [debug] [Thread-4 (]: Began compiling node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:00:36.148787 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:00:36.152794 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:00:36.156803 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:00:36.159179 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:00:36.175281 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:00:36.176392 [debug] [Thread-3 (]: Began executing node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:00:36.177395 [debug] [Thread-2 (]: Began executing node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:00:36.177395 [debug] [Thread-4 (]: Began executing node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:00:36.179639 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:00:36.181989 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:00:36.182989 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:00:36.184493 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:00:36.185500 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: BEGIN
[0m15:00:36.186005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:00:36.186312 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:00:36.187007 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:00:36.187007 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:00:36.187007 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: BEGIN
[0m15:00:36.188010 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: BEGIN
[0m15:00:36.188010 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: BEGIN
[0m15:00:36.188010 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:00:36.189172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:00:36.189172 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:00:36.231507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m15:00:36.232510 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:00:36.233513 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_customers"
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'Champion','Loyal','Potential','At Risk','Needs Attention'
)



  
  
      
    ) dbt_internal_test
[0m15:00:36.233513 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m15:00:36.233513 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:00:36.234513 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sales_category as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_products"
    group by sales_category

)

select *
from all_values
where value_field not in (
    'Best Seller','Popular','Regular','Slow Moving','Never Sold'
)



  
  
      
    ) dbt_internal_test
[0m15:00:36.236567 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.238008 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:00:36.238008 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        seller_tier as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_sellers"
    group by seller_tier

)

select *
from all_values
where value_field not in (
    'Top Seller','High Volume','Active','Low Volume','Inactive'
)



  
  
      
    ) dbt_internal_test
[0m15:00:36.241300 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:36.245942 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: ROLLBACK
[0m15:00:36.245942 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m15:00:36.246652 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:00:36.246652 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: Close
[0m15:00:36.246652 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_weekend as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_time"
    group by is_weekend

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m15:00:36.247668 [info ] [Thread-3 (]: 3 of 42 PASS accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive  [[32mPASS[0m in 0.12s]
[0m15:00:36.248833 [debug] [Thread-3 (]: Finished running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:00:36.248833 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m15:00:36.250073 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:00:36.252142 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: ROLLBACK
[0m15:00:36.252142 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m15:00:36.253142 [info ] [Thread-3 (]: 5 of 42 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m15:00:36.255167 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: ROLLBACK
[0m15:00:36.255167 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: Close
[0m15:00:36.256373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:00:36.256373 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:00:36.257706 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: Close
[0m15:00:36.268911 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:00:36.257706 [info ] [Thread-2 (]: 2 of 42 PASS accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold  [[32mPASS[0m in 0.13s]
[0m15:00:36.269914 [debug] [Thread-2 (]: Finished running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:00:36.268911 [info ] [Thread-4 (]: 4 of 42 PASS accepted_values_dim_time_is_weekend__True__False .................. [[32mPASS[0m in 0.14s]
[0m15:00:36.271032 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:00:36.272032 [debug] [Thread-4 (]: Finished running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:00:36.273032 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:00:36.272032 [info ] [Thread-2 (]: 6 of 42 START test not_null_dim_customers_customer_segment ..................... [RUN]
[0m15:00:36.273032 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:00:36.276544 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:00:36.277798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68, now test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m15:00:36.277798 [info ] [Thread-4 (]: 7 of 42 START test not_null_dim_customers_customer_unique_id ................... [RUN]
[0m15:00:36.277798 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:00:36.279117 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68, now test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m15:00:36.283119 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:00:36.283119 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:00:36.284622 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:00:36.285133 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m15:00:36.289412 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:00:36.290404 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.290404 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:00:36.294472 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:00:36.294472 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:00:36.297335 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:00:36.298336 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:00:36.299336 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: BEGIN
[0m15:00:36.299336 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:36.300336 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:00:36.300336 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: BEGIN
[0m15:00:36.301336 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.302462 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m15:00:36.304466 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: ROLLBACK
[0m15:00:36.304466 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: Close
[0m15:00:36.305561 [info ] [Thread-1 (]: 1 of 42 PASS accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention  [[32mPASS[0m in 0.18s]
[0m15:00:36.307129 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:00:36.307129 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:00:36.308151 [info ] [Thread-1 (]: 8 of 42 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m15:00:36.308151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf, now test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m15:00:36.309151 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:00:36.314372 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:00:36.316670 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:00:36.319031 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:00:36.320355 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:00:36.321373 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m15:00:36.322381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.341876 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:36.342876 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:00:36.342876 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.349953 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.351122 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:00:36.351122 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."dim_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.372126 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m15:00:36.373126 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:00:36.373126 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_orders
from "ecommerce_raw"."public"."dim_customers"
where lifetime_orders is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.401456 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.058 seconds
[0m15:00:36.402459 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m15:00:36.403459 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m15:00:36.403459 [info ] [Thread-3 (]: 5 of 42 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.15s]
[0m15:00:36.404460 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:00:36.405658 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:00:36.405658 [info ] [Thread-3 (]: 9 of 42 START test not_null_dim_customers_lifetime_value ....................... [RUN]
[0m15:00:36.405658 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_dim_customers_lifetime_value.8655024888)
[0m15:00:36.407176 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:00:36.411900 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:00:36.411900 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.060 seconds
[0m15:00:36.413045 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: ROLLBACK
[0m15:00:36.413045 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: Close
[0m15:00:36.415125 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:00:36.414548 [info ] [Thread-4 (]: 7 of 42 PASS not_null_dim_customers_customer_unique_id ......................... [[32mPASS[0m in 0.14s]
[0m15:00:36.417953 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:00:36.417953 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:00:36.419248 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:00:36.419248 [info ] [Thread-4 (]: 10 of 42 START test not_null_dim_products_product_id ........................... [RUN]
[0m15:00:36.420249 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_project.not_null_dim_products_product_id.c8aba288d1)
[0m15:00:36.420249 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:00:36.421249 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:00:36.424709 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:36.424709 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m15:00:36.425226 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.426375 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:00:36.428378 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:36.429378 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:36.429378 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m15:00:36.430535 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.450303 [debug] [Thread-2 (]: SQL status: BEGIN in 0.151 seconds
[0m15:00:36.451303 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:00:36.451303 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_segment
from "ecommerce_raw"."public"."dim_customers"
where customer_segment is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.472510 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m15:00:36.473873 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:00:36.474376 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_value
from "ecommerce_raw"."public"."dim_customers"
where lifetime_value is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.480064 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.480064 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:36.481065 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.488095 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:00:36.490096 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m15:00:36.491096 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m15:00:36.492142 [info ] [Thread-4 (]: 10 of 42 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.07s]
[0m15:00:36.493142 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:00:36.493142 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:00:36.494646 [info ] [Thread-4 (]: 11 of 42 START test not_null_dim_products_sales_category ....................... [RUN]
[0m15:00:36.495159 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_product_id.c8aba288d1, now test.dbt_project.not_null_dim_products_sales_category.882d9c4faa)
[0m15:00:36.495159 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:00:36.503414 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:00:36.505421 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:00:36.508281 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:00:36.509275 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.057 seconds
[0m15:00:36.510359 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: ROLLBACK
[0m15:00:36.511580 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: Close
[0m15:00:36.514297 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:00:36.512788 [info ] [Thread-2 (]: 6 of 42 PASS not_null_dim_customers_customer_segment ........................... [[32mPASS[0m in 0.24s]
[0m15:00:36.514297 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: BEGIN
[0m15:00:36.515304 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:00:36.515304 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.516794 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:00:36.516794 [info ] [Thread-2 (]: 12 of 42 START test not_null_dim_products_times_sold ........................... [RUN]
[0m15:00:36.518064 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a)
[0m15:00:36.518064 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:00:36.523151 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:00:36.524654 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:00:36.528664 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:00:36.529667 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:00:36.531032 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: BEGIN
[0m15:00:36.531032 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.158 seconds
[0m15:00:36.531032 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.057 seconds
[0m15:00:36.532504 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:36.534311 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m15:00:36.535313 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m15:00:36.536681 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: Close
[0m15:00:36.536681 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m15:00:36.536681 [info ] [Thread-3 (]: 9 of 42 PASS not_null_dim_customers_lifetime_value ............................. [[32mPASS[0m in 0.13s]
[0m15:00:36.539053 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:00:36.538050 [info ] [Thread-1 (]: 8 of 42 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.23s]
[0m15:00:36.539053 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:00:36.540053 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:00:36.541053 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:00:36.540053 [info ] [Thread-3 (]: 13 of 42 START test not_null_dim_sellers_seller_id ............................. [RUN]
[0m15:00:36.542444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_value.8655024888, now test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c)
[0m15:00:36.541053 [info ] [Thread-1 (]: 14 of 42 START test not_null_dim_sellers_seller_tier ........................... [RUN]
[0m15:00:36.542444 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:00:36.543445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d)
[0m15:00:36.548823 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:00:36.548823 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:00:36.552846 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:00:36.554349 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:00:36.557926 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:00:36.557926 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:00:36.560927 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:00:36.562927 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:00:36.562927 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: BEGIN
[0m15:00:36.562927 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.564430 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:00:36.565432 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: BEGIN
[0m15:00:36.565935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.568043 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:36.569048 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:00:36.569048 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_category
from "ecommerce_raw"."public"."dim_products"
where sales_category is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.577860 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.009 seconds
[0m15:00:36.579861 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: ROLLBACK
[0m15:00:36.580861 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: Close
[0m15:00:36.580861 [info ] [Thread-4 (]: 11 of 42 PASS not_null_dim_products_sales_category ............................. [[32mPASS[0m in 0.09s]
[0m15:00:36.582365 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:00:36.583399 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:00:36.583399 [info ] [Thread-4 (]: 15 of 42 START test not_null_dim_sellers_state ................................. [RUN]
[0m15:00:36.584399 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_sales_category.882d9c4faa, now test.dbt_project.not_null_dim_sellers_state.e0c340c724)
[0m15:00:36.584903 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:00:36.588527 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:00:36.589533 [debug] [Thread-2 (]: SQL status: BEGIN in 0.058 seconds
[0m15:00:36.590538 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:00:36.590538 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select times_sold
from "ecommerce_raw"."public"."dim_products"
where times_sold is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.590538 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:00:36.593049 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:00:36.595065 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:00:36.595835 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: BEGIN
[0m15:00:36.595835 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.598080 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:00:36.600081 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: ROLLBACK
[0m15:00:36.600081 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: Close
[0m15:00:36.601489 [info ] [Thread-2 (]: 12 of 42 PASS not_null_dim_products_times_sold ................................. [[32mPASS[0m in 0.08s]
[0m15:00:36.601489 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:00:36.602885 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:00:36.602885 [info ] [Thread-2 (]: 16 of 42 START test not_null_dim_sellers_total_orders .......................... [RUN]
[0m15:00:36.604390 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a, now test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b)
[0m15:00:36.604390 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:00:36.609744 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:00:36.610897 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:00:36.615483 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:00:36.616392 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m15:00:36.617635 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m15:00:36.617635 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:00:36.618638 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:00:36.618638 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_tier
from "ecommerce_raw"."public"."dim_sellers"
where seller_tier is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.618638 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:00:36.618638 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."dim_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.620009 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: BEGIN
[0m15:00:36.620009 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:36.622668 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:36.622668 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:36.624350 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: ROLLBACK
[0m15:00:36.626364 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: ROLLBACK
[0m15:00:36.626364 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: Close
[0m15:00:36.626364 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: Close
[0m15:00:36.627369 [info ] [Thread-1 (]: 14 of 42 PASS not_null_dim_sellers_seller_tier ................................. [[32mPASS[0m in 0.08s]
[0m15:00:36.628372 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:00:36.628372 [info ] [Thread-3 (]: 13 of 42 PASS not_null_dim_sellers_seller_id ................................... [[32mPASS[0m in 0.09s]
[0m15:00:36.629372 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:00:36.630423 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:00:36.631719 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:00:36.630423 [info ] [Thread-1 (]: 17 of 42 START test not_null_dim_time_date_day ................................. [RUN]
[0m15:00:36.632723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d, now test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa)
[0m15:00:36.631719 [info ] [Thread-3 (]: 18 of 42 START test not_null_dim_time_is_weekend ............................... [RUN]
[0m15:00:36.632723 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:00:36.633841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c, now test.dbt_project.not_null_dim_time_is_weekend.f294374ebd)
[0m15:00:36.690534 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:00:36.690534 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:00:36.691809 [debug] [Thread-4 (]: SQL status: BEGIN in 0.095 seconds
[0m15:00:36.691809 [debug] [Thread-2 (]: SQL status: BEGIN in 0.071 seconds
[0m15:00:36.695317 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:00:36.695317 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:00:36.695982 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:00:36.695982 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_state.e0c340c724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state
from "ecommerce_raw"."public"."dim_sellers"
where state is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.695982 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:00:36.697145 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from "ecommerce_raw"."public"."dim_sellers"
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.699186 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:00:36.699186 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:00:36.700189 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:36.702212 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:00:36.703216 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: ROLLBACK
[0m15:00:36.703216 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:36.705236 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: ROLLBACK
[0m15:00:36.705236 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:00:36.706305 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: Close
[0m15:00:36.706305 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: BEGIN
[0m15:00:36.706305 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: Close
[0m15:00:36.707305 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:00:36.707808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.707808 [info ] [Thread-4 (]: 15 of 42 PASS not_null_dim_sellers_state ....................................... [[32mPASS[0m in 0.12s]
[0m15:00:36.709016 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: BEGIN
[0m15:00:36.707808 [info ] [Thread-2 (]: 16 of 42 PASS not_null_dim_sellers_total_orders ................................ [[32mPASS[0m in 0.10s]
[0m15:00:36.709016 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:00:36.710168 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.710168 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:00:36.710168 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:00:36.711607 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:00:36.711607 [info ] [Thread-4 (]: 19 of 42 START test not_null_dim_time_year ..................................... [RUN]
[0m15:00:36.712662 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_state.e0c340c724, now test.dbt_project.not_null_dim_time_year.6fb9595d53)
[0m15:00:36.712662 [info ] [Thread-2 (]: 20 of 42 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m15:00:36.713662 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:00:36.713662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b, now test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:00:36.717913 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:00:36.717913 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:00:36.723174 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:00:36.724677 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:00:36.727569 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:00:36.727569 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:00:36.729731 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:00:36.730731 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:00:36.731737 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: BEGIN
[0m15:00:36.731737 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.732731 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:00:36.732731 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:00:36.733732 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:36.756370 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.756370 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:00:36.756370 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "ecommerce_raw"."public"."dim_time"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.758374 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:36.759606 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.760618 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: ROLLBACK
[0m15:00:36.760618 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:00:36.761618 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "ecommerce_raw"."public"."dim_time"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.761618 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: Close
[0m15:00:36.762618 [info ] [Thread-1 (]: 17 of 42 PASS not_null_dim_time_date_day ....................................... [[32mPASS[0m in 0.13s]
[0m15:00:36.763749 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:00:36.764254 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:00:36.764254 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:36.765759 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: ROLLBACK
[0m15:00:36.764254 [info ] [Thread-1 (]: 21 of 42 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m15:00:36.766483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m15:00:36.766483 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: Close
[0m15:00:36.767491 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:00:36.770718 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:00:36.770718 [info ] [Thread-3 (]: 18 of 42 PASS not_null_dim_time_is_weekend ..................................... [[32mPASS[0m in 0.14s]
[0m15:00:36.772205 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:00:36.772205 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:00:36.773322 [info ] [Thread-3 (]: 22 of 42 START test not_null_stg_items_ordered_item_id ......................... [RUN]
[0m15:00:36.773322 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_is_weekend.f294374ebd, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m15:00:36.774322 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:00:36.774322 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:00:36.777690 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:00:36.781076 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:00:36.782079 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m15:00:36.782079 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m15:00:36.782079 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:00:36.783168 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:00:36.783168 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.783168 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:00:36.784672 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:00:36.784672 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_year.6fb9595d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "ecommerce_raw"."public"."dim_time"
where year is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.785181 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m15:00:36.789575 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:00:36.789575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.792118 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:00:36.792118 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:36.792118 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m15:00:36.794256 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: ROLLBACK
[0m15:00:36.794256 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.795258 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: Close
[0m15:00:36.795258 [info ] [Thread-4 (]: 19 of 42 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 0.08s]
[0m15:00:36.796418 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:00:36.797419 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:00:36.797419 [info ] [Thread-4 (]: 23 of 42 START test not_null_stg_items_ordered_order_id ........................ [RUN]
[0m15:00:36.798419 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_year.6fb9595d53, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m15:00:36.798419 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:00:36.804332 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:00:36.805838 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:00:36.808939 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:00:36.811198 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:00:36.812199 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m15:00:36.812199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:36.835396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m15:00:36.836515 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:00:36.836515 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.843718 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:36.843718 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:00:36.843718 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.849489 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.065 seconds
[0m15:00:36.851548 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:00:36.851548 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:00:36.852573 [info ] [Thread-2 (]: 20 of 42 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.14s]
[0m15:00:36.853573 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:00:36.853573 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:00:36.854573 [info ] [Thread-2 (]: 24 of 42 START test not_null_stg_items_ordered_product_id ...................... [RUN]
[0m15:00:36.855077 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m15:00:36.856091 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:00:36.862514 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:00:36.863855 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m15:00:36.864359 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:36.866868 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m15:00:36.867868 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:00:36.867868 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.868944 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m15:00:36.868944 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:00:36.873231 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:00:36.873231 [info ] [Thread-1 (]: 21 of 42 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.11s]
[0m15:00:36.874232 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:00:36.875346 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:00:36.875346 [info ] [Thread-1 (]: 25 of 42 START test not_null_stg_items_ordered_seller_id ....................... [RUN]
[0m15:00:36.876604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m15:00:36.876604 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:00:36.877809 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:00:36.878809 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m15:00:36.884450 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:00:36.885453 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:36.887814 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:00:36.891815 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:00:36.894335 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:00:36.895841 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m15:00:36.895841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:36.942179 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m15:00:36.942179 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:00:36.942179 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.098 seconds
[0m15:00:36.943419 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.944419 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m15:00:36.944419 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m15:00:36.945624 [info ] [Thread-3 (]: 22 of 42 PASS not_null_stg_items_ordered_item_id ............................... [[32mPASS[0m in 0.17s]
[0m15:00:36.945624 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:00:36.946998 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:00:36.947998 [info ] [Thread-3 (]: 26 of 42 START test not_null_stg_order_payment_order_id ........................ [RUN]
[0m15:00:36.947998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:36.947998 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m15:00:36.949246 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:00:36.949246 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:00:36.950246 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:36.956051 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:00:36.957357 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:00:36.961833 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:00:36.962827 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.094 seconds
[0m15:00:36.965836 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m15:00:36.966838 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m15:00:36.967838 [info ] [Thread-4 (]: 23 of 42 PASS not_null_stg_items_ordered_order_id .............................. [[32mPASS[0m in 0.17s]
[0m15:00:36.968838 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:00:36.969838 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:00:36.969838 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:00:36.970839 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m15:00:36.971839 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:36.971839 [info ] [Thread-4 (]: 27 of 42 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m15:00:36.972839 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:00:36.972839 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:00:36.980855 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:00:36.981855 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:00:36.985881 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:00:36.988372 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:00:36.989373 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:00:36.990373 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:37.006626 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.061 seconds
[0m15:00:37.007627 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m15:00:37.008845 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m15:00:37.008845 [info ] [Thread-2 (]: 24 of 42 PASS not_null_stg_items_ordered_product_id ............................ [[32mPASS[0m in 0.15s]
[0m15:00:37.009848 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:00:37.010848 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:00:37.010848 [info ] [Thread-2 (]: 28 of 42 START test not_null_stg_orders_order_id ............................... [RUN]
[0m15:00:37.011909 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:00:37.011909 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:00:37.017765 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:00:37.019876 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:00:37.021877 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:00:37.023046 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:00:37.023046 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:00:37.024550 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:37.028419 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m15:00:37.029425 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:00:37.030424 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.038629 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m15:00:37.038629 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:00:37.039657 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.069968 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m15:00:37.070996 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:00:37.070996 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.070996 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.041 seconds
[0m15:00:37.073340 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m15:00:37.073340 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m15:00:37.074342 [info ] [Thread-3 (]: 26 of 42 PASS not_null_stg_order_payment_order_id .............................. [[32mPASS[0m in 0.13s]
[0m15:00:37.074342 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:00:37.075370 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:00:37.075370 [info ] [Thread-3 (]: 29 of 42 START test not_null_stg_products_product_id ........................... [RUN]
[0m15:00:37.076379 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m15:00:37.076379 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:00:37.080711 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:00:37.081713 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:00:37.084217 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:00:37.085902 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:00:37.085902 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m15:00:37.085902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:37.120779 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.164 seconds
[0m15:00:37.122785 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m15:00:37.122785 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m15:00:37.124288 [info ] [Thread-1 (]: 25 of 42 PASS not_null_stg_items_ordered_seller_id ............................. [[32mPASS[0m in 0.25s]
[0m15:00:37.124288 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:00:37.125289 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:00:37.125289 [info ] [Thread-1 (]: 30 of 42 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m15:00:37.125792 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m15:00:37.126471 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:00:37.129510 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:00:37.129510 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.059 seconds
[0m15:00:37.130953 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.091 seconds
[0m15:00:37.132037 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:00:37.132037 [debug] [Thread-3 (]: SQL status: BEGIN in 0.046 seconds
[0m15:00:37.133157 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:00:37.134661 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:00:37.135229 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:00:37.135229 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:00:37.137267 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.138269 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:00:37.140530 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:00:37.141532 [info ] [Thread-2 (]: 28 of 42 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.13s]
[0m15:00:37.142716 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:00:37.141532 [info ] [Thread-4 (]: 27 of 42 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.17s]
[0m15:00:37.142716 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:00:37.142716 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:00:37.145221 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:00:37.144219 [info ] [Thread-2 (]: 31 of 42 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:00:37.145221 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:00:37.145960 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m15:00:37.145960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m15:00:37.147024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:37.147024 [info ] [Thread-4 (]: 32 of 42 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m15:00:37.147024 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:00:37.148476 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m15:00:37.155798 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:00:37.157027 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:00:37.157027 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:00:37.162123 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:00:37.163142 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m15:00:37.164645 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:00:37.164645 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m15:00:37.167299 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:00:37.168607 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:00:37.168607 [info ] [Thread-3 (]: 29 of 42 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m15:00:37.172738 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:00:37.172738 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:00:37.172738 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:00:37.174242 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:00:37.174242 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m15:00:37.175257 [info ] [Thread-3 (]: 33 of 42 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m15:00:37.175257 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:37.176664 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m15:00:37.176664 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:00:37.177724 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:00:37.177724 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m15:00:37.183008 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:00:37.183008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:37.185514 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:00:37.192490 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:00:37.194429 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:00:37.194429 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m15:00:37.195439 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:37.198977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:37.199983 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:00:37.199983 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.201983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:37.202984 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m15:00:37.204488 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m15:00:37.204488 [info ] [Thread-1 (]: 30 of 42 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m15:00:37.206373 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:00:37.206373 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:00:37.206373 [info ] [Thread-1 (]: 34 of 42 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:00:37.207898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m15:00:37.207898 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:00:37.213060 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:00:37.215072 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:00:37.218217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:00:37.219539 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:00:37.219539 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m15:00:37.219539 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:37.224421 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m15:00:37.225431 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:00:37.225933 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.232461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m15:00:37.233460 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:00:37.233460 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.242312 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m15:00:37.243313 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:00:37.244314 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.272060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m15:00:37.273059 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:00:37.273059 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.343246 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.099 seconds
[0m15:00:37.345268 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m15:00:37.346281 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m15:00:37.347498 [info ] [Thread-3 (]: 33 of 42 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.17s]
[0m15:00:37.348498 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:00:37.349499 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:00:37.349499 [info ] [Thread-3 (]: 35 of 42 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:00:37.350499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:00:37.350499 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:00:37.357922 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:00:37.357922 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.132 seconds
[0m15:00:37.360008 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m15:00:37.360008 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.126 seconds
[0m15:00:37.361009 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m15:00:37.362009 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m15:00:37.362009 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m15:00:37.363009 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:00:37.363009 [info ] [Thread-2 (]: 31 of 42 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.22s]
[0m15:00:37.367026 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:00:37.364517 [info ] [Thread-4 (]: 32 of 42 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.22s]
[0m15:00:37.368027 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:00:37.368027 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:00:37.369027 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:00:37.370027 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:00:37.370027 [info ] [Thread-2 (]: 36 of 42 START test unique_dim_customers_customer_id ........................... [RUN]
[0m15:00:37.372028 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:00:37.372028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd)
[0m15:00:37.372028 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.098 seconds
[0m15:00:37.371028 [info ] [Thread-4 (]: 37 of 42 START test unique_dim_products_product_id ............................. [RUN]
[0m15:00:37.373028 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:00:37.373028 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:00:37.375531 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m15:00:37.376033 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_dim_products_product_id.ef7b2a9985)
[0m15:00:37.376033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:37.382818 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:00:37.382818 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:00:37.382818 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m15:00:37.388502 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:37.389505 [info ] [Thread-1 (]: 34 of 42 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.18s]
[0m15:00:37.390508 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:00:37.391717 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:00:37.391717 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:00:37.393113 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:00:37.391717 [info ] [Thread-1 (]: 38 of 42 START test unique_dim_sellers_seller_id ............................... [RUN]
[0m15:00:37.396229 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:00:37.399436 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:37.399436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.unique_dim_sellers_seller_id.b55e677f09)
[0m15:00:37.400437 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:00:37.406771 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:00:37.407772 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:00:37.407772 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd: BEGIN
[0m15:00:37.407772 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:37.409006 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:37.409006 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m15:00:37.410040 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:00:37.410040 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:37.413188 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:00:37.415204 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:00:37.415204 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: BEGIN
[0m15:00:37.416219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:37.456102 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m15:00:37.457133 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd"
[0m15:00:37.457133 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_customers"
where customer_id is not null
group by customer_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.459133 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m15:00:37.459133 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:37.459133 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.462450 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m15:00:37.463453 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:00:37.463453 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.466684 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:37.468687 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: ROLLBACK
[0m15:00:37.468687 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: Close
[0m15:00:37.469730 [info ] [Thread-1 (]: 38 of 42 PASS unique_dim_sellers_seller_id ..................................... [[32mPASS[0m in 0.07s]
[0m15:00:37.469730 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:00:37.471161 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:00:37.471161 [info ] [Thread-1 (]: 39 of 42 START test unique_dim_time_date_day ................................... [RUN]
[0m15:00:37.472163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_sellers_seller_id.b55e677f09, now test.dbt_project.unique_dim_time_date_day.d8637451e0)
[0m15:00:37.472163 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:00:37.478585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:00:37.479589 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:00:37.481849 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:00:37.482850 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m15:00:37.484353 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m15:00:37.484353 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m15:00:37.485354 [info ] [Thread-4 (]: 37 of 42 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.11s]
[0m15:00:37.486167 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:00:37.486167 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:00:37.487587 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:00:37.487587 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: BEGIN
[0m15:00:37.488668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:37.487587 [info ] [Thread-4 (]: 40 of 42 START test unique_stg_orders_order_id ................................. [RUN]
[0m15:00:37.489791 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_products_product_id.ef7b2a9985, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m15:00:37.489791 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:00:37.494638 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:00:37.496156 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:00:37.499646 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:00:37.502005 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:00:37.503054 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:00:37.503054 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:37.544359 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m15:00:37.545362 [debug] [Thread-3 (]: SQL status: BEGIN in 0.169 seconds
[0m15:00:37.545362 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:00:37.545362 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:00:37.546582 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_time_date_day.d8637451e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_time"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.546582 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:00:37.549592 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m15:00:37.549592 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:00:37.549592 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:00:37.551617 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: ROLLBACK
[0m15:00:37.551617 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.552621 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: Close
[0m15:00:37.552621 [info ] [Thread-1 (]: 39 of 42 PASS unique_dim_time_date_day ......................................... [[32mPASS[0m in 0.08s]
[0m15:00:37.554342 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:00:37.555345 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:00:37.556309 [info ] [Thread-1 (]: 41 of 42 START test unique_stg_products_product_id ............................. [RUN]
[0m15:00:37.556309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_time_date_day.d8637451e0, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m15:00:37.557328 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:00:37.562814 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:00:37.565320 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:00:37.568686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:00:37.570675 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:00:37.570675 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m15:00:37.571743 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:37.608233 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.150 seconds
[0m15:00:37.609741 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd: ROLLBACK
[0m15:00:37.609741 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd: Close
[0m15:00:37.610745 [error] [Thread-2 (]: 36 of 42 FAIL 99441 unique_dim_customers_customer_id ........................... [[31mFAIL 99441[0m in 0.24s]
[0m15:00:37.611767 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd
[0m15:00:37.611767 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:00:37.611767 [info ] [Thread-2 (]: 42 of 42 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m15:00:37.612767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m15:00:37.612767 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:00:37.618578 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:00:37.619905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m15:00:37.620909 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:00:37.620909 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.620909 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:00:37.622918 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:00:37.626571 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:00:37.626571 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m15:00:37.626571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:37.647283 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m15:00:37.648286 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m15:00:37.649290 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m15:00:37.649290 [info ] [Thread-1 (]: 41 of 42 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.09s]
[0m15:00:37.650294 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:00:37.657603 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.105 seconds
[0m15:00:37.658614 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:00:37.659618 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:00:37.659618 [info ] [Thread-4 (]: 40 of 42 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m15:00:37.660622 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:00:37.706398 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.159 seconds
[0m15:00:37.707501 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:00:37.708501 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:00:37.708501 [info ] [Thread-3 (]: 35 of 42 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.36s]
[0m15:00:37.709647 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:00:37.767474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.141 seconds
[0m15:00:37.768478 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:00:37.768478 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.771559 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:00:37.772997 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m15:00:37.774501 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m15:00:37.774501 [info ] [Thread-2 (]: 42 of 42 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.16s]
[0m15:00:37.775512 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:00:37.776611 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:37.777613 [debug] [MainThread]: On master: BEGIN
[0m15:00:37.777613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:37.814304 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:00:37.814304 [debug] [MainThread]: On master: COMMIT
[0m15:00:37.815310 [debug] [MainThread]: Using postgres connection "master"
[0m15:00:37.815815 [debug] [MainThread]: On master: COMMIT
[0m15:00:37.815815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:00:37.815815 [debug] [MainThread]: On master: Close
[0m15:00:37.816821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:37.816821 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m15:00:37.816821 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m15:00:37.816821 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m15:00:37.817895 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m15:00:37.817895 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:00:37.817895 [info ] [MainThread]: 
[0m15:00:37.818900 [info ] [MainThread]: Finished running 42 data tests in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m15:00:37.824428 [debug] [MainThread]: Command end result
[0m15:00:37.854340 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:00:37.857375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:00:37.865421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:00:37.865925 [info ] [MainThread]: 
[0m15:00:37.865925 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:00:37.866927 [info ] [MainThread]: 
[0m15:00:37.866927 [error] [MainThread]: [31mFailure in test unique_dim_customers_customer_id (models\staging\_marts_test.yml)[0m
[0m15:00:37.866927 [error] [MainThread]:   Got 99441 results, configured to fail if != 0
[0m15:00:37.868035 [info ] [MainThread]: 
[0m15:00:37.868035 [info ] [MainThread]:   compiled code at target\compiled\dbt_project\models\staging\_marts_test.yml\unique_dim_customers_customer_id.sql
[0m15:00:37.869042 [info ] [MainThread]: 
[0m15:00:37.869042 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=1 SKIP=0 TOTAL=42
[0m15:00:37.870046 [debug] [MainThread]: Command `dbt test` failed at 15:00:37.870046 after 3.32 seconds
[0m15:00:37.871051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2D9FC1A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2BA460C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017C2E24BDA0>]}
[0m15:00:37.871051 [debug] [MainThread]: Flushing usage events
[0m15:00:39.605115 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:30.341232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E1B77980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E1B74800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E1B756D0>]}


============================== 15:01:30.346000 | 27981666-b80d-413b-8c50-5bd1e94b98c6 ==============================
[0m15:01:30.346000 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:01:30.347213 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'no_print': 'None', 'printer_width': '80', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:01:30.539712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E20525D0>]}
[0m15:01:30.594501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E169FF80>]}
[0m15:01:30.595506 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:01:31.000129 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:01:31.200095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:31.200095 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:31.238176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E34EAFC0>]}
[0m15:01:31.308677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:01:31.326684 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:01:31.370050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E34EBFE0>]}
[0m15:01:31.371050 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:01:31.371050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E3BC8770>]}
[0m15:01:31.374408 [info ] [MainThread]: 
[0m15:01:31.375520 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:01:31.376334 [info ] [MainThread]: 
[0m15:01:31.376334 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:01:31.380799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m15:01:31.529522 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:01:31.530522 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m15:01:31.530522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:01:31.577620 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m15:01:31.578623 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:01:31.578623 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:01:31.586673 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.007 seconds
[0m15:01:31.587786 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m15:01:31.587786 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m15:01:31.595294 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:31.595294 [debug] [MainThread]: On master: BEGIN
[0m15:01:31.596320 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:01:31.632127 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:01:31.633353 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:31.633353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:01:31.640291 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m15:01:31.642673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27981666-b80d-413b-8c50-5bd1e94b98c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E3AA2420>]}
[0m15:01:31.642673 [debug] [MainThread]: On master: ROLLBACK
[0m15:01:31.643676 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:31.643676 [debug] [MainThread]: On master: BEGIN
[0m15:01:31.644677 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:01:31.644677 [debug] [MainThread]: On master: COMMIT
[0m15:01:31.645180 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:31.645180 [debug] [MainThread]: On master: COMMIT
[0m15:01:31.645180 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:31.645180 [debug] [MainThread]: On master: Close
[0m15:01:31.650196 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:01:31.650196 [debug] [Thread-2 (]: Began running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:01:31.650196 [debug] [Thread-3 (]: Began running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:01:31.651637 [debug] [Thread-4 (]: Began running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:01:31.651637 [info ] [Thread-1 (]: 1 of 41 START test accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention  [RUN]
[0m15:01:31.651637 [info ] [Thread-2 (]: 2 of 41 START test accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold  [RUN]
[0m15:01:31.652788 [info ] [Thread-3 (]: 3 of 41 START test accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive  [RUN]
[0m15:01:31.652788 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf'
[0m15:01:31.652788 [info ] [Thread-4 (]: 4 of 41 START test accepted_values_dim_time_is_weekend__True__False ............ [RUN]
[0m15:01:31.654291 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68'
[0m15:01:31.654291 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a'
[0m15:01:31.655293 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:01:31.656071 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68'
[0m15:01:31.656071 [debug] [Thread-2 (]: Began compiling node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:01:31.656071 [debug] [Thread-3 (]: Began compiling node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:01:31.671307 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:01:31.672309 [debug] [Thread-4 (]: Began compiling node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:01:31.677698 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:01:31.683142 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:01:31.686160 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:01:31.687514 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:01:31.704476 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:01:31.704476 [debug] [Thread-3 (]: Began executing node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:01:31.705484 [debug] [Thread-2 (]: Began executing node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:01:31.708025 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:01:31.708025 [debug] [Thread-4 (]: Began executing node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:01:31.710234 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:01:31.710234 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:01:31.712241 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:01:31.712241 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: BEGIN
[0m15:01:31.713721 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:01:31.714223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:01:31.714223 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: BEGIN
[0m15:01:31.715225 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:01:31.715729 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:01:31.716078 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:01:31.716078 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: BEGIN
[0m15:01:31.716730 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: BEGIN
[0m15:01:31.716730 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:01:31.717730 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:01:31.758988 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m15:01:31.759988 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:01:31.759988 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        seller_tier as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_sellers"
    group by seller_tier

)

select *
from all_values
where value_field not in (
    'Top Seller','High Volume','Active','Low Volume','Inactive'
)



  
  
      
    ) dbt_internal_test
[0m15:01:31.763111 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m15:01:31.763111 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:01:31.763111 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        sales_category as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_products"
    group by sales_category

)

select *
from all_values
where value_field not in (
    'Best Seller','Popular','Regular','Slow Moving','Never Sold'
)



  
  
      
    ) dbt_internal_test
[0m15:01:31.763111 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:31.767192 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: ROLLBACK
[0m15:01:31.768192 [debug] [Thread-3 (]: On test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a: Close
[0m15:01:31.768192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m15:01:31.769336 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:01:31.770343 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_weekend as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_time"
    group by is_weekend

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m15:01:31.769336 [info ] [Thread-3 (]: 3 of 41 PASS accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive  [[32mPASS[0m in 0.12s]
[0m15:01:31.770343 [debug] [Thread-3 (]: Finished running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:01:31.770343 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:01:31.771675 [info ] [Thread-3 (]: 5 of 41 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m15:01:31.771675 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:01:31.772679 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:01:31.772679 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:01:31.780195 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:01:31.780195 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:01:31.781317 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: ROLLBACK
[0m15:01:31.783408 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: ROLLBACK
[0m15:01:31.783408 [debug] [Thread-4 (]: On test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68: Close
[0m15:01:31.783408 [debug] [Thread-2 (]: On test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68: Close
[0m15:01:31.784409 [info ] [Thread-4 (]: 4 of 41 PASS accepted_values_dim_time_is_weekend__True__False .................. [[32mPASS[0m in 0.13s]
[0m15:01:31.785626 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:01:31.786665 [debug] [Thread-4 (]: Finished running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:01:31.784409 [info ] [Thread-2 (]: 2 of 41 PASS accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold  [[32mPASS[0m in 0.13s]
[0m15:01:31.788666 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:01:31.789774 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:01:31.789774 [debug] [Thread-2 (]: Finished running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:01:31.790777 [info ] [Thread-4 (]: 6 of 41 START test not_null_dim_customers_customer_segment ..................... [RUN]
[0m15:01:31.790777 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:01:31.791792 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68, now test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m15:01:31.791792 [info ] [Thread-2 (]: 7 of 41 START test not_null_dim_customers_customer_unique_id ................... [RUN]
[0m15:01:31.791792 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:01:31.792989 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:01:31.792989 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68, now test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m15:01:31.792989 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: BEGIN
[0m15:01:31.796672 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:01:31.797675 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:01:31.797675 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:31.800685 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:01:31.801688 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:01:31.802967 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:01:31.802967 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:01:31.805975 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:01:31.806726 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:01:31.806726 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: BEGIN
[0m15:01:31.807871 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:31.807871 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:01:31.809256 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: BEGIN
[0m15:01:31.809256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:31.852493 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m15:01:31.853493 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:01:31.853493 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_segment
from "ecommerce_raw"."public"."dim_customers"
where customer_segment is null



  
  
      
    ) dbt_internal_test
[0m15:01:31.855814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.142 seconds
[0m15:01:31.856828 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:01:31.856828 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        customer_segment as value_field,
        count(*) as n_records

    from "ecommerce_raw"."public"."dim_customers"
    group by customer_segment

)

select *
from all_values
where value_field not in (
    'Champion','Loyal','Potential','At Risk','Needs Attention'
)



  
  
      
    ) dbt_internal_test
[0m15:01:31.907356 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.054 seconds
[0m15:01:31.909761 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: ROLLBACK
[0m15:01:31.909761 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba: Close
[0m15:01:31.909761 [info ] [Thread-4 (]: 6 of 41 PASS not_null_dim_customers_customer_segment ........................... [[32mPASS[0m in 0.12s]
[0m15:01:31.911153 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:01:31.912195 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:01:31.912195 [info ] [Thread-4 (]: 8 of 41 START test not_null_dim_customers_lifetime_orders ...................... [RUN]
[0m15:01:31.913198 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m15:01:31.913198 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:01:31.917247 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:01:31.918250 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:01:31.920826 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:01:31.920826 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m15:01:31.922832 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: ROLLBACK
[0m15:01:31.922832 [debug] [Thread-1 (]: On test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf: Close
[0m15:01:31.922832 [info ] [Thread-1 (]: 1 of 41 PASS accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention  [[32mPASS[0m in 0.27s]
[0m15:01:31.924335 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:01:31.924335 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:01:31.925336 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: BEGIN
[0m15:01:31.926057 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:01:31.926057 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:31.926561 [info ] [Thread-1 (]: 9 of 41 START test not_null_dim_customers_lifetime_value ....................... [RUN]
[0m15:01:31.927564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf, now test.dbt_project.not_null_dim_customers_lifetime_value.8655024888)
[0m15:01:31.927564 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:01:31.930572 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:01:31.932579 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:01:31.936099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:01:31.938133 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:01:31.938133 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: BEGIN
[0m15:01:31.938133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:31.955938 [debug] [Thread-3 (]: SQL status: BEGIN in 0.158 seconds
[0m15:01:31.955938 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:01:31.955938 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."dim_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:31.970206 [debug] [Thread-2 (]: SQL status: BEGIN in 0.161 seconds
[0m15:01:31.971358 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:01:31.971358 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."dim_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:31.977386 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m15:01:31.978492 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:01:31.979492 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_orders
from "ecommerce_raw"."public"."dim_customers"
where lifetime_orders is null



  
  
      
    ) dbt_internal_test
[0m15:01:31.986985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m15:01:31.987985 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:01:31.987985 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select lifetime_value
from "ecommerce_raw"."public"."dim_customers"
where lifetime_value is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.015393 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.058 seconds
[0m15:01:32.017408 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: ROLLBACK
[0m15:01:32.018408 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d: Close
[0m15:01:32.019912 [info ] [Thread-3 (]: 5 of 41 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 0.25s]
[0m15:01:32.021362 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:01:32.021362 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:01:32.022362 [info ] [Thread-3 (]: 10 of 41 START test not_null_dim_products_product_id ........................... [RUN]
[0m15:01:32.023362 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_dim_products_product_id.c8aba288d1)
[0m15:01:32.024363 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:01:32.030387 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:01:32.031387 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:01:32.034894 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:01:32.036353 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:01:32.036353 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: BEGIN
[0m15:01:32.037409 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.042752 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.070 seconds
[0m15:01:32.044255 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: ROLLBACK
[0m15:01:32.045258 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d: Close
[0m15:01:32.046313 [info ] [Thread-2 (]: 7 of 41 PASS not_null_dim_customers_customer_unique_id ......................... [[32mPASS[0m in 0.25s]
[0m15:01:32.046313 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:01:32.047429 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:01:32.048457 [info ] [Thread-2 (]: 11 of 41 START test not_null_dim_products_sales_category ....................... [RUN]
[0m15:01:32.048457 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_project.not_null_dim_products_sales_category.882d9c4faa)
[0m15:01:32.048457 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:01:32.054642 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:01:32.055154 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.076 seconds
[0m15:01:32.057169 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: ROLLBACK
[0m15:01:32.057169 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3: Close
[0m15:01:32.058505 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:01:32.058505 [info ] [Thread-4 (]: 8 of 41 PASS not_null_dim_customers_lifetime_orders ............................ [[32mPASS[0m in 0.15s]
[0m15:01:32.062508 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:01:32.062508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.074 seconds
[0m15:01:32.063508 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:01:32.064509 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: ROLLBACK
[0m15:01:32.065560 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:01:32.066571 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:01:32.066571 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_customers_lifetime_value.8655024888: Close
[0m15:01:32.065560 [info ] [Thread-4 (]: 12 of 41 START test not_null_dim_products_times_sold ........................... [RUN]
[0m15:01:32.067573 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: BEGIN
[0m15:01:32.067573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a)
[0m15:01:32.068573 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.068573 [info ] [Thread-1 (]: 9 of 41 PASS not_null_dim_customers_lifetime_value ............................. [[32mPASS[0m in 0.14s]
[0m15:01:32.069573 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:01:32.069573 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:01:32.074526 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:01:32.074526 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:01:32.075539 [info ] [Thread-1 (]: 13 of 41 START test not_null_dim_sellers_seller_id ............................. [RUN]
[0m15:01:32.076445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_value.8655024888, now test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c)
[0m15:01:32.076445 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:01:32.082699 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:01:32.083699 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:01:32.087439 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:01:32.087439 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:01:32.088754 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m15:01:32.092013 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:01:32.092013 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:01:32.092013 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:01:32.093214 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."dim_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.093214 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: BEGIN
[0m15:01:32.093214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.094717 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:01:32.095231 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: BEGIN
[0m15:01:32.095231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.100481 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:01:32.102725 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: ROLLBACK
[0m15:01:32.102725 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_products_product_id.c8aba288d1: Close
[0m15:01:32.104229 [info ] [Thread-3 (]: 10 of 41 PASS not_null_dim_products_product_id ................................. [[32mPASS[0m in 0.08s]
[0m15:01:32.105231 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:01:32.105736 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:01:32.105736 [info ] [Thread-3 (]: 14 of 41 START test not_null_dim_sellers_seller_tier ........................... [RUN]
[0m15:01:32.106738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_product_id.c8aba288d1, now test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d)
[0m15:01:32.106738 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:01:32.112772 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:01:32.112772 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:01:32.116814 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:01:32.117807 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:01:32.117807 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: BEGIN
[0m15:01:32.119310 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.119310 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m15:01:32.120337 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:01:32.120337 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sales_category
from "ecommerce_raw"."public"."dim_products"
where sales_category is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.129071 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.009 seconds
[0m15:01:32.131426 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: ROLLBACK
[0m15:01:32.132570 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_products_sales_category.882d9c4faa: Close
[0m15:01:32.132570 [info ] [Thread-2 (]: 11 of 41 PASS not_null_dim_products_sales_category ............................. [[32mPASS[0m in 0.08s]
[0m15:01:32.133574 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:01:32.134574 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:01:32.135077 [info ] [Thread-2 (]: 15 of 41 START test not_null_dim_sellers_state ................................. [RUN]
[0m15:01:32.136089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_sales_category.882d9c4faa, now test.dbt_project.not_null_dim_sellers_state.e0c340c724)
[0m15:01:32.136089 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:01:32.140377 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:01:32.141383 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m15:01:32.142387 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:01:32.142387 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select times_sold
from "ecommerce_raw"."public"."dim_products"
where times_sold is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.143407 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:01:32.145562 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:01:32.146523 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:01:32.146523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m15:01:32.147578 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: BEGIN
[0m15:01:32.147578 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:01:32.148578 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.148578 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."dim_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.150578 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m15:01:32.151747 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: ROLLBACK
[0m15:01:32.152747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:32.152747 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: ROLLBACK
[0m15:01:32.154251 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a: Close
[0m15:01:32.154251 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c: Close
[0m15:01:32.155253 [info ] [Thread-4 (]: 12 of 41 PASS not_null_dim_products_times_sold ................................. [[32mPASS[0m in 0.09s]
[0m15:01:32.156298 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:01:32.155253 [info ] [Thread-1 (]: 13 of 41 PASS not_null_dim_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m15:01:32.156298 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:01:32.157301 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:01:32.158305 [info ] [Thread-4 (]: 16 of 41 START test not_null_dim_sellers_total_orders .......................... [RUN]
[0m15:01:32.158305 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:01:32.159413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a, now test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b)
[0m15:01:32.159413 [info ] [Thread-1 (]: 17 of 41 START test not_null_dim_time_date_day ................................. [RUN]
[0m15:01:32.160417 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:01:32.160417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c, now test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa)
[0m15:01:32.164568 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:01:32.165071 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:01:32.169972 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:01:32.170975 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m15:01:32.170975 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:01:32.171985 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:01:32.222249 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:01:32.222249 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:01:32.223611 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_tier
from "ecommerce_raw"."public"."dim_sellers"
where seller_tier is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.225121 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:01:32.225804 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:01:32.226836 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: BEGIN
[0m15:01:32.226836 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.226836 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:01:32.228123 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: BEGIN
[0m15:01:32.228123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.228123 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:32.230406 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: ROLLBACK
[0m15:01:32.230406 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d: Close
[0m15:01:32.231823 [info ] [Thread-3 (]: 14 of 41 PASS not_null_dim_sellers_seller_tier ................................. [[32mPASS[0m in 0.13s]
[0m15:01:32.232854 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:01:32.232854 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:01:32.232854 [info ] [Thread-3 (]: 18 of 41 START test not_null_dim_time_is_weekend ............................... [RUN]
[0m15:01:32.234358 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d, now test.dbt_project.not_null_dim_time_is_weekend.f294374ebd)
[0m15:01:32.234358 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:01:32.239782 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:01:32.240793 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:01:32.244317 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:01:32.245319 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:01:32.246382 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: BEGIN
[0m15:01:32.246382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.273665 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m15:01:32.273665 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:01:32.273665 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select total_orders
from "ecommerce_raw"."public"."dim_sellers"
where total_orders is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.275895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m15:01:32.275895 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:01:32.275895 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select date_day
from "ecommerce_raw"."public"."dim_time"
where date_day is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.275895 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:01:32.278180 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: ROLLBACK
[0m15:01:32.278180 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:01:32.279395 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: ROLLBACK
[0m15:01:32.280398 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b: Close
[0m15:01:32.280398 [debug] [Thread-1 (]: On test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa: Close
[0m15:01:32.280398 [info ] [Thread-4 (]: 16 of 41 PASS not_null_dim_sellers_total_orders ................................ [[32mPASS[0m in 0.12s]
[0m15:01:32.281744 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:01:32.281744 [info ] [Thread-1 (]: 17 of 41 PASS not_null_dim_time_date_day ....................................... [[32mPASS[0m in 0.12s]
[0m15:01:32.282795 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:01:32.282795 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:01:32.282795 [info ] [Thread-4 (]: 19 of 41 START test not_null_dim_time_year ..................................... [RUN]
[0m15:01:32.284298 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:01:32.284298 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b, now test.dbt_project.not_null_dim_time_year.6fb9595d53)
[0m15:01:32.285298 [info ] [Thread-1 (]: 20 of 41 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m15:01:32.285801 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:01:32.285801 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa, now test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:01:32.289940 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:01:32.289940 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:01:32.289940 [debug] [Thread-2 (]: SQL status: BEGIN in 0.142 seconds
[0m15:01:32.289940 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m15:01:32.294390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:01:32.294894 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:01:32.295397 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:01:32.296101 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_sellers_state.e0c340c724"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state
from "ecommerce_raw"."public"."dim_sellers"
where state is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.296406 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:01:32.296406 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select is_weekend
from "ecommerce_raw"."public"."dim_time"
where is_weekend is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.299408 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:01:32.299408 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:01:32.299408 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:32.301732 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:01:32.301732 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:01:32.302913 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: ROLLBACK
[0m15:01:32.305422 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: ROLLBACK
[0m15:01:32.305422 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:01:32.305422 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: BEGIN
[0m15:01:32.305422 [debug] [Thread-2 (]: On test.dbt_project.not_null_dim_sellers_state.e0c340c724: Close
[0m15:01:32.306748 [debug] [Thread-3 (]: On test.dbt_project.not_null_dim_time_is_weekend.f294374ebd: Close
[0m15:01:32.306748 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.307751 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:01:32.307751 [info ] [Thread-2 (]: 15 of 41 PASS not_null_dim_sellers_state ....................................... [[32mPASS[0m in 0.17s]
[0m15:01:32.309131 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: BEGIN
[0m15:01:32.309131 [info ] [Thread-3 (]: 18 of 41 PASS not_null_dim_time_is_weekend ..................................... [[32mPASS[0m in 0.07s]
[0m15:01:32.310160 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:01:32.310160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.311163 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:01:32.311163 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:01:32.312163 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:01:32.312163 [info ] [Thread-2 (]: 21 of 41 START test not_null_stg_customers_customer_unique_id .................. [RUN]
[0m15:01:32.312163 [info ] [Thread-3 (]: 22 of 41 START test not_null_stg_items_ordered_item_id ......................... [RUN]
[0m15:01:32.313392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_state.e0c340c724, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m15:01:32.313392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_is_weekend.f294374ebd, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m15:01:32.314392 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:01:32.314392 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:01:32.319499 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:01:32.324594 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:01:32.326115 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:01:32.326115 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:01:32.328122 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:01:32.332245 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:01:32.333274 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:01:32.334273 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: BEGIN
[0m15:01:32.334777 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.335280 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:01:32.335280 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: BEGIN
[0m15:01:32.336010 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.352754 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m15:01:32.354258 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:01:32.354258 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_dim_time_year.6fb9595d53"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "ecommerce_raw"."public"."dim_time"
where year is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.357332 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:01:32.358340 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: ROLLBACK
[0m15:01:32.359340 [debug] [Thread-4 (]: On test.dbt_project.not_null_dim_time_year.6fb9595d53: Close
[0m15:01:32.360340 [info ] [Thread-4 (]: 19 of 41 PASS not_null_dim_time_year ........................................... [[32mPASS[0m in 0.08s]
[0m15:01:32.360340 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:01:32.361341 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:01:32.361341 [info ] [Thread-4 (]: 23 of 41 START test not_null_stg_items_ordered_order_id ........................ [RUN]
[0m15:01:32.362341 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_year.6fb9595d53, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m15:01:32.362341 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:01:32.366357 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:01:32.367358 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:01:32.369359 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:01:32.371656 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:01:32.371656 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: BEGIN
[0m15:01:32.371656 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.380785 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m15:01:32.382033 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:01:32.382033 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_unique_id
from "ecommerce_raw"."public"."stg_customers"
where customer_unique_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.382033 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m15:01:32.383033 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:01:32.383033 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select item_id
from "ecommerce_raw"."public"."stg_items_ordered"
where item_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.432735 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.049 seconds
[0m15:01:32.435249 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: ROLLBACK
[0m15:01:32.435753 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505: Close
[0m15:01:32.436756 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.054 seconds
[0m15:01:32.435753 [info ] [Thread-3 (]: 22 of 41 PASS not_null_stg_items_ordered_item_id ............................... [[32mPASS[0m in 0.12s]
[0m15:01:32.438762 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: ROLLBACK
[0m15:01:32.438762 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:01:32.439765 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:01:32.439765 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba: Close
[0m15:01:32.439765 [info ] [Thread-3 (]: 24 of 41 START test not_null_stg_items_ordered_product_id ...................... [RUN]
[0m15:01:32.440768 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m15:01:32.440768 [info ] [Thread-2 (]: 21 of 41 PASS not_null_stg_customers_customer_unique_id ........................ [[32mPASS[0m in 0.13s]
[0m15:01:32.441771 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:01:32.441771 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:01:32.446093 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:01:32.446596 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:01:32.446596 [info ] [Thread-2 (]: 25 of 41 START test not_null_stg_items_ordered_seller_id ....................... [RUN]
[0m15:01:32.447599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m15:01:32.447599 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:01:32.451746 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:01:32.451746 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:01:32.454250 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:01:32.454250 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:01:32.457309 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:01:32.458312 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:01:32.458312 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: BEGIN
[0m15:01:32.458312 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.459318 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:01:32.459318 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: BEGIN
[0m15:01:32.459318 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.465608 [debug] [Thread-1 (]: SQL status: BEGIN in 0.155 seconds
[0m15:01:32.466532 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:01:32.466532 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_customers"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.493215 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m15:01:32.495224 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: ROLLBACK
[0m15:01:32.495224 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m15:01:32.496556 [info ] [Thread-1 (]: 20 of 41 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.21s]
[0m15:01:32.497666 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:01:32.497666 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:01:32.498695 [info ] [Thread-1 (]: 26 of 41 START test not_null_stg_order_payment_order_id ........................ [RUN]
[0m15:01:32.498695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m15:01:32.499742 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:01:32.502742 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:01:32.504245 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:01:32.506058 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:01:32.507071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m15:01:32.508135 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:01:32.508135 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:01:32.508135 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:01:32.509136 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:01:32.509136 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_items_ordered"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.510148 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_items_ordered"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.510148 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: BEGIN
[0m15:01:32.511257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.534321 [debug] [Thread-4 (]: SQL status: BEGIN in 0.162 seconds
[0m15:01:32.535323 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:01:32.535826 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_items_ordered"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.582137 [debug] [Thread-1 (]: SQL status: BEGIN in 0.071 seconds
[0m15:01:32.583177 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:01:32.583177 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_order_payment"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.585195 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.075 seconds
[0m15:01:32.587753 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: ROLLBACK
[0m15:01:32.587753 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879: Close
[0m15:01:32.588782 [info ] [Thread-2 (]: 25 of 41 PASS not_null_stg_items_ordered_seller_id ............................. [[32mPASS[0m in 0.14s]
[0m15:01:32.589787 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:01:32.590787 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:01:32.590787 [info ] [Thread-2 (]: 27 of 41 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m15:01:32.590787 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:01:32.592141 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:01:32.597379 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:01:32.597379 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.087 seconds
[0m15:01:32.599463 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: ROLLBACK
[0m15:01:32.599463 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f: Close
[0m15:01:32.600467 [info ] [Thread-3 (]: 24 of 41 PASS not_null_stg_items_ordered_product_id ............................ [[32mPASS[0m in 0.16s]
[0m15:01:32.601525 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:01:32.601525 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:01:32.605150 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:01:32.605150 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:01:32.606344 [info ] [Thread-3 (]: 28 of 41 START test not_null_stg_orders_order_id ............................... [RUN]
[0m15:01:32.606344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:01:32.607444 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:01:32.613649 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:01:32.614649 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:01:32.615153 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.079 seconds
[0m15:01:32.615153 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.031 seconds
[0m15:01:32.615928 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: BEGIN
[0m15:01:32.616433 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: ROLLBACK
[0m15:01:32.618440 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: ROLLBACK
[0m15:01:32.618440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.618440 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:01:32.619943 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f: Close
[0m15:01:32.619943 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947: Close
[0m15:01:32.622052 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:01:32.623055 [info ] [Thread-1 (]: 26 of 41 PASS not_null_stg_order_payment_order_id .............................. [[32mPASS[0m in 0.12s]
[0m15:01:32.623055 [info ] [Thread-4 (]: 23 of 41 PASS not_null_stg_items_ordered_order_id .............................. [[32mPASS[0m in 0.26s]
[0m15:01:32.624559 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:01:32.625073 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:01:32.625073 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:01:32.626103 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:01:32.627137 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:01:32.626103 [info ] [Thread-1 (]: 29 of 41 START test not_null_stg_products_product_id ........................... [RUN]
[0m15:01:32.628128 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: BEGIN
[0m15:01:32.627137 [info ] [Thread-4 (]: 30 of 41 START test not_null_stg_sellers_seller_id ............................. [RUN]
[0m15:01:32.629190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m15:01:32.629190 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.630210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m15:01:32.630210 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:01:32.630210 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:01:32.634251 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:01:32.641109 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:01:32.642109 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:01:32.645405 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:01:32.646455 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:01:32.648463 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:01:32.650470 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:01:32.650470 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: BEGIN
[0m15:01:32.650470 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.651581 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:01:32.651581 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: BEGIN
[0m15:01:32.652581 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.672808 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m15:01:32.672808 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:01:32.672808 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from "ecommerce_raw"."public"."stg_orders"
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.678053 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:01:32.679057 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:01:32.679057 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from "ecommerce_raw"."public"."stg_orders"
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.695903 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m15:01:32.696406 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:01:32.696406 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from "ecommerce_raw"."public"."stg_products"
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.698414 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m15:01:32.699577 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:01:32.699577 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select seller_id
from "ecommerce_raw"."public"."stg_sellers"
where seller_id is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.703161 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:32.704161 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: ROLLBACK
[0m15:01:32.705556 [debug] [Thread-4 (]: On test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315: Close
[0m15:01:32.706611 [info ] [Thread-4 (]: 30 of 41 PASS not_null_stg_sellers_seller_id ................................... [[32mPASS[0m in 0.08s]
[0m15:01:32.707614 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:01:32.707614 [debug] [Thread-4 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:01:32.708618 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m15:01:32.708618 [info ] [Thread-4 (]: 31 of 41 START test relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:01:32.710624 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: ROLLBACK
[0m15:01:32.710624 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.032 seconds
[0m15:01:32.711628 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.037 seconds
[0m15:01:32.711628 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m15:01:32.713635 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: ROLLBACK
[0m15:01:32.713635 [debug] [Thread-1 (]: On test.dbt_project.not_null_stg_products_product_id.6373b0acf3: Close
[0m15:01:32.715139 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: ROLLBACK
[0m15:01:32.715139 [debug] [Thread-4 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:01:32.715882 [debug] [Thread-3 (]: On test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m15:01:32.715882 [debug] [Thread-2 (]: On test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m15:01:32.715882 [info ] [Thread-1 (]: 29 of 41 PASS not_null_stg_products_product_id ................................. [[32mPASS[0m in 0.09s]
[0m15:01:32.725509 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:01:32.726519 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:01:32.727676 [info ] [Thread-3 (]: 28 of 41 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.12s]
[0m15:01:32.728679 [info ] [Thread-2 (]: 27 of 41 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.14s]
[0m15:01:32.728679 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:01:32.729976 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:01:32.729976 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:01:32.731176 [debug] [Thread-4 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:01:32.731176 [info ] [Thread-1 (]: 32 of 41 START test relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [RUN]
[0m15:01:32.732563 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:01:32.732563 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:01:32.735892 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:01:32.737080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m15:01:32.737080 [info ] [Thread-3 (]: 33 of 41 START test relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [RUN]
[0m15:01:32.738302 [info ] [Thread-2 (]: 34 of 41 START test relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [RUN]
[0m15:01:32.738302 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:01:32.739305 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m15:01:32.739305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m15:01:32.747476 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:01:32.747476 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:01:32.748479 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:01:32.748479 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:01:32.749512 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: BEGIN
[0m15:01:32.755156 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:01:32.759224 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:01:32.760224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.760224 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:01:32.763499 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:01:32.764500 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:01:32.764500 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:01:32.769383 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:01:32.771484 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:01:32.772485 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:01:32.773517 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: BEGIN
[0m15:01:32.773517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:32.774517 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:01:32.774517 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:01:32.775841 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: BEGIN
[0m15:01:32.775841 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: BEGIN
[0m15:01:32.775841 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.777079 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.810648 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m15:01:32.810648 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:01:32.811648 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.818227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m15:01:32.818227 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:01:32.819229 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select product_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where product_id is not null
),

parent as (
    select product_id as to_field
    from "ecommerce_raw"."public"."stg_products"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.820732 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m15:01:32.820732 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:01:32.821733 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select seller_id as from_field
    from "ecommerce_raw"."public"."stg_items_ordered"
    where seller_id is not null
),

parent as (
    select seller_id as to_field
    from "ecommerce_raw"."public"."stg_sellers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.826748 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m15:01:32.827748 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:01:32.828748 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select order_id as from_field
    from "ecommerce_raw"."public"."stg_order_payment"
    where order_id is not null
),

parent as (
    select order_id as to_field
    from "ecommerce_raw"."public"."stg_orders"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:01:32.920497 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.099 seconds
[0m15:01:32.922623 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: ROLLBACK
[0m15:01:32.923653 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87: Close
[0m15:01:32.924654 [info ] [Thread-3 (]: 33 of 41 PASS relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_  [[32mPASS[0m in 0.18s]
[0m15:01:32.925158 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:01:32.925158 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:01:32.926414 [info ] [Thread-3 (]: 35 of 41 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m15:01:32.927417 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:01:32.927417 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:01:32.927417 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.109 seconds
[0m15:01:32.932974 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:01:32.932974 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.105 seconds
[0m15:01:32.934478 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.122 seconds
[0m15:01:32.935480 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: ROLLBACK
[0m15:01:32.936196 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: ROLLBACK
[0m15:01:32.937484 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: ROLLBACK
[0m15:01:32.938487 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:01:32.938487 [debug] [Thread-2 (]: On test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8: Close
[0m15:01:32.939687 [debug] [Thread-4 (]: On test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b: Close
[0m15:01:32.939687 [debug] [Thread-1 (]: On test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c: Close
[0m15:01:32.941725 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:01:32.942728 [info ] [Thread-2 (]: 34 of 41 PASS relationships_stg_order_payment_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.20s]
[0m15:01:32.942728 [info ] [Thread-4 (]: 31 of 41 PASS relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_  [[32mPASS[0m in 0.23s]
[0m15:01:32.944231 [info ] [Thread-1 (]: 32 of 41 PASS relationships_stg_items_ordered_product_id__product_id__ref_stg_products_  [[32mPASS[0m in 0.21s]
[0m15:01:32.945232 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:01:32.945232 [debug] [Thread-4 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:01:32.946351 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:01:32.946351 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:01:32.947390 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:01:32.948390 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:01:32.948390 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:01:32.949391 [info ] [Thread-2 (]: 36 of 41 START test unique_dim_products_product_id ............................. [RUN]
[0m15:01:32.950391 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: BEGIN
[0m15:01:32.949391 [info ] [Thread-4 (]: 37 of 41 START test unique_dim_sellers_seller_id ............................... [RUN]
[0m15:01:32.951392 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.unique_dim_products_product_id.ef7b2a9985)
[0m15:01:32.951392 [info ] [Thread-1 (]: 38 of 41 START test unique_dim_time_date_day ................................... [RUN]
[0m15:01:32.951392 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:01:32.952646 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now test.dbt_project.unique_dim_sellers_seller_id.b55e677f09)
[0m15:01:32.952646 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:01:32.953649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.unique_dim_time_date_day.d8637451e0)
[0m15:01:32.953649 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:01:32.961034 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:01:32.962037 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:01:32.966297 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:01:32.971649 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:01:32.971649 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:01:32.975105 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:01:32.975852 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:01:32.975852 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:01:32.979224 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:01:32.981374 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:01:32.982441 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:01:32.982441 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: BEGIN
[0m15:01:32.983620 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:32.983620 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:01:32.984620 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: BEGIN
[0m15:01:32.985123 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:01:32.985123 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:32.985123 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: BEGIN
[0m15:01:32.986363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:33.009830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m15:01:33.010830 [debug] [Thread-3 (]: Using postgres connection "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:01:33.010830 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select customer_id as from_field
    from "ecommerce_raw"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "ecommerce_raw"."public"."stg_customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m15:01:33.046811 [debug] [Thread-2 (]: SQL status: BEGIN in 0.064 seconds
[0m15:01:33.047836 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:01:33.048849 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.061595 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m15:01:33.062595 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:01:33.062595 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.063934 [debug] [Thread-1 (]: SQL status: BEGIN in 0.077 seconds
[0m15:01:33.064438 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:01:33.064438 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_dim_time_date_day.d8637451e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    date_day as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."dim_time"
where date_day is not null
group by date_day
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.067638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:01:33.069769 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: ROLLBACK
[0m15:01:33.069769 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m15:01:33.070769 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: ROLLBACK
[0m15:01:33.071769 [debug] [Thread-1 (]: On test.dbt_project.unique_dim_time_date_day.d8637451e0: Close
[0m15:01:33.071769 [debug] [Thread-4 (]: On test.dbt_project.unique_dim_sellers_seller_id.b55e677f09: Close
[0m15:01:33.072769 [info ] [Thread-1 (]: 38 of 41 PASS unique_dim_time_date_day ......................................... [[32mPASS[0m in 0.12s]
[0m15:01:33.072769 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:01:33.072769 [info ] [Thread-4 (]: 37 of 41 PASS unique_dim_sellers_seller_id ..................................... [[32mPASS[0m in 0.12s]
[0m15:01:33.074275 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:01:33.075277 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.026 seconds
[0m15:01:33.075782 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:01:33.078784 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: ROLLBACK
[0m15:01:33.076784 [info ] [Thread-1 (]: 39 of 41 START test unique_stg_orders_order_id ................................. [RUN]
[0m15:01:33.079784 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:01:33.079784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_time_date_day.d8637451e0, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m15:01:33.081007 [debug] [Thread-2 (]: On test.dbt_project.unique_dim_products_product_id.ef7b2a9985: Close
[0m15:01:33.081007 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:01:33.081007 [info ] [Thread-4 (]: 40 of 41 START test unique_stg_products_product_id ............................. [RUN]
[0m15:01:33.088033 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:01:33.089194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_sellers_seller_id.b55e677f09, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m15:01:33.089194 [info ] [Thread-2 (]: 36 of 41 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 0.14s]
[0m15:01:33.090684 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:01:33.090684 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:01:33.096850 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:01:33.097850 [debug] [Thread-2 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:01:33.098850 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:01:33.101851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:01:33.098850 [info ] [Thread-2 (]: 41 of 41 START test unique_stg_sellers_seller_id ............................... [RUN]
[0m15:01:33.102851 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:01:33.102851 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_products_product_id.ef7b2a9985, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m15:01:33.105889 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:01:33.106804 [debug] [Thread-2 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:01:33.106804 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:01:33.110892 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:01:33.110892 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: BEGIN
[0m15:01:33.111892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:01:33.111892 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:01:33.111892 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: BEGIN
[0m15:01:33.113260 [debug] [Thread-2 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:01:33.114267 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:01:33.118107 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:01:33.119110 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:01:33.120614 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: BEGIN
[0m15:01:33.121636 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:01:33.144550 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.132 seconds
[0m15:01:33.145810 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: ROLLBACK
[0m15:01:33.146970 [debug] [Thread-3 (]: On test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m15:01:33.146970 [info ] [Thread-3 (]: 35 of 41 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.22s]
[0m15:01:33.147974 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:01:33.164263 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m15:01:33.164263 [debug] [Thread-1 (]: Using postgres connection "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:01:33.165578 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    order_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_orders"
where order_id is not null
group by order_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.167603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m15:01:33.167603 [debug] [Thread-4 (]: Using postgres connection "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:01:33.168627 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_products_product_id.7d950a1467"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    product_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_products"
where product_id is not null
group by product_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.172628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.052 seconds
[0m15:01:33.173628 [debug] [Thread-2 (]: Using postgres connection "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:01:33.173628 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    seller_id as unique_field,
    count(*) as n_records

from "ecommerce_raw"."public"."stg_sellers"
where seller_id is not null
group by seller_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:01:33.178146 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:01:33.180146 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: ROLLBACK
[0m15:01:33.180146 [debug] [Thread-2 (]: On test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8: Close
[0m15:01:33.181147 [info ] [Thread-2 (]: 41 of 41 PASS unique_stg_sellers_seller_id ..................................... [[32mPASS[0m in 0.08s]
[0m15:01:33.182147 [debug] [Thread-2 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:01:33.191333 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m15:01:33.193334 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: ROLLBACK
[0m15:01:33.194334 [debug] [Thread-4 (]: On test.dbt_project.unique_stg_products_product_id.7d950a1467: Close
[0m15:01:33.194838 [info ] [Thread-4 (]: 40 of 41 PASS unique_stg_products_product_id ................................... [[32mPASS[0m in 0.11s]
[0m15:01:33.195341 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:01:33.246518 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.080 seconds
[0m15:01:33.247521 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: ROLLBACK
[0m15:01:33.248520 [debug] [Thread-1 (]: On test.dbt_project.unique_stg_orders_order_id.e3b841c71a: Close
[0m15:01:33.248520 [info ] [Thread-1 (]: 39 of 41 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 0.17s]
[0m15:01:33.249628 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:01:33.250628 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:33.251629 [debug] [MainThread]: On master: BEGIN
[0m15:01:33.251629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:01:33.291270 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m15:01:33.291270 [debug] [MainThread]: On master: COMMIT
[0m15:01:33.291270 [debug] [MainThread]: Using postgres connection "master"
[0m15:01:33.291270 [debug] [MainThread]: On master: COMMIT
[0m15:01:33.292624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:01:33.292624 [debug] [MainThread]: On master: Close
[0m15:01:33.293630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:01:33.293630 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m15:01:33.294629 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m15:01:33.294629 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8' was properly closed.
[0m15:01:33.295135 [debug] [MainThread]: Connection 'test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m15:01:33.295135 [debug] [MainThread]: Connection 'test.dbt_project.unique_stg_products_product_id.7d950a1467' was properly closed.
[0m15:01:33.295987 [info ] [MainThread]: 
[0m15:01:33.295987 [info ] [MainThread]: Finished running 41 data tests in 0 hours 0 minutes and 1.92 seconds (1.92s).
[0m15:01:33.303187 [debug] [MainThread]: Command end result
[0m15:01:33.331005 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:01:33.334616 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:01:33.342137 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:01:33.342137 [info ] [MainThread]: 
[0m15:01:33.342137 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:01:33.343484 [info ] [MainThread]: 
[0m15:01:33.343484 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 TOTAL=41
[0m15:01:33.345489 [debug] [MainThread]: Command `dbt test` succeeded at 15:01:33.344488 after 3.10 seconds
[0m15:01:33.345489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E1AA8B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E405A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8E14C02C0>]}
[0m15:01:33.345489 [debug] [MainThread]: Flushing usage events
[0m15:01:36.139794 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:41.908653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECDCC6BD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECDCC6D20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECD481370>]}


============================== 15:03:41.914150 | d4793773-afc5-4413-bc21-a0e7e9bfb38d ==============================
[0m15:03:41.914150 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:03:41.915595 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'write_json': 'True', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --select _marts_test.yml', 'cache_selected_only': 'False', 'target_path': 'None'}
[0m15:03:42.128206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4793773-afc5-4413-bc21-a0e7e9bfb38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECDCF8F50>]}
[0m15:03:42.180007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4793773-afc5-4413-bc21-a0e7e9bfb38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECB0F4590>]}
[0m15:03:42.183397 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:03:42.612907 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:03:42.847317 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:42.848318 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:42.885019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4793773-afc5-4413-bc21-a0e7e9bfb38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECF327440>]}
[0m15:03:42.955471 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:03:42.977849 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:03:43.035073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4793773-afc5-4413-bc21-a0e7e9bfb38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECF2E4DA0>]}
[0m15:03:43.036157 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:03:43.036157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4793773-afc5-4413-bc21-a0e7e9bfb38d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECF3265D0>]}
[0m15:03:43.037344 [warn ] [MainThread]: The selection criterion '_marts_test.yml' does not match any enabled nodes
[0m15:03:43.038347 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:03:43.039850 [debug] [MainThread]: Command end result
[0m15:03:43.067653 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:03:43.070671 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:03:43.073682 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:03:43.074683 [debug] [MainThread]: Command `dbt test` succeeded at 15:03:43.073682 after 1.32 seconds
[0m15:03:43.074683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECAEBFD70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECF6C10D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ECB97E000>]}
[0m15:03:43.074683 [debug] [MainThread]: Flushing usage events
[0m15:03:44.745051 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:20.999089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA66E7C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA46CE9C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA7113D70>]}


============================== 15:04:21.004259 | 1a1d436f-d591-48c7-80bf-d83d8b118926 ==============================
[0m15:04:21.004259 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:04:21.004259 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test --select marts/_marts_test.yml', 'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'warn_error': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:04:21.192121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a1d436f-d591-48c7-80bf-d83d8b118926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA6C419A0>]}
[0m15:04:21.243308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a1d436f-d591-48c7-80bf-d83d8b118926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA767A330>]}
[0m15:04:21.245319 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:04:21.653764 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:04:21.850992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:21.850992 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:21.888996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1d436f-d591-48c7-80bf-d83d8b118926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA7819A60>]}
[0m15:04:21.962277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:04:21.979961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:04:22.024845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1d436f-d591-48c7-80bf-d83d8b118926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA9192090>]}
[0m15:04:22.024845 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:04:22.025845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1d436f-d591-48c7-80bf-d83d8b118926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA8E33290>]}
[0m15:04:22.028761 [warn ] [MainThread]: The selection criterion 'marts/_marts_test.yml' does not match any enabled nodes
[0m15:04:22.029888 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:04:22.032015 [debug] [MainThread]: Command end result
[0m15:04:22.058290 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:04:22.060847 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:04:22.064589 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:04:22.065678 [debug] [MainThread]: Command `dbt test` succeeded at 15:04:22.065678 after 1.16 seconds
[0m15:04:22.065678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA4C7C890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA6A43170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AA6A196A0>]}
[0m15:04:22.065678 [debug] [MainThread]: Flushing usage events
[0m15:04:24.094789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:27.279737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBC023EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBE903020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBE902630>]}


============================== 15:06:27.283968 | 34585460-e866-452a-a7f5-30284b661f30 ==============================
[0m15:06:27.283968 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:06:27.285474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'target_path': 'None', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test --select marts', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:06:27.477349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34585460-e866-452a-a7f5-30284b661f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBEFCFFE0>]}
[0m15:06:27.529059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34585460-e866-452a-a7f5-30284b661f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBEEDD490>]}
[0m15:06:27.531059 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:06:27.946490 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:06:28.143690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:28.144696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:28.181642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34585460-e866-452a-a7f5-30284b661f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC03278F0>]}
[0m15:06:28.252871 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:06:28.271394 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:06:28.314744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34585460-e866-452a-a7f5-30284b661f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC0981F10>]}
[0m15:06:28.315745 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:06:28.316249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34585460-e866-452a-a7f5-30284b661f30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC05200E0>]}
[0m15:06:28.317267 [warn ] [MainThread]: The selection criterion 'marts' does not match any enabled nodes
[0m15:06:28.318271 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:06:28.320282 [debug] [MainThread]: Command end result
[0m15:06:28.349456 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:06:28.352486 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:06:28.356047 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:06:28.356551 [debug] [MainThread]: Command `dbt test` succeeded at 15:06:28.356551 after 1.22 seconds
[0m15:06:28.356551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBE5EB080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBBE5EA840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC0386C60>]}
[0m15:06:28.356551 [debug] [MainThread]: Flushing usage events
[0m15:06:30.004437 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:05.876629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218CF8836B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D238A870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D1E1BA40>]}


============================== 15:07:05.882758 | 34f2ae0c-e285-4bc7-823f-93b7e7c51203 ==============================
[0m15:07:05.882758 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:07:05.882758 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'log_format': 'default', 'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m15:07:06.072887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D26D1F40>]}
[0m15:07:06.124670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D1BCE1B0>]}
[0m15:07:06.126674 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:07:06.532101 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:07:06.735406 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m15:07:06.736408 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\staging\marts\dim_products.sql
[0m15:07:06.736408 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\staging\marts\dim_customers.sql
[0m15:07:06.737409 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\staging\marts\dim_time.sql
[0m15:07:06.737409 [debug] [MainThread]: Partial parsing: added file: dbt_project://models\staging\marts\dim_sellers.sql
[0m15:07:06.737409 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\staging\Marts\dim_customers.sql
[0m15:07:06.737409 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\staging\Marts\dim_time.sql
[0m15:07:06.738419 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\staging\Marts\dim_sellers.sql
[0m15:07:06.738419 [debug] [MainThread]: Partial parsing: deleted file: dbt_project://models\staging\Marts\dim_products.sql
[0m15:07:07.136181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D4145D60>]}
[0m15:07:07.208320 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:07.227572 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:07.264041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D41293D0>]}
[0m15:07:07.265146 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:07:07.265146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D42CFCB0>]}
[0m15:07:07.267691 [info ] [MainThread]: 
[0m15:07:07.267691 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:07.268802 [info ] [MainThread]: 
[0m15:07:07.268802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:07.272812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m15:07:07.459247 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m15:07:07.460247 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:07:07.460247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:07.512041 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m15:07:07.513043 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m15:07:07.514772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m15:07:07.569902 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:07:07.569902 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m15:07:07.569902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:07.605901 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:07:07.606903 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:07:07.606903 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:07:07.617177 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.010 seconds
[0m15:07:07.618694 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m15:07:07.619695 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m15:07:07.625760 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:07.626760 [debug] [MainThread]: On master: BEGIN
[0m15:07:07.626760 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:07.663716 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m15:07:07.663716 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:07.663716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:07:07.672667 [debug] [MainThread]: SQL status: SELECT 9 in 0.008 seconds
[0m15:07:07.674900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218CFAFA030>]}
[0m15:07:07.675903 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:07.675903 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:07.675903 [debug] [MainThread]: On master: BEGIN
[0m15:07:07.676906 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:07:07.676906 [debug] [MainThread]: On master: COMMIT
[0m15:07:07.676906 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:07.677910 [debug] [MainThread]: On master: COMMIT
[0m15:07:07.677910 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:07.677910 [debug] [MainThread]: On master: Close
[0m15:07:07.682918 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_time
[0m15:07:07.682918 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m15:07:07.683600 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m15:07:07.683600 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m15:07:07.683600 [info ] [Thread-1 (]: 1 of 11 START sql table model public.dim_time .................................. [RUN]
[0m15:07:07.684610 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m15:07:07.684610 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_items_ordered .......................... [RUN]
[0m15:07:07.685614 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.dim_time'
[0m15:07:07.685614 [info ] [Thread-4 (]: 4 of 11 START sql view model public.stg_name_translation ....................... [RUN]
[0m15:07:07.686617 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m15:07:07.686617 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m15:07:07.686617 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_time
[0m15:07:07.686617 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m15:07:07.687916 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m15:07:07.687916 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m15:07:07.693986 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_time"
[0m15:07:07.693986 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m15:07:07.696387 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m15:07:07.699533 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m15:07:07.700537 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m15:07:07.702547 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_time
[0m15:07:07.733882 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_time"
[0m15:07:07.734884 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m15:07:07.734884 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m15:07:07.736034 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m15:07:07.752617 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m15:07:07.755922 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m15:07:07.758924 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m15:07:07.758924 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.758924 [debug] [Thread-1 (]: On model.dbt_project.dim_time: BEGIN
[0m15:07:07.760172 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:07:07.761174 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.761174 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.762174 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m15:07:07.762678 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.762678 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m15:07:07.762678 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:07:07.763700 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m15:07:07.763700 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:07:07.763700 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:07.803200 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m15:07:07.803200 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.804202 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */

  
    

  create  table "ecommerce_raw"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

with date_spine as (
    -- Generate all dates from 2016 to 2020 (covers your data range)
    select
        date_day::date as date_day
    from 
        generate_series(
            '2016-01-01'::date,
            '2020-12-31'::date,
            '1 day'::interval
        ) as date_day
),

final as (
    select
        -- Date
        date_day,
        
        -- Year
        extract(year from date_day) as year,
        extract(quarter from date_day) as quarter,
        extract(month from date_day) as month,
        extract(week from date_day) as week_of_year,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week, -- 0=Sunday, 6=Saturday
        extract(doy from date_day) as day_of_year,
        
        -- Formatted dates
        to_char(date_day, 'YYYY-MM-DD') as date_formatted,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'YYYY-Q') as year_quarter,
        
        -- Names
        to_char(date_day, 'Day') as day_name,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Mon') as month_name_short,
        
        -- Flags
        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend,
        case when extract(dow from date_day) between 1 and 5 then true else false end as is_weekday,
        
        -- Relative dates
        case when date_day = current_date then true else false end as is_today,
        case when date_day = current_date - interval '1 day' then true else false end as is_yesterday,
        case when date_day >= date_trunc('month', current_date) then true else false end as is_current_month,
        case when date_day >= date_trunc('year', current_date) then true else false end as is_current_year,
        
        -- Holiday markers (add as needed for your region)
        case 
            when extract(month from date_day) = 12 and extract(day from date_day) = 25 then 'Christmas'
            when extract(month from date_day) = 1 and extract(day from date_day) = 1 then 'New Year'
            when extract(month from date_day) = 11 and extract(day from date_day) = 15 then 'Black Friday (approx)'
            else null
        end as holiday_name

    from date_spine
)

select * from final
  );
  
[0m15:07:07.807627 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m15:07:07.807627 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.808718 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m15:07:07.813513 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m15:07:07.813513 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.813513 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m15:07:07.820085 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:07:07.820085 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:07:07.826301 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.829388 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.829388 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m15:07:07.829388 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:07:07.831880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:07.831880 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:07:07.834466 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.834466 [debug] [Thread-1 (]: SQL status: SELECT 1827 in 0.030 seconds
[0m15:07:07.836472 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.837476 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m15:07:07.841987 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.842988 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:07:07.842988 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
alter table "ecommerce_raw"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m15:07:07.842988 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:07.844277 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:07.844277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:07.857853 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m15:07:07.858857 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m15:07:07.860860 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.861860 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.861860 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.861860 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
alter table "ecommerce_raw"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m15:07:07.862972 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m15:07:07.862972 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m15:07:07.863994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:07.864997 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m15:07:07.864997 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:07.864997 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:07.866486 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.870641 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m15:07:07.874806 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m15:07:07.874806 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m15:07:07.878919 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:07:07.879921 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m15:07:07.879921 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:07:07.879921 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m15:07:07.881336 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:07:07.882843 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_time__dbt_backup"
[0m15:07:07.882843 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:07:07.883955 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:07:07.885962 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:07:07.887964 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m15:07:07.889230 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m15:07:07.889230 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
drop table if exists "ecommerce_raw"."public"."dim_time__dbt_backup" cascade
[0m15:07:07.892737 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218CF97BAD0>]}
[0m15:07:07.893242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D41BE510>]}
[0m15:07:07.894031 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.20s]
[0m15:07:07.895070 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m15:07:07.895070 [info ] [Thread-4 (]: 4 of 11 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.20s]
[0m15:07:07.895070 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_order_payment
[0m15:07:07.896409 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m15:07:07.896409 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_orders
[0m15:07:07.896409 [info ] [Thread-2 (]: 5 of 11 START sql view model public.stg_order_payment .......................... [RUN]
[0m15:07:07.897805 [info ] [Thread-4 (]: 6 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m15:07:07.898812 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_order_payment)
[0m15:07:07.898812 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:07:07.898812 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_orders)
[0m15:07:07.898812 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_order_payment
[0m15:07:07.900983 [debug] [Thread-1 (]: On model.dbt_project.dim_time: Close
[0m15:07:07.900983 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_orders
[0m15:07:07.902988 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m15:07:07.906074 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m15:07:07.906074 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D478D520>]}
[0m15:07:07.907078 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.dim_time ............................. [[32mSELECT 1827[0m in 0.22s]
[0m15:07:07.908386 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_time
[0m15:07:07.908386 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_products
[0m15:07:07.909402 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_order_payment
[0m15:07:07.909402 [info ] [Thread-1 (]: 7 of 11 START sql view model public.stg_products ............................... [RUN]
[0m15:07:07.910408 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_orders
[0m15:07:07.913737 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m15:07:07.913737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_time, now model.dbt_project.stg_products)
[0m15:07:07.916567 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m15:07:07.916567 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_products
[0m15:07:07.920085 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m15:07:07.920085 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:07.920085 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m15:07:07.921483 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:07.921483 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:07.921992 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: BEGIN
[0m15:07:07.921992 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_products
[0m15:07:07.922999 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:07.926262 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m15:07:07.927266 [debug] [Thread-3 (]: SQL status: BEGIN in 0.163 seconds
[0m15:07:07.927266 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.928267 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m15:07:07.928267 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:07.929280 [debug] [Thread-1 (]: On model.dbt_project.stg_products: BEGIN
[0m15:07:07.929280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:07.935477 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:07:07.940078 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.940078 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m15:07:07.942082 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:07.945601 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.945601 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m15:07:07.945601 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:07.948061 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m15:07:07.948061 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.948061 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m15:07:07.949089 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:07:07.953292 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m15:07:07.953292 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:07:07.954293 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m15:07:07.955769 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:07:07.956772 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m15:07:07.956772 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D3EBE5D0>]}
[0m15:07:07.957947 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.27s]
[0m15:07:07.958951 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m15:07:07.958951 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_sellers
[0m15:07:07.958951 [info ] [Thread-3 (]: 8 of 11 START sql view model public.stg_sellers ................................ [RUN]
[0m15:07:07.959951 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_sellers)
[0m15:07:07.959951 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_sellers
[0m15:07:07.961951 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m15:07:07.964508 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_sellers
[0m15:07:07.967521 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m15:07:07.968537 [debug] [Thread-2 (]: SQL status: BEGIN in 0.048 seconds
[0m15:07:07.969539 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:07.969539 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m15:07:07.971022 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:07.971022 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m15:07:07.971022 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: BEGIN
[0m15:07:07.972033 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:07.972541 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:07:07.972541 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m15:07:07.973957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m15:07:07.973957 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:07.975151 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m15:07:07.977154 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:07:07.980345 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:07.980345 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:07:07.980345 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m15:07:07.983878 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:07.984970 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m15:07:07.984970 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:07:07.988041 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:07.988041 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:07:07.988041 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m15:07:07.990587 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:07.992090 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:07:07.992600 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m15:07:07.994919 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:07.994919 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:07:07.994919 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:07:07.995921 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:07.998251 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:07.999579 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m15:07:07.999579 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:07.999579 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m15:07:07.999579 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:08.001809 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m15:07:08.001809 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m15:07:08.001809 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:08.001809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:08.003024 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: COMMIT
[0m15:07:08.003781 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m15:07:08.003781 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:08.005167 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:08.006439 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m15:07:08.007443 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:08.007443 [debug] [Thread-1 (]: On model.dbt_project.stg_products: COMMIT
[0m15:07:08.008447 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:07:08.009682 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m15:07:08.009682 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m15:07:08.010695 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:07:08.010695 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m15:07:08.011695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m15:07:08.011695 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m15:07:08.011695 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:08.015104 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m15:07:08.015104 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:07:08.015104 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as sellers_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m15:07:08.016108 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:07:08.016108 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:07:08.017167 [debug] [Thread-2 (]: On model.dbt_project.stg_order_payment: Close
[0m15:07:08.018166 [debug] [Thread-1 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m15:07:08.019372 [debug] [Thread-4 (]: On model.dbt_project.stg_orders: Close
[0m15:07:08.019372 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D4490230>]}
[0m15:07:08.020379 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D3EBE360>]}
[0m15:07:08.020379 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:07:08.020379 [info ] [Thread-2 (]: 5 of 11 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.12s]
[0m15:07:08.022894 [debug] [Thread-1 (]: On model.dbt_project.stg_products: Close
[0m15:07:08.021884 [info ] [Thread-4 (]: 6 of 11 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.12s]
[0m15:07:08.023684 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:07:08.023684 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_order_payment
[0m15:07:08.023684 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_orders
[0m15:07:08.024765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D485E1B0>]}
[0m15:07:08.027768 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:08.028839 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_customers
[0m15:07:08.028839 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m15:07:08.028839 [info ] [Thread-1 (]: 7 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m15:07:08.029842 [info ] [Thread-2 (]: 9 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m15:07:08.029842 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_products
[0m15:07:08.031041 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:08.031041 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m15:07:08.032042 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_products
[0m15:07:08.034564 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:08.034564 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_customers
[0m15:07:08.035568 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m15:07:08.035568 [info ] [Thread-4 (]: 10 of 11 START sql table model public.dim_products ............................. [RUN]
[0m15:07:08.038573 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m15:07:08.038573 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m15:07:08.039730 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:08.039730 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_products
[0m15:07:08.040977 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m15:07:08.044373 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m15:07:08.044373 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:08.045378 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_customers
[0m15:07:08.045378 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: COMMIT
[0m15:07:08.049518 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m15:07:08.049518 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_products
[0m15:07:08.052826 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m15:07:08.053961 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:07:08.055964 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m15:07:08.055964 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:07:08.055964 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:08.057227 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m15:07:08.057227 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: BEGIN
[0m15:07:08.057227 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:08.058274 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:07:08.058274 [debug] [Thread-4 (]: On model.dbt_project.dim_products: BEGIN
[0m15:07:08.059330 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:07:08.059330 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:07:08.060334 [debug] [Thread-3 (]: On model.dbt_project.stg_sellers: Close
[0m15:07:08.060334 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D4492F30>]}
[0m15:07:08.061837 [info ] [Thread-3 (]: 8 of 11 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:07:08.062839 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_sellers
[0m15:07:08.063341 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_sellers
[0m15:07:08.063789 [info ] [Thread-1 (]: 11 of 11 START sql table model public.dim_sellers .............................. [RUN]
[0m15:07:08.064342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.dim_sellers)
[0m15:07:08.064342 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_sellers
[0m15:07:08.067435 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m15:07:08.068529 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_sellers
[0m15:07:08.072819 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m15:07:08.074069 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:08.075392 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: BEGIN
[0m15:07:08.075392 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:08.106478 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m15:07:08.107854 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:08.107854 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m15:07:08.114722 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m15:07:08.115954 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:08.115954 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.sellers_zip_code ,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m15:07:08.203553 [debug] [Thread-2 (]: SQL status: BEGIN in 0.145 seconds
[0m15:07:08.203553 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:08.204554 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m15:07:10.296390 [debug] [Thread-4 (]: SQL status: SELECT 32951 in 2.189 seconds
[0m15:07:10.301603 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:10.301603 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m15:07:10.313364 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m15:07:10.317504 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:10.318506 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m15:07:10.318506 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:10.320009 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m15:07:10.320009 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:10.321527 [debug] [Thread-4 (]: On model.dbt_project.dim_products: COMMIT
[0m15:07:10.323814 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:10.325820 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m15:07:10.325820 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:07:10.326824 [debug] [Thread-4 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m15:07:10.332439 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:07:10.333705 [debug] [Thread-4 (]: On model.dbt_project.dim_products: Close
[0m15:07:10.334715 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D4851B20>]}
[0m15:07:10.334715 [info ] [Thread-4 (]: 10 of 11 OK created sql table model public.dim_products ........................ [[32mSELECT 32951[0m in 2.30s]
[0m15:07:10.335829 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_products
[0m15:07:10.340402 [debug] [Thread-1 (]: SQL status: SELECT 3095 in 2.224 seconds
[0m15:07:10.344483 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:10.344483 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers" rename to "dim_sellers__dbt_backup"
[0m15:07:10.345486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.348888 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:10.348888 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m15:07:10.350380 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:10.351884 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: COMMIT
[0m15:07:10.352397 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:10.352397 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: COMMIT
[0m15:07:10.354453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:07:10.357473 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_sellers__dbt_backup"
[0m15:07:10.357473 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:07:10.358473 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
drop table if exists "ecommerce_raw"."public"."dim_sellers__dbt_backup" cascade
[0m15:07:10.363389 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:07:10.365454 [debug] [Thread-1 (]: On model.dbt_project.dim_sellers: Close
[0m15:07:10.365454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218CFAFAE70>]}
[0m15:07:10.366454 [info ] [Thread-1 (]: 11 of 11 OK created sql table model public.dim_sellers ......................... [[32mSELECT 3095[0m in 2.30s]
[0m15:07:10.366454 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_sellers
[0m15:07:11.320063 [debug] [Thread-2 (]: SQL status: SELECT 198882 in 3.115 seconds
[0m15:07:11.323070 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:11.323070 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m15:07:11.323070 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:11.326394 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:11.326394 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m15:07:11.326394 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:07:11.327534 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m15:07:11.328536 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:11.328536 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: COMMIT
[0m15:07:11.342332 [debug] [Thread-2 (]: SQL status: COMMIT in 0.013 seconds
[0m15:07:11.344360 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m15:07:11.344360 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:07:11.345363 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m15:07:11.375765 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.030 seconds
[0m15:07:11.377768 [debug] [Thread-2 (]: On model.dbt_project.dim_customers: Close
[0m15:07:11.377768 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '34f2ae0c-e285-4bc7-823f-93b7e7c51203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D43EFCB0>]}
[0m15:07:11.378768 [info ] [Thread-2 (]: 9 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 198882[0m in 3.35s]
[0m15:07:11.379961 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_customers
[0m15:07:11.379961 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:11.381463 [debug] [MainThread]: On master: BEGIN
[0m15:07:11.381463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:11.425231 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m15:07:11.426564 [debug] [MainThread]: On master: COMMIT
[0m15:07:11.426564 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:11.426564 [debug] [MainThread]: On master: COMMIT
[0m15:07:11.427567 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:07:11.427567 [debug] [MainThread]: On master: Close
[0m15:07:11.427567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:11.428569 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m15:07:11.428569 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m15:07:11.428569 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m15:07:11.428569 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m15:07:11.429569 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m15:07:11.429569 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m15:07:11.429569 [info ] [MainThread]: 
[0m15:07:11.430569 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 4.16 seconds (4.16s).
[0m15:07:11.432574 [debug] [MainThread]: Command end result
[0m15:07:11.458305 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:11.462488 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:11.467497 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:07:11.467497 [info ] [MainThread]: 
[0m15:07:11.468497 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:11.468497 [info ] [MainThread]: 
[0m15:07:11.469607 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:07:11.469607 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:11.469607 after 5.69 seconds
[0m15:07:11.470780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D1B4A270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D20FB380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000218D20F8800>]}
[0m15:07:11.470780 [debug] [MainThread]: Flushing usage events
[0m15:07:13.419248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:18.716834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E29D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9C0D7A70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9C0D7FB0>]}


============================== 15:07:18.721848 | 9f5a605c-d905-460e-93d9-f459d636aa57 ==============================
[0m15:07:18.721848 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:07:18.721848 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt test --select marts', 'cache_selected_only': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:07:18.909470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f5a605c-d905-460e-93d9-f459d636aa57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E999910>]}
[0m15:07:18.961612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f5a605c-d905-460e-93d9-f459d636aa57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9FCA9E50>]}
[0m15:07:18.963632 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:07:19.367882 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:07:19.579356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:19.579356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:19.616793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f5a605c-d905-460e-93d9-f459d636aa57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9FCAAF00>]}
[0m15:07:19.687597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:19.705675 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:19.749543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f5a605c-d905-460e-93d9-f459d636aa57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FA046BA10>]}
[0m15:07:19.749543 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:07:19.751046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f5a605c-d905-460e-93d9-f459d636aa57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E973290>]}
[0m15:07:19.751595 [warn ] [MainThread]: The selection criterion 'marts' does not match any enabled nodes
[0m15:07:19.752498 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:07:19.754742 [debug] [MainThread]: Command end result
[0m15:07:19.779551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:19.782601 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:19.785801 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:07:19.787041 [debug] [MainThread]: Command `dbt test` succeeded at 15:07:19.787041 after 1.16 seconds
[0m15:07:19.788043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E29D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E0D4230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9E658920>]}
[0m15:07:19.788043 [debug] [MainThread]: Flushing usage events
[0m15:07:21.416832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:53.783394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C92476D2B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9247D35C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9240E49E0>]}


============================== 15:07:53.789306 | e14afa32-aa8e-4cb1-b76a-b8a812947cf9 ==============================
[0m15:07:53.789306 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:07:53.790328 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt test --select models/marts', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'log_format': 'default', 'use_colors': 'True', 'printer_width': '80', 'write_json': 'True'}
[0m15:07:54.005621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e14afa32-aa8e-4cb1-b76a-b8a812947cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9242B4470>]}
[0m15:07:54.059438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e14afa32-aa8e-4cb1-b76a-b8a812947cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C92492DD00>]}
[0m15:07:54.061439 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:07:54.477448 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:07:54.679605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:54.680606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:54.719157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e14afa32-aa8e-4cb1-b76a-b8a812947cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C925E1AE40>]}
[0m15:07:54.792677 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:54.810715 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:54.855442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e14afa32-aa8e-4cb1-b76a-b8a812947cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9265411C0>]}
[0m15:07:54.855442 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:07:54.856444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e14afa32-aa8e-4cb1-b76a-b8a812947cf9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C924A1BE90>]}
[0m15:07:54.859555 [warn ] [MainThread]: The selection criterion 'models/marts' does not match any enabled nodes
[0m15:07:54.860558 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:07:54.862559 [debug] [MainThread]: Command end result
[0m15:07:54.889232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:07:54.892508 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:07:54.895508 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:07:54.896509 [debug] [MainThread]: Command `dbt test` succeeded at 15:07:54.896509 after 1.24 seconds
[0m15:07:54.896509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9220841A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9243EC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9243EFFE0>]}
[0m15:07:54.897509 [debug] [MainThread]: Flushing usage events
[0m15:07:56.578438 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:13:57.785288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6A7C3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6E10FC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6E10E270>]}


============================== 15:13:57.792007 | 01c2e39c-be37-4649-9e5a-d900bb4cb24e ==============================
[0m15:13:57.792007 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:13:57.792007 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'False', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'invocation_command': 'dbt run', 'printer_width': '80', 'target_path': 'None'}
[0m15:13:58.008860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6BF78860>]}
[0m15:13:58.060128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6E19C5C0>]}
[0m15:13:58.062694 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:13:58.475023 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:13:58.674927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:13:58.674927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:13:58.712333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6EED1AC0>]}
[0m15:13:58.782954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:13:58.806309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:13:58.850400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F701366F0>]}
[0m15:13:58.851401 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:13:58.852524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F705026F0>]}
[0m15:13:58.855028 [info ] [MainThread]: 
[0m15:13:58.855028 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:13:58.856427 [info ] [MainThread]: 
[0m15:13:58.856427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:13:58.860438 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw'
[0m15:13:59.044960 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw"
[0m15:13:59.045967 [debug] [ThreadPool]: On list_ecommerce_raw: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw"} */

    select distinct nspname from pg_namespace
  
[0m15:13:59.045967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:59.115325 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m15:13:59.116341 [debug] [ThreadPool]: On list_ecommerce_raw: Close
[0m15:13:59.118418 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m15:13:59.123528 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:13:59.123528 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m15:13:59.123528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:13:59.159824 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m15:13:59.159824 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:13:59.159824 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:13:59.171870 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.011 seconds
[0m15:13:59.172873 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m15:13:59.172873 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m15:13:59.180068 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:59.181072 [debug] [MainThread]: On master: BEGIN
[0m15:13:59.181072 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:13:59.217269 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:13:59.217269 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:59.217269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:13:59.226731 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m15:13:59.228757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F702906B0>]}
[0m15:13:59.229772 [debug] [MainThread]: On master: ROLLBACK
[0m15:13:59.229772 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:59.229772 [debug] [MainThread]: On master: BEGIN
[0m15:13:59.230800 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:13:59.230800 [debug] [MainThread]: On master: COMMIT
[0m15:13:59.230800 [debug] [MainThread]: Using postgres connection "master"
[0m15:13:59.230800 [debug] [MainThread]: On master: COMMIT
[0m15:13:59.231815 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:13:59.231815 [debug] [MainThread]: On master: Close
[0m15:13:59.236882 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_time
[0m15:13:59.236882 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m15:13:59.236882 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m15:13:59.237884 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m15:13:59.237884 [info ] [Thread-1 (]: 1 of 11 START sql table model public.dim_time .................................. [RUN]
[0m15:13:59.238887 [info ] [Thread-2 (]: 2 of 11 START sql view model public.stg_customers .............................. [RUN]
[0m15:13:59.238887 [info ] [Thread-3 (]: 3 of 11 START sql view model public.stg_items_ordered .......................... [RUN]
[0m15:13:59.239889 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.dim_time'
[0m15:13:59.238887 [info ] [Thread-4 (]: 4 of 11 START sql view model public.stg_name_translation ....................... [RUN]
[0m15:13:59.239889 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m15:13:59.240892 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m15:13:59.240892 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_time
[0m15:13:59.240892 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m15:13:59.242073 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m15:13:59.242073 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m15:13:59.249026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_time"
[0m15:13:59.249026 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m15:13:59.251321 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m15:13:59.254826 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m15:13:59.257423 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m15:13:59.258427 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_time
[0m15:13:59.290934 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.dim_time"
[0m15:13:59.290934 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m15:13:59.292323 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m15:13:59.292323 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m15:13:59.307623 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_customers"
[0m15:13:59.309630 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_items_ordered"
[0m15:13:59.312642 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_name_translation"
[0m15:13:59.312642 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.314144 [debug] [Thread-1 (]: On model.dbt_project.dim_time: BEGIN
[0m15:13:59.314144 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:13:59.315662 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.315662 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.316111 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: BEGIN
[0m15:13:59.316664 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.316664 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: BEGIN
[0m15:13:59.316664 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:13:59.317668 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: BEGIN
[0m15:13:59.317668 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:13:59.318667 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:13:59.360367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m15:13:59.360367 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.361367 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */

  
    

  create  table "ecommerce_raw"."public"."dim_time__dbt_tmp"
  
  
    as
  
  (
    

with date_spine as (
    -- Generate all dates from 2016 to 2020 (covers your data range)
    select
        date_day::date as date_day
    from 
        generate_series(
            '2016-01-01'::date,
            '2020-12-31'::date,
            '1 day'::interval
        ) as date_day
),

final as (
    select
        -- Date
        date_day,
        
        -- Year
        extract(year from date_day) as year,
        extract(quarter from date_day) as quarter,
        extract(month from date_day) as month,
        extract(week from date_day) as week_of_year,
        extract(day from date_day) as day_of_month,
        extract(dow from date_day) as day_of_week, -- 0=Sunday, 6=Saturday
        extract(doy from date_day) as day_of_year,
        
        -- Formatted dates
        to_char(date_day, 'YYYY-MM-DD') as date_formatted,
        to_char(date_day, 'YYYY-MM') as year_month,
        to_char(date_day, 'YYYY-Q') as year_quarter,
        
        -- Names
        to_char(date_day, 'Day') as day_name,
        to_char(date_day, 'Month') as month_name,
        to_char(date_day, 'Mon') as month_name_short,
        
        -- Flags
        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend,
        case when extract(dow from date_day) between 1 and 5 then true else false end as is_weekday,
        
        -- Relative dates
        case when date_day = current_date then true else false end as is_today,
        case when date_day = current_date - interval '1 day' then true else false end as is_yesterday,
        case when date_day >= date_trunc('month', current_date) then true else false end as is_current_month,
        case when date_day >= date_trunc('year', current_date) then true else false end as is_current_year,
        
        -- Holiday markers (add as needed for your region)
        case 
            when extract(month from date_day) = 12 and extract(day from date_day) = 25 then 'Christmas'
            when extract(month from date_day) = 1 and extract(day from date_day) = 1 then 'New Year'
            when extract(month from date_day) = 11 and extract(day from date_day) = 15 then 'Black Friday (approx)'
            else null
        end as holiday_name

    from date_spine
)

select * from final
  );
  
[0m15:13:59.361367 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m15:13:59.361367 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.362819 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */

  create view "ecommerce_raw"."public"."stg_customers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_customers_dataset"
),

renamed as (
    select
        customer_id,
        customer_unique_id,
        customer_zip_code_prefix as zip_code,
        customer_city as city,
        customer_state as state
    from source
)

select * from renamed
  );
[0m15:13:59.364835 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m15:13:59.365858 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.365858 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */

  create view "ecommerce_raw"."public"."stg_name_translation__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."product_category_name_translation"
),

renamed as (
    select
        product_category_name,
        product_category_name_english
    from source
)

select * from renamed
  );
[0m15:13:59.368947 [debug] [Thread-3 (]: SQL status: BEGIN in 0.051 seconds
[0m15:13:59.368947 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.369950 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */

  create view "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_items_dataset"
),

renamed as (
    select
        order_id,
        order_item_id as item_id,
        product_id,
        seller_id,
        shipping_limit_date as shipping_Date,
        price as item_price,
        freight_value as shipping_price 
    from source
)

select * from renamed
  );
[0m15:13:59.371955 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:13:59.371955 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m15:13:59.378186 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.378186 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m15:13:59.381204 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.382204 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation" rename to "stg_name_translation__dbt_backup"
[0m15:13:59.384823 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.385829 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers" rename to "stg_customers__dbt_backup"
[0m15:13:59.385829 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered" rename to "stg_items_ordered__dbt_backup"
[0m15:13:59.387830 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.387830 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.387830 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:13:59.390207 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.391209 [debug] [Thread-1 (]: SQL status: SELECT 1827 in 0.029 seconds
[0m15:13:59.392506 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.395514 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.395514 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
alter table "ecommerce_raw"."public"."stg_name_translation__dbt_tmp" rename to "stg_name_translation"
[0m15:13:59.400745 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.400745 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
alter table "ecommerce_raw"."public"."stg_items_ordered__dbt_tmp" rename to "stg_items_ordered"
[0m15:13:59.402043 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
alter table "ecommerce_raw"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
[0m15:13:59.402043 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
alter table "ecommerce_raw"."public"."dim_time" rename to "dim_time__dbt_backup"
[0m15:13:59.402043 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.403286 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.403286 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.403286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.416943 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m15:13:59.417945 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m15:13:59.420023 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m15:13:59.422025 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.422025 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.422025 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.422025 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.423445 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
alter table "ecommerce_raw"."public"."dim_time__dbt_tmp" rename to "dim_time"
[0m15:13:59.423445 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: COMMIT
[0m15:13:59.423445 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: COMMIT
[0m15:13:59.423445 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: COMMIT
[0m15:13:59.424948 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:13:59.426641 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m15:13:59.426641 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:13:59.426641 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:13:59.426641 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m15:13:59.426641 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.432462 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_customers__dbt_backup"
[0m15:13:59.434966 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_name_translation__dbt_backup"
[0m15:13:59.436978 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_items_ordered__dbt_backup"
[0m15:13:59.436978 [debug] [Thread-1 (]: On model.dbt_project.dim_time: COMMIT
[0m15:13:59.441292 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_customers"
[0m15:13:59.442620 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_customers"} */
drop view if exists "ecommerce_raw"."public"."stg_customers__dbt_backup" cascade
[0m15:13:59.442620 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_items_ordered"
[0m15:13:59.441292 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_name_translation"
[0m15:13:59.442620 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_items_ordered"} */
drop view if exists "ecommerce_raw"."public"."stg_items_ordered__dbt_backup" cascade
[0m15:13:59.444131 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_name_translation"} */
drop view if exists "ecommerce_raw"."public"."stg_name_translation__dbt_backup" cascade
[0m15:13:59.445132 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:13:59.446844 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."dim_time__dbt_backup"
[0m15:13:59.446844 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:13:59.447904 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:13:59.447904 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:13:59.450908 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.dim_time"
[0m15:13:59.452164 [debug] [Thread-3 (]: On model.dbt_project.stg_items_ordered: Close
[0m15:13:59.454167 [debug] [Thread-2 (]: On model.dbt_project.stg_customers: Close
[0m15:13:59.454167 [debug] [Thread-4 (]: On model.dbt_project.stg_name_translation: Close
[0m15:13:59.455496 [debug] [Thread-1 (]: On model.dbt_project.dim_time: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_time"} */
drop table if exists "ecommerce_raw"."public"."dim_time__dbt_backup" cascade
[0m15:13:59.457790 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6BF5BA70>]}
[0m15:13:59.457790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F707B75F0>]}
[0m15:13:59.458792 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70A310A0>]}
[0m15:13:59.458792 [info ] [Thread-3 (]: 3 of 11 OK created sql view model public.stg_items_ordered ..................... [[32mCREATE VIEW[0m in 0.21s]
[0m15:13:59.461084 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m15:13:59.460084 [info ] [Thread-2 (]: 2 of 11 OK created sql view model public.stg_customers ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m15:13:59.461084 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_order_payment
[0m15:13:59.460084 [info ] [Thread-4 (]: 4 of 11 OK created sql view model public.stg_name_translation .................. [[32mCREATE VIEW[0m in 0.22s]
[0m15:13:59.462475 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m15:13:59.462475 [info ] [Thread-3 (]: 5 of 11 START sql view model public.stg_order_payment .......................... [RUN]
[0m15:13:59.463483 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m15:13:59.463483 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m15:13:59.463483 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_order_payment)
[0m15:13:59.464483 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_products
[0m15:13:59.465776 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_order_payment
[0m15:13:59.464987 [info ] [Thread-2 (]: 6 of 11 START sql view model public.stg_orders ................................. [RUN]
[0m15:13:59.466281 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:13:59.466281 [info ] [Thread-4 (]: 7 of 11 START sql view model public.stg_products ............................... [RUN]
[0m15:13:59.468289 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m15:13:59.470298 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m15:13:59.471319 [debug] [Thread-1 (]: On model.dbt_project.dim_time: Close
[0m15:13:59.472323 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_products)
[0m15:13:59.472323 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m15:13:59.473327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70FF7230>]}
[0m15:13:59.473327 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_products
[0m15:13:59.477186 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m15:13:59.478205 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_order_payment
[0m15:13:59.478205 [info ] [Thread-1 (]: 1 of 11 OK created sql table model public.dim_time ............................. [[32mSELECT 1827[0m in 0.23s]
[0m15:13:59.481214 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m15:13:59.484224 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.stg_order_payment"
[0m15:13:59.484727 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_time
[0m15:13:59.485231 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sellers
[0m15:13:59.486018 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m15:13:59.489054 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.stg_orders"
[0m15:13:59.486018 [info ] [Thread-1 (]: 8 of 11 START sql view model public.stg_sellers ................................ [RUN]
[0m15:13:59.490057 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.490057 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_products
[0m15:13:59.491061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_time, now model.dbt_project.stg_sellers)
[0m15:13:59.491061 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: BEGIN
[0m15:13:59.495503 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.stg_products"
[0m15:13:59.495503 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.496521 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sellers
[0m15:13:59.496521 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:13:59.497599 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: BEGIN
[0m15:13:59.500125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m15:13:59.500125 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:59.500125 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.501482 [debug] [Thread-4 (]: On model.dbt_project.stg_products: BEGIN
[0m15:13:59.501482 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:13:59.502796 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sellers
[0m15:13:59.505967 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sellers"
[0m15:13:59.506979 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.506979 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: BEGIN
[0m15:13:59.508051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:13:59.546588 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m15:13:59.546588 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.546588 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */

  create view "ecommerce_raw"."public"."stg_order_payment__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_order_payments_dataset"
),

renamed as (
    select
       order_id,
       payment_type,
       payment_installments,
       payment_value
    from source
)

select * from renamed
  );
[0m15:13:59.549600 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m15:13:59.549600 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.549600 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */

  create view "ecommerce_raw"."public"."stg_orders__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_orders_dataset"
),

renamed as (
    select
        order_id,
        customer_id,
        order_status,
        order_purchase_timestamp as Purchased_date,
        order_approved_at as Confirmation_date,
        order_delivered_carrier_date as order_shipped_date,
        order_delivered_customer_date as order_delivered_date,
        order_estimated_delivery_date as estimated_delivery_date
    from source
)

select * from renamed
  );
[0m15:13:59.551607 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m15:13:59.551607 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.551607 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */

  create view "ecommerce_raw"."public"."stg_products__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_products_dataset"
),

renamed as (
    select
        product_id,
        product_category_name
    from source
)

select * from renamed
  );
[0m15:13:59.551607 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:13:59.555618 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.555618 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment" rename to "stg_order_payment__dbt_backup"
[0m15:13:59.555618 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:13:59.555618 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m15:13:59.559106 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.559106 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:13:59.560110 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:13:59.560110 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.560110 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders" rename to "stg_orders__dbt_backup"
[0m15:13:59.562133 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.566162 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.566162 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */

  create view "ecommerce_raw"."public"."stg_sellers__dbt_tmp"
    
    
  as (
    with source as (
    select * from "ecommerce_raw"."public"."olist_sellers_dataset"
),

renamed as (
    select
        seller_id,
        seller_zip_code_prefix as sellers_zip_code,
        seller_city,
        seller_state
    from source
)

select * from renamed
  );
[0m15:13:59.567166 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
alter table "ecommerce_raw"."public"."stg_order_payment__dbt_tmp" rename to "stg_order_payment"
[0m15:13:59.567166 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:59.567166 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products" rename to "stg_products__dbt_backup"
[0m15:13:59.616990 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.617992 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.050 seconds
[0m15:13:59.617992 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m15:13:59.617992 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
alter table "ecommerce_raw"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
[0m15:13:59.619447 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m15:13:59.620461 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:13:59.622463 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.622463 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.623897 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:59.625942 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.625942 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers" rename to "stg_sellers__dbt_backup"
[0m15:13:59.625942 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: COMMIT
[0m15:13:59.626946 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m15:13:59.627967 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
alter table "ecommerce_raw"."public"."stg_products__dbt_tmp" rename to "stg_products"
[0m15:13:59.627967 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.627967 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:59.628969 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: COMMIT
[0m15:13:59.629717 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:13:59.631732 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.631732 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:13:59.634060 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."stg_order_payment__dbt_backup"
[0m15:13:59.634060 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:13:59.634060 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
alter table "ecommerce_raw"."public"."stg_sellers__dbt_tmp" rename to "stg_sellers"
[0m15:13:59.635393 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m15:13:59.636068 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.stg_order_payment"
[0m15:13:59.638295 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."stg_orders__dbt_backup"
[0m15:13:59.638295 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.638295 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:13:59.638295 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_order_payment"} */
drop view if exists "ecommerce_raw"."public"."stg_order_payment__dbt_backup" cascade
[0m15:13:59.639298 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.stg_orders"
[0m15:13:59.639298 [debug] [Thread-4 (]: On model.dbt_project.stg_products: COMMIT
[0m15:13:59.640522 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m15:13:59.641525 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders"} */
drop view if exists "ecommerce_raw"."public"."stg_orders__dbt_backup" cascade
[0m15:13:59.641525 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.641525 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: COMMIT
[0m15:13:59.642527 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:13:59.642527 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:13:59.644031 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."stg_products__dbt_backup"
[0m15:13:59.645040 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:13:59.645040 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:13:59.646452 [debug] [Thread-3 (]: On model.dbt_project.stg_order_payment: Close
[0m15:13:59.646452 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.stg_products"
[0m15:13:59.648667 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_raw"."public"."stg_sellers__dbt_backup"
[0m15:13:59.648667 [debug] [Thread-2 (]: On model.dbt_project.stg_orders: Close
[0m15:13:59.650022 [debug] [Thread-4 (]: On model.dbt_project.stg_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_products"} */
drop view if exists "ecommerce_raw"."public"."stg_products__dbt_backup" cascade
[0m15:13:59.650022 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70A97D70>]}
[0m15:13:59.651089 [debug] [Thread-1 (]: Using postgres connection "model.dbt_project.stg_sellers"
[0m15:13:59.651089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6EED1580>]}
[0m15:13:59.652243 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_sellers"} */
drop view if exists "ecommerce_raw"."public"."stg_sellers__dbt_backup" cascade
[0m15:13:59.652243 [info ] [Thread-3 (]: 5 of 11 OK created sql view model public.stg_order_payment ..................... [[32mCREATE VIEW[0m in 0.19s]
[0m15:13:59.653442 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:13:59.653442 [info ] [Thread-2 (]: 6 of 11 OK created sql view model public.stg_orders ............................ [[32mCREATE VIEW[0m in 0.18s]
[0m15:13:59.654944 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_order_payment
[0m15:13:59.655957 [debug] [Thread-4 (]: On model.dbt_project.stg_products: Close
[0m15:13:59.655957 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:13:59.656958 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m15:13:59.658218 [debug] [Thread-1 (]: On model.dbt_project.stg_sellers: Close
[0m15:13:59.658218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70A324B0>]}
[0m15:13:59.658218 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_customers
[0m15:13:59.659509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70AAC0B0>]}
[0m15:13:59.659509 [info ] [Thread-4 (]: 7 of 11 OK created sql view model public.stg_products .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m15:13:59.659509 [info ] [Thread-3 (]: 9 of 11 START sql table model public.dim_customers ............................. [RUN]
[0m15:13:59.660905 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_products
[0m15:13:59.660905 [info ] [Thread-1 (]: 8 of 11 OK created sql view model public.stg_sellers ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m15:13:59.660905 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now model.dbt_project.dim_customers)
[0m15:13:59.662386 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sellers
[0m15:13:59.662386 [debug] [Thread-2 (]: Began running node model.dbt_project.dim_products
[0m15:13:59.662386 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_customers
[0m15:13:59.663882 [debug] [Thread-4 (]: Began running node model.dbt_project.dim_sellers
[0m15:13:59.663882 [info ] [Thread-2 (]: 10 of 11 START sql table model public.dim_products ............................. [RUN]
[0m15:13:59.668005 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m15:13:59.668005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now model.dbt_project.dim_products)
[0m15:13:59.668005 [info ] [Thread-4 (]: 11 of 11 START sql table model public.dim_sellers .............................. [RUN]
[0m15:13:59.669007 [debug] [Thread-2 (]: Began compiling node model.dbt_project.dim_products
[0m15:13:59.669007 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now model.dbt_project.dim_sellers)
[0m15:13:59.672014 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m15:13:59.673017 [debug] [Thread-4 (]: Began compiling node model.dbt_project.dim_sellers
[0m15:13:59.673017 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_customers
[0m15:13:59.676212 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m15:13:59.680233 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.dim_customers"
[0m15:13:59.681249 [debug] [Thread-2 (]: Began executing node model.dbt_project.dim_products
[0m15:13:59.684943 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.dim_products"
[0m15:13:59.685959 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:13:59.685959 [debug] [Thread-4 (]: Began executing node model.dbt_project.dim_sellers
[0m15:13:59.685959 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: BEGIN
[0m15:13:59.689972 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.dim_sellers"
[0m15:13:59.690969 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:13:59.690969 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:13:59.692209 [debug] [Thread-2 (]: On model.dbt_project.dim_products: BEGIN
[0m15:13:59.692209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:13:59.693283 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:13:59.693283 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: BEGIN
[0m15:13:59.694787 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:13:59.739173 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m15:13:59.740242 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:13:59.740242 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */

  
    

  create  table "ecommerce_raw"."public"."dim_products__dbt_tmp"
  
  
    as
  
  (
    

with products as (
    select * from "ecommerce_raw"."public"."stg_products"
),

category_translation as (
    select * from "ecommerce_raw"."public"."stg_name_translation"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate product sales metrics
product_metrics as (
    select
        product_id,
        count(distinct order_id) as times_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_price,
        sum(shipping_price) as total_shipping_cost,
        avg(shipping_price) as avg_shipping_cost,
        min(item_id) as first_sold_order_item_id -- proxy for when first sold
    from order_items
    group by product_id
),

final as (
    select
        -- Product attributes
        p.product_id,
        p.product_category_name,
        ct.product_category_name_english as product_category,
        
        -- Product dimensions (if you have them in staging)
        
        -- Sales metrics
        coalesce(pm.times_sold, 0) as times_sold,
        coalesce(pm.total_revenue, 0) as total_revenue,
        pm.avg_price,
        pm.total_shipping_cost,
        pm.avg_shipping_cost,
        
        -- Calculated fields
        
        -- Product categorization
        case
            when pm.times_sold >= 100 then 'Best Seller'
            when pm.times_sold >= 50 then 'Popular'
            when pm.times_sold >= 10 then 'Regular'
            when pm.times_sold > 0 then 'Slow Moving'
            else 'Never Sold'
        end as sales_category,
        
        case
            when pm.avg_price >= 500 then 'Premium'
            when pm.avg_price >= 100 then 'Mid-Range'
            when pm.avg_price > 0 then 'Budget'
            else 'Unknown'
        end as price_category

    from products p
    left join category_translation ct 
        on p.product_category_name = ct.product_category_name
    left join product_metrics pm 
        on p.product_id = pm.product_id
)

select * from final
  );
  
[0m15:13:59.741304 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m15:13:59.741304 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:13:59.742308 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_sellers__dbt_tmp"
  
  
    as
  
  (
    

with sellers as (
    select * from "ecommerce_raw"."public"."stg_sellers"
),

order_items as (
    select * from "ecommerce_raw"."public"."stg_items_ordered"
),

-- Aggregate seller metrics
seller_metrics as (
    select
        seller_id,
        count(distinct order_id) as total_orders,
        count(distinct product_id) as unique_products_sold,
        sum(item_price) as total_revenue,
        avg(item_price) as avg_order_value,
        sum(shipping_price) as total_shipping_cost
    from order_items
    group by seller_id
),

final as (
    select
        -- Seller attributes
        s.seller_id,
        s.sellers_zip_code ,
        s.seller_city as city,
        s.seller_state as state,
        
        -- Sales metrics
        coalesce(sm.total_orders, 0) as total_orders,
        coalesce(sm.unique_products_sold, 0) as unique_products_sold,
        coalesce(sm.total_revenue, 0) as total_revenue,
        sm.avg_order_value,
        sm.total_shipping_cost,
        
        -- Performance categories
        case
            when sm.total_orders >= 100 then 'Top Seller'
            when sm.total_orders >= 50 then 'High Volume'
            when sm.total_orders >= 10 then 'Active'
            when sm.total_orders > 0 then 'Low Volume'
            else 'Inactive'
        end as seller_tier,
        
        case
            when sm.avg_order_value >= 500 then 'Premium'
            when sm.avg_order_value >= 100 then 'Standard'
            when sm.avg_order_value > 0 then 'Budget'
            else 'No Sales'
        end as price_tier

    from sellers s
    left join seller_metrics sm on s.seller_id = sm.seller_id
)

select * from final
  );
  
[0m15:13:59.832895 [debug] [Thread-3 (]: SQL status: BEGIN in 0.143 seconds
[0m15:13:59.834397 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:13:59.834902 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */

  
    

  create  table "ecommerce_raw"."public"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    

with customers as (
    select * from "ecommerce_raw"."public"."stg_customers"
),

orders as (
    select * from "ecommerce_raw"."public"."stg_orders"
),

order_payments as (
    select * from "ecommerce_raw"."public"."stg_order_payment"
),

-- Aggregate order metrics per customer
customer_orders as (
    select
        customer_id,
        count(distinct order_id) as lifetime_orders,
        min(purchased_date) as first_order_date,
        max(purchased_date) as most_recent_order_date,
        -- Calculate days between first and last order (date - date -> integer days)
      (max((purchased_date))::date - min((purchased_date)::date)) as customer_lifetime_days
    from orders
    where order_status not in ('canceled', 'unavailable')
    group by customer_id
),

-- Aggregate payment metrics per customer
customer_payments as (
    select
        o.customer_id,
        sum(op.payment_value) as lifetime_value,
        avg(op.payment_value) as avg_order_value,
        -- Count distinct payment types used
        count(distinct op.payment_type) as payment_methods
    from orders o
    left join order_payments op on o.order_id = op.order_id
    where o.order_status not in ('canceled', 'unavailable')
    group by o.customer_id
),

-- Join everything together
final as (
    select
        -- Customer attributes
        c.customer_id,
        c.customer_unique_id,
        c.zip_code,
        c.city,
        c.state,
        
        -- Order metrics
        coalesce(co.lifetime_orders, 0) as lifetime_orders,
        co.first_order_date,
        co.most_recent_order_date,
        co.customer_lifetime_days,
        
        -- Payment metrics
        coalesce(cp.lifetime_value, 0) as lifetime_value,
        cp.avg_order_value,
        cp.payment_methods,
        
        -- Segmentation fields
        case 
            when co.lifetime_orders >= 5 then 'High Frequency'
            when co.lifetime_orders >= 2 then 'Medium Frequency'
            when co.lifetime_orders = 1 then 'One-time'
            else 'No Orders'
        end as frequency_segment,
        
        case
            when coalesce(cp.lifetime_value,0) >= 1000 then 'High Value'
            when coalesce(cp.lifetime_value,0) >= 500 then 'Medium Value'
            when coalesce(cp.lifetime_value,0) > 0 then 'Low Value'
            else 'No Value'
        end as value_segment,
        
        -- Recency (days since last order) -- result is integer days (nullable)
        case 
            when co.most_recent_order_date is not null 
            then (current_date::date - co.most_recent_order_date::DATE)
            else null
        end as days_since_last_order,
        
        -- RFM composite segment (NULL-safe recency checks)
        case
            when co.lifetime_orders >= 3 
                 and coalesce(cp.lifetime_value,0) >= 500 
                 and co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) <= 180
            then 'Champion'
            
            when co.lifetime_orders >= 2 
                 and coalesce(cp.lifetime_value,0) >= 300
            then 'Loyal'
            
            when co.lifetime_orders = 1 
                 and coalesce(cp.lifetime_value,0) >= 200
            then 'Potential'
            
            when co.most_recent_order_date is not null
                 and (current_date::date - co.most_recent_order_date::date) > 365
            then 'At Risk'
            
            else 'Needs Attention'
        end as customer_segment

    from customers c
    left join customer_orders co on c.customer_id = co.customer_id
    left join customer_payments cp on c.customer_id = cp.customer_id
)

select * from final
  );
  
[0m15:14:01.239253 [debug] [Thread-2 (]: SQL status: SELECT 32951 in 1.499 seconds
[0m15:14:01.242254 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:14:01.242254 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products" rename to "dim_products__dbt_backup"
[0m15:14:01.243757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:01.245260 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:14:01.246261 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
alter table "ecommerce_raw"."public"."dim_products__dbt_tmp" rename to "dim_products"
[0m15:14:01.246261 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:01.247262 [debug] [Thread-2 (]: On model.dbt_project.dim_products: COMMIT
[0m15:14:01.248261 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:14:01.248261 [debug] [Thread-2 (]: On model.dbt_project.dim_products: COMMIT
[0m15:14:01.253765 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m15:14:01.255959 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_raw"."public"."dim_products__dbt_backup"
[0m15:14:01.255959 [debug] [Thread-2 (]: Using postgres connection "model.dbt_project.dim_products"
[0m15:14:01.255959 [debug] [Thread-2 (]: On model.dbt_project.dim_products: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_products"} */
drop table if exists "ecommerce_raw"."public"."dim_products__dbt_backup" cascade
[0m15:14:01.260980 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:14:01.263099 [debug] [Thread-2 (]: On model.dbt_project.dim_products: Close
[0m15:14:01.264101 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6EC79BB0>]}
[0m15:14:01.264101 [info ] [Thread-2 (]: 10 of 11 OK created sql table model public.dim_products ........................ [[32mSELECT 32951[0m in 1.60s]
[0m15:14:01.265203 [debug] [Thread-2 (]: Finished running node model.dbt_project.dim_products
[0m15:14:01.355804 [debug] [Thread-4 (]: SQL status: SELECT 3095 in 1.614 seconds
[0m15:14:01.359181 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:14:01.360181 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers" rename to "dim_sellers__dbt_backup"
[0m15:14:01.361182 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:01.363182 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:14:01.364182 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
alter table "ecommerce_raw"."public"."dim_sellers__dbt_tmp" rename to "dim_sellers"
[0m15:14:01.364685 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:01.365646 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: COMMIT
[0m15:14:01.366699 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:14:01.366699 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: COMMIT
[0m15:14:01.367710 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:14:01.370723 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_raw"."public"."dim_sellers__dbt_backup"
[0m15:14:01.371728 [debug] [Thread-4 (]: Using postgres connection "model.dbt_project.dim_sellers"
[0m15:14:01.371728 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_sellers"} */
drop table if exists "ecommerce_raw"."public"."dim_sellers__dbt_backup" cascade
[0m15:14:01.377378 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:14:01.379487 [debug] [Thread-4 (]: On model.dbt_project.dim_sellers: Close
[0m15:14:01.380494 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6EDE5F10>]}
[0m15:14:01.380494 [info ] [Thread-4 (]: 11 of 11 OK created sql table model public.dim_sellers ......................... [[32mSELECT 3095[0m in 1.71s]
[0m15:14:01.381501 [debug] [Thread-4 (]: Finished running node model.dbt_project.dim_sellers
[0m15:14:02.610168 [debug] [Thread-3 (]: SQL status: SELECT 198882 in 2.776 seconds
[0m15:14:02.613170 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:14:02.614170 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers" rename to "dim_customers__dbt_backup"
[0m15:14:02.614673 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:02.616708 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:14:02.616708 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
alter table "ecommerce_raw"."public"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m15:14:02.617708 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:14:02.618797 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m15:14:02.618797 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:14:02.619797 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: COMMIT
[0m15:14:02.627450 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:14:02.630683 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_raw"."public"."dim_customers__dbt_backup"
[0m15:14:02.631685 [debug] [Thread-3 (]: Using postgres connection "model.dbt_project.dim_customers"
[0m15:14:02.631685 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.dim_customers"} */
drop table if exists "ecommerce_raw"."public"."dim_customers__dbt_backup" cascade
[0m15:14:02.636878 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.005 seconds
[0m15:14:02.638066 [debug] [Thread-3 (]: On model.dbt_project.dim_customers: Close
[0m15:14:02.639068 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c2e39c-be37-4649-9e5a-d900bb4cb24e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70F91D00>]}
[0m15:14:02.639068 [info ] [Thread-3 (]: 9 of 11 OK created sql table model public.dim_customers ........................ [[32mSELECT 198882[0m in 2.98s]
[0m15:14:02.640068 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_customers
[0m15:14:02.641069 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:02.641069 [debug] [MainThread]: On master: BEGIN
[0m15:14:02.642221 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:02.685420 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m15:14:02.685420 [debug] [MainThread]: On master: COMMIT
[0m15:14:02.685420 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:02.686688 [debug] [MainThread]: On master: COMMIT
[0m15:14:02.686688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:14:02.687691 [debug] [MainThread]: On master: Close
[0m15:14:02.687691 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:02.687691 [debug] [MainThread]: Connection 'list_ecommerce_raw' was properly closed.
[0m15:14:02.688690 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m15:14:02.688690 [debug] [MainThread]: Connection 'model.dbt_project.stg_sellers' was properly closed.
[0m15:14:02.688690 [debug] [MainThread]: Connection 'model.dbt_project.dim_products' was properly closed.
[0m15:14:02.688690 [debug] [MainThread]: Connection 'model.dbt_project.dim_customers' was properly closed.
[0m15:14:02.689690 [debug] [MainThread]: Connection 'model.dbt_project.dim_sellers' was properly closed.
[0m15:14:02.689690 [info ] [MainThread]: 
[0m15:14:02.690728 [info ] [MainThread]: Finished running 4 table models, 7 view models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m15:14:02.692744 [debug] [MainThread]: Command end result
[0m15:14:02.721155 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:14:02.724963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:14:02.731043 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:14:02.731043 [info ] [MainThread]: 
[0m15:14:02.732047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:02.732047 [info ] [MainThread]: 
[0m15:14:02.733088 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=0 SKIP=0 TOTAL=11
[0m15:14:02.734594 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:02.734090 after 5.10 seconds
[0m15:14:02.734594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6A7C3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F6E5ABA40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F70317E30>]}
[0m15:14:02.734594 [debug] [MainThread]: Flushing usage events
[0m15:14:04.758208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:38.205699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE819C8FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE819C9EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE819C9DC0>]}


============================== 15:14:38.211525 | 0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4 ==============================
[0m15:14:38.211525 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:14:38.212030 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'write_json': 'True', 'invocation_command': 'dbt docs generate', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:14:38.411378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE81B6A690>]}
[0m15:14:38.464526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF5DD9A0>]}
[0m15:14:38.466782 [info ] [MainThread]: Registered adapter: postgres=1.9.1
[0m15:14:38.904818 [debug] [MainThread]: checksum: c40cca0353c9a9b4dbd2a57cdc3e2440f5c9a71a795694b25a51e704baaf554e, vars: {}, profile: , target: , version: 1.9.10
[0m15:14:39.107091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:39.107091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:39.145241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE82EB67B0>]}
[0m15:14:39.182698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE8330E360>]}
[0m15:14:39.182698 [info ] [MainThread]: Found 11 models, 41 data tests, 9 sources, 447 macros
[0m15:14:39.183709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE830ECE60>]}
[0m15:14:39.186149 [info ] [MainThread]: 
[0m15:14:39.187163 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:39.187163 [info ] [MainThread]: 
[0m15:14:39.188165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:39.191669 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_raw_public'
[0m15:14:39.347430 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:14:39.347430 [debug] [ThreadPool]: On list_ecommerce_raw_public: BEGIN
[0m15:14:39.347430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:39.400599 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m15:14:39.401102 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_raw_public"
[0m15:14:39.401605 [debug] [ThreadPool]: On list_ecommerce_raw_public: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "list_ecommerce_raw_public"} */
select
      'ecommerce_raw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_raw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:14:39.406624 [debug] [ThreadPool]: SQL status: SELECT 24 in 0.005 seconds
[0m15:14:39.408628 [debug] [ThreadPool]: On list_ecommerce_raw_public: ROLLBACK
[0m15:14:39.408628 [debug] [ThreadPool]: On list_ecommerce_raw_public: Close
[0m15:14:39.416273 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:39.416273 [debug] [MainThread]: On master: BEGIN
[0m15:14:39.417273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:39.451833 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:14:39.453243 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:39.453243 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m15:14:39.460511 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m15:14:39.463220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0229e0b0-327a-4baf-b2ba-c4f9d4a5c2a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE819C8A70>]}
[0m15:14:39.464223 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:39.464223 [debug] [MainThread]: On master: Close
[0m15:14:39.468405 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_time
[0m15:14:39.468405 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_customers
[0m15:14:39.468405 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_items_ordered
[0m15:14:39.469409 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_name_translation
[0m15:14:39.469409 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.dbt_project.dim_time'
[0m15:14:39.470408 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.dbt_project.stg_customers'
[0m15:14:39.470408 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.dbt_project.stg_items_ordered'
[0m15:14:39.470408 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.dbt_project.stg_name_translation'
[0m15:14:39.470408 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_time
[0m15:14:39.471733 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_customers
[0m15:14:39.471733 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_items_ordered
[0m15:14:39.471733 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_name_translation
[0m15:14:39.478001 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_time"
[0m15:14:39.480504 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_customers"
[0m15:14:39.483225 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_items_ordered"
[0m15:14:39.484228 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_name_translation"
[0m15:14:39.486338 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_time
[0m15:14:39.486338 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_time
[0m15:14:39.487364 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_customers
[0m15:14:39.488364 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_order_payment
[0m15:14:39.488364 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_items_ordered
[0m15:14:39.488364 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_name_translation
[0m15:14:39.489576 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_customers
[0m15:14:39.489576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_time, now model.dbt_project.stg_order_payment)
[0m15:14:39.490578 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_items_ordered
[0m15:14:39.490578 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_name_translation
[0m15:14:39.491580 [debug] [Thread-2 (]: Began running node model.dbt_project.stg_orders
[0m15:14:39.491580 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_order_payment
[0m15:14:39.491580 [debug] [Thread-3 (]: Began running node model.dbt_project.stg_products
[0m15:14:39.492662 [debug] [Thread-4 (]: Began running node model.dbt_project.stg_sellers
[0m15:14:39.492662 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_customers, now model.dbt_project.stg_orders)
[0m15:14:39.495683 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_order_payment"
[0m15:14:39.495683 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_items_ordered, now model.dbt_project.stg_products)
[0m15:14:39.495683 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_name_translation, now model.dbt_project.stg_sellers)
[0m15:14:39.496911 [debug] [Thread-2 (]: Began compiling node model.dbt_project.stg_orders
[0m15:14:39.496911 [debug] [Thread-3 (]: Began compiling node model.dbt_project.stg_products
[0m15:14:39.496911 [debug] [Thread-4 (]: Began compiling node model.dbt_project.stg_sellers
[0m15:14:39.499237 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.stg_orders"
[0m15:14:39.502514 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.stg_products"
[0m15:14:39.503572 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_order_payment
[0m15:14:39.505578 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.stg_sellers"
[0m15:14:39.505578 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_order_payment
[0m15:14:39.506580 [debug] [Thread-1 (]: Began running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:14:39.506580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_order_payment, now test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68)
[0m15:14:39.507727 [debug] [Thread-1 (]: Began compiling node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:14:39.507727 [debug] [Thread-2 (]: Began executing node model.dbt_project.stg_orders
[0m15:14:39.518149 [debug] [Thread-4 (]: Began executing node model.dbt_project.stg_sellers
[0m15:14:39.518149 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68"
[0m15:14:39.519213 [debug] [Thread-3 (]: Began executing node model.dbt_project.stg_products
[0m15:14:39.519213 [debug] [Thread-2 (]: Finished running node model.dbt_project.stg_orders
[0m15:14:39.520717 [debug] [Thread-4 (]: Finished running node model.dbt_project.stg_sellers
[0m15:14:39.521224 [debug] [Thread-3 (]: Finished running node model.dbt_project.stg_products
[0m15:14:39.521954 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:14:39.521954 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:14:39.521954 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:14:39.523059 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders, now test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa)
[0m15:14:39.524059 [debug] [Thread-1 (]: Began executing node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:14:39.524059 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_sellers, now test.dbt_project.not_null_dim_time_is_weekend.f294374ebd)
[0m15:14:39.524059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_products, now test.dbt_project.not_null_dim_time_year.6fb9595d53)
[0m15:14:39.525059 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:14:39.525059 [debug] [Thread-1 (]: Finished running node test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68
[0m15:14:39.525059 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:14:39.525059 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:14:39.532486 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa"
[0m15:14:39.533487 [debug] [Thread-1 (]: Began running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:14:39.536639 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_is_weekend.f294374ebd"
[0m15:14:39.539642 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_time_year.6fb9595d53"
[0m15:14:39.540642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_time_is_weekend__True__False.af2a49ff68, now test.dbt_project.unique_dim_time_date_day.d8637451e0)
[0m15:14:39.541145 [debug] [Thread-1 (]: Began compiling node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:14:39.545161 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.unique_dim_time_date_day.d8637451e0"
[0m15:14:39.546437 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:14:39.547451 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa
[0m15:14:39.547451 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:14:39.547451 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:14:39.548498 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:14:39.548498 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_time_is_weekend.f294374ebd
[0m15:14:39.549720 [debug] [Thread-1 (]: Began executing node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:14:39.549720 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_time_year.6fb9595d53
[0m15:14:39.550722 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_date_day.f8d7dcdffa, now test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m15:14:39.550722 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:14:39.551231 [debug] [Thread-1 (]: Finished running node test.dbt_project.unique_dim_time_date_day.d8637451e0
[0m15:14:39.552240 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:14:39.552240 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:14:39.552240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_is_weekend.f294374ebd, now test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba)
[0m15:14:39.552240 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:14:39.553637 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_time_year.6fb9595d53, now test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505)
[0m15:14:39.556644 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m15:14:39.556644 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:14:39.557647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_time_date_day.d8637451e0, now test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947)
[0m15:14:39.557647 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:14:39.561154 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba"
[0m15:14:39.561154 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:14:39.564189 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505"
[0m15:14:39.567261 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947"
[0m15:14:39.568263 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:14:39.569265 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m15:14:39.569265 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:14:39.569265 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:14:39.570768 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f)
[0m15:14:39.571279 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba
[0m15:14:39.571279 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:14:39.572065 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:14:39.572065 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:14:39.572568 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:14:39.572568 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505
[0m15:14:39.573571 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947
[0m15:14:39.576578 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f"
[0m15:14:39.577592 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_customers_customer_unique_id.7144461cba, now test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879)
[0m15:14:39.577592 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:14:39.578622 [debug] [Thread-1 (]: Began running node model.dbt_project.dim_customers
[0m15:14:39.578622 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:14:39.578622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_item_id.5aad00a505, now test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f)
[0m15:14:39.579624 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_order_id.247fd2b947, now model.dbt_project.dim_customers)
[0m15:14:39.582659 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879"
[0m15:14:39.582659 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:14:39.584106 [debug] [Thread-1 (]: Began compiling node model.dbt_project.dim_customers
[0m15:14:39.584106 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:14:39.589125 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f"
[0m15:14:39.592132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.dim_customers"
[0m15:14:39.592786 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f
[0m15:14:39.592786 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:14:39.592786 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:14:39.593799 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879
[0m15:14:39.594801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_product_id.59ea49a46f, now test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5)
[0m15:14:39.594801 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:14:39.595878 [debug] [Thread-1 (]: Began executing node model.dbt_project.dim_customers
[0m15:14:39.595878 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:14:39.595878 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:14:39.597233 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f
[0m15:14:39.597233 [debug] [Thread-1 (]: Finished running node model.dbt_project.dim_customers
[0m15:14:39.597233 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_items_ordered_seller_id.1e68ff9879, now test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64)
[0m15:14:39.600528 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5"
[0m15:14:39.601849 [debug] [Thread-3 (]: Began running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:14:39.601849 [debug] [Thread-1 (]: Began running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:14:39.602871 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:14:39.602871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_order_payment_order_id.a247e92d3f, now test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b)
[0m15:14:39.603875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_customers, now test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8)
[0m15:14:39.607191 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64"
[0m15:14:39.607191 [debug] [Thread-3 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:14:39.607191 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:14:39.608222 [debug] [Thread-1 (]: Began compiling node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:14:39.614449 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b"
[0m15:14:39.615450 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5
[0m15:14:39.619469 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8"
[0m15:14:39.619469 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:14:39.620470 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:14:39.621500 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64
[0m15:14:39.621500 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_customer_id.af79d5e4b5, now test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m15:14:39.621500 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:14:39.622531 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:14:39.622531 [debug] [Thread-3 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:14:39.622531 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_orders_order_id.81cfe2fe64, now test.dbt_project.unique_stg_orders_order_id.e3b841c71a)
[0m15:14:39.623533 [debug] [Thread-1 (]: Began executing node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:14:39.627835 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m15:14:39.628838 [debug] [Thread-3 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b
[0m15:14:39.628838 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:14:39.628838 [debug] [Thread-1 (]: Finished running node test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8
[0m15:14:39.630340 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_sellers
[0m15:14:39.633537 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_orders_order_id.e3b841c71a"
[0m15:14:39.633537 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:14:39.633537 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_order_id__order_id__ref_stg_orders_.2dbc91952b, now model.dbt_project.dim_sellers)
[0m15:14:39.633537 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:14:39.634922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_order_payment_order_id__order_id__ref_stg_orders_.63529acec8, now test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315)
[0m15:14:39.634922 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_sellers
[0m15:14:39.635924 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m15:14:39.635924 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:14:39.639031 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_sellers"
[0m15:14:39.639031 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:14:39.640535 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:14:39.643040 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315"
[0m15:14:39.644406 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_orders_order_id.e3b841c71a
[0m15:14:39.644406 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87)
[0m15:14:39.645409 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:14:39.645409 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:14:39.645409 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_sellers
[0m15:14:39.646410 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_orders_order_id.e3b841c71a, now test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8)
[0m15:14:39.650913 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87"
[0m15:14:39.652056 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_sellers
[0m15:14:39.652056 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:14:39.652056 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:14:39.652056 [debug] [Thread-3 (]: Began running node model.dbt_project.dim_products
[0m15:14:39.653354 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315
[0m15:14:39.658357 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8"
[0m15:14:39.658357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_sellers, now model.dbt_project.dim_products)
[0m15:14:39.658357 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:14:39.659807 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:14:39.660316 [debug] [Thread-3 (]: Began compiling node model.dbt_project.dim_products
[0m15:14:39.661318 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87
[0m15:14:39.661318 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_sellers_seller_id.35d0bce315, now test.dbt_project.not_null_stg_products_product_id.6373b0acf3)
[0m15:14:39.664410 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.dim_products"
[0m15:14:39.664410 [debug] [Thread-2 (]: Began running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:14:39.665414 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:14:39.665414 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:14:39.666419 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_seller_id__seller_id__ref_stg_sellers_.37dae98b87, now test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c)
[0m15:14:39.666419 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8
[0m15:14:39.670303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_stg_products_product_id.6373b0acf3"
[0m15:14:39.670303 [debug] [Thread-2 (]: Began compiling node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:14:39.670303 [debug] [Thread-3 (]: Began executing node model.dbt_project.dim_products
[0m15:14:39.671304 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:14:39.675397 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c"
[0m15:14:39.676397 [debug] [Thread-3 (]: Finished running node model.dbt_project.dim_products
[0m15:14:39.677473 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_sellers_seller_id.cb2e34d4b8, now test.dbt_project.unique_stg_products_product_id.7d950a1467)
[0m15:14:39.677473 [debug] [Thread-3 (]: Began running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:14:39.678476 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:14:39.678476 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:14:39.678476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.dim_products, now test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf)
[0m15:14:39.679479 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_stg_products_product_id.6373b0acf3
[0m15:14:39.683494 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_stg_products_product_id.7d950a1467"
[0m15:14:39.683494 [debug] [Thread-2 (]: Began executing node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:14:39.683494 [debug] [Thread-3 (]: Began compiling node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:14:39.683494 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:14:39.684924 [debug] [Thread-2 (]: Finished running node test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c
[0m15:14:39.690439 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf"
[0m15:14:39.691440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_stg_products_product_id.6373b0acf3, now test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m15:14:39.691440 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:14:39.692103 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:14:39.692709 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:14:39.692709 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.relationships_stg_items_ordered_product_id__product_id__ref_stg_products_.653853a51c, now test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba)
[0m15:14:39.693814 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_stg_products_product_id.7d950a1467
[0m15:14:39.696825 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m15:14:39.697826 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:14:39.697826 [debug] [Thread-3 (]: Began executing node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:14:39.697826 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:14:39.701935 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba"
[0m15:14:39.701935 [debug] [Thread-3 (]: Finished running node test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf
[0m15:14:39.701935 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_stg_products_product_id.7d950a1467, now test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d)
[0m15:14:39.703187 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:14:39.703187 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:14:39.704197 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:14:39.704197 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d
[0m15:14:39.705278 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_customers_customer_segment__Champion__Loyal__Potential__At_Risk__Needs_Attention.790289fcbf, now test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3)
[0m15:14:39.705278 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:14:39.708566 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d"
[0m15:14:39.708566 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:14:39.708566 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:14:39.710038 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba
[0m15:14:39.710541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_project.not_null_dim_customers_lifetime_value.8655024888)
[0m15:14:39.713707 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3"
[0m15:14:39.714211 [debug] [Thread-2 (]: Began running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:14:39.714211 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:14:39.715227 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:14:39.715227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_segment.bc342ee8ba, now test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a)
[0m15:14:39.716229 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d
[0m15:14:39.719617 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_customers_lifetime_value.8655024888"
[0m15:14:39.719617 [debug] [Thread-2 (]: Began compiling node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:14:39.720617 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:14:39.720617 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:14:39.727888 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a"
[0m15:14:39.727888 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3
[0m15:14:39.727888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_customer_unique_id.e3fe18087d, now test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c)
[0m15:14:39.729202 [debug] [Thread-3 (]: Began running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:14:39.729202 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:14:39.729202 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:14:39.730705 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_orders.9712bd37b3, now test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d)
[0m15:14:39.731212 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_customers_lifetime_value.8655024888
[0m15:14:39.734226 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c"
[0m15:14:39.734226 [debug] [Thread-3 (]: Began compiling node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:14:39.734226 [debug] [Thread-2 (]: Began executing node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:14:39.735452 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:14:39.738795 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d"
[0m15:14:39.738795 [debug] [Thread-2 (]: Finished running node test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a
[0m15:14:39.738795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_customers_lifetime_value.8655024888, now test.dbt_project.not_null_dim_sellers_state.e0c340c724)
[0m15:14:39.740298 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:14:39.741300 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:14:39.741300 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:14:39.741993 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c
[0m15:14:39.742573 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_sellers_seller_tier__Top_Seller__High_Volume__Active__Low_Volume__Inactive.287f35379a, now test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b)
[0m15:14:39.742573 [debug] [Thread-3 (]: Began executing node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:14:39.745573 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_state.e0c340c724"
[0m15:14:39.746573 [debug] [Thread-4 (]: Began running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:14:39.746573 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:14:39.747688 [debug] [Thread-3 (]: Finished running node test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d
[0m15:14:39.747688 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_id.2e68260d7c, now test.dbt_project.unique_dim_sellers_seller_id.b55e677f09)
[0m15:14:39.751571 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b"
[0m15:14:39.751571 [debug] [Thread-3 (]: Began running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:14:39.751571 [debug] [Thread-4 (]: Began compiling node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:14:39.752762 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:14:39.752762 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_seller_tier.8c1945722d, now test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68)
[0m15:14:39.756280 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.unique_dim_sellers_seller_id.b55e677f09"
[0m15:14:39.757292 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_sellers_state.e0c340c724
[0m15:14:39.757292 [debug] [Thread-3 (]: Began compiling node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:14:39.757292 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:14:39.758373 [debug] [Thread-1 (]: Began running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:14:39.764478 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68"
[0m15:14:39.764478 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b
[0m15:14:39.764478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_state.e0c340c724, now test.dbt_project.not_null_dim_products_product_id.c8aba288d1)
[0m15:14:39.765961 [debug] [Thread-4 (]: Began executing node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:14:39.765961 [debug] [Thread-2 (]: Began running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:14:39.765961 [debug] [Thread-1 (]: Began compiling node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:14:39.766983 [debug] [Thread-4 (]: Finished running node test.dbt_project.unique_dim_sellers_seller_id.b55e677f09
[0m15:14:39.768170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_project.not_null_dim_sellers_total_orders.9d7726b37b, now test.dbt_project.not_null_dim_products_sales_category.882d9c4faa)
[0m15:14:39.771182 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_product_id.c8aba288d1"
[0m15:14:39.771182 [debug] [Thread-4 (]: Began running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:14:39.772214 [debug] [Thread-3 (]: Began executing node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:14:39.772214 [debug] [Thread-2 (]: Began compiling node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:14:39.772214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_project.unique_dim_sellers_seller_id.b55e677f09, now test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a)
[0m15:14:39.773217 [debug] [Thread-3 (]: Finished running node test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68
[0m15:14:39.776274 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_sales_category.882d9c4faa"
[0m15:14:39.776274 [debug] [Thread-4 (]: Began compiling node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:14:39.776274 [debug] [Thread-1 (]: Began executing node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:14:39.777541 [debug] [Thread-3 (]: Began running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:14:39.780545 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a"
[0m15:14:39.781551 [debug] [Thread-1 (]: Finished running node test.dbt_project.not_null_dim_products_product_id.c8aba288d1
[0m15:14:39.781551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_project.accepted_values_dim_products_sales_category__Best_Seller__Popular__Regular__Slow_Moving__Never_Sold.f5063f8d68, now test.dbt_project.unique_dim_products_product_id.ef7b2a9985)
[0m15:14:39.782206 [debug] [Thread-2 (]: Began executing node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:14:39.782206 [debug] [Thread-3 (]: Began compiling node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:14:39.783455 [debug] [Thread-2 (]: Finished running node test.dbt_project.not_null_dim_products_sales_category.882d9c4faa
[0m15:14:39.786461 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_project.unique_dim_products_product_id.ef7b2a9985"
[0m15:14:39.786461 [debug] [Thread-4 (]: Began executing node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:14:39.787823 [debug] [Thread-4 (]: Finished running node test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a
[0m15:14:39.788915 [debug] [Thread-3 (]: Began executing node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:14:39.788915 [debug] [Thread-3 (]: Finished running node test.dbt_project.unique_dim_products_product_id.ef7b2a9985
[0m15:14:39.790418 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:39.790418 [debug] [MainThread]: Connection 'list_ecommerce_raw_public' was properly closed.
[0m15:14:39.791419 [debug] [MainThread]: Connection 'test.dbt_project.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m15:14:39.791923 [debug] [MainThread]: Connection 'test.dbt_project.not_null_dim_products_sales_category.882d9c4faa' was properly closed.
[0m15:14:39.791923 [debug] [MainThread]: Connection 'test.dbt_project.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m15:14:39.791923 [debug] [MainThread]: Connection 'test.dbt_project.not_null_dim_products_times_sold.c2fc0f643a' was properly closed.
[0m15:14:39.798361 [debug] [MainThread]: Command end result
[0m15:14:39.923771 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:14:39.942464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:14:39.950567 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\run_results.json
[0m15:14:40.472313 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m15:14:40.472313 [info ] [MainThread]: Building catalog
[0m15:14:40.482500 [debug] [ThreadPool]: Acquiring new postgres connection 'ecommerce_raw.information_schema'
[0m15:14:40.488868 [debug] [ThreadPool]: Using postgres connection "ecommerce_raw.information_schema"
[0m15:14:40.488868 [debug] [ThreadPool]: On ecommerce_raw.information_schema: BEGIN
[0m15:14:40.488868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:40.527103 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m15:14:40.528517 [debug] [ThreadPool]: Using postgres connection "ecommerce_raw.information_schema"
[0m15:14:40.528517 [debug] [ThreadPool]: On ecommerce_raw.information_schema: /* {"app": "dbt", "dbt_version": "1.9.10", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "ecommerce_raw.information_schema"} */

    
    

    select
        'ecommerce_raw' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_sellers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_orders_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_order_payments_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_sellers_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_sellers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_customers_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_products_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_time')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_customers')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_order_reviews_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('dim_products')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_items_ordered')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_order_payment')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_order_items_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('product_category_name_translation')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('olist_geolocation_dataset')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_name_translation')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m15:14:40.541040 [debug] [ThreadPool]: SQL status: SELECT 142 in 0.012 seconds
[0m15:14:40.545561 [debug] [ThreadPool]: On ecommerce_raw.information_schema: ROLLBACK
[0m15:14:40.545561 [debug] [ThreadPool]: On ecommerce_raw.information_schema: Close
[0m15:14:40.560444 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\catalog.json
[0m15:14:40.586108 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\manifest.json
[0m15:14:40.589176 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\semantic_manifest.json
[0m15:14:40.589176 [info ] [MainThread]: Catalog written to C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\target\catalog.json
[0m15:14:40.590679 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:14:40.590679 after 2.48 seconds
[0m15:14:40.591188 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:14:40.591188 [debug] [MainThread]: Connection 'ecommerce_raw.information_schema' was properly closed.
[0m15:14:40.591846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE813BC860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE813BDD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EEFF15B980>]}
[0m15:14:40.591846 [debug] [MainThread]: Flushing usage events
[0m15:14:42.172334 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:57.103706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75A131040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B759D72540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B759D70FE0>]}


============================== 15:14:57.107715 | bbae9654-3e66-44c0-8acb-f8e8d6fe465d ==============================
[0m15:14:57.107715 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:14:57.108716 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'invocation_command': 'dbt docs serve', 'no_print': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'use_colors': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m15:14:57.297252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbae9654-3e66-44c0-8acb-f8e8d6fe465d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75A131460>]}
[0m15:14:57.350368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbae9654-3e66-44c0-8acb-f8e8d6fe465d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B759F38AA0>]}
[0m15:15:24.308082 [error] [MainThread]: Encountered an error:

[0m15:15:24.353312 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:15:24.354325 [debug] [MainThread]: Command `dbt docs serve` failed at 15:15:24.354325 after 27.35 seconds
[0m15:15:24.355334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75A208F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75A41F230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75A41F2F0>]}
[0m15:15:24.355334 [debug] [MainThread]: Flushing usage events
[0m15:15:26.032168 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:15:31.206712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E29B1FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E2260560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E20B0A70>]}


============================== 15:15:31.210978 | c83007f5-27e4-4fd4-94f9-8962a3ed97e6 ==============================
[0m15:15:31.210978 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:15:31.211980 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'log_format': 'default', 'profiles_dir': 'C:\\Users\\krang\\.dbt', 'cache_selected_only': 'False', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'fail_fast': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_path': 'C:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'quiet': 'False', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt docs serve', 'printer_width': '80', 'target_path': 'None'}
[0m15:15:31.399947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c83007f5-27e4-4fd4-94f9-8962a3ed97e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E3EA6B70>]}
[0m15:15:31.451967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c83007f5-27e4-4fd4-94f9-8962a3ed97e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E2AF9A00>]}
[0m15:17:27.739098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764ABA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764ABA720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764ABB740>]}


============================== 15:17:27.744953 | 5fde08bd-8d2a-4ea5-bc6b-c709585e0849 ==============================
[0m15:17:27.744953 [info ] [MainThread]: Running with dbt=1.9.10
[0m15:17:27.746879 [debug] [MainThread]: running dbt with arguments {'profiles_dir': 'C:\\Users\\krang\\.dbt', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'log_path': 'c:\\Users\\krang\\OneDrive\\Desktop\\Projects\\ecommerce-analytics-platform\\logs', 'fail_fast': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'indirect_selection': 'eager', 'version_check': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'log_cache_events': 'False', 'debug': 'False', 'no_print': 'None', 'invocation_command': 'dbt ', 'cache_selected_only': 'False', 'write_json': 'True'}
[0m15:17:27.889729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fde08bd-8d2a-4ea5-bc6b-c709585e0849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764F554F0>]}
[0m15:17:27.930320 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:17:27.933341 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:17:27.936716 [debug] [MainThread]: Command `cli deps` succeeded at 15:17:27.936716 after 0.32 seconds
[0m15:17:27.937738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764F55220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764F54E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020764F54E00>]}
[0m15:17:27.938738 [debug] [MainThread]: Flushing usage events
[0m15:17:31.824591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:18:27.899368 [error] [MainThread]: Encountered an error:

[0m15:18:27.944688 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\krang\OneDrive\Desktop\Projects\ecommerce-analytics-platform\.venv\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\krang\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:18:27.954440 [debug] [MainThread]: Command `dbt docs serve` failed at 15:18:27.953332 after 176.87 seconds
[0m15:18:27.961252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E266A3C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E2ACC7A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249E2ACF2F0>]}
[0m15:18:27.964403 [debug] [MainThread]: Flushing usage events
[0m15:18:29.596018 [debug] [MainThread]: An error was encountered while trying to flush usage events
